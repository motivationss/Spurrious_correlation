wandb: Currently logged in as: gaotang (use `wandb login --relogin` to force relogin)
wandb: wandb version 0.12.21 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.8
wandb: Syncing run divine-field-70
wandb: ‚≠êÔ∏è View project at https://wandb.ai/gaotang/spurious_CUB
wandb: üöÄ View run at https://wandb.ai/gaotang/spurious_CUB/runs/g6hf7a8r
wandb: Run data is saved locally in wandb/run-20220717_182237-g6hf7a8r
wandb: Run `wandb off` to turn off syncing.
Dataset: CUB
Shift type: confounder
Wandb: True
Project name: spurious
Target name: waterbird_complete95
Confounder names: ['forest2water2']
Up weight: 100
Resume: True
Minority fraction: None
Imbalance ratio: None
Fraction: 1.0
Root dir: ./cub
Reweight groups: False
Augment data: False
Val fraction: 0.1
Loss type: erm
Alpha: 0.2
Generalization adjustment: 0.0
Automatic adjustment: False
Robust step size: 0.01
Joint dro alpha: 1
Use normalized loss: False
Btl: False
Hinge: False
Model: resnet50
Train from scratch: False
N epochs: 300
Batch size: 64
Lr: 1e-05
Scheduler: False
Weight decay: 0.0
Gamma: 0.1
Minimum variational weight: 0
Seed: 0
Show progress: False
Log dir: results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs
Log every: 50
Save step: 10
Save best: False
Save last: False
Use bert params: 1
Num folds per sweep: 5
Num sweeps: 4
Q: 0.7
Metadata csv name: metadata.csv
Fold: None
Metadata path: results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/metadata_aug.csv
Aug col: wrong_1_times

Reading './cub/data/waterbird_complete95_forest2water2/metadata.csv'
length of train_data:  4795
length of test_data:  5794
length of val_data:  1199
args fold:  None
len 4795 275
Up-weight factor: 100
Training Data...
    waterbird_complete95 = 0, forest2water2 = 0: n = 4198
    waterbird_complete95 = 0, forest2water2 = 1: n = 7484
    waterbird_complete95 = 1, forest2water2 = 0: n = 5156
    waterbird_complete95 = 1, forest2water2 = 1: n = 15457
Validation Data...
    waterbird_complete95 = 0, forest2water2 = 0: n = 467
    waterbird_complete95 = 0, forest2water2 = 1: n = 466
    waterbird_complete95 = 1, forest2water2 = 0: n = 133
    waterbird_complete95 = 1, forest2water2 = 1: n = 133
Test Data...
    waterbird_complete95 = 0, forest2water2 = 0: n = 2255
    waterbird_complete95 = 0, forest2water2 = 1: n = 2255
    waterbird_complete95 = 1, forest2water2 = 0: n = 642
    waterbird_complete95 = 1, forest2water2 = 1: n = 642

Epoch [0]:
Training:
Average incurred loss: 1.137  
Average sample loss: 1.137  
Average acc: 0.356  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 440]:	loss = 0.111  exp loss = 0.150  adjusted loss = 0.150  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 0, forest2water2 = 1  [n = 715]:	loss = 0.594  exp loss = 0.787  adjusted loss = 0.787  adv prob = 0.250000   acc = 0.684
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 1.851  exp loss = 1.452  adjusted loss = 1.452  adv prob = 0.250000   acc = 0.041
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 1.446  exp loss = 1.121  adjusted loss = 1.121  adv prob = 0.250000   acc = 0.129
Average incurred loss: 0.808  
Average sample loss: 0.808  
Average acc: 0.465  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 409]:	loss = 0.258  exp loss = 0.310  adjusted loss = 0.310  adv prob = 0.250000   acc = 0.922
  waterbird_complete95 = 0, forest2water2 = 1  [n = 738]:	loss = 1.127  exp loss = 1.246  adjusted loss = 1.246  adv prob = 0.250000   acc = 0.134
  waterbird_complete95 = 1, forest2water2 = 0  [n = 533]:	loss = 0.998  exp loss = 0.843  adjusted loss = 0.843  adv prob = 0.250000   acc = 0.345
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1520]:	loss = 0.733  exp loss = 0.604  adjusted loss = 0.604  adv prob = 0.250000   acc = 0.545
Average incurred loss: 0.722  
Average sample loss: 0.722  
Average acc: 0.577  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 454]:	loss = 0.374  exp loss = 0.391  adjusted loss = 0.391  adv prob = 0.250000   acc = 0.833
  waterbird_complete95 = 0, forest2water2 = 1  [n = 730]:	loss = 1.374  exp loss = 1.365  adjusted loss = 1.365  adv prob = 0.250000   acc = 0.053
  waterbird_complete95 = 1, forest2water2 = 0  [n = 528]:	loss = 0.713  exp loss = 0.682  adjusted loss = 0.682  adv prob = 0.250000   acc = 0.595
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1488]:	loss = 0.512  exp loss = 0.488  adjusted loss = 0.488  adv prob = 0.250000   acc = 0.749
Average incurred loss: 0.683  
Average sample loss: 0.683  
Average acc: 0.624  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 395]:	loss = 0.402  exp loss = 0.399  adjusted loss = 0.399  adv prob = 0.250000   acc = 0.828
  waterbird_complete95 = 0, forest2water2 = 1  [n = 769]:	loss = 1.351  exp loss = 1.346  adjusted loss = 1.346  adv prob = 0.250000   acc = 0.061
  waterbird_complete95 = 1, forest2water2 = 0  [n = 489]:	loss = 0.612  exp loss = 0.579  adjusted loss = 0.579  adv prob = 0.250000   acc = 0.720
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1547]:	loss = 0.444  exp loss = 0.439  adjusted loss = 0.439  adv prob = 0.250000   acc = 0.821
Average incurred loss: 0.650  
Average sample loss: 0.650  
Average acc: 0.652  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.409  exp loss = 0.443  adjusted loss = 0.443  adv prob = 0.250000   acc = 0.828
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 1.336  exp loss = 1.316  adjusted loss = 1.316  adv prob = 0.250000   acc = 0.056
  waterbird_complete95 = 1, forest2water2 = 0  [n = 537]:	loss = 0.549  exp loss = 0.574  adjusted loss = 0.574  adv prob = 0.250000   acc = 0.775
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.417  exp loss = 0.401  adjusted loss = 0.401  adv prob = 0.250000   acc = 0.851
Average incurred loss: 0.626  
Average sample loss: 0.626  
Average acc: 0.657  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.434  exp loss = 0.399  adjusted loss = 0.399  adv prob = 0.250000   acc = 0.799
  waterbird_complete95 = 0, forest2water2 = 1  [n = 762]:	loss = 1.251  exp loss = 1.226  adjusted loss = 1.226  adv prob = 0.250000   acc = 0.071
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.500  exp loss = 0.472  adjusted loss = 0.472  adv prob = 0.250000   acc = 0.809
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1508]:	loss = 0.407  exp loss = 0.404  adjusted loss = 0.404  adv prob = 0.250000   acc = 0.863
Average incurred loss: 0.594  
Average sample loss: 0.594  
Average acc: 0.688  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.426  exp loss = 0.397  adjusted loss = 0.397  adv prob = 0.250000   acc = 0.820
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 1.207  exp loss = 1.193  adjusted loss = 1.193  adv prob = 0.250000   acc = 0.093
  waterbird_complete95 = 1, forest2water2 = 0  [n = 468]:	loss = 0.448  exp loss = 0.419  adjusted loss = 0.419  adv prob = 0.250000   acc = 0.861
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1598]:	loss = 0.404  exp loss = 0.399  adjusted loss = 0.399  adv prob = 0.250000   acc = 0.873
Average incurred loss: 0.581  
Average sample loss: 0.581  
Average acc: 0.699  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 403]:	loss = 0.439  exp loss = 0.450  adjusted loss = 0.450  adv prob = 0.250000   acc = 0.819
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 1.156  exp loss = 1.162  adjusted loss = 1.162  adv prob = 0.250000   acc = 0.119
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.422  exp loss = 0.418  adjusted loss = 0.418  adv prob = 0.250000   acc = 0.879
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.392  exp loss = 0.401  adjusted loss = 0.401  adv prob = 0.250000   acc = 0.888
Average incurred loss: 0.557  
Average sample loss: 0.557  
Average acc: 0.712  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 395]:	loss = 0.405  exp loss = 0.392  adjusted loss = 0.392  adv prob = 0.250000   acc = 0.843
  waterbird_complete95 = 0, forest2water2 = 1  [n = 745]:	loss = 1.118  exp loss = 1.130  adjusted loss = 1.130  adv prob = 0.250000   acc = 0.152
  waterbird_complete95 = 1, forest2water2 = 0  [n = 492]:	loss = 0.409  exp loss = 0.396  adjusted loss = 0.396  adv prob = 0.250000   acc = 0.866
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1568]:	loss = 0.376  exp loss = 0.364  adjusted loss = 0.364  adv prob = 0.250000   acc = 0.897
Average incurred loss: 0.542  
Average sample loss: 0.542  
Average acc: 0.713  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.433  exp loss = 0.477  adjusted loss = 0.477  adv prob = 0.250000   acc = 0.843
  waterbird_complete95 = 0, forest2water2 = 1  [n = 760]:	loss = 1.036  exp loss = 1.030  adjusted loss = 1.030  adv prob = 0.250000   acc = 0.184
  waterbird_complete95 = 1, forest2water2 = 0  [n = 525]:	loss = 0.386  exp loss = 0.380  adjusted loss = 0.380  adv prob = 0.250000   acc = 0.878
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1494]:	loss = 0.375  exp loss = 0.373  adjusted loss = 0.373  adv prob = 0.250000   acc = 0.886
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_0.csv
logged to wandb
Average incurred loss: 0.499  
Average sample loss: 0.496  
Average acc: 0.756  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 39]:	loss = 0.363  exp loss = 0.414  adjusted loss = 0.414  adv prob = 0.250000   acc = 0.923
  waterbird_complete95 = 0, forest2water2 = 1  [n = 60]:	loss = 0.990  exp loss = 1.014  adjusted loss = 1.014  adv prob = 0.250000   acc = 0.233
  waterbird_complete95 = 1, forest2water2 = 0  [n = 47]:	loss = 0.372  exp loss = 0.374  adjusted loss = 0.374  adv prob = 0.250000   acc = 0.872
  waterbird_complete95 = 1, forest2water2 = 1  [n = 149]:	loss = 0.377  exp loss = 0.372  adjusted loss = 0.372  adv prob = 0.250000   acc = 0.886

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_0.csv
logged to wandb
Average incurred loss: 0.540  
Average sample loss: 0.539  
Average acc: 0.736  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.350  exp loss = 0.344  adjusted loss = 0.344  adv prob = 0.250000   acc = 0.925
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.859  exp loss = 0.867  adjusted loss = 0.867  adv prob = 0.250000   acc = 0.470
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.477  exp loss = 0.522  adjusted loss = 0.522  adv prob = 0.250000   acc = 0.774
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.158  exp loss = 0.162  adjusted loss = 0.162  adv prob = 0.250000   acc = 0.970
Spurious Score = 1.523
Weighted Spurious Score = 1.742
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_0.csv
logged to wandb
Current lr: 0.000010


Epoch [1]:
Training:
Average incurred loss: 0.526  
Average sample loss: 0.526  
Average acc: 0.721  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 436]:	loss = 0.413  exp loss = 0.395  adjusted loss = 0.395  adv prob = 0.250000   acc = 0.869
  waterbird_complete95 = 0, forest2water2 = 1  [n = 747]:	loss = 0.990  exp loss = 0.971  adjusted loss = 0.971  adv prob = 0.250000   acc = 0.209
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.373  exp loss = 0.352  adjusted loss = 0.352  adv prob = 0.250000   acc = 0.876
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.380  exp loss = 0.390  adjusted loss = 0.390  adv prob = 0.250000   acc = 0.880
Average incurred loss: 0.514  
Average sample loss: 0.514  
Average acc: 0.742  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 456]:	loss = 0.410  exp loss = 0.399  adjusted loss = 0.399  adv prob = 0.250000   acc = 0.888
  waterbird_complete95 = 0, forest2water2 = 1  [n = 769]:	loss = 0.948  exp loss = 0.877  adjusted loss = 0.877  adv prob = 0.250000   acc = 0.272
  waterbird_complete95 = 1, forest2water2 = 0  [n = 493]:	loss = 0.366  exp loss = 0.404  adjusted loss = 0.404  adv prob = 0.250000   acc = 0.880
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1482]:	loss = 0.370  exp loss = 0.362  adjusted loss = 0.362  adv prob = 0.250000   acc = 0.895
Average incurred loss: 0.488  
Average sample loss: 0.488  
Average acc: 0.760  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 401]:	loss = 0.392  exp loss = 0.421  adjusted loss = 0.421  adv prob = 0.250000   acc = 0.878
  waterbird_complete95 = 0, forest2water2 = 1  [n = 750]:	loss = 0.865  exp loss = 0.840  adjusted loss = 0.840  adv prob = 0.250000   acc = 0.345
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.363  exp loss = 0.325  adjusted loss = 0.325  adv prob = 0.250000   acc = 0.878
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1548]:	loss = 0.370  exp loss = 0.369  adjusted loss = 0.369  adv prob = 0.250000   acc = 0.893
Average incurred loss: 0.478  
Average sample loss: 0.478  
Average acc: 0.758  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 389]:	loss = 0.402  exp loss = 0.394  adjusted loss = 0.394  adv prob = 0.250000   acc = 0.869
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.872  exp loss = 0.862  adjusted loss = 0.862  adv prob = 0.250000   acc = 0.310
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.338  exp loss = 0.348  adjusted loss = 0.348  adv prob = 0.250000   acc = 0.876
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1574]:	loss = 0.356  exp loss = 0.340  adjusted loss = 0.340  adv prob = 0.250000   acc = 0.902
Average incurred loss: 0.458  
Average sample loss: 0.458  
Average acc: 0.785  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.424  exp loss = 0.389  adjusted loss = 0.389  adv prob = 0.250000   acc = 0.844
  waterbird_complete95 = 0, forest2water2 = 1  [n = 713]:	loss = 0.842  exp loss = 0.822  adjusted loss = 0.822  adv prob = 0.250000   acc = 0.376
  waterbird_complete95 = 1, forest2water2 = 0  [n = 529]:	loss = 0.308  exp loss = 0.307  adjusted loss = 0.307  adv prob = 0.250000   acc = 0.913
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1542]:	loss = 0.340  exp loss = 0.342  adjusted loss = 0.342  adv prob = 0.250000   acc = 0.914
Average incurred loss: 0.454  
Average sample loss: 0.454  
Average acc: 0.781  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.427  exp loss = 0.419  adjusted loss = 0.419  adv prob = 0.250000   acc = 0.871
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.823  exp loss = 0.829  adjusted loss = 0.829  adv prob = 0.250000   acc = 0.389
  waterbird_complete95 = 1, forest2water2 = 0  [n = 476]:	loss = 0.298  exp loss = 0.293  adjusted loss = 0.293  adv prob = 0.250000   acc = 0.897
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1546]:	loss = 0.329  exp loss = 0.319  adjusted loss = 0.319  adv prob = 0.250000   acc = 0.911
Average incurred loss: 0.442  
Average sample loss: 0.442  
Average acc: 0.799  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.418  exp loss = 0.423  adjusted loss = 0.423  adv prob = 0.250000   acc = 0.862
  waterbird_complete95 = 0, forest2water2 = 1  [n = 731]:	loss = 0.793  exp loss = 0.801  adjusted loss = 0.801  adv prob = 0.250000   acc = 0.451
  waterbird_complete95 = 1, forest2water2 = 0  [n = 544]:	loss = 0.294  exp loss = 0.278  adjusted loss = 0.278  adv prob = 0.250000   acc = 0.888
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1511]:	loss = 0.333  exp loss = 0.315  adjusted loss = 0.315  adv prob = 0.250000   acc = 0.918
Average incurred loss: 0.422  
Average sample loss: 0.422  
Average acc: 0.820  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 386]:	loss = 0.425  exp loss = 0.413  adjusted loss = 0.413  adv prob = 0.250000   acc = 0.855
  waterbird_complete95 = 0, forest2water2 = 1  [n = 720]:	loss = 0.721  exp loss = 0.714  adjusted loss = 0.714  adv prob = 0.250000   acc = 0.539
  waterbird_complete95 = 1, forest2water2 = 0  [n = 535]:	loss = 0.288  exp loss = 0.282  adjusted loss = 0.282  adv prob = 0.250000   acc = 0.899
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1559]:	loss = 0.330  exp loss = 0.328  adjusted loss = 0.328  adv prob = 0.250000   acc = 0.914
Average incurred loss: 0.430  
Average sample loss: 0.430  
Average acc: 0.812  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.434  exp loss = 0.456  adjusted loss = 0.456  adv prob = 0.250000   acc = 0.852
  waterbird_complete95 = 0, forest2water2 = 1  [n = 750]:	loss = 0.754  exp loss = 0.753  adjusted loss = 0.753  adv prob = 0.250000   acc = 0.519
  waterbird_complete95 = 1, forest2water2 = 0  [n = 487]:	loss = 0.264  exp loss = 0.251  adjusted loss = 0.251  adv prob = 0.250000   acc = 0.908
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1531]:	loss = 0.322  exp loss = 0.316  adjusted loss = 0.316  adv prob = 0.250000   acc = 0.914
Average incurred loss: 0.416  
Average sample loss: 0.416  
Average acc: 0.822  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.426  exp loss = 0.430  adjusted loss = 0.430  adv prob = 0.250000   acc = 0.873
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.698  exp loss = 0.679  adjusted loss = 0.679  adv prob = 0.250000   acc = 0.567
  waterbird_complete95 = 1, forest2water2 = 0  [n = 535]:	loss = 0.273  exp loss = 0.251  adjusted loss = 0.251  adv prob = 0.250000   acc = 0.899
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1510]:	loss = 0.324  exp loss = 0.315  adjusted loss = 0.315  adv prob = 0.250000   acc = 0.907
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_1.csv
logged to wandb
Average incurred loss: 0.402  
Average sample loss: 0.399  
Average acc: 0.834  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 41]:	loss = 0.396  exp loss = 0.409  adjusted loss = 0.409  adv prob = 0.250000   acc = 0.854
  waterbird_complete95 = 0, forest2water2 = 1  [n = 63]:	loss = 0.712  exp loss = 0.682  adjusted loss = 0.682  adv prob = 0.250000   acc = 0.556
  waterbird_complete95 = 1, forest2water2 = 0  [n = 55]:	loss = 0.254  exp loss = 0.240  adjusted loss = 0.240  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 1, forest2water2 = 1  [n = 136]:	loss = 0.320  exp loss = 0.316  adjusted loss = 0.316  adv prob = 0.250000   acc = 0.904

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_1.csv
logged to wandb
Average incurred loss: 0.486  
Average sample loss: 0.485  
Average acc: 0.781  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.386  exp loss = 0.384  adjusted loss = 0.384  adv prob = 0.250000   acc = 0.899
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.710  exp loss = 0.734  adjusted loss = 0.734  adv prob = 0.250000   acc = 0.590
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.376  exp loss = 0.419  adjusted loss = 0.419  adv prob = 0.250000   acc = 0.857
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.165  exp loss = 0.167  adjusted loss = 0.167  adv prob = 0.250000   acc = 0.962
Spurious Score = 1.286
Weighted Spurious Score = 1.409
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_1.csv
logged to wandb
Current lr: 0.000010


Epoch [2]:
Training:
Average incurred loss: 0.405  
Average sample loss: 0.405  
Average acc: 0.835  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 433]:	loss = 0.422  exp loss = 0.375  adjusted loss = 0.375  adv prob = 0.250000   acc = 0.866
  waterbird_complete95 = 0, forest2water2 = 1  [n = 742]:	loss = 0.670  exp loss = 0.638  adjusted loss = 0.638  adv prob = 0.250000   acc = 0.593
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.256  exp loss = 0.266  adjusted loss = 0.266  adv prob = 0.250000   acc = 0.905
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1519]:	loss = 0.319  exp loss = 0.328  adjusted loss = 0.328  adv prob = 0.250000   acc = 0.920
Average incurred loss: 0.398  
Average sample loss: 0.398  
Average acc: 0.847  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.438  exp loss = 0.448  adjusted loss = 0.448  adv prob = 0.250000   acc = 0.841
  waterbird_complete95 = 0, forest2water2 = 1  [n = 736]:	loss = 0.647  exp loss = 0.629  adjusted loss = 0.629  adv prob = 0.250000   acc = 0.645
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.247  exp loss = 0.229  adjusted loss = 0.229  adv prob = 0.250000   acc = 0.940
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.318  exp loss = 0.321  adjusted loss = 0.321  adv prob = 0.250000   acc = 0.913
Average incurred loss: 0.384  
Average sample loss: 0.384  
Average acc: 0.860  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.425  exp loss = 0.396  adjusted loss = 0.396  adv prob = 0.250000   acc = 0.864
  waterbird_complete95 = 0, forest2water2 = 1  [n = 745]:	loss = 0.630  exp loss = 0.602  adjusted loss = 0.602  adv prob = 0.250000   acc = 0.662
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.239  exp loss = 0.224  adjusted loss = 0.224  adv prob = 0.250000   acc = 0.929
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1524]:	loss = 0.301  exp loss = 0.304  adjusted loss = 0.304  adv prob = 0.250000   acc = 0.932
Average incurred loss: 0.377  
Average sample loss: 0.377  
Average acc: 0.853  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.407  exp loss = 0.445  adjusted loss = 0.445  adv prob = 0.250000   acc = 0.863
  waterbird_complete95 = 0, forest2water2 = 1  [n = 766]:	loss = 0.619  exp loss = 0.613  adjusted loss = 0.613  adv prob = 0.250000   acc = 0.659
  waterbird_complete95 = 1, forest2water2 = 0  [n = 510]:	loss = 0.221  exp loss = 0.226  adjusted loss = 0.226  adv prob = 0.250000   acc = 0.929
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1514]:	loss = 0.298  exp loss = 0.285  adjusted loss = 0.285  adv prob = 0.250000   acc = 0.923
Average incurred loss: 0.362  
Average sample loss: 0.362  
Average acc: 0.870  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.393  exp loss = 0.355  adjusted loss = 0.355  adv prob = 0.250000   acc = 0.887
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.569  exp loss = 0.581  adjusted loss = 0.581  adv prob = 0.250000   acc = 0.729
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.234  exp loss = 0.228  adjusted loss = 0.228  adv prob = 0.250000   acc = 0.917
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1550]:	loss = 0.298  exp loss = 0.294  adjusted loss = 0.294  adv prob = 0.250000   acc = 0.918
Average incurred loss: 0.349  
Average sample loss: 0.349  
Average acc: 0.881  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 393]:	loss = 0.390  exp loss = 0.385  adjusted loss = 0.385  adv prob = 0.250000   acc = 0.878
  waterbird_complete95 = 0, forest2water2 = 1  [n = 728]:	loss = 0.548  exp loss = 0.544  adjusted loss = 0.544  adv prob = 0.250000   acc = 0.739
  waterbird_complete95 = 1, forest2water2 = 0  [n = 519]:	loss = 0.205  exp loss = 0.207  adjusted loss = 0.207  adv prob = 0.250000   acc = 0.954
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1560]:	loss = 0.293  exp loss = 0.284  adjusted loss = 0.284  adv prob = 0.250000   acc = 0.924
Average incurred loss: 0.338  
Average sample loss: 0.338  
Average acc: 0.889  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.386  exp loss = 0.366  adjusted loss = 0.366  adv prob = 0.250000   acc = 0.882
  waterbird_complete95 = 0, forest2water2 = 1  [n = 693]:	loss = 0.557  exp loss = 0.552  adjusted loss = 0.552  adv prob = 0.250000   acc = 0.727
  waterbird_complete95 = 1, forest2water2 = 0  [n = 539]:	loss = 0.207  exp loss = 0.210  adjusted loss = 0.210  adv prob = 0.250000   acc = 0.959
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1561]:	loss = 0.274  exp loss = 0.277  adjusted loss = 0.277  adv prob = 0.250000   acc = 0.939
Average incurred loss: 0.343  
Average sample loss: 0.343  
Average acc: 0.885  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.436  exp loss = 0.434  adjusted loss = 0.434  adv prob = 0.250000   acc = 0.825
  waterbird_complete95 = 0, forest2water2 = 1  [n = 768]:	loss = 0.540  exp loss = 0.521  adjusted loss = 0.521  adv prob = 0.250000   acc = 0.753
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.185  exp loss = 0.183  adjusted loss = 0.183  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1513]:	loss = 0.269  exp loss = 0.275  adjusted loss = 0.275  adv prob = 0.250000   acc = 0.943
Average incurred loss: 0.338  
Average sample loss: 0.338  
Average acc: 0.886  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.414  exp loss = 0.387  adjusted loss = 0.387  adv prob = 0.250000   acc = 0.849
  waterbird_complete95 = 0, forest2water2 = 1  [n = 736]:	loss = 0.511  exp loss = 0.456  adjusted loss = 0.456  adv prob = 0.250000   acc = 0.772
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.206  exp loss = 0.187  adjusted loss = 0.187  adv prob = 0.250000   acc = 0.940
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.278  exp loss = 0.282  adjusted loss = 0.282  adv prob = 0.250000   acc = 0.932
Average incurred loss: 0.331  
Average sample loss: 0.331  
Average acc: 0.898  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 440]:	loss = 0.408  exp loss = 0.395  adjusted loss = 0.395  adv prob = 0.250000   acc = 0.861
  waterbird_complete95 = 0, forest2water2 = 1  [n = 761]:	loss = 0.503  exp loss = 0.505  adjusted loss = 0.505  adv prob = 0.250000   acc = 0.791
  waterbird_complete95 = 1, forest2water2 = 0  [n = 500]:	loss = 0.191  exp loss = 0.194  adjusted loss = 0.194  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1499]:	loss = 0.267  exp loss = 0.279  adjusted loss = 0.279  adv prob = 0.250000   acc = 0.938
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_2.csv
logged to wandb
Average incurred loss: 0.310  
Average sample loss: 0.311  
Average acc: 0.929  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 33]:	loss = 0.349  exp loss = 0.376  adjusted loss = 0.376  adv prob = 0.250000   acc = 0.909
  waterbird_complete95 = 0, forest2water2 = 1  [n = 72]:	loss = 0.442  exp loss = 0.471  adjusted loss = 0.471  adv prob = 0.250000   acc = 0.875
  waterbird_complete95 = 1, forest2water2 = 0  [n = 38]:	loss = 0.177  exp loss = 0.190  adjusted loss = 0.190  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 1, forest2water2 = 1  [n = 152]:	loss = 0.272  exp loss = 0.278  adjusted loss = 0.278  adv prob = 0.250000   acc = 0.947

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_2.csv
logged to wandb
Average incurred loss: 0.456  
Average sample loss: 0.455  
Average acc: 0.794  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.404  exp loss = 0.404  adjusted loss = 0.404  adv prob = 0.250000   acc = 0.854
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.631  exp loss = 0.662  adjusted loss = 0.662  adv prob = 0.250000   acc = 0.663
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.317  exp loss = 0.358  adjusted loss = 0.358  adv prob = 0.250000   acc = 0.880
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.164  exp loss = 0.164  adjusted loss = 0.164  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.173
Weighted Spurious Score = 1.235
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_2.csv
logged to wandb
Current lr: 0.000010


Epoch [3]:
Training:
Average incurred loss: 0.317  
Average sample loss: 0.317  
Average acc: 0.907  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 406]:	loss = 0.391  exp loss = 0.376  adjusted loss = 0.376  adv prob = 0.250000   acc = 0.860
  waterbird_complete95 = 0, forest2water2 = 1  [n = 717]:	loss = 0.459  exp loss = 0.437  adjusted loss = 0.437  adv prob = 0.250000   acc = 0.827
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.192  exp loss = 0.188  adjusted loss = 0.188  adv prob = 0.250000   acc = 0.956
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1559]:	loss = 0.274  exp loss = 0.274  adjusted loss = 0.274  adv prob = 0.250000   acc = 0.940
Average incurred loss: 0.318  
Average sample loss: 0.318  
Average acc: 0.907  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.410  exp loss = 0.412  adjusted loss = 0.412  adv prob = 0.250000   acc = 0.836
  waterbird_complete95 = 0, forest2water2 = 1  [n = 754]:	loss = 0.476  exp loss = 0.463  adjusted loss = 0.463  adv prob = 0.250000   acc = 0.818
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.189  exp loss = 0.192  adjusted loss = 0.192  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.259  exp loss = 0.245  adjusted loss = 0.245  adv prob = 0.250000   acc = 0.943
Average incurred loss: 0.303  
Average sample loss: 0.303  
Average acc: 0.913  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 453]:	loss = 0.397  exp loss = 0.380  adjusted loss = 0.380  adv prob = 0.250000   acc = 0.859
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.448  exp loss = 0.422  adjusted loss = 0.422  adv prob = 0.250000   acc = 0.828
  waterbird_complete95 = 1, forest2water2 = 0  [n = 478]:	loss = 0.167  exp loss = 0.163  adjusted loss = 0.163  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1525]:	loss = 0.247  exp loss = 0.236  adjusted loss = 0.236  adv prob = 0.250000   acc = 0.949
Average incurred loss: 0.296  
Average sample loss: 0.296  
Average acc: 0.919  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.394  exp loss = 0.358  adjusted loss = 0.358  adv prob = 0.250000   acc = 0.852
  waterbird_complete95 = 0, forest2water2 = 1  [n = 718]:	loss = 0.419  exp loss = 0.432  adjusted loss = 0.432  adv prob = 0.250000   acc = 0.848
  waterbird_complete95 = 1, forest2water2 = 0  [n = 539]:	loss = 0.166  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.258  exp loss = 0.241  adjusted loss = 0.241  adv prob = 0.250000   acc = 0.948
Average incurred loss: 0.290  
Average sample loss: 0.290  
Average acc: 0.923  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.375  exp loss = 0.383  adjusted loss = 0.383  adv prob = 0.250000   acc = 0.874
  waterbird_complete95 = 0, forest2water2 = 1  [n = 747]:	loss = 0.427  exp loss = 0.416  adjusted loss = 0.416  adv prob = 0.250000   acc = 0.853
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.166  exp loss = 0.154  adjusted loss = 0.154  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1509]:	loss = 0.241  exp loss = 0.249  adjusted loss = 0.249  adv prob = 0.250000   acc = 0.949
Average incurred loss: 0.281  
Average sample loss: 0.281  
Average acc: 0.932  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 450]:	loss = 0.381  exp loss = 0.367  adjusted loss = 0.367  adv prob = 0.250000   acc = 0.867
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.395  exp loss = 0.398  adjusted loss = 0.398  adv prob = 0.250000   acc = 0.882
  waterbird_complete95 = 1, forest2water2 = 0  [n = 497]:	loss = 0.155  exp loss = 0.150  adjusted loss = 0.150  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1531]:	loss = 0.239  exp loss = 0.238  adjusted loss = 0.238  adv prob = 0.250000   acc = 0.956
Average incurred loss: 0.282  
Average sample loss: 0.282  
Average acc: 0.926  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.371  exp loss = 0.347  adjusted loss = 0.347  adv prob = 0.250000   acc = 0.874
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.404  exp loss = 0.380  adjusted loss = 0.380  adv prob = 0.250000   acc = 0.842
  waterbird_complete95 = 1, forest2water2 = 0  [n = 519]:	loss = 0.158  exp loss = 0.170  adjusted loss = 0.170  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1520]:	loss = 0.241  exp loss = 0.235  adjusted loss = 0.235  adv prob = 0.250000   acc = 0.959
Average incurred loss: 0.274  
Average sample loss: 0.274  
Average acc: 0.932  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 391]:	loss = 0.392  exp loss = 0.404  adjusted loss = 0.404  adv prob = 0.250000   acc = 0.852
  waterbird_complete95 = 0, forest2water2 = 1  [n = 761]:	loss = 0.378  exp loss = 0.356  adjusted loss = 0.356  adv prob = 0.250000   acc = 0.876
  waterbird_complete95 = 1, forest2water2 = 0  [n = 532]:	loss = 0.149  exp loss = 0.136  adjusted loss = 0.136  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1516]:	loss = 0.235  exp loss = 0.219  adjusted loss = 0.219  adv prob = 0.250000   acc = 0.960
Average incurred loss: 0.267  
Average sample loss: 0.267  
Average acc: 0.937  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.394  exp loss = 0.400  adjusted loss = 0.400  adv prob = 0.250000   acc = 0.870
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.370  exp loss = 0.380  adjusted loss = 0.380  adv prob = 0.250000   acc = 0.870
  waterbird_complete95 = 1, forest2water2 = 0  [n = 486]:	loss = 0.138  exp loss = 0.136  adjusted loss = 0.136  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1545]:	loss = 0.222  exp loss = 0.205  adjusted loss = 0.205  adv prob = 0.250000   acc = 0.968
Average incurred loss: 0.266  
Average sample loss: 0.266  
Average acc: 0.934  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.396  exp loss = 0.430  adjusted loss = 0.430  adv prob = 0.250000   acc = 0.827
  waterbird_complete95 = 0, forest2water2 = 1  [n = 749]:	loss = 0.361  exp loss = 0.337  adjusted loss = 0.337  adv prob = 0.250000   acc = 0.892
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.152  exp loss = 0.147  adjusted loss = 0.147  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.223  exp loss = 0.227  adjusted loss = 0.227  adv prob = 0.250000   acc = 0.967
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_3.csv
logged to wandb
Average incurred loss: 0.277  
Average sample loss: 0.290  
Average acc: 0.912  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 36]:	loss = 0.418  exp loss = 0.428  adjusted loss = 0.428  adv prob = 0.250000   acc = 0.833
  waterbird_complete95 = 0, forest2water2 = 1  [n = 77]:	loss = 0.394  exp loss = 0.360  adjusted loss = 0.360  adv prob = 0.250000   acc = 0.818
  waterbird_complete95 = 1, forest2water2 = 0  [n = 39]:	loss = 0.134  exp loss = 0.131  adjusted loss = 0.131  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 143]:	loss = 0.219  exp loss = 0.218  adjusted loss = 0.218  adv prob = 0.250000   acc = 0.958

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_3.csv
logged to wandb
Average incurred loss: 0.456  
Average sample loss: 0.454  
Average acc: 0.797  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.429  exp loss = 0.430  adjusted loss = 0.430  adv prob = 0.250000   acc = 0.839
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.622  exp loss = 0.663  adjusted loss = 0.663  adv prob = 0.250000   acc = 0.674
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.271  exp loss = 0.308  adjusted loss = 0.308  adv prob = 0.250000   acc = 0.910
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.150  exp loss = 0.148  adjusted loss = 0.148  adv prob = 0.250000   acc = 0.970
Spurious Score = 1.143
Weighted Spurious Score = 1.198
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_3.csv
logged to wandb
Current lr: 0.000010


Epoch [4]:
Training:
Average incurred loss: 0.261  
Average sample loss: 0.261  
Average acc: 0.942  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.379  exp loss = 0.324  adjusted loss = 0.324  adv prob = 0.250000   acc = 0.860
  waterbird_complete95 = 0, forest2water2 = 1  [n = 774]:	loss = 0.351  exp loss = 0.324  adjusted loss = 0.324  adv prob = 0.250000   acc = 0.899
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.137  exp loss = 0.135  adjusted loss = 0.135  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1488]:	loss = 0.223  exp loss = 0.214  adjusted loss = 0.214  adv prob = 0.250000   acc = 0.968
Average incurred loss: 0.250  
Average sample loss: 0.250  
Average acc: 0.954  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.356  exp loss = 0.326  adjusted loss = 0.326  adv prob = 0.250000   acc = 0.888
  waterbird_complete95 = 0, forest2water2 = 1  [n = 712]:	loss = 0.313  exp loss = 0.308  adjusted loss = 0.308  adv prob = 0.250000   acc = 0.935
  waterbird_complete95 = 1, forest2water2 = 0  [n = 490]:	loss = 0.145  exp loss = 0.130  adjusted loss = 0.130  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1586]:	loss = 0.226  exp loss = 0.219  adjusted loss = 0.219  adv prob = 0.250000   acc = 0.965
Average incurred loss: 0.241  
Average sample loss: 0.241  
Average acc: 0.955  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 401]:	loss = 0.364  exp loss = 0.387  adjusted loss = 0.387  adv prob = 0.250000   acc = 0.860
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.322  exp loss = 0.314  adjusted loss = 0.314  adv prob = 0.250000   acc = 0.927
  waterbird_complete95 = 1, forest2water2 = 0  [n = 497]:	loss = 0.129  exp loss = 0.119  adjusted loss = 0.119  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1549]:	loss = 0.207  exp loss = 0.205  adjusted loss = 0.205  adv prob = 0.250000   acc = 0.980
Average incurred loss: 0.240  
Average sample loss: 0.240  
Average acc: 0.950  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.370  exp loss = 0.455  adjusted loss = 0.455  adv prob = 0.250000   acc = 0.862
  waterbird_complete95 = 0, forest2water2 = 1  [n = 695]:	loss = 0.313  exp loss = 0.323  adjusted loss = 0.323  adv prob = 0.250000   acc = 0.911
  waterbird_complete95 = 1, forest2water2 = 0  [n = 547]:	loss = 0.127  exp loss = 0.124  adjusted loss = 0.124  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.212  exp loss = 0.199  adjusted loss = 0.199  adv prob = 0.250000   acc = 0.974
Average incurred loss: 0.236  
Average sample loss: 0.236  
Average acc: 0.956  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 406]:	loss = 0.373  exp loss = 0.362  adjusted loss = 0.362  adv prob = 0.250000   acc = 0.865
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.320  exp loss = 0.312  adjusted loss = 0.312  adv prob = 0.250000   acc = 0.920
  waterbird_complete95 = 1, forest2water2 = 0  [n = 526]:	loss = 0.129  exp loss = 0.119  adjusted loss = 0.119  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1520]:	loss = 0.194  exp loss = 0.192  adjusted loss = 0.192  adv prob = 0.250000   acc = 0.984
Average incurred loss: 0.231  
Average sample loss: 0.231  
Average acc: 0.955  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.350  exp loss = 0.349  adjusted loss = 0.349  adv prob = 0.250000   acc = 0.873
  waterbird_complete95 = 0, forest2water2 = 1  [n = 745]:	loss = 0.312  exp loss = 0.282  adjusted loss = 0.282  adv prob = 0.250000   acc = 0.915
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.123  exp loss = 0.120  adjusted loss = 0.120  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.196  exp loss = 0.214  adjusted loss = 0.214  adv prob = 0.250000   acc = 0.981
Average incurred loss: 0.225  
Average sample loss: 0.225  
Average acc: 0.959  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.375  exp loss = 0.372  adjusted loss = 0.372  adv prob = 0.250000   acc = 0.846
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.292  exp loss = 0.322  adjusted loss = 0.322  adv prob = 0.250000   acc = 0.939
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.111  exp loss = 0.101  adjusted loss = 0.101  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1542]:	loss = 0.189  exp loss = 0.171  adjusted loss = 0.171  adv prob = 0.250000   acc = 0.985
Average incurred loss: 0.227  
Average sample loss: 0.227  
Average acc: 0.960  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.372  exp loss = 0.347  adjusted loss = 0.347  adv prob = 0.250000   acc = 0.865
  waterbird_complete95 = 0, forest2water2 = 1  [n = 763]:	loss = 0.293  exp loss = 0.276  adjusted loss = 0.276  adv prob = 0.250000   acc = 0.950
  waterbird_complete95 = 1, forest2water2 = 0  [n = 486]:	loss = 0.122  exp loss = 0.111  adjusted loss = 0.111  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.186  exp loss = 0.195  adjusted loss = 0.195  adv prob = 0.250000   acc = 0.979
Average incurred loss: 0.227  
Average sample loss: 0.227  
Average acc: 0.957  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.377  exp loss = 0.470  adjusted loss = 0.470  adv prob = 0.250000   acc = 0.856
  waterbird_complete95 = 0, forest2water2 = 1  [n = 792]:	loss = 0.290  exp loss = 0.300  adjusted loss = 0.300  adv prob = 0.250000   acc = 0.939
  waterbird_complete95 = 1, forest2water2 = 0  [n = 476]:	loss = 0.116  exp loss = 0.110  adjusted loss = 0.110  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.189  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 0.980
Average incurred loss: 0.219  
Average sample loss: 0.219  
Average acc: 0.962  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 438]:	loss = 0.354  exp loss = 0.366  adjusted loss = 0.366  adv prob = 0.250000   acc = 0.872
  waterbird_complete95 = 0, forest2water2 = 1  [n = 703]:	loss = 0.252  exp loss = 0.226  adjusted loss = 0.226  adv prob = 0.250000   acc = 0.952
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.121  exp loss = 0.128  adjusted loss = 0.128  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.200  exp loss = 0.198  adjusted loss = 0.198  adv prob = 0.250000   acc = 0.979
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_4.csv
logged to wandb
Average incurred loss: 0.215  
Average sample loss: 0.218  
Average acc: 0.966  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 40]:	loss = 0.319  exp loss = 0.351  adjusted loss = 0.351  adv prob = 0.250000   acc = 0.925
  waterbird_complete95 = 0, forest2water2 = 1  [n = 72]:	loss = 0.294  exp loss = 0.252  adjusted loss = 0.252  adv prob = 0.250000   acc = 0.917
  waterbird_complete95 = 1, forest2water2 = 0  [n = 63]:	loss = 0.134  exp loss = 0.116  adjusted loss = 0.116  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 120]:	loss = 0.175  exp loss = 0.186  adjusted loss = 0.186  adv prob = 0.250000   acc = 0.992

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_4.csv
logged to wandb
Average incurred loss: 0.418  
Average sample loss: 0.417  
Average acc: 0.821  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.388  exp loss = 0.390  adjusted loss = 0.390  adv prob = 0.250000   acc = 0.861
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.567  exp loss = 0.614  adjusted loss = 0.614  adv prob = 0.250000   acc = 0.712
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.273  exp loss = 0.315  adjusted loss = 0.315  adv prob = 0.250000   acc = 0.910
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.154  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 0.970
Spurious Score = 1.129
Weighted Spurious Score = 1.172
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_4.csv
logged to wandb
Current lr: 0.000010


Epoch [5]:
Training:
Average incurred loss: 0.205  
Average sample loss: 0.205  
Average acc: 0.973  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 409]:	loss = 0.333  exp loss = 0.289  adjusted loss = 0.289  adv prob = 0.250000   acc = 0.888
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.243  exp loss = 0.210  adjusted loss = 0.210  adv prob = 0.250000   acc = 0.969
  waterbird_complete95 = 1, forest2water2 = 0  [n = 543]:	loss = 0.124  exp loss = 0.117  adjusted loss = 0.117  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1511]:	loss = 0.182  exp loss = 0.185  adjusted loss = 0.185  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.201  
Average sample loss: 0.201  
Average acc: 0.973  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.332  exp loss = 0.305  adjusted loss = 0.305  adv prob = 0.250000   acc = 0.887
  waterbird_complete95 = 0, forest2water2 = 1  [n = 767]:	loss = 0.252  exp loss = 0.240  adjusted loss = 0.240  adv prob = 0.250000   acc = 0.973
  waterbird_complete95 = 1, forest2water2 = 0  [n = 531]:	loss = 0.105  exp loss = 0.105  adjusted loss = 0.105  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1485]:	loss = 0.173  exp loss = 0.174  adjusted loss = 0.174  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.198  
Average sample loss: 0.198  
Average acc: 0.977  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.345  exp loss = 0.345  adjusted loss = 0.345  adv prob = 0.250000   acc = 0.889
  waterbird_complete95 = 0, forest2water2 = 1  [n = 725]:	loss = 0.226  exp loss = 0.234  adjusted loss = 0.234  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 1, forest2water2 = 0  [n = 517]:	loss = 0.114  exp loss = 0.088  adjusted loss = 0.088  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.173  exp loss = 0.162  adjusted loss = 0.162  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.203  
Average sample loss: 0.203  
Average acc: 0.969  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 404]:	loss = 0.362  exp loss = 0.398  adjusted loss = 0.398  adv prob = 0.250000   acc = 0.864
  waterbird_complete95 = 0, forest2water2 = 1  [n = 691]:	loss = 0.229  exp loss = 0.230  adjusted loss = 0.230  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 1, forest2water2 = 0  [n = 530]:	loss = 0.108  exp loss = 0.101  adjusted loss = 0.101  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1575]:	loss = 0.183  exp loss = 0.180  adjusted loss = 0.180  adv prob = 0.250000   acc = 0.986
Average incurred loss: 0.192  
Average sample loss: 0.192  
Average acc: 0.973  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 466]:	loss = 0.335  exp loss = 0.326  adjusted loss = 0.326  adv prob = 0.250000   acc = 0.893
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.247  exp loss = 0.242  adjusted loss = 0.242  adv prob = 0.250000   acc = 0.965
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.096  exp loss = 0.095  adjusted loss = 0.095  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1491]:	loss = 0.151  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.189  
Average sample loss: 0.189  
Average acc: 0.972  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.348  exp loss = 0.323  adjusted loss = 0.323  adv prob = 0.250000   acc = 0.864
  waterbird_complete95 = 0, forest2water2 = 1  [n = 771]:	loss = 0.220  exp loss = 0.197  adjusted loss = 0.197  adv prob = 0.250000   acc = 0.969
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.107  exp loss = 0.109  adjusted loss = 0.109  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1512]:	loss = 0.159  exp loss = 0.164  adjusted loss = 0.164  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.191  
Average sample loss: 0.191  
Average acc: 0.973  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 436]:	loss = 0.354  exp loss = 0.332  adjusted loss = 0.332  adv prob = 0.250000   acc = 0.869
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.208  exp loss = 0.199  adjusted loss = 0.199  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 1, forest2water2 = 0  [n = 470]:	loss = 0.090  exp loss = 0.090  adjusted loss = 0.090  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1554]:	loss = 0.168  exp loss = 0.175  adjusted loss = 0.175  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.179  
Average sample loss: 0.179  
Average acc: 0.980  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 376]:	loss = 0.320  exp loss = 0.308  adjusted loss = 0.308  adv prob = 0.250000   acc = 0.894
  waterbird_complete95 = 0, forest2water2 = 1  [n = 742]:	loss = 0.197  exp loss = 0.180  adjusted loss = 0.180  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 1, forest2water2 = 0  [n = 511]:	loss = 0.099  exp loss = 0.083  adjusted loss = 0.083  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1571]:	loss = 0.163  exp loss = 0.157  adjusted loss = 0.157  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.179  
Average sample loss: 0.179  
Average acc: 0.976  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.331  exp loss = 0.336  adjusted loss = 0.336  adv prob = 0.250000   acc = 0.859
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.204  exp loss = 0.189  adjusted loss = 0.189  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.090  exp loss = 0.092  adjusted loss = 0.092  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1540]:	loss = 0.154  exp loss = 0.147  adjusted loss = 0.147  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.179  
Average sample loss: 0.179  
Average acc: 0.978  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.350  exp loss = 0.338  adjusted loss = 0.338  adv prob = 0.250000   acc = 0.872
  waterbird_complete95 = 0, forest2water2 = 1  [n = 769]:	loss = 0.204  exp loss = 0.172  adjusted loss = 0.172  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 1, forest2water2 = 0  [n = 488]:	loss = 0.090  exp loss = 0.084  adjusted loss = 0.084  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1538]:	loss = 0.150  exp loss = 0.166  adjusted loss = 0.166  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_5.csv
logged to wandb
Average incurred loss: 0.190  
Average sample loss: 0.191  
Average acc: 0.966  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 32]:	loss = 0.384  exp loss = 0.380  adjusted loss = 0.380  adv prob = 0.250000   acc = 0.844
  waterbird_complete95 = 0, forest2water2 = 1  [n = 72]:	loss = 0.209  exp loss = 0.186  adjusted loss = 0.186  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 1, forest2water2 = 0  [n = 54]:	loss = 0.080  exp loss = 0.080  adjusted loss = 0.080  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 137]:	loss = 0.177  exp loss = 0.169  adjusted loss = 0.169  adv prob = 0.250000   acc = 0.978

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_5.csv
logged to wandb
Average incurred loss: 0.397  
Average sample loss: 0.396  
Average acc: 0.831  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.361  exp loss = 0.362  adjusted loss = 0.362  adv prob = 0.250000   acc = 0.867
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.540  exp loss = 0.591  adjusted loss = 0.591  adv prob = 0.250000   acc = 0.738
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.270  exp loss = 0.315  adjusted loss = 0.315  adv prob = 0.250000   acc = 0.887
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.152  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 0.970
Spurious Score = 1.130
Weighted Spurious Score = 1.156
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_5.csv
logged to wandb
Current lr: 0.000010


Epoch [6]:
Training:
Average incurred loss: 0.172  
Average sample loss: 0.172  
Average acc: 0.977  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.318  exp loss = 0.335  adjusted loss = 0.335  adv prob = 0.250000   acc = 0.872
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 0.196  exp loss = 0.187  adjusted loss = 0.187  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 1, forest2water2 = 0  [n = 481]:	loss = 0.087  exp loss = 0.087  adjusted loss = 0.087  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1551]:	loss = 0.147  exp loss = 0.145  adjusted loss = 0.145  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.169  
Average sample loss: 0.169  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 392]:	loss = 0.319  exp loss = 0.313  adjusted loss = 0.313  adv prob = 0.250000   acc = 0.893
  waterbird_complete95 = 0, forest2water2 = 1  [n = 770]:	loss = 0.186  exp loss = 0.166  adjusted loss = 0.166  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.089  exp loss = 0.092  adjusted loss = 0.092  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1515]:	loss = 0.149  exp loss = 0.153  adjusted loss = 0.153  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.168  
Average sample loss: 0.168  
Average acc: 0.977  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.351  exp loss = 0.296  adjusted loss = 0.296  adv prob = 0.250000   acc = 0.855
  waterbird_complete95 = 0, forest2water2 = 1  [n = 764]:	loss = 0.176  exp loss = 0.163  adjusted loss = 0.163  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.083  exp loss = 0.079  adjusted loss = 0.079  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.144  exp loss = 0.142  adjusted loss = 0.142  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.158  
Average sample loss: 0.158  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 403]:	loss = 0.316  exp loss = 0.281  adjusted loss = 0.281  adv prob = 0.250000   acc = 0.888
  waterbird_complete95 = 0, forest2water2 = 1  [n = 739]:	loss = 0.162  exp loss = 0.143  adjusted loss = 0.143  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 1, forest2water2 = 0  [n = 527]:	loss = 0.085  exp loss = 0.082  adjusted loss = 0.082  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1531]:	loss = 0.139  exp loss = 0.134  adjusted loss = 0.134  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.160  
Average sample loss: 0.160  
Average acc: 0.981  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 463]:	loss = 0.310  exp loss = 0.277  adjusted loss = 0.277  adv prob = 0.250000   acc = 0.892
  waterbird_complete95 = 0, forest2water2 = 1  [n = 677]:	loss = 0.165  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.086  exp loss = 0.088  adjusted loss = 0.088  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1559]:	loss = 0.138  exp loss = 0.134  adjusted loss = 0.134  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.155  
Average sample loss: 0.155  
Average acc: 0.981  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 400]:	loss = 0.323  exp loss = 0.314  adjusted loss = 0.314  adv prob = 0.250000   acc = 0.865
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.159  exp loss = 0.153  adjusted loss = 0.153  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 485]:	loss = 0.082  exp loss = 0.077  adjusted loss = 0.077  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1571]:	loss = 0.133  exp loss = 0.123  adjusted loss = 0.123  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.148  
Average sample loss: 0.148  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.302  exp loss = 0.325  adjusted loss = 0.325  adv prob = 0.250000   acc = 0.902
  waterbird_complete95 = 0, forest2water2 = 1  [n = 738]:	loss = 0.157  exp loss = 0.152  adjusted loss = 0.152  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 1, forest2water2 = 0  [n = 546]:	loss = 0.078  exp loss = 0.074  adjusted loss = 0.074  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1509]:	loss = 0.127  exp loss = 0.118  adjusted loss = 0.118  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.152  
Average sample loss: 0.152  
Average acc: 0.979  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 441]:	loss = 0.315  exp loss = 0.274  adjusted loss = 0.274  adv prob = 0.250000   acc = 0.871
  waterbird_complete95 = 0, forest2water2 = 1  [n = 770]:	loss = 0.167  exp loss = 0.140  adjusted loss = 0.140  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 1, forest2water2 = 0  [n = 490]:	loss = 0.080  exp loss = 0.080  adjusted loss = 0.080  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1499]:	loss = 0.120  exp loss = 0.132  adjusted loss = 0.132  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.146  
Average sample loss: 0.146  
Average acc: 0.984  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.269  exp loss = 0.302  adjusted loss = 0.302  adv prob = 0.250000   acc = 0.912
  waterbird_complete95 = 0, forest2water2 = 1  [n = 709]:	loss = 0.146  exp loss = 0.134  adjusted loss = 0.134  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 1, forest2water2 = 0  [n = 539]:	loss = 0.089  exp loss = 0.082  adjusted loss = 0.082  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.134  exp loss = 0.127  adjusted loss = 0.127  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.147  
Average sample loss: 0.147  
Average acc: 0.984  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 438]:	loss = 0.289  exp loss = 0.248  adjusted loss = 0.248  adv prob = 0.250000   acc = 0.911
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.162  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.075  exp loss = 0.070  adjusted loss = 0.070  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1510]:	loss = 0.122  exp loss = 0.112  adjusted loss = 0.112  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_6.csv
logged to wandb
Average incurred loss: 0.123  
Average sample loss: 0.123  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 25]:	loss = 0.237  exp loss = 0.223  adjusted loss = 0.223  adv prob = 0.250000   acc = 0.880
  waterbird_complete95 = 0, forest2water2 = 1  [n = 74]:	loss = 0.113  exp loss = 0.136  adjusted loss = 0.136  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 49]:	loss = 0.081  exp loss = 0.076  adjusted loss = 0.076  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 147]:	loss = 0.122  exp loss = 0.117  adjusted loss = 0.117  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_6.csv
logged to wandb
Average incurred loss: 0.389  
Average sample loss: 0.388  
Average acc: 0.834  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.345  exp loss = 0.345  adjusted loss = 0.345  adv prob = 0.250000   acc = 0.869
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.537  exp loss = 0.592  adjusted loss = 0.592  adv prob = 0.250000   acc = 0.751
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.270  exp loss = 0.318  adjusted loss = 0.318  adv prob = 0.250000   acc = 0.880
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.148  exp loss = 0.140  adjusted loss = 0.140  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.119
Weighted Spurious Score = 1.141
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_6.csv
logged to wandb
Current lr: 0.000010


Epoch [7]:
Training:
Average incurred loss: 0.145  
Average sample loss: 0.145  
Average acc: 0.981  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.294  exp loss = 0.298  adjusted loss = 0.298  adv prob = 0.250000   acc = 0.887
  waterbird_complete95 = 0, forest2water2 = 1  [n = 699]:	loss = 0.138  exp loss = 0.118  adjusted loss = 0.118  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.078  exp loss = 0.075  adjusted loss = 0.075  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1556]:	loss = 0.128  exp loss = 0.121  adjusted loss = 0.121  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.141  
Average sample loss: 0.141  
Average acc: 0.985  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 431]:	loss = 0.293  exp loss = 0.271  adjusted loss = 0.271  adv prob = 0.250000   acc = 0.910
  waterbird_complete95 = 0, forest2water2 = 1  [n = 782]:	loss = 0.163  exp loss = 0.148  adjusted loss = 0.148  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 1, forest2water2 = 0  [n = 479]:	loss = 0.072  exp loss = 0.078  adjusted loss = 0.078  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1508]:	loss = 0.108  exp loss = 0.112  adjusted loss = 0.112  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.138  
Average sample loss: 0.138  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 388]:	loss = 0.308  exp loss = 0.298  adjusted loss = 0.298  adv prob = 0.250000   acc = 0.874
  waterbird_complete95 = 0, forest2water2 = 1  [n = 758]:	loss = 0.129  exp loss = 0.126  adjusted loss = 0.126  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 534]:	loss = 0.075  exp loss = 0.071  adjusted loss = 0.071  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1520]:	loss = 0.122  exp loss = 0.112  adjusted loss = 0.112  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.137  
Average sample loss: 0.137  
Average acc: 0.981  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.320  exp loss = 0.309  adjusted loss = 0.309  adv prob = 0.250000   acc = 0.874
  waterbird_complete95 = 0, forest2water2 = 1  [n = 797]:	loss = 0.133  exp loss = 0.117  adjusted loss = 0.117  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 0  [n = 511]:	loss = 0.072  exp loss = 0.069  adjusted loss = 0.069  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1472]:	loss = 0.110  exp loss = 0.110  adjusted loss = 0.110  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.126  
Average sample loss: 0.126  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 364]:	loss = 0.250  exp loss = 0.247  adjusted loss = 0.247  adv prob = 0.250000   acc = 0.915
  waterbird_complete95 = 0, forest2water2 = 1  [n = 763]:	loss = 0.119  exp loss = 0.102  adjusted loss = 0.102  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 530]:	loss = 0.076  exp loss = 0.069  adjusted loss = 0.069  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.118  exp loss = 0.114  adjusted loss = 0.114  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.130  
Average sample loss: 0.130  
Average acc: 0.985  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.267  exp loss = 0.242  adjusted loss = 0.242  adv prob = 0.250000   acc = 0.893
  waterbird_complete95 = 0, forest2water2 = 1  [n = 712]:	loss = 0.122  exp loss = 0.106  adjusted loss = 0.106  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.080  exp loss = 0.070  adjusted loss = 0.070  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1573]:	loss = 0.114  exp loss = 0.110  adjusted loss = 0.110  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.126  
Average sample loss: 0.126  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.266  exp loss = 0.268  adjusted loss = 0.268  adv prob = 0.250000   acc = 0.911
  waterbird_complete95 = 0, forest2water2 = 1  [n = 699]:	loss = 0.114  exp loss = 0.115  adjusted loss = 0.115  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 532]:	loss = 0.070  exp loss = 0.063  adjusted loss = 0.063  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1542]:	loss = 0.112  exp loss = 0.108  adjusted loss = 0.108  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.123  
Average sample loss: 0.123  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 440]:	loss = 0.263  exp loss = 0.246  adjusted loss = 0.246  adv prob = 0.250000   acc = 0.889
  waterbird_complete95 = 0, forest2water2 = 1  [n = 712]:	loss = 0.122  exp loss = 0.107  adjusted loss = 0.107  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 528]:	loss = 0.063  exp loss = 0.063  adjusted loss = 0.063  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1520]:	loss = 0.104  exp loss = 0.107  adjusted loss = 0.107  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.119  
Average sample loss: 0.119  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.259  exp loss = 0.244  adjusted loss = 0.244  adv prob = 0.250000   acc = 0.906
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.119  exp loss = 0.114  adjusted loss = 0.114  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 517]:	loss = 0.068  exp loss = 0.075  adjusted loss = 0.075  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1524]:	loss = 0.098  exp loss = 0.099  adjusted loss = 0.099  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.123  
Average sample loss: 0.123  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.295  exp loss = 0.271  adjusted loss = 0.271  adv prob = 0.250000   acc = 0.883
  waterbird_complete95 = 0, forest2water2 = 1  [n = 747]:	loss = 0.115  exp loss = 0.108  adjusted loss = 0.108  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 461]:	loss = 0.063  exp loss = 0.063  adjusted loss = 0.063  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1563]:	loss = 0.097  exp loss = 0.094  adjusted loss = 0.094  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_7.csv
logged to wandb
Average incurred loss: 0.124  
Average sample loss: 0.122  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 38]:	loss = 0.270  exp loss = 0.261  adjusted loss = 0.261  adv prob = 0.250000   acc = 0.921
  waterbird_complete95 = 0, forest2water2 = 1  [n = 72]:	loss = 0.126  exp loss = 0.113  adjusted loss = 0.113  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 1, forest2water2 = 0  [n = 49]:	loss = 0.063  exp loss = 0.064  adjusted loss = 0.064  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 136]:	loss = 0.104  exp loss = 0.095  adjusted loss = 0.095  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_7.csv
logged to wandb
Average incurred loss: 0.383  
Average sample loss: 0.381  
Average acc: 0.838  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.325  exp loss = 0.327  adjusted loss = 0.327  adv prob = 0.250000   acc = 0.874
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.543  exp loss = 0.607  adjusted loss = 0.607  adv prob = 0.250000   acc = 0.753
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.267  exp loss = 0.316  adjusted loss = 0.316  adv prob = 0.250000   acc = 0.887
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.139  exp loss = 0.128  adjusted loss = 0.128  adv prob = 0.250000   acc = 0.962
Spurious Score = 1.119
Weighted Spurious Score = 1.143
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_7.csv
logged to wandb
Current lr: 0.000010


Epoch [8]:
Training:
Average incurred loss: 0.119  
Average sample loss: 0.119  
Average acc: 0.985  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 440]:	loss = 0.271  exp loss = 0.302  adjusted loss = 0.302  adv prob = 0.250000   acc = 0.900
  waterbird_complete95 = 0, forest2water2 = 1  [n = 721]:	loss = 0.111  exp loss = 0.121  adjusted loss = 0.121  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.066  exp loss = 0.058  adjusted loss = 0.058  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1533]:	loss = 0.097  exp loss = 0.090  adjusted loss = 0.090  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.121  
Average sample loss: 0.121  
Average acc: 0.985  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.278  exp loss = 0.240  adjusted loss = 0.240  adv prob = 0.250000   acc = 0.891
  waterbird_complete95 = 0, forest2water2 = 1  [n = 707]:	loss = 0.104  exp loss = 0.098  adjusted loss = 0.098  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 0  [n = 558]:	loss = 0.073  exp loss = 0.060  adjusted loss = 0.060  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.105  exp loss = 0.096  adjusted loss = 0.096  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.111  
Average sample loss: 0.111  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.260  exp loss = 0.261  adjusted loss = 0.261  adv prob = 0.250000   acc = 0.915
  waterbird_complete95 = 0, forest2water2 = 1  [n = 734]:	loss = 0.096  exp loss = 0.096  adjusted loss = 0.096  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 510]:	loss = 0.062  exp loss = 0.055  adjusted loss = 0.055  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1546]:	loss = 0.094  exp loss = 0.085  adjusted loss = 0.085  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.111  
Average sample loss: 0.111  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 377]:	loss = 0.266  exp loss = 0.226  adjusted loss = 0.226  adv prob = 0.250000   acc = 0.915
  waterbird_complete95 = 0, forest2water2 = 1  [n = 782]:	loss = 0.103  exp loss = 0.090  adjusted loss = 0.090  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 481]:	loss = 0.060  exp loss = 0.053  adjusted loss = 0.053  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1560]:	loss = 0.092  exp loss = 0.092  adjusted loss = 0.092  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.113  
Average sample loss: 0.113  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 409]:	loss = 0.259  exp loss = 0.253  adjusted loss = 0.253  adv prob = 0.250000   acc = 0.900
  waterbird_complete95 = 0, forest2water2 = 1  [n = 750]:	loss = 0.109  exp loss = 0.089  adjusted loss = 0.089  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 497]:	loss = 0.057  exp loss = 0.056  adjusted loss = 0.056  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.094  exp loss = 0.092  adjusted loss = 0.092  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.110  
Average sample loss: 0.110  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.268  exp loss = 0.249  adjusted loss = 0.249  adv prob = 0.250000   acc = 0.906
  waterbird_complete95 = 0, forest2water2 = 1  [n = 763]:	loss = 0.101  exp loss = 0.096  adjusted loss = 0.096  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.054  exp loss = 0.058  adjusted loss = 0.058  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1510]:	loss = 0.089  exp loss = 0.096  adjusted loss = 0.096  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.109  
Average sample loss: 0.109  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 397]:	loss = 0.248  exp loss = 0.251  adjusted loss = 0.251  adv prob = 0.250000   acc = 0.904
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.094  exp loss = 0.098  adjusted loss = 0.098  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 542]:	loss = 0.063  exp loss = 0.061  adjusted loss = 0.061  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1513]:	loss = 0.095  exp loss = 0.090  adjusted loss = 0.090  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.113  
Average sample loss: 0.113  
Average acc: 0.985  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.271  exp loss = 0.239  adjusted loss = 0.239  adv prob = 0.250000   acc = 0.899
  waterbird_complete95 = 0, forest2water2 = 1  [n = 751]:	loss = 0.103  exp loss = 0.090  adjusted loss = 0.090  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 486]:	loss = 0.057  exp loss = 0.056  adjusted loss = 0.056  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1538]:	loss = 0.092  exp loss = 0.086  adjusted loss = 0.086  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.102  
Average sample loss: 0.102  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 435]:	loss = 0.235  exp loss = 0.233  adjusted loss = 0.233  adv prob = 0.250000   acc = 0.913
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.088  exp loss = 0.074  adjusted loss = 0.074  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.056  exp loss = 0.056  adjusted loss = 0.056  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1505]:	loss = 0.086  exp loss = 0.092  adjusted loss = 0.092  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.106  
Average sample loss: 0.106  
Average acc: 0.985  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 441]:	loss = 0.244  exp loss = 0.207  adjusted loss = 0.207  adv prob = 0.250000   acc = 0.905
  waterbird_complete95 = 0, forest2water2 = 1  [n = 716]:	loss = 0.087  exp loss = 0.071  adjusted loss = 0.071  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.056  exp loss = 0.055  adjusted loss = 0.055  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1538]:	loss = 0.092  exp loss = 0.101  adjusted loss = 0.101  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_8.csv
logged to wandb
Average incurred loss: 0.117  
Average sample loss: 0.116  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 34]:	loss = 0.256  exp loss = 0.212  adjusted loss = 0.212  adv prob = 0.250000   acc = 0.912
  waterbird_complete95 = 0, forest2water2 = 1  [n = 75]:	loss = 0.095  exp loss = 0.083  adjusted loss = 0.083  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 46]:	loss = 0.084  exp loss = 0.065  adjusted loss = 0.065  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 140]:	loss = 0.105  exp loss = 0.097  adjusted loss = 0.097  adv prob = 0.250000   acc = 0.993

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_8.csv
logged to wandb
Average incurred loss: 0.365  
Average sample loss: 0.363  
Average acc: 0.849  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.292  exp loss = 0.294  adjusted loss = 0.294  adv prob = 0.250000   acc = 0.891
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.527  exp loss = 0.593  adjusted loss = 0.593  adv prob = 0.250000   acc = 0.762
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.279  exp loss = 0.327  adjusted loss = 0.327  adv prob = 0.250000   acc = 0.887
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.139  exp loss = 0.127  adjusted loss = 0.127  adv prob = 0.250000   acc = 0.970
Spurious Score = 1.128
Weighted Spurious Score = 1.152
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_8.csv
logged to wandb
Current lr: 0.000010


Epoch [9]:
Training:
Average incurred loss: 0.102  
Average sample loss: 0.102  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 382]:	loss = 0.247  exp loss = 0.236  adjusted loss = 0.236  adv prob = 0.250000   acc = 0.903
  waterbird_complete95 = 0, forest2water2 = 1  [n = 754]:	loss = 0.084  exp loss = 0.086  adjusted loss = 0.086  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 534]:	loss = 0.058  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.090  exp loss = 0.081  adjusted loss = 0.081  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.102  
Average sample loss: 0.102  
Average acc: 0.985  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 406]:	loss = 0.252  exp loss = 0.278  adjusted loss = 0.278  adv prob = 0.250000   acc = 0.889
  waterbird_complete95 = 0, forest2water2 = 1  [n = 738]:	loss = 0.081  exp loss = 0.064  adjusted loss = 0.064  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 511]:	loss = 0.056  exp loss = 0.059  adjusted loss = 0.059  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1545]:	loss = 0.087  exp loss = 0.095  adjusted loss = 0.095  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.098  
Average sample loss: 0.098  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.250  exp loss = 0.202  adjusted loss = 0.202  adv prob = 0.250000   acc = 0.902
  waterbird_complete95 = 0, forest2water2 = 1  [n = 765]:	loss = 0.084  exp loss = 0.074  adjusted loss = 0.074  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.052  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1503]:	loss = 0.078  exp loss = 0.084  adjusted loss = 0.084  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.100  
Average sample loss: 0.100  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.251  exp loss = 0.214  adjusted loss = 0.214  adv prob = 0.250000   acc = 0.899
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.083  exp loss = 0.073  adjusted loss = 0.073  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 484]:	loss = 0.052  exp loss = 0.055  adjusted loss = 0.055  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.083  exp loss = 0.089  adjusted loss = 0.089  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.096  
Average sample loss: 0.096  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.224  exp loss = 0.247  adjusted loss = 0.247  adv prob = 0.250000   acc = 0.932
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.075  exp loss = 0.073  adjusted loss = 0.073  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.059  exp loss = 0.053  adjusted loss = 0.053  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1552]:	loss = 0.085  exp loss = 0.080  adjusted loss = 0.080  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.095  
Average sample loss: 0.095  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 453]:	loss = 0.223  exp loss = 0.210  adjusted loss = 0.210  adv prob = 0.250000   acc = 0.912
  waterbird_complete95 = 0, forest2water2 = 1  [n = 760]:	loss = 0.091  exp loss = 0.089  adjusted loss = 0.089  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 530]:	loss = 0.049  exp loss = 0.049  adjusted loss = 0.049  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1457]:	loss = 0.073  exp loss = 0.073  adjusted loss = 0.073  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.090  
Average sample loss: 0.090  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.210  exp loss = 0.191  adjusted loss = 0.191  adv prob = 0.250000   acc = 0.934
  waterbird_complete95 = 0, forest2water2 = 1  [n = 703]:	loss = 0.068  exp loss = 0.059  adjusted loss = 0.059  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 542]:	loss = 0.058  exp loss = 0.055  adjusted loss = 0.055  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1547]:	loss = 0.080  exp loss = 0.082  adjusted loss = 0.082  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.095  
Average sample loss: 0.095  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.224  exp loss = 0.213  adjusted loss = 0.213  adv prob = 0.250000   acc = 0.913
  waterbird_complete95 = 0, forest2water2 = 1  [n = 749]:	loss = 0.081  exp loss = 0.078  adjusted loss = 0.078  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 465]:	loss = 0.052  exp loss = 0.051  adjusted loss = 0.051  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1562]:	loss = 0.079  exp loss = 0.077  adjusted loss = 0.077  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.086  
Average sample loss: 0.086  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.203  exp loss = 0.204  adjusted loss = 0.204  adv prob = 0.250000   acc = 0.934
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.073  exp loss = 0.068  adjusted loss = 0.068  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.049  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1554]:	loss = 0.074  exp loss = 0.071  adjusted loss = 0.071  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.091  
Average sample loss: 0.091  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.231  exp loss = 0.204  adjusted loss = 0.204  adv prob = 0.250000   acc = 0.912
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.074  exp loss = 0.068  adjusted loss = 0.068  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.056  exp loss = 0.045  adjusted loss = 0.045  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.072  exp loss = 0.072  adjusted loss = 0.072  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_9.csv
logged to wandb
Average incurred loss: 0.077  
Average sample loss: 0.077  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 39]:	loss = 0.158  exp loss = 0.197  adjusted loss = 0.197  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 65]:	loss = 0.062  exp loss = 0.061  adjusted loss = 0.061  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 57]:	loss = 0.052  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 134]:	loss = 0.071  exp loss = 0.071  adjusted loss = 0.071  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_9.csv
logged to wandb
Average incurred loss: 0.349  
Average sample loss: 0.347  
Average acc: 0.852  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.267  exp loss = 0.268  adjusted loss = 0.268  adv prob = 0.250000   acc = 0.895
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.507  exp loss = 0.576  adjusted loss = 0.576  adv prob = 0.250000   acc = 0.775
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.294  exp loss = 0.351  adjusted loss = 0.351  adv prob = 0.250000   acc = 0.872
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.140  exp loss = 0.127  adjusted loss = 0.127  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.123
Weighted Spurious Score = 1.143
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_9.csv
logged to wandb
Current lr: 0.000010


Epoch [10]:
Training:
Average incurred loss: 0.089  
Average sample loss: 0.089  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.211  exp loss = 0.183  adjusted loss = 0.183  adv prob = 0.250000   acc = 0.915
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.080  exp loss = 0.077  adjusted loss = 0.077  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 526]:	loss = 0.045  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1495]:	loss = 0.074  exp loss = 0.076  adjusted loss = 0.076  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.085  
Average sample loss: 0.085  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.203  exp loss = 0.213  adjusted loss = 0.213  adv prob = 0.250000   acc = 0.931
  waterbird_complete95 = 0, forest2water2 = 1  [n = 768]:	loss = 0.067  exp loss = 0.062  adjusted loss = 0.062  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.047  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.075  exp loss = 0.079  adjusted loss = 0.079  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.091  
Average sample loss: 0.091  
Average acc: 0.985  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.234  exp loss = 0.215  adjusted loss = 0.215  adv prob = 0.250000   acc = 0.901
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.071  exp loss = 0.068  adjusted loss = 0.068  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 534]:	loss = 0.054  exp loss = 0.053  adjusted loss = 0.053  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1495]:	loss = 0.074  exp loss = 0.074  adjusted loss = 0.074  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.086  
Average sample loss: 0.086  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 398]:	loss = 0.207  exp loss = 0.188  adjusted loss = 0.188  adv prob = 0.250000   acc = 0.930
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 0.070  exp loss = 0.065  adjusted loss = 0.065  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.053  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1548]:	loss = 0.073  exp loss = 0.070  adjusted loss = 0.070  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.083  
Average sample loss: 0.083  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.232  exp loss = 0.220  adjusted loss = 0.220  adv prob = 0.250000   acc = 0.917
  waterbird_complete95 = 0, forest2water2 = 1  [n = 758]:	loss = 0.064  exp loss = 0.062  adjusted loss = 0.062  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 491]:	loss = 0.045  exp loss = 0.045  adjusted loss = 0.045  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1519]:	loss = 0.063  exp loss = 0.065  adjusted loss = 0.065  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.084  
Average sample loss: 0.084  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.227  exp loss = 0.236  adjusted loss = 0.236  adv prob = 0.250000   acc = 0.918
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.061  exp loss = 0.067  adjusted loss = 0.067  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.049  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1516]:	loss = 0.068  exp loss = 0.069  adjusted loss = 0.069  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.087  
Average sample loss: 0.087  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 398]:	loss = 0.246  exp loss = 0.186  adjusted loss = 0.186  adv prob = 0.250000   acc = 0.902
  waterbird_complete95 = 0, forest2water2 = 1  [n = 731]:	loss = 0.056  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 492]:	loss = 0.049  exp loss = 0.052  adjusted loss = 0.052  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1579]:	loss = 0.073  exp loss = 0.080  adjusted loss = 0.080  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.075  
Average sample loss: 0.075  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 385]:	loss = 0.176  exp loss = 0.164  adjusted loss = 0.164  adv prob = 0.250000   acc = 0.938
  waterbird_complete95 = 0, forest2water2 = 1  [n = 725]:	loss = 0.052  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 525]:	loss = 0.050  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1565]:	loss = 0.068  exp loss = 0.066  adjusted loss = 0.066  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.082  
Average sample loss: 0.082  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 440]:	loss = 0.226  exp loss = 0.241  adjusted loss = 0.241  adv prob = 0.250000   acc = 0.918
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.061  exp loss = 0.064  adjusted loss = 0.064  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.045  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1551]:	loss = 0.061  exp loss = 0.060  adjusted loss = 0.060  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.074  
Average sample loss: 0.074  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 436]:	loss = 0.176  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 0.945
  waterbird_complete95 = 0, forest2water2 = 1  [n = 703]:	loss = 0.058  exp loss = 0.058  adjusted loss = 0.058  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 537]:	loss = 0.047  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1524]:	loss = 0.063  exp loss = 0.061  adjusted loss = 0.061  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_10.csv
logged to wandb
Average incurred loss: 0.072  
Average sample loss: 0.071  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 38]:	loss = 0.109  exp loss = 0.133  adjusted loss = 0.133  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 52]:	loss = 0.040  exp loss = 0.052  adjusted loss = 0.052  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 62]:	loss = 0.050  exp loss = 0.045  adjusted loss = 0.045  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 143]:	loss = 0.083  exp loss = 0.068  adjusted loss = 0.068  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_10.csv
logged to wandb
Average incurred loss: 0.330  
Average sample loss: 0.328  
Average acc: 0.858  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.225  exp loss = 0.225  adjusted loss = 0.225  adv prob = 0.250000   acc = 0.914
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.486  exp loss = 0.553  adjusted loss = 0.553  adv prob = 0.250000   acc = 0.779
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.333  exp loss = 0.398  adjusted loss = 0.398  adv prob = 0.250000   acc = 0.857
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.146  exp loss = 0.132  adjusted loss = 0.132  adv prob = 0.250000   acc = 0.940
Spurious Score = 1.133
Weighted Spurious Score = 1.157
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_10.csv
logged to wandb
Current lr: 0.000010


Epoch [11]:
Training:
Average incurred loss: 0.072  
Average sample loss: 0.072  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 392]:	loss = 0.177  exp loss = 0.170  adjusted loss = 0.170  adv prob = 0.250000   acc = 0.941
  waterbird_complete95 = 0, forest2water2 = 1  [n = 745]:	loss = 0.058  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.041  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1560]:	loss = 0.062  exp loss = 0.062  adjusted loss = 0.062  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.081  
Average sample loss: 0.081  
Average acc: 0.985  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 447]:	loss = 0.245  exp loss = 0.201  adjusted loss = 0.201  adv prob = 0.250000   acc = 0.899
  waterbird_complete95 = 0, forest2water2 = 1  [n = 752]:	loss = 0.060  exp loss = 0.052  adjusted loss = 0.052  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.041  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1500]:	loss = 0.057  exp loss = 0.055  adjusted loss = 0.055  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.076  
Average sample loss: 0.076  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.195  exp loss = 0.176  adjusted loss = 0.176  adv prob = 0.250000   acc = 0.920
  waterbird_complete95 = 0, forest2water2 = 1  [n = 711]:	loss = 0.052  exp loss = 0.040  adjusted loss = 0.040  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.049  exp loss = 0.057  adjusted loss = 0.057  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1554]:	loss = 0.064  exp loss = 0.069  adjusted loss = 0.069  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.075  
Average sample loss: 0.075  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 394]:	loss = 0.202  exp loss = 0.173  adjusted loss = 0.173  adv prob = 0.250000   acc = 0.929
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 0.054  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 534]:	loss = 0.045  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1526]:	loss = 0.062  exp loss = 0.062  adjusted loss = 0.062  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.073  
Average sample loss: 0.073  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 385]:	loss = 0.203  exp loss = 0.185  adjusted loss = 0.185  adv prob = 0.250000   acc = 0.919
  waterbird_complete95 = 0, forest2water2 = 1  [n = 770]:	loss = 0.058  exp loss = 0.056  adjusted loss = 0.056  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.041  exp loss = 0.036  adjusted loss = 0.036  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1538]:	loss = 0.058  exp loss = 0.053  adjusted loss = 0.053  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.073  
Average sample loss: 0.073  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.181  exp loss = 0.209  adjusted loss = 0.209  adv prob = 0.250000   acc = 0.950
  waterbird_complete95 = 0, forest2water2 = 1  [n = 734]:	loss = 0.055  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.044  exp loss = 0.045  adjusted loss = 0.045  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1540]:	loss = 0.061  exp loss = 0.058  adjusted loss = 0.058  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.071  
Average sample loss: 0.071  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.176  exp loss = 0.198  adjusted loss = 0.198  adv prob = 0.250000   acc = 0.939
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.052  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 495]:	loss = 0.043  exp loss = 0.040  adjusted loss = 0.040  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1562]:	loss = 0.061  exp loss = 0.058  adjusted loss = 0.058  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.069  
Average sample loss: 0.069  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.183  exp loss = 0.170  adjusted loss = 0.170  adv prob = 0.250000   acc = 0.928
  waterbird_complete95 = 0, forest2water2 = 1  [n = 759]:	loss = 0.054  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 526]:	loss = 0.040  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1500]:	loss = 0.054  exp loss = 0.059  adjusted loss = 0.059  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.074  
Average sample loss: 0.074  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 449]:	loss = 0.191  exp loss = 0.186  adjusted loss = 0.186  adv prob = 0.250000   acc = 0.933
  waterbird_complete95 = 0, forest2water2 = 1  [n = 728]:	loss = 0.059  exp loss = 0.057  adjusted loss = 0.057  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.042  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1527]:	loss = 0.057  exp loss = 0.064  adjusted loss = 0.064  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.067  
Average sample loss: 0.067  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.181  exp loss = 0.205  adjusted loss = 0.205  adv prob = 0.250000   acc = 0.933
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.049  exp loss = 0.054  adjusted loss = 0.054  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.040  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.054  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_11.csv
logged to wandb
Average incurred loss: 0.076  
Average sample loss: 0.081  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 48]:	loss = 0.228  exp loss = 0.241  adjusted loss = 0.241  adv prob = 0.250000   acc = 0.958
  waterbird_complete95 = 0, forest2water2 = 1  [n = 66]:	loss = 0.044  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 48]:	loss = 0.039  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.051  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_11.csv
logged to wandb
Average incurred loss: 0.358  
Average sample loss: 0.356  
Average acc: 0.846  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.246  exp loss = 0.247  adjusted loss = 0.247  adv prob = 0.250000   acc = 0.901
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.552  exp loss = 0.630  adjusted loss = 0.630  adv prob = 0.250000   acc = 0.751
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.298  exp loss = 0.353  adjusted loss = 0.353  adv prob = 0.250000   acc = 0.857
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.126  exp loss = 0.110  adjusted loss = 0.110  adv prob = 0.250000   acc = 0.970
Spurious Score = 1.164
Weighted Spurious Score = 1.185
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_11.csv
logged to wandb
Current lr: 0.000010


Epoch [12]:
Training:
Average incurred loss: 0.071  
Average sample loss: 0.071  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.214  exp loss = 0.216  adjusted loss = 0.216  adv prob = 0.250000   acc = 0.912
  waterbird_complete95 = 0, forest2water2 = 1  [n = 798]:	loss = 0.054  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 491]:	loss = 0.037  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1500]:	loss = 0.051  exp loss = 0.057  adjusted loss = 0.057  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.070  
Average sample loss: 0.070  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 406]:	loss = 0.196  exp loss = 0.153  adjusted loss = 0.153  adv prob = 0.250000   acc = 0.926
  waterbird_complete95 = 0, forest2water2 = 1  [n = 760]:	loss = 0.050  exp loss = 0.049  adjusted loss = 0.049  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 473]:	loss = 0.041  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1561]:	loss = 0.056  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.066  
Average sample loss: 0.066  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 384]:	loss = 0.178  exp loss = 0.183  adjusted loss = 0.183  adv prob = 0.250000   acc = 0.930
  waterbird_complete95 = 0, forest2water2 = 1  [n = 749]:	loss = 0.043  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 482]:	loss = 0.047  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1585]:	loss = 0.056  exp loss = 0.051  adjusted loss = 0.051  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.065  
Average sample loss: 0.065  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.171  exp loss = 0.188  adjusted loss = 0.188  adv prob = 0.250000   acc = 0.933
  waterbird_complete95 = 0, forest2water2 = 1  [n = 739]:	loss = 0.048  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.040  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1520]:	loss = 0.054  exp loss = 0.051  adjusted loss = 0.051  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.067  
Average sample loss: 0.067  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.181  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 0.929
  waterbird_complete95 = 0, forest2water2 = 1  [n = 731]:	loss = 0.045  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 527]:	loss = 0.041  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1532]:	loss = 0.056  exp loss = 0.063  adjusted loss = 0.063  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.062  
Average sample loss: 0.062  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.152  exp loss = 0.136  adjusted loss = 0.136  adv prob = 0.250000   acc = 0.937
  waterbird_complete95 = 0, forest2water2 = 1  [n = 700]:	loss = 0.041  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.040  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.055  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.061  
Average sample loss: 0.061  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 449]:	loss = 0.158  exp loss = 0.196  adjusted loss = 0.196  adv prob = 0.250000   acc = 0.955
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.048  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 535]:	loss = 0.036  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1473]:	loss = 0.048  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.064  
Average sample loss: 0.064  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.173  exp loss = 0.153  adjusted loss = 0.153  adv prob = 0.250000   acc = 0.933
  waterbird_complete95 = 0, forest2water2 = 1  [n = 736]:	loss = 0.047  exp loss = 0.051  adjusted loss = 0.051  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.038  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1538]:	loss = 0.052  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.057  
Average sample loss: 0.057  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.133  exp loss = 0.111  adjusted loss = 0.111  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 0, forest2water2 = 1  [n = 716]:	loss = 0.039  exp loss = 0.036  adjusted loss = 0.036  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 500]:	loss = 0.039  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1572]:	loss = 0.051  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.062  
Average sample loss: 0.062  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.185  exp loss = 0.176  adjusted loss = 0.176  adv prob = 0.250000   acc = 0.930
  waterbird_complete95 = 0, forest2water2 = 1  [n = 749]:	loss = 0.041  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 530]:	loss = 0.037  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1506]:	loss = 0.048  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_12.csv
logged to wandb
Average incurred loss: 0.051  
Average sample loss: 0.049  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 43]:	loss = 0.092  exp loss = 0.135  adjusted loss = 0.135  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 63]:	loss = 0.043  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 63]:	loss = 0.042  exp loss = 0.036  adjusted loss = 0.036  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 126]:	loss = 0.046  exp loss = 0.045  adjusted loss = 0.045  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_12.csv
logged to wandb
Average incurred loss: 0.328  
Average sample loss: 0.326  
Average acc: 0.859  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.200  exp loss = 0.199  adjusted loss = 0.199  adv prob = 0.250000   acc = 0.925
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.501  exp loss = 0.575  adjusted loss = 0.575  adv prob = 0.250000   acc = 0.770
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.354  exp loss = 0.424  adjusted loss = 0.424  adv prob = 0.250000   acc = 0.850
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.142  exp loss = 0.124  adjusted loss = 0.124  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.156
Weighted Spurious Score = 1.182
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_12.csv
logged to wandb
Current lr: 0.000010


Epoch [13]:
Training:
Average incurred loss: 0.061  
Average sample loss: 0.061  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.178  exp loss = 0.167  adjusted loss = 0.167  adv prob = 0.250000   acc = 0.930
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.040  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 491]:	loss = 0.037  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.047  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.059  
Average sample loss: 0.059  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 403]:	loss = 0.152  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 0.943
  waterbird_complete95 = 0, forest2water2 = 1  [n = 747]:	loss = 0.041  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.036  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.050  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.061  
Average sample loss: 0.061  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 441]:	loss = 0.165  exp loss = 0.153  adjusted loss = 0.153  adv prob = 0.250000   acc = 0.943
  waterbird_complete95 = 0, forest2water2 = 1  [n = 731]:	loss = 0.042  exp loss = 0.040  adjusted loss = 0.040  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 478]:	loss = 0.034  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1550]:	loss = 0.048  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.061  
Average sample loss: 0.061  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 430]:	loss = 0.174  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 0.947
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.038  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 532]:	loss = 0.036  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1509]:	loss = 0.049  exp loss = 0.059  adjusted loss = 0.059  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.059  
Average sample loss: 0.059  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.172  exp loss = 0.139  adjusted loss = 0.139  adv prob = 0.250000   acc = 0.935
  waterbird_complete95 = 0, forest2water2 = 1  [n = 738]:	loss = 0.039  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.040  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.045  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.064  
Average sample loss: 0.064  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 452]:	loss = 0.199  exp loss = 0.198  adjusted loss = 0.198  adv prob = 0.250000   acc = 0.909
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.041  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.034  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1492]:	loss = 0.045  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.054  
Average sample loss: 0.054  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 385]:	loss = 0.153  exp loss = 0.128  adjusted loss = 0.128  adv prob = 0.250000   acc = 0.943
  waterbird_complete95 = 0, forest2water2 = 1  [n = 769]:	loss = 0.037  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 533]:	loss = 0.034  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1513]:	loss = 0.045  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.057  
Average sample loss: 0.057  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 377]:	loss = 0.148  exp loss = 0.119  adjusted loss = 0.119  adv prob = 0.250000   acc = 0.950
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.040  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.039  exp loss = 0.040  adjusted loss = 0.040  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1558]:	loss = 0.049  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.055  
Average sample loss: 0.055  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.143  exp loss = 0.123  adjusted loss = 0.123  adv prob = 0.250000   acc = 0.956
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.037  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 532]:	loss = 0.037  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1528]:	loss = 0.046  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.058  
Average sample loss: 0.058  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.155  exp loss = 0.152  adjusted loss = 0.152  adv prob = 0.250000   acc = 0.940
  waterbird_complete95 = 0, forest2water2 = 1  [n = 731]:	loss = 0.042  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.034  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1550]:	loss = 0.047  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_13.csv
logged to wandb
Average incurred loss: 0.063  
Average sample loss: 0.061  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 42]:	loss = 0.217  exp loss = 0.169  adjusted loss = 0.169  adv prob = 0.250000   acc = 0.905
  waterbird_complete95 = 0, forest2water2 = 1  [n = 75]:	loss = 0.048  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 44]:	loss = 0.026  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 134]:	loss = 0.035  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_13.csv
logged to wandb
Average incurred loss: 0.341  
Average sample loss: 0.339  
Average acc: 0.851  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.207  exp loss = 0.205  adjusted loss = 0.205  adv prob = 0.250000   acc = 0.914
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.538  exp loss = 0.616  adjusted loss = 0.616  adv prob = 0.250000   acc = 0.760
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.337  exp loss = 0.399  adjusted loss = 0.399  adv prob = 0.250000   acc = 0.842
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.130  exp loss = 0.111  adjusted loss = 0.111  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.167
Weighted Spurious Score = 1.189
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_13.csv
logged to wandb
Current lr: 0.000010


Epoch [14]:
Training:
Average incurred loss: 0.053  
Average sample loss: 0.053  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.142  exp loss = 0.133  adjusted loss = 0.133  adv prob = 0.250000   acc = 0.946
  waterbird_complete95 = 0, forest2water2 = 1  [n = 742]:	loss = 0.038  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.032  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.042  exp loss = 0.040  adjusted loss = 0.040  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.052  
Average sample loss: 0.052  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 371]:	loss = 0.148  exp loss = 0.151  adjusted loss = 0.151  adv prob = 0.250000   acc = 0.941
  waterbird_complete95 = 0, forest2water2 = 1  [n = 730]:	loss = 0.031  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.037  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1593]:	loss = 0.045  exp loss = 0.036  adjusted loss = 0.036  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.052  
Average sample loss: 0.052  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.146  exp loss = 0.142  adjusted loss = 0.142  adv prob = 0.250000   acc = 0.946
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.035  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.032  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.041  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.053  
Average sample loss: 0.053  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.147  exp loss = 0.134  adjusted loss = 0.134  adv prob = 0.250000   acc = 0.944
  waterbird_complete95 = 0, forest2water2 = 1  [n = 764]:	loss = 0.040  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.029  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1502]:	loss = 0.042  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.054  
Average sample loss: 0.054  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 435]:	loss = 0.144  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 0.954
  waterbird_complete95 = 0, forest2water2 = 1  [n = 715]:	loss = 0.038  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.033  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1527]:	loss = 0.044  exp loss = 0.045  adjusted loss = 0.045  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.052  
Average sample loss: 0.052  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 398]:	loss = 0.149  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 0.952
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.032  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.035  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1533]:	loss = 0.043  exp loss = 0.051  adjusted loss = 0.051  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.052  
Average sample loss: 0.052  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.146  exp loss = 0.146  adjusted loss = 0.146  adv prob = 0.250000   acc = 0.949
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.031  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.033  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1547]:	loss = 0.044  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.057  
Average sample loss: 0.057  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 404]:	loss = 0.193  exp loss = 0.179  adjusted loss = 0.179  adv prob = 0.250000   acc = 0.918
  waterbird_complete95 = 0, forest2water2 = 1  [n = 747]:	loss = 0.034  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 529]:	loss = 0.031  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1520]:	loss = 0.041  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.052  
Average sample loss: 0.052  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.155  exp loss = 0.150  adjusted loss = 0.150  adv prob = 0.250000   acc = 0.939
  waterbird_complete95 = 0, forest2water2 = 1  [n = 766]:	loss = 0.033  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.030  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1511]:	loss = 0.039  exp loss = 0.036  adjusted loss = 0.036  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.052  
Average sample loss: 0.052  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 438]:	loss = 0.133  exp loss = 0.168  adjusted loss = 0.168  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.040  exp loss = 0.049  adjusted loss = 0.049  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 485]:	loss = 0.034  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.040  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.998
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_14.csv
logged to wandb
Average incurred loss: 0.061  
Average sample loss: 0.059  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 44]:	loss = 0.169  exp loss = 0.159  adjusted loss = 0.159  adv prob = 0.250000   acc = 0.932
  waterbird_complete95 = 0, forest2water2 = 1  [n = 61]:	loss = 0.035  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 43]:	loss = 0.033  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 147]:	loss = 0.048  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_14.csv
logged to wandb
Average incurred loss: 0.346  
Average sample loss: 0.343  
Average acc: 0.852  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.205  exp loss = 0.204  adjusted loss = 0.204  adv prob = 0.250000   acc = 0.921
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.554  exp loss = 0.634  adjusted loss = 0.634  adv prob = 0.250000   acc = 0.751
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.332  exp loss = 0.387  adjusted loss = 0.387  adv prob = 0.250000   acc = 0.850
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.122  exp loss = 0.102  adjusted loss = 0.102  adv prob = 0.250000   acc = 0.962
Spurious Score = 1.176
Weighted Spurious Score = 1.205
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_14.csv
logged to wandb
Current lr: 0.000010


Epoch [15]:
Training:
Average incurred loss: 0.052  
Average sample loss: 0.052  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.155  exp loss = 0.115  adjusted loss = 0.115  adv prob = 0.250000   acc = 0.949
  waterbird_complete95 = 0, forest2water2 = 1  [n = 769]:	loss = 0.032  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.030  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1519]:	loss = 0.041  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.051  
Average sample loss: 0.051  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 454]:	loss = 0.142  exp loss = 0.119  adjusted loss = 0.119  adv prob = 0.250000   acc = 0.954
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.039  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 527]:	loss = 0.030  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1486]:	loss = 0.037  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.050  
Average sample loss: 0.050  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.139  exp loss = 0.157  adjusted loss = 0.157  adv prob = 0.250000   acc = 0.943
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.030  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.031  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1516]:	loss = 0.042  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.050  
Average sample loss: 0.050  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 449]:	loss = 0.153  exp loss = 0.131  adjusted loss = 0.131  adv prob = 0.250000   acc = 0.938
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.030  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 500]:	loss = 0.027  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.037  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.047  
Average sample loss: 0.047  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.131  exp loss = 0.104  adjusted loss = 0.104  adv prob = 0.250000   acc = 0.949
  waterbird_complete95 = 0, forest2water2 = 1  [n = 775]:	loss = 0.033  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.032  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1500]:	loss = 0.035  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.049  
Average sample loss: 0.049  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.123  exp loss = 0.108  adjusted loss = 0.108  adv prob = 0.250000   acc = 0.965
  waterbird_complete95 = 0, forest2water2 = 1  [n = 754]:	loss = 0.033  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 531]:	loss = 0.034  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1510]:	loss = 0.042  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.051  
Average sample loss: 0.051  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 403]:	loss = 0.142  exp loss = 0.109  adjusted loss = 0.109  adv prob = 0.250000   acc = 0.958
  waterbird_complete95 = 0, forest2water2 = 1  [n = 715]:	loss = 0.028  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.033  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1566]:	loss = 0.044  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.045  
Average sample loss: 0.045  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 400]:	loss = 0.109  exp loss = 0.116  adjusted loss = 0.116  adv prob = 0.250000   acc = 0.960
  waterbird_complete95 = 0, forest2water2 = 1  [n = 691]:	loss = 0.023  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 530]:	loss = 0.032  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1579]:	loss = 0.043  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.046  
Average sample loss: 0.046  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.140  exp loss = 0.145  adjusted loss = 0.145  adv prob = 0.250000   acc = 0.945
  waterbird_complete95 = 0, forest2water2 = 1  [n = 770]:	loss = 0.031  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.031  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1510]:	loss = 0.034  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.044  
Average sample loss: 0.044  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 390]:	loss = 0.114  exp loss = 0.102  adjusted loss = 0.102  adv prob = 0.250000   acc = 0.949
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.026  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.035  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1589]:	loss = 0.038  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_15.csv
logged to wandb
Average incurred loss: 0.043  
Average sample loss: 0.042  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 31]:	loss = 0.083  exp loss = 0.091  adjusted loss = 0.091  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 66]:	loss = 0.020  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 34]:	loss = 0.037  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 164]:	loss = 0.046  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_15.csv
logged to wandb
Average incurred loss: 0.305  
Average sample loss: 0.303  
Average acc: 0.867  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.159  exp loss = 0.157  adjusted loss = 0.157  adv prob = 0.250000   acc = 0.938
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.469  exp loss = 0.545  adjusted loss = 0.545  adv prob = 0.250000   acc = 0.785
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.400  exp loss = 0.476  adjusted loss = 0.476  adv prob = 0.250000   acc = 0.820
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.146  exp loss = 0.123  adjusted loss = 0.123  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.175
Weighted Spurious Score = 1.187
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_15.csv
logged to wandb
Current lr: 0.000010


Epoch [16]:
Training:
Average incurred loss: 0.047  
Average sample loss: 0.047  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 441]:	loss = 0.120  exp loss = 0.089  adjusted loss = 0.089  adv prob = 0.250000   acc = 0.959
  waterbird_complete95 = 0, forest2water2 = 1  [n = 706]:	loss = 0.034  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 493]:	loss = 0.029  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1560]:	loss = 0.039  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.044  
Average sample loss: 0.044  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.133  exp loss = 0.137  adjusted loss = 0.137  adv prob = 0.250000   acc = 0.961
  waterbird_complete95 = 0, forest2water2 = 1  [n = 731]:	loss = 0.026  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 525]:	loss = 0.029  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.034  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.044  
Average sample loss: 0.044  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.128  exp loss = 0.121  adjusted loss = 0.121  adv prob = 0.250000   acc = 0.953
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.030  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 492]:	loss = 0.025  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1531]:	loss = 0.034  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.041  
Average sample loss: 0.041  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.120  exp loss = 0.119  adjusted loss = 0.119  adv prob = 0.250000   acc = 0.956
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.028  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.029  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1520]:	loss = 0.031  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.042  
Average sample loss: 0.042  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.119  exp loss = 0.097  adjusted loss = 0.097  adv prob = 0.250000   acc = 0.955
  waterbird_complete95 = 0, forest2water2 = 1  [n = 771]:	loss = 0.033  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 510]:	loss = 0.024  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1499]:	loss = 0.031  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.047  
Average sample loss: 0.047  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.141  exp loss = 0.101  adjusted loss = 0.101  adv prob = 0.250000   acc = 0.952
  waterbird_complete95 = 0, forest2water2 = 1  [n = 745]:	loss = 0.030  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 510]:	loss = 0.029  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1528]:	loss = 0.035  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.044  
Average sample loss: 0.044  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.134  exp loss = 0.163  adjusted loss = 0.163  adv prob = 0.250000   acc = 0.944
  waterbird_complete95 = 0, forest2water2 = 1  [n = 730]:	loss = 0.026  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.027  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1527]:	loss = 0.033  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.047  
Average sample loss: 0.047  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 385]:	loss = 0.130  exp loss = 0.116  adjusted loss = 0.116  adv prob = 0.250000   acc = 0.948
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.025  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.031  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1572]:	loss = 0.042  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.042  
Average sample loss: 0.042  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.132  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 0.948
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.022  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.026  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1515]:	loss = 0.033  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.041  
Average sample loss: 0.041  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 397]:	loss = 0.119  exp loss = 0.100  adjusted loss = 0.100  adv prob = 0.250000   acc = 0.960
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.022  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.029  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1555]:	loss = 0.034  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_16.csv
logged to wandb
Average incurred loss: 0.058  
Average sample loss: 0.063  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 47]:	loss = 0.221  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 0.915
  waterbird_complete95 = 0, forest2water2 = 1  [n = 78]:	loss = 0.041  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 57]:	loss = 0.020  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 113]:	loss = 0.021  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_16.csv
logged to wandb
Average incurred loss: 0.357  
Average sample loss: 0.355  
Average acc: 0.849  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.197  exp loss = 0.194  adjusted loss = 0.194  adv prob = 0.250000   acc = 0.923
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.594  exp loss = 0.682  adjusted loss = 0.682  adv prob = 0.250000   acc = 0.738
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.336  exp loss = 0.393  adjusted loss = 0.393  adv prob = 0.250000   acc = 0.865
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.114  exp loss = 0.093  adjusted loss = 0.093  adv prob = 0.250000   acc = 0.962
Spurious Score = 1.176
Weighted Spurious Score = 1.218
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_16.csv
logged to wandb
Current lr: 0.000010


Epoch [17]:
Training:
Average incurred loss: 0.044  
Average sample loss: 0.044  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 398]:	loss = 0.145  exp loss = 0.129  adjusted loss = 0.129  adv prob = 0.250000   acc = 0.937
  waterbird_complete95 = 0, forest2water2 = 1  [n = 728]:	loss = 0.023  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 543]:	loss = 0.031  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1531]:	loss = 0.033  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.041  
Average sample loss: 0.041  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 401]:	loss = 0.119  exp loss = 0.132  adjusted loss = 0.132  adv prob = 0.250000   acc = 0.958
  waterbird_complete95 = 0, forest2water2 = 1  [n = 758]:	loss = 0.027  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.028  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.031  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.039  
Average sample loss: 0.039  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.102  exp loss = 0.074  adjusted loss = 0.074  adv prob = 0.250000   acc = 0.967
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 0.033  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 543]:	loss = 0.028  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1493]:	loss = 0.030  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.037  
Average sample loss: 0.037  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.092  exp loss = 0.107  adjusted loss = 0.107  adv prob = 0.250000   acc = 0.967
  waterbird_complete95 = 0, forest2water2 = 1  [n = 705]:	loss = 0.021  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 531]:	loss = 0.026  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1545]:	loss = 0.033  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.039  
Average sample loss: 0.039  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.108  exp loss = 0.093  adjusted loss = 0.093  adv prob = 0.250000   acc = 0.967
  waterbird_complete95 = 0, forest2water2 = 1  [n = 713]:	loss = 0.025  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.027  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1564]:	loss = 0.031  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.039  
Average sample loss: 0.039  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.112  exp loss = 0.102  adjusted loss = 0.102  adv prob = 0.250000   acc = 0.958
  waterbird_complete95 = 0, forest2water2 = 1  [n = 717]:	loss = 0.020  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 530]:	loss = 0.029  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1546]:	loss = 0.033  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.042  
Average sample loss: 0.042  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 387]:	loss = 0.131  exp loss = 0.133  adjusted loss = 0.133  adv prob = 0.250000   acc = 0.946
  waterbird_complete95 = 0, forest2water2 = 1  [n = 795]:	loss = 0.032  exp loss = 0.045  adjusted loss = 0.045  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 490]:	loss = 0.023  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1528]:	loss = 0.030  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.042  
Average sample loss: 0.042  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 468]:	loss = 0.121  exp loss = 0.133  adjusted loss = 0.133  adv prob = 0.250000   acc = 0.962
  waterbird_complete95 = 0, forest2water2 = 1  [n = 720]:	loss = 0.028  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.024  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1505]:	loss = 0.030  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.039  
Average sample loss: 0.039  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.117  exp loss = 0.110  adjusted loss = 0.110  adv prob = 0.250000   acc = 0.956
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.021  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.025  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.032  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.046  
Average sample loss: 0.046  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.159  exp loss = 0.169  adjusted loss = 0.169  adv prob = 0.250000   acc = 0.939
  waterbird_complete95 = 0, forest2water2 = 1  [n = 784]:	loss = 0.026  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.022  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1523]:	loss = 0.032  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_17.csv
logged to wandb
Average incurred loss: 0.031  
Average sample loss: 0.030  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 41]:	loss = 0.072  exp loss = 0.123  adjusted loss = 0.123  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 63]:	loss = 0.016  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 49]:	loss = 0.027  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 142]:	loss = 0.027  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_17.csv
logged to wandb
Average incurred loss: 0.318  
Average sample loss: 0.316  
Average acc: 0.862  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.154  exp loss = 0.151  adjusted loss = 0.151  adv prob = 0.250000   acc = 0.936
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.509  exp loss = 0.591  adjusted loss = 0.591  adv prob = 0.250000   acc = 0.777
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.405  exp loss = 0.471  adjusted loss = 0.471  adv prob = 0.250000   acc = 0.820
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.136  exp loss = 0.113  adjusted loss = 0.113  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.180
Weighted Spurious Score = 1.195
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_17.csv
logged to wandb
Current lr: 0.000010


Epoch [18]:
Training:
Average incurred loss: 0.041  
Average sample loss: 0.041  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 388]:	loss = 0.131  exp loss = 0.132  adjusted loss = 0.132  adv prob = 0.250000   acc = 0.948
  waterbird_complete95 = 0, forest2water2 = 1  [n = 747]:	loss = 0.020  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 531]:	loss = 0.027  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1534]:	loss = 0.033  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.040  
Average sample loss: 0.040  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.120  exp loss = 0.113  adjusted loss = 0.113  adv prob = 0.250000   acc = 0.958
  waterbird_complete95 = 0, forest2water2 = 1  [n = 783]:	loss = 0.029  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 495]:	loss = 0.024  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1514]:	loss = 0.029  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.040  
Average sample loss: 0.040  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 442]:	loss = 0.113  exp loss = 0.103  adjusted loss = 0.103  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.022  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 481]:	loss = 0.025  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1548]:	loss = 0.033  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.039  
Average sample loss: 0.039  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.129  exp loss = 0.095  adjusted loss = 0.095  adv prob = 0.250000   acc = 0.955
  waterbird_complete95 = 0, forest2water2 = 1  [n = 775]:	loss = 0.023  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.022  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1493]:	loss = 0.028  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.036  
Average sample loss: 0.036  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.089  exp loss = 0.082  adjusted loss = 0.082  adv prob = 0.250000   acc = 0.967
  waterbird_complete95 = 0, forest2water2 = 1  [n = 719]:	loss = 0.023  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.025  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1555]:	loss = 0.030  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.037  
Average sample loss: 0.037  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 426]:	loss = 0.096  exp loss = 0.107  adjusted loss = 0.107  adv prob = 0.250000   acc = 0.969
  waterbird_complete95 = 0, forest2water2 = 1  [n = 689]:	loss = 0.020  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 535]:	loss = 0.027  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1550]:	loss = 0.031  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.037  
Average sample loss: 0.037  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 440]:	loss = 0.114  exp loss = 0.112  adjusted loss = 0.112  adv prob = 0.250000   acc = 0.950
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.024  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.024  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.026  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.034  
Average sample loss: 0.034  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.101  exp loss = 0.130  adjusted loss = 0.130  adv prob = 0.250000   acc = 0.961
  waterbird_complete95 = 0, forest2water2 = 1  [n = 754]:	loss = 0.021  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.024  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1510]:	loss = 0.026  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.040  
Average sample loss: 0.040  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.115  exp loss = 0.101  adjusted loss = 0.101  adv prob = 0.250000   acc = 0.956
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.022  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 536]:	loss = 0.028  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1511]:	loss = 0.033  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.036  
Average sample loss: 0.036  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 383]:	loss = 0.102  exp loss = 0.074  adjusted loss = 0.074  adv prob = 0.250000   acc = 0.961
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 0.021  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 497]:	loss = 0.025  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1574]:	loss = 0.030  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_18.csv
logged to wandb
Average incurred loss: 0.035  
Average sample loss: 0.034  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 39]:	loss = 0.095  exp loss = 0.078  adjusted loss = 0.078  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 65]:	loss = 0.017  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 40]:	loss = 0.025  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 151]:	loss = 0.029  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_18.csv
logged to wandb
Average incurred loss: 0.296  
Average sample loss: 0.294  
Average acc: 0.873  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.129  exp loss = 0.126  adjusted loss = 0.126  adv prob = 0.250000   acc = 0.946
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.461  exp loss = 0.545  adjusted loss = 0.545  adv prob = 0.250000   acc = 0.798
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.453  exp loss = 0.538  adjusted loss = 0.538  adv prob = 0.250000   acc = 0.805
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.149  exp loss = 0.123  adjusted loss = 0.123  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.182
Weighted Spurious Score = 1.186
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_18.csv
logged to wandb
Current lr: 0.000010


Epoch [19]:
Training:
Average incurred loss: 0.039  
Average sample loss: 0.039  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 394]:	loss = 0.120  exp loss = 0.084  adjusted loss = 0.084  adv prob = 0.250000   acc = 0.952
  waterbird_complete95 = 0, forest2water2 = 1  [n = 766]:	loss = 0.025  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 551]:	loss = 0.026  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1489]:	loss = 0.029  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.037  
Average sample loss: 0.037  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 428]:	loss = 0.112  exp loss = 0.111  adjusted loss = 0.111  adv prob = 0.250000   acc = 0.963
  waterbird_complete95 = 0, forest2water2 = 1  [n = 754]:	loss = 0.023  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 474]:	loss = 0.022  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.027  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.034  
Average sample loss: 0.034  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.090  exp loss = 0.075  adjusted loss = 0.075  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.021  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 482]:	loss = 0.023  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1555]:	loss = 0.029  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.034  
Average sample loss: 0.034  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 400]:	loss = 0.097  exp loss = 0.087  adjusted loss = 0.087  adv prob = 0.250000   acc = 0.965
  waterbird_complete95 = 0, forest2water2 = 1  [n = 730]:	loss = 0.018  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 535]:	loss = 0.026  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1535]:	loss = 0.028  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.037  
Average sample loss: 0.037  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.117  exp loss = 0.148  adjusted loss = 0.148  adv prob = 0.250000   acc = 0.959
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.026  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.026  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1526]:	loss = 0.026  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.036  
Average sample loss: 0.036  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.101  exp loss = 0.102  adjusted loss = 0.102  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 0, forest2water2 = 1  [n = 728]:	loss = 0.021  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 511]:	loss = 0.024  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.029  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.034  
Average sample loss: 0.034  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.100  exp loss = 0.098  adjusted loss = 0.098  adv prob = 0.250000   acc = 0.962
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.018  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 535]:	loss = 0.025  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1539]:	loss = 0.027  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.035  
Average sample loss: 0.035  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 451]:	loss = 0.102  exp loss = 0.112  adjusted loss = 0.112  adv prob = 0.250000   acc = 0.958
  waterbird_complete95 = 0, forest2water2 = 1  [n = 731]:	loss = 0.022  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 486]:	loss = 0.023  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1532]:	loss = 0.026  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.034  
Average sample loss: 0.034  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 390]:	loss = 0.093  exp loss = 0.088  adjusted loss = 0.088  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 760]:	loss = 0.019  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 519]:	loss = 0.026  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1531]:	loss = 0.028  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.036  
Average sample loss: 0.036  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 451]:	loss = 0.096  exp loss = 0.083  adjusted loss = 0.083  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 705]:	loss = 0.017  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 493]:	loss = 0.023  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1551]:	loss = 0.030  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 0.998
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_19.csv
logged to wandb
Average incurred loss: 0.037  
Average sample loss: 0.037  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 47]:	loss = 0.133  exp loss = 0.098  adjusted loss = 0.098  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 0, forest2water2 = 1  [n = 80]:	loss = 0.030  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 54]:	loss = 0.013  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 114]:	loss = 0.014  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_19.csv
logged to wandb
Average incurred loss: 0.334  
Average sample loss: 0.332  
Average acc: 0.853  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.152  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 0.936
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.554  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 0.753
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.413  exp loss = 0.484  adjusted loss = 0.484  adv prob = 0.250000   acc = 0.812
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.125  exp loss = 0.102  adjusted loss = 0.102  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.208
Weighted Spurious Score = 1.229
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_19.csv
logged to wandb
Current lr: 0.000010


Epoch [20]:
Training:
Average incurred loss: 0.034  
Average sample loss: 0.034  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 426]:	loss = 0.101  exp loss = 0.113  adjusted loss = 0.113  adv prob = 0.250000   acc = 0.965
  waterbird_complete95 = 0, forest2water2 = 1  [n = 734]:	loss = 0.020  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 533]:	loss = 0.022  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1507]:	loss = 0.025  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.033  
Average sample loss: 0.033  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.096  exp loss = 0.066  adjusted loss = 0.066  adv prob = 0.250000   acc = 0.965
  waterbird_complete95 = 0, forest2water2 = 1  [n = 758]:	loss = 0.020  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.024  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.027  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.033  
Average sample loss: 0.033  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.093  exp loss = 0.076  adjusted loss = 0.076  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.021  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.023  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1554]:	loss = 0.027  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.032  
Average sample loss: 0.032  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 409]:	loss = 0.094  exp loss = 0.085  adjusted loss = 0.085  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.018  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 537]:	loss = 0.024  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.025  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.037  
Average sample loss: 0.037  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.110  exp loss = 0.075  adjusted loss = 0.075  adv prob = 0.250000   acc = 0.952
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.022  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 474]:	loss = 0.024  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1570]:	loss = 0.030  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.034  
Average sample loss: 0.034  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.112  exp loss = 0.115  adjusted loss = 0.115  adv prob = 0.250000   acc = 0.950
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.017  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.021  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1528]:	loss = 0.024  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.036  
Average sample loss: 0.036  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.106  exp loss = 0.065  adjusted loss = 0.065  adv prob = 0.250000   acc = 0.965
  waterbird_complete95 = 0, forest2water2 = 1  [n = 795]:	loss = 0.026  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 495]:	loss = 0.019  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1487]:	loss = 0.028  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.033  
Average sample loss: 0.033  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.095  exp loss = 0.095  adjusted loss = 0.095  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 734]:	loss = 0.019  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 511]:	loss = 0.022  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1526]:	loss = 0.026  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.030  
Average sample loss: 0.030  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.085  exp loss = 0.081  adjusted loss = 0.081  adv prob = 0.250000   acc = 0.973
  waterbird_complete95 = 0, forest2water2 = 1  [n = 720]:	loss = 0.014  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.022  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1553]:	loss = 0.025  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.030  
Average sample loss: 0.030  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.089  exp loss = 0.079  adjusted loss = 0.079  adv prob = 0.250000   acc = 0.962
  waterbird_complete95 = 0, forest2water2 = 1  [n = 731]:	loss = 0.020  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.022  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1528]:	loss = 0.022  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_20.csv
logged to wandb
Average incurred loss: 0.029  
Average sample loss: 0.030  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 35]:	loss = 0.095  exp loss = 0.078  adjusted loss = 0.078  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 72]:	loss = 0.017  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 47]:	loss = 0.021  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 141]:	loss = 0.022  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_20.csv
logged to wandb
Average incurred loss: 0.305  
Average sample loss: 0.303  
Average acc: 0.872  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.121  exp loss = 0.116  adjusted loss = 0.116  adv prob = 0.250000   acc = 0.953
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.488  exp loss = 0.576  adjusted loss = 0.576  adv prob = 0.250000   acc = 0.790
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.475  exp loss = 0.563  adjusted loss = 0.563  adv prob = 0.250000   acc = 0.797
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.144  exp loss = 0.118  adjusted loss = 0.118  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.198
Weighted Spurious Score = 1.205
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_20.csv
logged to wandb
Current lr: 0.000010


Epoch [21]:
Training:
Average incurred loss: 0.032  
Average sample loss: 0.032  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.082  exp loss = 0.064  adjusted loss = 0.064  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 707]:	loss = 0.017  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.024  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1571]:	loss = 0.027  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.031  
Average sample loss: 0.031  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 398]:	loss = 0.092  exp loss = 0.054  adjusted loss = 0.054  adv prob = 0.250000   acc = 0.965
  waterbird_complete95 = 0, forest2water2 = 1  [n = 779]:	loss = 0.018  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 511]:	loss = 0.021  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1512]:	loss = 0.026  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.031  
Average sample loss: 0.031  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 433]:	loss = 0.098  exp loss = 0.082  adjusted loss = 0.082  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 709]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 525]:	loss = 0.020  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1533]:	loss = 0.023  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.034  
Average sample loss: 0.034  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.093  exp loss = 0.075  adjusted loss = 0.075  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 0, forest2water2 = 1  [n = 739]:	loss = 0.022  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 500]:	loss = 0.020  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1550]:	loss = 0.028  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.032  
Average sample loss: 0.032  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.093  exp loss = 0.102  adjusted loss = 0.102  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 766]:	loss = 0.021  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 493]:	loss = 0.021  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1534]:	loss = 0.025  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.029  
Average sample loss: 0.029  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.082  exp loss = 0.083  adjusted loss = 0.083  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 742]:	loss = 0.018  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 548]:	loss = 0.023  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1502]:	loss = 0.021  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.030  
Average sample loss: 0.030  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.086  exp loss = 0.080  adjusted loss = 0.080  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.020  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.021  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1515]:	loss = 0.022  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.031  
Average sample loss: 0.031  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 391]:	loss = 0.087  exp loss = 0.073  adjusted loss = 0.073  adv prob = 0.250000   acc = 0.962
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.019  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.022  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1554]:	loss = 0.025  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.031  
Average sample loss: 0.031  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 453]:	loss = 0.105  exp loss = 0.122  adjusted loss = 0.122  adv prob = 0.250000   acc = 0.962
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.016  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 483]:	loss = 0.018  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.020  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.030  
Average sample loss: 0.030  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 403]:	loss = 0.083  exp loss = 0.076  adjusted loss = 0.076  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 765]:	loss = 0.021  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.020  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1531]:	loss = 0.023  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_21.csv
logged to wandb
Average incurred loss: 0.030  
Average sample loss: 0.030  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 55]:	loss = 0.091  exp loss = 0.084  adjusted loss = 0.084  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 0, forest2water2 = 1  [n = 73]:	loss = 0.027  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 53]:	loss = 0.011  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 114]:	loss = 0.010  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_21.csv
logged to wandb
Average incurred loss: 0.338  
Average sample loss: 0.336  
Average acc: 0.851  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.146  exp loss = 0.142  adjusted loss = 0.142  adv prob = 0.250000   acc = 0.938
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.571  exp loss = 0.666  adjusted loss = 0.666  adv prob = 0.250000   acc = 0.747
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.414  exp loss = 0.476  adjusted loss = 0.476  adv prob = 0.250000   acc = 0.805
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.123  exp loss = 0.098  adjusted loss = 0.098  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.220
Weighted Spurious Score = 1.242
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_21.csv
logged to wandb
Current lr: 0.000010


Epoch [22]:
Training:
Average incurred loss: 0.031  
Average sample loss: 0.031  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 440]:	loss = 0.094  exp loss = 0.083  adjusted loss = 0.083  adv prob = 0.250000   acc = 0.966
  waterbird_complete95 = 0, forest2water2 = 1  [n = 736]:	loss = 0.018  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.020  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.022  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.033  
Average sample loss: 0.033  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.102  exp loss = 0.123  adjusted loss = 0.123  adv prob = 0.250000   acc = 0.961
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.018  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.024  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1556]:	loss = 0.026  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.031  
Average sample loss: 0.031  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.103  exp loss = 0.105  adjusted loss = 0.105  adv prob = 0.250000   acc = 0.965
  waterbird_complete95 = 0, forest2water2 = 1  [n = 720]:	loss = 0.014  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 535]:	loss = 0.020  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1520]:	loss = 0.024  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.033  
Average sample loss: 0.033  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 442]:	loss = 0.103  exp loss = 0.083  adjusted loss = 0.083  adv prob = 0.250000   acc = 0.966
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.020  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.019  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.025  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.030  
Average sample loss: 0.030  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 393]:	loss = 0.091  exp loss = 0.074  adjusted loss = 0.074  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.017  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 511]:	loss = 0.021  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1552]:	loss = 0.024  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.027  
Average sample loss: 0.027  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.072  exp loss = 0.066  adjusted loss = 0.066  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 738]:	loss = 0.015  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.019  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1532]:	loss = 0.022  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.029  
Average sample loss: 0.029  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 379]:	loss = 0.073  exp loss = 0.066  adjusted loss = 0.066  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.014  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 544]:	loss = 0.021  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.028  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.025  
Average sample loss: 0.025  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.070  exp loss = 0.068  adjusted loss = 0.068  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.015  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.019  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1512]:	loss = 0.019  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.030  
Average sample loss: 0.030  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 409]:	loss = 0.091  exp loss = 0.087  adjusted loss = 0.087  adv prob = 0.250000   acc = 0.973
  waterbird_complete95 = 0, forest2water2 = 1  [n = 761]:	loss = 0.018  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 500]:	loss = 0.019  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.022  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.053  exp loss = 0.082  adjusted loss = 0.082  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 757]:	loss = 0.015  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 491]:	loss = 0.018  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1545]:	loss = 0.019  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_22.csv
logged to wandb
Average incurred loss: 0.029  
Average sample loss: 0.028  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 40]:	loss = 0.087  exp loss = 0.078  adjusted loss = 0.078  adv prob = 0.250000   acc = 0.950
  waterbird_complete95 = 0, forest2water2 = 1  [n = 60]:	loss = 0.013  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 49]:	loss = 0.024  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 146]:	loss = 0.021  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_22.csv
logged to wandb
Average incurred loss: 0.311  
Average sample loss: 0.309  
Average acc: 0.872  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.117  exp loss = 0.112  adjusted loss = 0.112  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.504  exp loss = 0.591  adjusted loss = 0.591  adv prob = 0.250000   acc = 0.788
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.488  exp loss = 0.573  adjusted loss = 0.573  adv prob = 0.250000   acc = 0.789
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.140  exp loss = 0.112  adjusted loss = 0.112  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.208
Weighted Spurious Score = 1.214
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_22.csv
logged to wandb
Current lr: 0.000010


Epoch [23]:
Training:
Average incurred loss: 0.028  
Average sample loss: 0.028  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.090  exp loss = 0.091  adjusted loss = 0.091  adv prob = 0.250000   acc = 0.958
  waterbird_complete95 = 0, forest2water2 = 1  [n = 757]:	loss = 0.018  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.020  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.020  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.029  
Average sample loss: 0.029  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 431]:	loss = 0.086  exp loss = 0.075  adjusted loss = 0.075  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.017  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.020  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1510]:	loss = 0.021  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.031  
Average sample loss: 0.031  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.101  exp loss = 0.080  adjusted loss = 0.080  adv prob = 0.250000   acc = 0.960
  waterbird_complete95 = 0, forest2water2 = 1  [n = 772]:	loss = 0.015  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 488]:	loss = 0.019  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1516]:	loss = 0.023  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.030  
Average sample loss: 0.030  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 428]:	loss = 0.084  exp loss = 0.082  adjusted loss = 0.082  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 689]:	loss = 0.015  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 533]:	loss = 0.021  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1550]:	loss = 0.024  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.029  
Average sample loss: 0.029  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.093  exp loss = 0.116  adjusted loss = 0.116  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 763]:	loss = 0.016  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 479]:	loss = 0.020  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1559]:	loss = 0.022  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.028  
Average sample loss: 0.028  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.074  exp loss = 0.070  adjusted loss = 0.070  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 724]:	loss = 0.019  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 534]:	loss = 0.019  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1525]:	loss = 0.024  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.025  
Average sample loss: 0.025  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.072  exp loss = 0.067  adjusted loss = 0.067  adv prob = 0.250000   acc = 0.973
  waterbird_complete95 = 0, forest2water2 = 1  [n = 718]:	loss = 0.012  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 476]:	loss = 0.020  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1593]:	loss = 0.020  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.027  
Average sample loss: 0.027  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.071  exp loss = 0.102  adjusted loss = 0.102  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 738]:	loss = 0.015  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.019  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1523]:	loss = 0.022  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.027  
Average sample loss: 0.027  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.082  exp loss = 0.082  adjusted loss = 0.082  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 803]:	loss = 0.021  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 490]:	loss = 0.015  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1487]:	loss = 0.019  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.025  
Average sample loss: 0.025  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.069  exp loss = 0.058  adjusted loss = 0.058  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 718]:	loss = 0.015  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 553]:	loss = 0.021  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.020  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_23.csv
logged to wandb
Average incurred loss: 0.030  
Average sample loss: 0.033  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 35]:	loss = 0.048  exp loss = 0.053  adjusted loss = 0.053  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 67]:	loss = 0.015  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 56]:	loss = 0.021  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 137]:	loss = 0.037  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.993

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_23.csv
logged to wandb
Average incurred loss: 0.301  
Average sample loss: 0.298  
Average acc: 0.877  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.103  exp loss = 0.099  adjusted loss = 0.099  adv prob = 0.250000   acc = 0.966
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.475  exp loss = 0.560  adjusted loss = 0.560  adv prob = 0.250000   acc = 0.794
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.532  exp loss = 0.638  adjusted loss = 0.638  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.151  exp loss = 0.122  adjusted loss = 0.122  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.214
Weighted Spurious Score = 1.217
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_23.csv
logged to wandb
Current lr: 0.000010


Epoch [24]:
Training:
Average incurred loss: 0.027  
Average sample loss: 0.027  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 430]:	loss = 0.081  exp loss = 0.052  adjusted loss = 0.052  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 718]:	loss = 0.014  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 484]:	loss = 0.017  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1568]:	loss = 0.021  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.027  
Average sample loss: 0.027  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.082  exp loss = 0.076  adjusted loss = 0.076  adv prob = 0.250000   acc = 0.973
  waterbird_complete95 = 0, forest2water2 = 1  [n = 725]:	loss = 0.012  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 525]:	loss = 0.019  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.022  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.025  
Average sample loss: 0.025  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.078  exp loss = 0.090  adjusted loss = 0.090  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.017  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.017  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1524]:	loss = 0.017  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.029  
Average sample loss: 0.029  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 437]:	loss = 0.074  exp loss = 0.059  adjusted loss = 0.059  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 712]:	loss = 0.016  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 517]:	loss = 0.020  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1534]:	loss = 0.025  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.027  
Average sample loss: 0.027  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.076  exp loss = 0.088  adjusted loss = 0.088  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 786]:	loss = 0.017  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.017  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1531]:	loss = 0.023  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.023  
Average sample loss: 0.023  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.069  exp loss = 0.081  adjusted loss = 0.081  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 511]:	loss = 0.017  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.018  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.026  
Average sample loss: 0.026  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 390]:	loss = 0.087  exp loss = 0.131  adjusted loss = 0.131  adv prob = 0.250000   acc = 0.954
  waterbird_complete95 = 0, forest2water2 = 1  [n = 779]:	loss = 0.016  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.019  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1516]:	loss = 0.019  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.026  
Average sample loss: 0.026  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.077  exp loss = 0.059  adjusted loss = 0.059  adv prob = 0.250000   acc = 0.969
  waterbird_complete95 = 0, forest2water2 = 1  [n = 768]:	loss = 0.021  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.020  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1506]:	loss = 0.017  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.026  
Average sample loss: 0.026  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.069  exp loss = 0.059  adjusted loss = 0.059  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 717]:	loss = 0.014  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 565]:	loss = 0.020  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1506]:	loss = 0.021  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.026  
Average sample loss: 0.026  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.066  exp loss = 0.060  adjusted loss = 0.060  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 730]:	loss = 0.019  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.018  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1554]:	loss = 0.022  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.998
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_24.csv
logged to wandb
Average incurred loss: 0.018  
Average sample loss: 0.018  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 33]:	loss = 0.016  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 68]:	loss = 0.009  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 49]:	loss = 0.017  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 145]:	loss = 0.022  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_24.csv
logged to wandb
Average incurred loss: 0.296  
Average sample loss: 0.294  
Average acc: 0.883  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.095  exp loss = 0.090  adjusted loss = 0.090  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.461  exp loss = 0.544  adjusted loss = 0.544  adv prob = 0.250000   acc = 0.807
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.562  exp loss = 0.670  adjusted loss = 0.670  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.159  exp loss = 0.128  adjusted loss = 0.128  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.207
Weighted Spurious Score = 1.206
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_24.csv
logged to wandb
Current lr: 0.000010


Epoch [25]:
Training:
Average incurred loss: 0.026  
Average sample loss: 0.026  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.078  exp loss = 0.067  adjusted loss = 0.067  adv prob = 0.250000   acc = 0.973
  waterbird_complete95 = 0, forest2water2 = 1  [n = 759]:	loss = 0.018  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.018  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.019  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.026  
Average sample loss: 0.026  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 445]:	loss = 0.081  exp loss = 0.077  adjusted loss = 0.077  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 0.017  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 511]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1498]:	loss = 0.019  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.024  
Average sample loss: 0.024  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.057  exp loss = 0.062  adjusted loss = 0.062  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 724]:	loss = 0.013  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 519]:	loss = 0.018  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1535]:	loss = 0.023  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.026  
Average sample loss: 0.026  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.084  exp loss = 0.114  adjusted loss = 0.114  adv prob = 0.250000   acc = 0.969
  waterbird_complete95 = 0, forest2water2 = 1  [n = 721]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 517]:	loss = 0.019  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.019  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 430]:	loss = 0.059  exp loss = 0.064  adjusted loss = 0.064  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.015  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 481]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1545]:	loss = 0.016  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.025  
Average sample loss: 0.025  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.072  exp loss = 0.088  adjusted loss = 0.088  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 710]:	loss = 0.015  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 543]:	loss = 0.017  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.020  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.023  
Average sample loss: 0.023  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 395]:	loss = 0.054  exp loss = 0.054  adjusted loss = 0.054  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 750]:	loss = 0.013  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.017  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1556]:	loss = 0.022  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.025  
Average sample loss: 0.025  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.065  exp loss = 0.055  adjusted loss = 0.055  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 525]:	loss = 0.017  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1525]:	loss = 0.024  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.024  
Average sample loss: 0.024  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.080  exp loss = 0.064  adjusted loss = 0.064  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 781]:	loss = 0.016  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 481]:	loss = 0.016  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1526]:	loss = 0.016  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 384]:	loss = 0.058  exp loss = 0.060  adjusted loss = 0.060  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.010  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 525]:	loss = 0.018  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1556]:	loss = 0.020  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_25.csv
logged to wandb
Average incurred loss: 0.046  
Average sample loss: 0.048  
Average acc: 0.980  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 46]:	loss = 0.214  exp loss = 0.118  adjusted loss = 0.118  adv prob = 0.250000   acc = 0.891
  waterbird_complete95 = 0, forest2water2 = 1  [n = 66]:	loss = 0.011  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 46]:	loss = 0.013  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 137]:	loss = 0.019  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.993

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_25.csv
logged to wandb
Average incurred loss: 0.319  
Average sample loss: 0.316  
Average acc: 0.869  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.109  exp loss = 0.103  adjusted loss = 0.103  adv prob = 0.250000   acc = 0.959
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.529  exp loss = 0.620  adjusted loss = 0.620  adv prob = 0.250000   acc = 0.779
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.502  exp loss = 0.585  adjusted loss = 0.585  adv prob = 0.250000   acc = 0.789
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.133  exp loss = 0.105  adjusted loss = 0.105  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.216
Weighted Spurious Score = 1.226
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_25.csv
logged to wandb
Current lr: 0.000010


Epoch [26]:
Training:
Average incurred loss: 0.025  
Average sample loss: 0.025  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 391]:	loss = 0.072  exp loss = 0.079  adjusted loss = 0.079  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.019  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1567]:	loss = 0.022  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.062  exp loss = 0.055  adjusted loss = 0.055  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 726]:	loss = 0.015  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1556]:	loss = 0.017  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.021  
Average sample loss: 0.021  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.052  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.014  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.016  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1538]:	loss = 0.018  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 441]:	loss = 0.058  exp loss = 0.071  adjusted loss = 0.071  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 0, forest2water2 = 1  [n = 720]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.017  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.017  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.027  
Average sample loss: 0.027  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 370]:	loss = 0.108  exp loss = 0.078  adjusted loss = 0.078  adv prob = 0.250000   acc = 0.962
  waterbird_complete95 = 0, forest2water2 = 1  [n = 819]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 493]:	loss = 0.015  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.020  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.026  
Average sample loss: 0.026  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 431]:	loss = 0.074  exp loss = 0.077  adjusted loss = 0.077  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.016  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.016  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1514]:	loss = 0.021  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.025  
Average sample loss: 0.025  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.092  exp loss = 0.085  adjusted loss = 0.085  adv prob = 0.250000   acc = 0.967
  waterbird_complete95 = 0, forest2water2 = 1  [n = 742]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 532]:	loss = 0.015  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1499]:	loss = 0.016  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.063  exp loss = 0.051  adjusted loss = 0.051  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 760]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 519]:	loss = 0.016  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1509]:	loss = 0.017  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 430]:	loss = 0.059  exp loss = 0.084  adjusted loss = 0.084  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 716]:	loss = 0.014  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.019  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1548]:	loss = 0.017  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.024  
Average sample loss: 0.024  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.062  exp loss = 0.063  adjusted loss = 0.063  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 711]:	loss = 0.016  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.016  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1556]:	loss = 0.019  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_26.csv
logged to wandb
Average incurred loss: 0.028  
Average sample loss: 0.027  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 48]:	loss = 0.091  exp loss = 0.069  adjusted loss = 0.069  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 65]:	loss = 0.016  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 51]:	loss = 0.016  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 131]:	loss = 0.015  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_26.csv
logged to wandb
Average incurred loss: 0.316  
Average sample loss: 0.314  
Average acc: 0.871  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.101  exp loss = 0.097  adjusted loss = 0.097  adv prob = 0.250000   acc = 0.966
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.522  exp loss = 0.614  adjusted loss = 0.614  adv prob = 0.250000   acc = 0.779
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.527  exp loss = 0.622  adjusted loss = 0.622  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.138  exp loss = 0.109  adjusted loss = 0.109  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.226
Weighted Spurious Score = 1.236
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_26.csv
logged to wandb
Current lr: 0.000010


Epoch [27]:
Training:
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 398]:	loss = 0.063  exp loss = 0.053  adjusted loss = 0.053  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.017  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1557]:	loss = 0.018  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.026  
Average sample loss: 0.026  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.093  exp loss = 0.084  adjusted loss = 0.084  adv prob = 0.250000   acc = 0.960
  waterbird_complete95 = 0, forest2water2 = 1  [n = 762]:	loss = 0.017  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.015  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1514]:	loss = 0.016  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.021  
Average sample loss: 0.021  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.049  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 734]:	loss = 0.011  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 561]:	loss = 0.016  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1490]:	loss = 0.020  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.071  exp loss = 0.072  adjusted loss = 0.072  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 771]:	loss = 0.016  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 490]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1524]:	loss = 0.015  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.021  
Average sample loss: 0.021  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 426]:	loss = 0.058  exp loss = 0.057  adjusted loss = 0.057  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.013  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 494]:	loss = 0.016  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1558]:	loss = 0.017  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.024  
Average sample loss: 0.024  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 390]:	loss = 0.064  exp loss = 0.085  adjusted loss = 0.085  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 734]:	loss = 0.013  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.021  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1561]:	loss = 0.020  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.053  exp loss = 0.045  adjusted loss = 0.045  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 739]:	loss = 0.017  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1527]:	loss = 0.019  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.027  
Average sample loss: 0.027  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 435]:	loss = 0.095  exp loss = 0.094  adjusted loss = 0.094  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 712]:	loss = 0.012  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.016  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1539]:	loss = 0.018  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 380]:	loss = 0.054  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 793]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 528]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1499]:	loss = 0.015  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.020  
Average sample loss: 0.020  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 437]:	loss = 0.041  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 713]:	loss = 0.012  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.015  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1548]:	loss = 0.019  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.998
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_27.csv
logged to wandb
Average incurred loss: 0.027  
Average sample loss: 0.026  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 45]:	loss = 0.101  exp loss = 0.060  adjusted loss = 0.060  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 0, forest2water2 = 1  [n = 61]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 49]:	loss = 0.011  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 140]:	loss = 0.015  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_27.csv
logged to wandb
Average incurred loss: 0.307  
Average sample loss: 0.305  
Average acc: 0.878  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.090  exp loss = 0.084  adjusted loss = 0.084  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.492  exp loss = 0.584  adjusted loss = 0.584  adv prob = 0.250000   acc = 0.794
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.579  exp loss = 0.682  adjusted loss = 0.682  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.149  exp loss = 0.117  adjusted loss = 0.117  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.217
Weighted Spurious Score = 1.222
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_27.csv
logged to wandb
Current lr: 0.000010


Epoch [28]:
Training:
Average incurred loss: 0.023  
Average sample loss: 0.023  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.069  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.016  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.017  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.020  
Average sample loss: 0.020  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.056  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 766]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 493]:	loss = 0.014  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.016  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 441]:	loss = 0.056  exp loss = 0.063  adjusted loss = 0.063  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.014  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1533]:	loss = 0.014  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.061  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1524]:	loss = 0.019  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.048  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.014  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.016  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.020  
Average sample loss: 0.020  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.052  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 724]:	loss = 0.011  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.015  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1565]:	loss = 0.017  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.026  
Average sample loss: 0.026  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.094  exp loss = 0.104  adjusted loss = 0.104  adv prob = 0.250000   acc = 0.973
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.011  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 549]:	loss = 0.018  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.019  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.070  exp loss = 0.062  adjusted loss = 0.062  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 752]:	loss = 0.012  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 473]:	loss = 0.014  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1556]:	loss = 0.015  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.020  
Average sample loss: 0.020  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.061  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 749]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.014  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1508]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.059  exp loss = 0.093  adjusted loss = 0.093  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 764]:	loss = 0.018  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1507]:	loss = 0.018  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_28.csv
logged to wandb
Average incurred loss: 0.024  
Average sample loss: 0.026  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 27]:	loss = 0.071  exp loss = 0.091  adjusted loss = 0.091  adv prob = 0.250000   acc = 0.963
  waterbird_complete95 = 0, forest2water2 = 1  [n = 75]:	loss = 0.010  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 48]:	loss = 0.021  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 145]:	loss = 0.023  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_28.csv
logged to wandb
Average incurred loss: 0.302  
Average sample loss: 0.299  
Average acc: 0.878  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.089  exp loss = 0.083  adjusted loss = 0.083  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.480  exp loss = 0.569  adjusted loss = 0.569  adv prob = 0.250000   acc = 0.796
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.572  exp loss = 0.670  adjusted loss = 0.670  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.150  exp loss = 0.118  adjusted loss = 0.118  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.214
Weighted Spurious Score = 1.217
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_28.csv
logged to wandb
Current lr: 0.000010


Epoch [29]:
Training:
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 371]:	loss = 0.037  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 752]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.015  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1572]:	loss = 0.017  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.021  
Average sample loss: 0.021  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 378]:	loss = 0.059  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.009  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1575]:	loss = 0.020  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.018  
Average sample loss: 0.018  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.045  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.012  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.013  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1528]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 404]:	loss = 0.053  exp loss = 0.057  adjusted loss = 0.057  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 762]:	loss = 0.012  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 483]:	loss = 0.014  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1551]:	loss = 0.014  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 439]:	loss = 0.072  exp loss = 0.072  adjusted loss = 0.072  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 0, forest2water2 = 1  [n = 731]:	loss = 0.012  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 537]:	loss = 0.014  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1493]:	loss = 0.014  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 450]:	loss = 0.057  exp loss = 0.093  adjusted loss = 0.093  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 713]:	loss = 0.012  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 479]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1558]:	loss = 0.013  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 437]:	loss = 0.074  exp loss = 0.111  adjusted loss = 0.111  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 745]:	loss = 0.014  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1506]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.023  
Average sample loss: 0.023  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 397]:	loss = 0.065  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 0, forest2water2 = 1  [n = 754]:	loss = 0.014  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 529]:	loss = 0.015  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1520]:	loss = 0.018  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.020  
Average sample loss: 0.020  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.062  exp loss = 0.051  adjusted loss = 0.051  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.013  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 528]:	loss = 0.013  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1499]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.020  
Average sample loss: 0.020  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 436]:	loss = 0.063  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 749]:	loss = 0.012  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 490]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1525]:	loss = 0.015  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_29.csv
logged to wandb
Average incurred loss: 0.039  
Average sample loss: 0.039  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 44]:	loss = 0.194  exp loss = 0.107  adjusted loss = 0.107  adv prob = 0.250000   acc = 0.932
  waterbird_complete95 = 0, forest2water2 = 1  [n = 72]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 49]:	loss = 0.012  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 130]:	loss = 0.010  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_29.csv
logged to wandb
Average incurred loss: 0.322  
Average sample loss: 0.320  
Average acc: 0.869  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.096  exp loss = 0.090  adjusted loss = 0.090  adv prob = 0.250000   acc = 0.966
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.537  exp loss = 0.635  adjusted loss = 0.635  adv prob = 0.250000   acc = 0.775
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.546  exp loss = 0.634  adjusted loss = 0.634  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.135  exp loss = 0.104  adjusted loss = 0.104  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.229
Weighted Spurious Score = 1.241
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_29.csv
logged to wandb
Current lr: 0.000010


Epoch [30]:
Training:
Average incurred loss: 0.021  
Average sample loss: 0.021  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 400]:	loss = 0.055  exp loss = 0.098  adjusted loss = 0.098  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 701]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 533]:	loss = 0.015  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1566]:	loss = 0.019  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.055  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 738]:	loss = 0.012  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1551]:	loss = 0.015  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.021  
Average sample loss: 0.021  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.063  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 768]:	loss = 0.014  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.014  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1496]:	loss = 0.016  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.020  
Average sample loss: 0.020  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 382]:	loss = 0.055  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 747]:	loss = 0.014  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1555]:	loss = 0.016  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 439]:	loss = 0.045  exp loss = 0.058  adjusted loss = 0.058  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 754]:	loss = 0.014  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 486]:	loss = 0.013  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.020  
Average sample loss: 0.020  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 444]:	loss = 0.064  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 0, forest2water2 = 1  [n = 742]:	loss = 0.012  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1508]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.021  
Average sample loss: 0.021  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.063  exp loss = 0.053  adjusted loss = 0.053  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 494]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.017  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.058  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 739]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 519]:	loss = 0.015  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.015  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.057  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 754]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.016  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1540]:	loss = 0.015  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.035  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 551]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1498]:	loss = 0.016  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.998
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_30.csv
logged to wandb
Average incurred loss: 0.023  
Average sample loss: 0.022  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 41]:	loss = 0.033  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 58]:	loss = 0.014  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 46]:	loss = 0.028  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 150]:	loss = 0.022  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_30.csv
logged to wandb
Average incurred loss: 0.307  
Average sample loss: 0.305  
Average acc: 0.878  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.080  exp loss = 0.073  adjusted loss = 0.073  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.489  exp loss = 0.582  adjusted loss = 0.582  adv prob = 0.250000   acc = 0.794
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.624  exp loss = 0.723  adjusted loss = 0.723  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.150  exp loss = 0.117  adjusted loss = 0.117  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.217
Weighted Spurious Score = 1.222
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_30.csv
logged to wandb
Current lr: 0.000010


Epoch [31]:
Training:
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.058  exp loss = 0.062  adjusted loss = 0.062  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 0, forest2water2 = 1  [n = 751]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.012  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1513]:	loss = 0.014  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.020  
Average sample loss: 0.020  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.063  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.011  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1533]:	loss = 0.016  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.020  
Average sample loss: 0.020  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 370]:	loss = 0.063  exp loss = 0.058  adjusted loss = 0.058  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 802]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.013  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1512]:	loss = 0.017  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.048  exp loss = 0.072  adjusted loss = 0.072  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1534]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 400]:	loss = 0.041  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 725]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 547]:	loss = 0.016  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1528]:	loss = 0.016  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 437]:	loss = 0.046  exp loss = 0.074  adjusted loss = 0.074  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.013  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.013  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.018  
Average sample loss: 0.018  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 409]:	loss = 0.042  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 715]:	loss = 0.009  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.014  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1570]:	loss = 0.017  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.020  
Average sample loss: 0.020  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 409]:	loss = 0.057  exp loss = 0.067  adjusted loss = 0.067  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.012  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 530]:	loss = 0.013  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.016  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.021  
Average sample loss: 0.021  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 463]:	loss = 0.068  exp loss = 0.077  adjusted loss = 0.077  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.015  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.012  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1506]:	loss = 0.012  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.018  
Average sample loss: 0.018  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.052  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 483]:	loss = 0.014  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1563]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_31.csv
logged to wandb
Average incurred loss: 0.025  
Average sample loss: 0.026  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 35]:	loss = 0.045  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 70]:	loss = 0.008  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 47]:	loss = 0.017  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 143]:	loss = 0.032  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.993

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_31.csv
logged to wandb
Average incurred loss: 0.323  
Average sample loss: 0.321  
Average acc: 0.872  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.092  exp loss = 0.085  adjusted loss = 0.085  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.538  exp loss = 0.631  adjusted loss = 0.631  adv prob = 0.250000   acc = 0.779
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.566  exp loss = 0.654  adjusted loss = 0.654  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.136  exp loss = 0.104  adjusted loss = 0.104  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.227
Weighted Spurious Score = 1.238
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_31.csv
logged to wandb
Current lr: 0.000010


Epoch [32]:
Training:
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 431]:	loss = 0.059  exp loss = 0.067  adjusted loss = 0.067  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 761]:	loss = 0.014  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1487]:	loss = 0.013  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.018  
Average sample loss: 0.018  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.054  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 745]:	loss = 0.008  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 492]:	loss = 0.010  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1539]:	loss = 0.015  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.020  
Average sample loss: 0.020  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.060  exp loss = 0.073  adjusted loss = 0.073  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 500]:	loss = 0.014  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1550]:	loss = 0.016  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 445]:	loss = 0.053  exp loss = 0.066  adjusted loss = 0.066  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 0, forest2water2 = 1  [n = 730]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.037  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 747]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 527]:	loss = 0.012  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.017  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.018  
Average sample loss: 0.018  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.046  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.014  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.015  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 388]:	loss = 0.041  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 759]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 491]:	loss = 0.014  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1562]:	loss = 0.014  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.046  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 500]:	loss = 0.014  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1551]:	loss = 0.017  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.018  
Average sample loss: 0.018  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.054  exp loss = 0.051  adjusted loss = 0.051  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 526]:	loss = 0.013  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.014  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.066  exp loss = 0.084  adjusted loss = 0.084  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 720]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 525]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_32.csv
logged to wandb
Average incurred loss: 0.020  
Average sample loss: 0.019  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 44]:	loss = 0.066  exp loss = 0.065  adjusted loss = 0.065  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 60]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 47]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 144]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_32.csv
logged to wandb
Average incurred loss: 0.304  
Average sample loss: 0.302  
Average acc: 0.885  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.072  exp loss = 0.065  adjusted loss = 0.065  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.476  exp loss = 0.566  adjusted loss = 0.566  adv prob = 0.250000   acc = 0.809
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.667  exp loss = 0.775  adjusted loss = 0.775  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.154  exp loss = 0.121  adjusted loss = 0.121  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.207
Weighted Spurious Score = 1.206
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_32.csv
logged to wandb
Current lr: 0.000010


Epoch [33]:
Training:
Average incurred loss: 0.016  
Average sample loss: 0.016  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 436]:	loss = 0.036  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 767]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 495]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1502]:	loss = 0.015  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.018  
Average sample loss: 0.018  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.049  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 719]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 529]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 396]:	loss = 0.036  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 774]:	loss = 0.012  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 529]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1501]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.045  exp loss = 0.040  adjusted loss = 0.040  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 388]:	loss = 0.047  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.015  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1566]:	loss = 0.014  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 439]:	loss = 0.052  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1513]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.018  
Average sample loss: 0.018  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 428]:	loss = 0.051  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 730]:	loss = 0.012  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 477]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1565]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 396]:	loss = 0.046  exp loss = 0.079  adjusted loss = 0.079  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 750]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 540]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1514]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.020  
Average sample loss: 0.020  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.053  exp loss = 0.079  adjusted loss = 0.079  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 721]:	loss = 0.010  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 528]:	loss = 0.013  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.018  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.054  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 490]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.012  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_33.csv
logged to wandb
Average incurred loss: 0.016  
Average sample loss: 0.017  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 38]:	loss = 0.032  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 56]:	loss = 0.004  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 45]:	loss = 0.018  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 156]:	loss = 0.017  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_33.csv
logged to wandb
Average incurred loss: 0.292  
Average sample loss: 0.290  
Average acc: 0.892  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.065  exp loss = 0.059  adjusted loss = 0.059  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.437  exp loss = 0.524  adjusted loss = 0.524  adv prob = 0.250000   acc = 0.824
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.705  exp loss = 0.817  adjusted loss = 0.817  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.169  exp loss = 0.132  adjusted loss = 0.132  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.197
Weighted Spurious Score = 1.191
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_33.csv
logged to wandb
Current lr: 0.000010


Epoch [34]:
Training:
Average incurred loss: 0.021  
Average sample loss: 0.021  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.060  exp loss = 0.073  adjusted loss = 0.073  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 759]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 490]:	loss = 0.013  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1535]:	loss = 0.019  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.016  
Average sample loss: 0.016  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 382]:	loss = 0.039  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 764]:	loss = 0.012  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1549]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 403]:	loss = 0.055  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 758]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 526]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1513]:	loss = 0.017  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.018  
Average sample loss: 0.018  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 438]:	loss = 0.057  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.012  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1514]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.018  
Average sample loss: 0.018  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 443]:	loss = 0.053  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 519]:	loss = 0.013  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1511]:	loss = 0.012  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 444]:	loss = 0.043  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 763]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1484]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.016  
Average sample loss: 0.016  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.034  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 702]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 543]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1556]:	loss = 0.018  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 392]:	loss = 0.055  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.013  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1563]:	loss = 0.013  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.047  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 767]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 494]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 409]:	loss = 0.033  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 703]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.013  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1584]:	loss = 0.013  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_34.csv
logged to wandb
Average incurred loss: 0.026  
Average sample loss: 0.025  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 50]:	loss = 0.094  exp loss = 0.056  adjusted loss = 0.056  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 0, forest2water2 = 1  [n = 65]:	loss = 0.012  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 49]:	loss = 0.010  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 131]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_34.csv
logged to wandb
Average incurred loss: 0.307  
Average sample loss: 0.304  
Average acc: 0.883  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.070  exp loss = 0.064  adjusted loss = 0.064  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.484  exp loss = 0.578  adjusted loss = 0.578  adv prob = 0.250000   acc = 0.807
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.667  exp loss = 0.779  adjusted loss = 0.779  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.156  exp loss = 0.121  adjusted loss = 0.121  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.207
Weighted Spurious Score = 1.206
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_34.csv
logged to wandb
Current lr: 0.000010


Epoch [35]:
Training:
Average incurred loss: 0.016  
Average sample loss: 0.016  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 396]:	loss = 0.033  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.015  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1550]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.053  exp loss = 0.062  adjusted loss = 0.062  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 0, forest2water2 = 1  [n = 774]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1525]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 426]:	loss = 0.034  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1532]:	loss = 0.012  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 435]:	loss = 0.051  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 700]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1561]:	loss = 0.017  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.016  
Average sample loss: 0.016  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 426]:	loss = 0.047  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 812]:	loss = 0.012  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 482]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1480]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.018  
Average sample loss: 0.018  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 441]:	loss = 0.055  exp loss = 0.040  adjusted loss = 0.040  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 712]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 548]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1499]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.049  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 739]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 531]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1528]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.058  exp loss = 0.054  adjusted loss = 0.054  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 726]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1557]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 406]:	loss = 0.036  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 529]:	loss = 0.013  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.036  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 750]:	loss = 0.010  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 495]:	loss = 0.011  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_35.csv
logged to wandb
Average incurred loss: 0.013  
Average sample loss: 0.014  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 42]:	loss = 0.042  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 66]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 42]:	loss = 0.010  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 145]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_35.csv
logged to wandb
Average incurred loss: 0.314  
Average sample loss: 0.312  
Average acc: 0.881  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.076  exp loss = 0.069  adjusted loss = 0.069  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.506  exp loss = 0.598  adjusted loss = 0.598  adv prob = 0.250000   acc = 0.800
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.640  exp loss = 0.734  adjusted loss = 0.734  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.149  exp loss = 0.114  adjusted loss = 0.114  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.212
Weighted Spurious Score = 1.214
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_35.csv
logged to wandb
Current lr: 0.000010


Epoch [36]:
Training:
Average incurred loss: 0.018  
Average sample loss: 0.018  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.040  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 698]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 526]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1553]:	loss = 0.018  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 451]:	loss = 0.060  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 718]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.011  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1524]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 437]:	loss = 0.043  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 721]:	loss = 0.009  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 398]:	loss = 0.031  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1532]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.042  exp loss = 0.065  adjusted loss = 0.065  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.012  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 527]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1515]:	loss = 0.016  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.016  
Average sample loss: 0.016  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 381]:	loss = 0.049  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 519]:	loss = 0.012  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1556]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.048  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 761]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 488]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 387]:	loss = 0.055  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.008  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.012  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1557]:	loss = 0.013  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.016  
Average sample loss: 0.016  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 459]:	loss = 0.044  exp loss = 0.045  adjusted loss = 0.045  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 754]:	loss = 0.011  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1483]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 401]:	loss = 0.035  exp loss = 0.061  adjusted loss = 0.061  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 779]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.011  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_36.csv
logged to wandb
Average incurred loss: 0.029  
Average sample loss: 0.029  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 46]:	loss = 0.100  exp loss = 0.076  adjusted loss = 0.076  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 0, forest2water2 = 1  [n = 57]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 43]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 149]:	loss = 0.020  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.993

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_36.csv
logged to wandb
Average incurred loss: 0.310  
Average sample loss: 0.308  
Average acc: 0.882  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.070  exp loss = 0.063  adjusted loss = 0.063  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.494  exp loss = 0.583  adjusted loss = 0.583  adv prob = 0.250000   acc = 0.803
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.664  exp loss = 0.773  adjusted loss = 0.773  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.153  exp loss = 0.117  adjusted loss = 0.117  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.210
Weighted Spurious Score = 1.211
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_36.csv
logged to wandb
Current lr: 0.000010


Epoch [37]:
Training:
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 391]:	loss = 0.040  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 0, forest2water2 = 1  [n = 771]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.046  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 739]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1525]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.055  exp loss = 0.056  adjusted loss = 0.056  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 793]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 519]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1461]:	loss = 0.011  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.022  
Average sample loss: 0.022  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 398]:	loss = 0.060  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 688]:	loss = 0.010  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 529]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1585]:	loss = 0.019  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.030  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 682]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 519]:	loss = 0.014  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1600]:	loss = 0.018  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.043  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 776]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 491]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1519]:	loss = 0.010  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.044  exp loss = 0.053  adjusted loss = 0.053  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.007  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.011  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.016  
Average sample loss: 0.016  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 433]:	loss = 0.056  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 497]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.011  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.039  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.012  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 435]:	loss = 0.036  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.012  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1499]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_37.csv
logged to wandb
Average incurred loss: 0.010  
Average sample loss: 0.009  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 36]:	loss = 0.014  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 73]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 38]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 148]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_37.csv
logged to wandb
Average incurred loss: 0.329  
Average sample loss: 0.326  
Average acc: 0.870  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.082  exp loss = 0.075  adjusted loss = 0.075  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.550  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 0.775
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.608  exp loss = 0.692  adjusted loss = 0.692  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.141  exp loss = 0.106  adjusted loss = 0.106  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.230
Weighted Spurious Score = 1.243
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_37.csv
logged to wandb
Current lr: 0.000010


Epoch [38]:
Training:
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.040  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 766]:	loss = 0.012  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.009  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.019  
Average sample loss: 0.019  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 453]:	loss = 0.057  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1510]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 430]:	loss = 0.030  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 491]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1533]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.017  
Average sample loss: 0.017  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 378]:	loss = 0.058  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 760]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 500]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1562]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 433]:	loss = 0.031  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 739]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 491]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.030  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.012  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1540]:	loss = 0.014  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.043  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 711]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1549]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 386]:	loss = 0.022  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.044  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 529]:	loss = 0.012  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1515]:	loss = 0.010  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 431]:	loss = 0.038  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 736]:	loss = 0.010  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1515]:	loss = 0.011  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_38.csv
logged to wandb
Average incurred loss: 0.020  
Average sample loss: 0.021  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 29]:	loss = 0.081  exp loss = 0.054  adjusted loss = 0.054  adv prob = 0.250000   acc = 0.966
  waterbird_complete95 = 0, forest2water2 = 1  [n = 73]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 51]:	loss = 0.014  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 142]:	loss = 0.017  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_38.csv
logged to wandb
Average incurred loss: 0.307  
Average sample loss: 0.305  
Average acc: 0.887  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.062  exp loss = 0.055  adjusted loss = 0.055  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.475  exp loss = 0.564  adjusted loss = 0.564  adv prob = 0.250000   acc = 0.811
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.722  exp loss = 0.841  adjusted loss = 0.841  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.162  exp loss = 0.126  adjusted loss = 0.126  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.208
Weighted Spurious Score = 1.207
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_38.csv
logged to wandb
Current lr: 0.000010


Epoch [39]:
Training:
Average incurred loss: 0.016  
Average sample loss: 0.016  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 442]:	loss = 0.037  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.013  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.014  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.028  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 731]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 391]:	loss = 0.042  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 758]:	loss = 0.009  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 539]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1512]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.016  
Average sample loss: 0.016  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.061  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1520]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.035  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 709]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1561]:	loss = 0.015  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 428]:	loss = 0.038  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.011  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 511]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 385]:	loss = 0.033  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 751]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1552]:	loss = 0.014  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.038  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 778]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1501]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.049  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 770]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.009  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1507]:	loss = 0.010  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 430]:	loss = 0.033  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 719]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 481]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1570]:	loss = 0.010  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_39.csv
logged to wandb
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 36]:	loss = 0.009  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 55]:	loss = 0.002  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 43]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 161]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_39.csv
logged to wandb
Average incurred loss: 0.298  
Average sample loss: 0.296  
Average acc: 0.892  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.053  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.437  exp loss = 0.520  adjusted loss = 0.520  adv prob = 0.250000   acc = 0.826
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.795  exp loss = 0.932  adjusted loss = 0.932  adv prob = 0.250000   acc = 0.774
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.178  exp loss = 0.138  adjusted loss = 0.138  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.202
Weighted Spurious Score = 1.193
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_39.csv
logged to wandb
Current lr: 0.000010


Epoch [40]:
Training:
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 393]:	loss = 0.029  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 542]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1525]:	loss = 0.014  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 435]:	loss = 0.033  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 754]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 493]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.050  exp loss = 0.036  adjusted loss = 0.036  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 782]:	loss = 0.016  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 480]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1509]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 391]:	loss = 0.039  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 745]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 482]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1582]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.032  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.012  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1542]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 390]:	loss = 0.033  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 0, forest2water2 = 1  [n = 757]:	loss = 0.009  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 476]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1577]:	loss = 0.014  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 430]:	loss = 0.049  exp loss = 0.036  adjusted loss = 0.036  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 764]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1494]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.041  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 704]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1593]:	loss = 0.014  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 445]:	loss = 0.038  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 705]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 571]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1479]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.041  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 739]:	loss = 0.011  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 546]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1490]:	loss = 0.011  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_40.csv
logged to wandb
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 32]:	loss = 0.017  exp loss = 0.036  adjusted loss = 0.036  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 72]:	loss = 0.004  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 43]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 148]:	loss = 0.012  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_40.csv
logged to wandb
Average incurred loss: 0.307  
Average sample loss: 0.304  
Average acc: 0.887  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.063  exp loss = 0.056  adjusted loss = 0.056  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.481  exp loss = 0.571  adjusted loss = 0.571  adv prob = 0.250000   acc = 0.811
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.703  exp loss = 0.826  adjusted loss = 0.826  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.155  exp loss = 0.119  adjusted loss = 0.119  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.206
Weighted Spurious Score = 1.205
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_40.csv
logged to wandb
Current lr: 0.000010


Epoch [41]:
Training:
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 386]:	loss = 0.039  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 0, forest2water2 = 1  [n = 717]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 545]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1552]:	loss = 0.014  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.024  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.035  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.009  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 530]:	loss = 0.009  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1490]:	loss = 0.010  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.041  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 777]:	loss = 0.012  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 482]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 444]:	loss = 0.034  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 717]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 545]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1494]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 406]:	loss = 0.037  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 730]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 528]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.054  exp loss = 0.060  adjusted loss = 0.060  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 767]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 493]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1520]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.032  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 742]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 490]:	loss = 0.009  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1551]:	loss = 0.012  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 400]:	loss = 0.027  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 752]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 484]:	loss = 0.009  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1564]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 428]:	loss = 0.042  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 714]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1555]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_41.csv
logged to wandb
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 36]:	loss = 0.010  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 64]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 43]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 152]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_41.csv
logged to wandb
Average incurred loss: 0.311  
Average sample loss: 0.308  
Average acc: 0.888  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.061  exp loss = 0.055  adjusted loss = 0.055  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.485  exp loss = 0.577  adjusted loss = 0.577  adv prob = 0.250000   acc = 0.815
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.732  exp loss = 0.845  adjusted loss = 0.845  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.158  exp loss = 0.122  adjusted loss = 0.122  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.203
Weighted Spurious Score = 1.200
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_41.csv
logged to wandb
Current lr: 0.000010


Epoch [42]:
Training:
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.031  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1525]:	loss = 0.014  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 403]:	loss = 0.041  exp loss = 0.058  adjusted loss = 0.058  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 781]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 544]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1472]:	loss = 0.011  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 404]:	loss = 0.023  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1532]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 387]:	loss = 0.042  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 760]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 482]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1571]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.025  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1542]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 437]:	loss = 0.034  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1511]:	loss = 0.012  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.034  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 730]:	loss = 0.011  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 438]:	loss = 0.041  exp loss = 0.056  adjusted loss = 0.056  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 700]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 491]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1571]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 439]:	loss = 0.034  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 742]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 510]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1509]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.053  exp loss = 0.049  adjusted loss = 0.049  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.008  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_42.csv
logged to wandb
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 32]:	loss = 0.016  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 73]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 50]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 140]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_42.csv
logged to wandb
Average incurred loss: 0.319  
Average sample loss: 0.316  
Average acc: 0.882  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.063  exp loss = 0.057  adjusted loss = 0.057  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.511  exp loss = 0.605  adjusted loss = 0.605  adv prob = 0.250000   acc = 0.796
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.707  exp loss = 0.804  adjusted loss = 0.804  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.152  exp loss = 0.115  adjusted loss = 0.115  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.219
Weighted Spurious Score = 1.225
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_42.csv
logged to wandb
Current lr: 0.000010


Epoch [43]:
Training:
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 389]:	loss = 0.040  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 780]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 531]:	loss = 0.010  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1500]:	loss = 0.010  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 430]:	loss = 0.030  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 537]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1500]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.027  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 720]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.014  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 431]:	loss = 0.040  exp loss = 0.045  adjusted loss = 0.045  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 738]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 491]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1540]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.043  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 736]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 485]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1567]:	loss = 0.012  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.038  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 544]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1503]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.030  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.009  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 473]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1558]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.024  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 717]:	loss = 0.009  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 517]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1545]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 401]:	loss = 0.030  exp loss = 0.086  adjusted loss = 0.086  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 759]:	loss = 0.011  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.034  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 517]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_43.csv
logged to wandb
Average incurred loss: 0.013  
Average sample loss: 0.012  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 40]:	loss = 0.015  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 77]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 52]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 126]:	loss = 0.017  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.992

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_43.csv
logged to wandb
Average incurred loss: 0.326  
Average sample loss: 0.323  
Average acc: 0.878  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.066  exp loss = 0.058  adjusted loss = 0.058  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.535  exp loss = 0.627  adjusted loss = 0.627  adv prob = 0.250000   acc = 0.790
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.687  exp loss = 0.794  adjusted loss = 0.794  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.146  exp loss = 0.110  adjusted loss = 0.110  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.223
Weighted Spurious Score = 1.231
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_43.csv
logged to wandb
Current lr: 0.000010


Epoch [44]:
Training:
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 444]:	loss = 0.039  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 0, forest2water2 = 1  [n = 758]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 527]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1471]:	loss = 0.009  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 400]:	loss = 0.040  exp loss = 0.074  adjusted loss = 0.074  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 478]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1595]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.026  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 763]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.027  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 716]:	loss = 0.012  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 550]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1507]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 391]:	loss = 0.032  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 487]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1567]:	loss = 0.011  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.028  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 539]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1519]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 396]:	loss = 0.029  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 483]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1565]:	loss = 0.010  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.028  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.008  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1533]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 400]:	loss = 0.026  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 742]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 437]:	loss = 0.052  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1513]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_44.csv
logged to wandb
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 45]:	loss = 0.030  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 73]:	loss = 0.014  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 51]:	loss = 0.006  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 126]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_44.csv
logged to wandb
Average incurred loss: 0.333  
Average sample loss: 0.330  
Average acc: 0.877  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.068  exp loss = 0.061  adjusted loss = 0.061  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.554  exp loss = 0.655  adjusted loss = 0.655  adv prob = 0.250000   acc = 0.788
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.677  exp loss = 0.771  adjusted loss = 0.771  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.144  exp loss = 0.108  adjusted loss = 0.108  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.223
Weighted Spurious Score = 1.231
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_44.csv
logged to wandb
Current lr: 0.000010


Epoch [45]:
Training:
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 392]:	loss = 0.041  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.008  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.014  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.022  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 725]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 494]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1557]:	loss = 0.009  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 400]:	loss = 0.023  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 770]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 473]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1557]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 435]:	loss = 0.021  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 783]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 535]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1447]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 435]:	loss = 0.031  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.013  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 528]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1496]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.046  exp loss = 0.045  adjusted loss = 0.045  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 494]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1534]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 404]:	loss = 0.027  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 713]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 529]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1554]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 397]:	loss = 0.021  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 716]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1563]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.037  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.009  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 447]:	loss = 0.036  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 713]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 487]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1553]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_45.csv
logged to wandb
Average incurred loss: 0.005  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 31]:	loss = 0.008  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 83]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 46]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 135]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_45.csv
logged to wandb
Average incurred loss: 0.321  
Average sample loss: 0.318  
Average acc: 0.883  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.058  exp loss = 0.052  adjusted loss = 0.052  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.510  exp loss = 0.602  adjusted loss = 0.602  adv prob = 0.250000   acc = 0.800
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.742  exp loss = 0.852  adjusted loss = 0.852  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.157  exp loss = 0.118  adjusted loss = 0.118  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.216
Weighted Spurious Score = 1.220
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_45.csv
logged to wandb
Current lr: 0.000010


Epoch [46]:
Training:
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.027  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 527]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 443]:	loss = 0.031  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 713]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 482]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1562]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 392]:	loss = 0.024  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 547]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1508]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 444]:	loss = 0.025  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 760]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 474]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.017  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 706]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 497]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1592]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 393]:	loss = 0.037  exp loss = 0.055  adjusted loss = 0.055  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 728]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 540]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1539]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 426]:	loss = 0.034  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.009  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 528]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1498]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 439]:	loss = 0.029  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 0, forest2water2 = 1  [n = 725]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1534]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 406]:	loss = 0.032  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 760]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1533]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.051  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 786]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1497]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_46.csv
logged to wandb
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 43]:	loss = 0.034  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 64]:	loss = 0.016  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 46]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 142]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_46.csv
logged to wandb
Average incurred loss: 0.322  
Average sample loss: 0.319  
Average acc: 0.882  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.061  exp loss = 0.054  adjusted loss = 0.054  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.515  exp loss = 0.605  adjusted loss = 0.605  adv prob = 0.250000   acc = 0.798
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.727  exp loss = 0.822  adjusted loss = 0.822  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.155  exp loss = 0.116  adjusted loss = 0.116  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.216
Weighted Spurious Score = 1.221
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_46.csv
logged to wandb
Current lr: 0.000010


Epoch [47]:
Training:
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.028  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 747]:	loss = 0.012  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 495]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1548]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 433]:	loss = 0.035  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 526]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.031  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1549]:	loss = 0.009  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 390]:	loss = 0.021  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 769]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1519]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.041  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 478]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1553]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.024  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 751]:	loss = 0.006  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1526]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.025  exp loss = 0.040  adjusted loss = 0.040  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.006  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 536]:	loss = 0.008  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1508]:	loss = 0.009  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.019  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 747]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 531]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1506]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 406]:	loss = 0.025  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 734]:	loss = 0.009  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.007  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1551]:	loss = 0.010  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 433]:	loss = 0.030  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_47.csv
logged to wandb
Average incurred loss: 0.011  
Average sample loss: 0.010  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 45]:	loss = 0.030  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 67]:	loss = 0.013  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 41]:	loss = 0.006  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 142]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_47.csv
logged to wandb
Average incurred loss: 0.318  
Average sample loss: 0.316  
Average acc: 0.886  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.056  exp loss = 0.049  adjusted loss = 0.049  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.499  exp loss = 0.595  adjusted loss = 0.595  adv prob = 0.250000   acc = 0.809
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.765  exp loss = 0.880  adjusted loss = 0.880  adv prob = 0.250000   acc = 0.774
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.156  exp loss = 0.117  adjusted loss = 0.117  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.215
Weighted Spurious Score = 1.213
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_47.csv
logged to wandb
Current lr: 0.000010


Epoch [48]:
Training:
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 436]:	loss = 0.042  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 0, forest2water2 = 1  [n = 728]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 517]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1519]:	loss = 0.012  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.033  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 711]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 561]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1511]:	loss = 0.010  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.041  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 0, forest2water2 = 1  [n = 763]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1540]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.014  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 510]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.014  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.024  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 776]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 476]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.036  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 728]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 527]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1528]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.024  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1539]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 391]:	loss = 0.033  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 761]:	loss = 0.006  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 493]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1555]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.026  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 444]:	loss = 0.025  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.011  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1514]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_48.csv
logged to wandb
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 40]:	loss = 0.020  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 65]:	loss = 0.006  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 62]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 128]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_48.csv
logged to wandb
Average incurred loss: 0.337  
Average sample loss: 0.335  
Average acc: 0.877  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.066  exp loss = 0.059  adjusted loss = 0.059  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.561  exp loss = 0.661  adjusted loss = 0.661  adv prob = 0.250000   acc = 0.783
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.699  exp loss = 0.788  adjusted loss = 0.788  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.143  exp loss = 0.107  adjusted loss = 0.107  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.233
Weighted Spurious Score = 1.241
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_48.csv
logged to wandb
Current lr: 0.000010


Epoch [49]:
Training:
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 409]:	loss = 0.025  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 724]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 550]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 437]:	loss = 0.032  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 483]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1547]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.023  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 773]:	loss = 0.011  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 476]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1546]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 752]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1519]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.013  
Average sample loss: 0.013  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 388]:	loss = 0.030  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 767]:	loss = 0.006  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1547]:	loss = 0.013  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.043  exp loss = 0.046  adjusted loss = 0.046  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.028  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 730]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1549]:	loss = 0.011  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 446]:	loss = 0.027  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1498]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 433]:	loss = 0.044  exp loss = 0.056  adjusted loss = 0.056  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 725]:	loss = 0.008  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 397]:	loss = 0.023  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 734]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 536]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1533]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_49.csv
logged to wandb
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 43]:	loss = 0.029  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 65]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 43]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 144]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_49.csv
logged to wandb
Average incurred loss: 0.326  
Average sample loss: 0.323  
Average acc: 0.884  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.057  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.516  exp loss = 0.611  adjusted loss = 0.611  adv prob = 0.250000   acc = 0.803
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.771  exp loss = 0.878  adjusted loss = 0.878  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.157  exp loss = 0.118  adjusted loss = 0.118  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.214
Weighted Spurious Score = 1.218
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_49.csv
logged to wandb
Current lr: 0.000010


Epoch [50]:
Training:
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.032  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 720]:	loss = 0.009  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 538]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1510]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 428]:	loss = 0.044  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 786]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 500]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1486]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.025  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 713]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 510]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1557]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.018  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.007  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1542]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 447]:	loss = 0.023  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 724]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1527]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.023  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 712]:	loss = 0.006  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 519]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1557]:	loss = 0.009  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 403]:	loss = 0.022  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 777]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1500]:	loss = 0.010  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.035  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 542]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1491]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.021  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 752]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 492]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1554]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 390]:	loss = 0.022  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 750]:	loss = 0.008  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 474]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1586]:	loss = 0.009  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_50.csv
logged to wandb
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 35]:	loss = 0.010  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 63]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 50]:	loss = 0.011  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 147]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_50.csv
logged to wandb
Average incurred loss: 0.313  
Average sample loss: 0.311  
Average acc: 0.891  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.048  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.465  exp loss = 0.555  adjusted loss = 0.555  adv prob = 0.250000   acc = 0.824
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.851  exp loss = 0.992  adjusted loss = 0.992  adv prob = 0.250000   acc = 0.759
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.174  exp loss = 0.132  adjusted loss = 0.132  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.216
Weighted Spurious Score = 1.202
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_50.csv
logged to wandb
Current lr: 0.000010


Epoch [51]:
Training:
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.019  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 532]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1489]:	loss = 0.007  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.018  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 705]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1553]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 378]:	loss = 0.026  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 786]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 485]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1551]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.023  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 497]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1535]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 386]:	loss = 0.024  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 528]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1533]:	loss = 0.009  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 436]:	loss = 0.027  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 688]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 494]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1582]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.032  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 700]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 546]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 431]:	loss = 0.035  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 773]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1500]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.031  exp loss = 0.063  adjusted loss = 0.063  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 742]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1532]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.035  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 762]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1505]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_51.csv
logged to wandb
Average incurred loss: 0.021  
Average sample loss: 0.020  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 35]:	loss = 0.142  exp loss = 0.055  adjusted loss = 0.055  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 73]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 46]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 141]:	loss = 0.004  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_51.csv
logged to wandb
Average incurred loss: 0.326  
Average sample loss: 0.323  
Average acc: 0.886  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.054  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.516  exp loss = 0.613  adjusted loss = 0.613  adv prob = 0.250000   acc = 0.807
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.783  exp loss = 0.897  adjusted loss = 0.897  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.155  exp loss = 0.116  adjusted loss = 0.116  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.211
Weighted Spurious Score = 1.213
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_51.csv
logged to wandb
Current lr: 0.000010


Epoch [52]:
Training:
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.035  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.007  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 490]:	loss = 0.007  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1560]:	loss = 0.009  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 460]:	loss = 0.028  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 714]:	loss = 0.010  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 487]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1539]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.014  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 706]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 537]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.043  exp loss = 0.049  adjusted loss = 0.049  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 761]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1511]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 372]:	loss = 0.018  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 768]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1546]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.027  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1538]:	loss = 0.009  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.024  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1535]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.025  exp loss = 0.036  adjusted loss = 0.036  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 797]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 479]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.029  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 700]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 557]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1511]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.017  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 772]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1499]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_52.csv
logged to wandb
Average incurred loss: 0.022  
Average sample loss: 0.021  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 38]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 52]:	loss = 0.002  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 53]:	loss = 0.012  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 152]:	loss = 0.034  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.993

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_52.csv
logged to wandb
Average incurred loss: 0.329  
Average sample loss: 0.326  
Average acc: 0.891  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.050  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.508  exp loss = 0.599  adjusted loss = 0.599  adv prob = 0.250000   acc = 0.818
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.841  exp loss = 0.951  adjusted loss = 0.951  adv prob = 0.250000   acc = 0.774
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.166  exp loss = 0.125  adjusted loss = 0.125  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.211
Weighted Spurious Score = 1.207
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_52.csv
logged to wandb
Current lr: 0.000010


Epoch [53]:
Training:
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 404]:	loss = 0.021  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 758]:	loss = 0.006  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1514]:	loss = 0.008  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 461]:	loss = 0.018  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 0, forest2water2 = 1  [n = 715]:	loss = 0.012  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 500]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1524]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.019  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 532]:	loss = 0.007  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1528]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 396]:	loss = 0.026  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1553]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 404]:	loss = 0.019  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1534]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 406]:	loss = 0.036  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 489]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1562]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.021  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.013  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.024  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 749]:	loss = 0.008  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 484]:	loss = 0.008  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1540]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 442]:	loss = 0.034  exp loss = 0.036  adjusted loss = 0.036  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 0, forest2water2 = 1  [n = 759]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 530]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1469]:	loss = 0.011  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.032  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 749]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 493]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1547]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_53.csv
logged to wandb
Average incurred loss: 0.014  
Average sample loss: 0.014  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 41]:	loss = 0.016  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 66]:	loss = 0.020  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 1, forest2water2 = 0  [n = 45]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 143]:	loss = 0.014  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.993

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_53.csv
logged to wandb
Average incurred loss: 0.335  
Average sample loss: 0.332  
Average acc: 0.882  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.060  exp loss = 0.053  adjusted loss = 0.053  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.547  exp loss = 0.647  adjusted loss = 0.647  adv prob = 0.250000   acc = 0.796
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.742  exp loss = 0.820  adjusted loss = 0.820  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.149  exp loss = 0.111  adjusted loss = 0.111  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.219
Weighted Spurious Score = 1.225
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_53.csv
logged to wandb
Current lr: 0.000010


Epoch [54]:
Training:
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 435]:	loss = 0.024  exp loss = 0.039  adjusted loss = 0.039  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 738]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1523]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.020  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 772]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 489]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1523]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 436]:	loss = 0.029  exp loss = 0.052  adjusted loss = 0.052  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1534]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 392]:	loss = 0.021  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 754]:	loss = 0.009  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 527]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1527]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.015  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 552]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1505]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.029  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.006  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1527]:	loss = 0.009  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 366]:	loss = 0.013  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 749]:	loss = 0.004  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 527]:	loss = 0.007  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1558]:	loss = 0.011  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 443]:	loss = 0.019  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 700]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1539]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 400]:	loss = 0.014  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 742]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 511]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1547]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 439]:	loss = 0.045  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 489]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_54.csv
logged to wandb
Average incurred loss: 0.013  
Average sample loss: 0.015  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 44]:	loss = 0.057  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 75]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 39]:	loss = 0.003  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 137]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_54.csv
logged to wandb
Average incurred loss: 0.335  
Average sample loss: 0.333  
Average acc: 0.882  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.060  exp loss = 0.053  adjusted loss = 0.053  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.550  exp loss = 0.650  adjusted loss = 0.650  adv prob = 0.250000   acc = 0.796
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.736  exp loss = 0.825  adjusted loss = 0.825  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.147  exp loss = 0.108  adjusted loss = 0.108  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.222
Weighted Spurious Score = 1.225
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_54.csv
logged to wandb
Current lr: 0.000010


Epoch [55]:
Training:
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 369]:	loss = 0.020  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 751]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 555]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1525]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.024  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 724]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 529]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1515]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 457]:	loss = 0.018  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 730]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 480]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1533]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 390]:	loss = 0.023  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 763]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 497]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1550]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 426]:	loss = 0.039  exp loss = 0.072  adjusted loss = 0.072  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1523]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.020  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1516]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.019  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 703]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 539]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 441]:	loss = 0.022  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 717]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1546]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 397]:	loss = 0.020  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 757]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.010  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.023  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 759]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 477]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1545]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_55.csv
logged to wandb
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 37]:	loss = 0.011  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 81]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 38]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 139]:	loss = 0.003  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_55.csv
logged to wandb
Average incurred loss: 0.355  
Average sample loss: 0.353  
Average acc: 0.871  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.069  exp loss = 0.061  adjusted loss = 0.061  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.611  exp loss = 0.718  adjusted loss = 0.718  adv prob = 0.250000   acc = 0.775
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.683  exp loss = 0.750  adjusted loss = 0.750  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.136  exp loss = 0.099  adjusted loss = 0.099  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.235
Weighted Spurious Score = 1.245
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_55.csv
logged to wandb
Current lr: 0.000010


Epoch [56]:
Training:
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.027  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.009  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 526]:	loss = 0.006  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1515]:	loss = 0.007  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 447]:	loss = 0.026  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 517]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1496]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 394]:	loss = 0.035  exp loss = 0.049  adjusted loss = 0.049  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 778]:	loss = 0.007  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1514]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.017  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 750]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1519]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 390]:	loss = 0.016  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 531]:	loss = 0.008  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1557]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.025  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1547]:	loss = 0.007  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.031  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 765]:	loss = 0.009  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1508]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.025  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 467]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1578]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.025  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 711]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 535]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1546]:	loss = 0.009  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.023  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 493]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_56.csv
logged to wandb
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 38]:	loss = 0.008  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 61]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 48]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 148]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_56.csv
logged to wandb
Average incurred loss: 0.323  
Average sample loss: 0.321  
Average acc: 0.888  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.047  exp loss = 0.040  adjusted loss = 0.040  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.491  exp loss = 0.583  adjusted loss = 0.583  adv prob = 0.250000   acc = 0.818
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.859  exp loss = 0.972  adjusted loss = 0.972  adv prob = 0.250000   acc = 0.759
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.172  exp loss = 0.128  adjusted loss = 0.128  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.221
Weighted Spurious Score = 1.210
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_56.csv
logged to wandb
Current lr: 0.000010


Epoch [57]:
Training:
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 409]:	loss = 0.017  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 724]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1547]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 376]:	loss = 0.024  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 770]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 536]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.015  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 684]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 542]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1558]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.021  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 751]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 494]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1531]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.021  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 764]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 490]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 448]:	loss = 0.021  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 0, forest2water2 = 1  [n = 725]:	loss = 0.006  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1514]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 403]:	loss = 0.025  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 752]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 529]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1516]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 452]:	loss = 0.018  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 0, forest2water2 = 1  [n = 726]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 479]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 386]:	loss = 0.038  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 769]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.024  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 752]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1519]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_57.csv
logged to wandb
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 48]:	loss = 0.032  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 67]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 42]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 138]:	loss = 0.004  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_57.csv
logged to wandb
Average incurred loss: 0.342  
Average sample loss: 0.340  
Average acc: 0.882  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.055  exp loss = 0.049  adjusted loss = 0.049  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.562  exp loss = 0.667  adjusted loss = 0.667  adv prob = 0.250000   acc = 0.794
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.772  exp loss = 0.875  adjusted loss = 0.875  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.151  exp loss = 0.110  adjusted loss = 0.110  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.226
Weighted Spurious Score = 1.230
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_57.csv
logged to wandb
Current lr: 0.000010


Epoch [58]:
Training:
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.022  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 731]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 530]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1519]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.027  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 721]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1552]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.026  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 718]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1559]:	loss = 0.010  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.023  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 770]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 488]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.006  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 436]:	loss = 0.016  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 728]:	loss = 0.010  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 736]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.027  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 717]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1545]:	loss = 0.009  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.018  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 526]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1489]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.018  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 762]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 485]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1548]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 401]:	loss = 0.023  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 765]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1511]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_58.csv
logged to wandb
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 23]:	loss = 0.005  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 80]:	loss = 0.002  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 46]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 146]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_58.csv
logged to wandb
Average incurred loss: 0.332  
Average sample loss: 0.330  
Average acc: 0.886  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.051  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.526  exp loss = 0.626  adjusted loss = 0.626  adv prob = 0.250000   acc = 0.807
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.813  exp loss = 0.922  adjusted loss = 0.922  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.159  exp loss = 0.117  adjusted loss = 0.117  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.211
Weighted Spurious Score = 1.212
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_58.csv
logged to wandb
Current lr: 0.000010


Epoch [59]:
Training:
Average incurred loss: 0.010  
Average sample loss: 0.010  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.028  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 767]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 495]:	loss = 0.006  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 438]:	loss = 0.021  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 510]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.012  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.004  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 487]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1560]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.030  exp loss = 0.036  adjusted loss = 0.036  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 739]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.023  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 721]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 532]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1528]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.018  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1526]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.022  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 777]:	loss = 0.008  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1510]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 391]:	loss = 0.016  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 738]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 535]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 404]:	loss = 0.022  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1535]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 437]:	loss = 0.018  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 694]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 517]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1552]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_59.csv
logged to wandb
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 28]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 57]:	loss = 0.001  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 57]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 153]:	loss = 0.011  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_59.csv
logged to wandb
Average incurred loss: 0.321  
Average sample loss: 0.318  
Average acc: 0.893  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.038  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.452  exp loss = 0.536  adjusted loss = 0.536  adv prob = 0.250000   acc = 0.835
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.985  exp loss = 1.121  adjusted loss = 1.121  adv prob = 0.250000   acc = 0.737
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.191  exp loss = 0.145  adjusted loss = 0.145  adv prob = 0.250000   acc = 0.940
Spurious Score = 1.223
Weighted Spurious Score = 1.199
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_59.csv
logged to wandb
Current lr: 0.000010


Epoch [60]:
Training:
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.022  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1514]:	loss = 0.008  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.022  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 721]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 532]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1527]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.020  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 736]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1559]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 406]:	loss = 0.013  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 736]:	loss = 0.011  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 497]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1561]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.020  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 730]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1526]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.018  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 752]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.009  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 428]:	loss = 0.041  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 721]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 536]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1515]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.021  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.011  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.008  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1524]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.026  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 780]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 476]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_60.csv
logged to wandb
Average incurred loss: 0.004  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 32]:	loss = 0.004  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 66]:	loss = 0.001  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 48]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 149]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_60.csv
logged to wandb
Average incurred loss: 0.333  
Average sample loss: 0.330  
Average acc: 0.889  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.049  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.521  exp loss = 0.617  adjusted loss = 0.617  adv prob = 0.250000   acc = 0.813
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.841  exp loss = 0.950  adjusted loss = 0.950  adv prob = 0.250000   acc = 0.774
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.162  exp loss = 0.120  adjusted loss = 0.120  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.214
Weighted Spurious Score = 1.212
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_60.csv
logged to wandb
Current lr: 0.000010


Epoch [61]:
Training:
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.015  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 768]:	loss = 0.008  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 519]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1496]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 435]:	loss = 0.027  exp loss = 0.049  adjusted loss = 0.049  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 485]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.021  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 537]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1505]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 433]:	loss = 0.016  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 711]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1533]:	loss = 0.007  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.012  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 726]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.008  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1568]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 436]:	loss = 0.027  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 0, forest2water2 = 1  [n = 788]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 494]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1482]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 382]:	loss = 0.013  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 725]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1579]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.023  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 717]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1557]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.018  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 757]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1503]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 397]:	loss = 0.019  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 739]:	loss = 0.006  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1555]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_61.csv
logged to wandb
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 41]:	loss = 0.004  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 72]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 46]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 136]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_61.csv
logged to wandb
Average incurred loss: 0.332  
Average sample loss: 0.330  
Average acc: 0.887  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.050  exp loss = 0.043  adjusted loss = 0.043  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.525  exp loss = 0.621  adjusted loss = 0.621  adv prob = 0.250000   acc = 0.809
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.821  exp loss = 0.940  adjusted loss = 0.940  adv prob = 0.250000   acc = 0.774
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.160  exp loss = 0.118  adjusted loss = 0.118  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.216
Weighted Spurious Score = 1.215
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_61.csv
logged to wandb
Current lr: 0.000010


Epoch [62]:
Training:
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 409]:	loss = 0.019  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.008  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.030  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 448]:	loss = 0.021  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 0, forest2water2 = 1  [n = 768]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 482]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1502]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 398]:	loss = 0.014  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 724]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 533]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1545]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 375]:	loss = 0.008  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1601]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 401]:	loss = 0.012  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 694]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 557]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1548]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.022  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 784]:	loss = 0.006  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 479]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1523]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 444]:	loss = 0.022  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 517]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1510]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 445]:	loss = 0.023  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.010  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 490]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 400]:	loss = 0.020  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 542]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1523]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_62.csv
logged to wandb
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 37]:	loss = 0.018  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 81]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 49]:	loss = 0.003  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 128]:	loss = 0.003  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_62.csv
logged to wandb
Average incurred loss: 0.342  
Average sample loss: 0.339  
Average acc: 0.882  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.049  exp loss = 0.042  adjusted loss = 0.042  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.548  exp loss = 0.649  adjusted loss = 0.649  adv prob = 0.250000   acc = 0.798
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.835  exp loss = 0.940  adjusted loss = 0.940  adv prob = 0.250000   acc = 0.774
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.154  exp loss = 0.114  adjusted loss = 0.114  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.225
Weighted Spurious Score = 1.227
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_62.csv
logged to wandb
Current lr: 0.000010


Epoch [63]:
Training:
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.016  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 728]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 528]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.029  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 768]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1503]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 436]:	loss = 0.018  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.012  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1513]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.017  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 479]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1562]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.021  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.004  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 530]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1531]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.022  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 772]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 469]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1548]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.011  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 752]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1531]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.019  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 745]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 489]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1539]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.017  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 528]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 396]:	loss = 0.022  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 704]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 543]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1557]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_63.csv
logged to wandb
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 38]:	loss = 0.004  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 68]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 59]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 130]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_63.csv
logged to wandb
Average incurred loss: 0.340  
Average sample loss: 0.337  
Average acc: 0.885  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.043  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.523  exp loss = 0.616  adjusted loss = 0.616  adv prob = 0.250000   acc = 0.809
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.914  exp loss = 1.046  adjusted loss = 1.046  adv prob = 0.250000   acc = 0.752
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.167  exp loss = 0.124  adjusted loss = 0.124  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.235
Weighted Spurious Score = 1.224
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_63.csv
logged to wandb
Current lr: 0.000010


Epoch [64]:
Training:
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 400]:	loss = 0.014  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 713]:	loss = 0.007  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 540]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1547]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.014  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 767]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1503]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.013  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 782]:	loss = 0.007  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1510]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 439]:	loss = 0.030  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 736]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1505]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 398]:	loss = 0.020  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 752]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 533]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 434]:	loss = 0.017  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 494]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1540]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.027  exp loss = 0.049  adjusted loss = 0.049  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 510]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1526]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 426]:	loss = 0.016  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 709]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1552]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 388]:	loss = 0.015  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 751]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 480]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1581]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.017  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1526]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_64.csv
logged to wandb
Average incurred loss: 0.014  
Average sample loss: 0.013  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 46]:	loss = 0.042  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 0, forest2water2 = 1  [n = 57]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 42]:	loss = 0.012  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 150]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_64.csv
logged to wandb
Average incurred loss: 0.341  
Average sample loss: 0.339  
Average acc: 0.887  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.048  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.540  exp loss = 0.638  adjusted loss = 0.638  adv prob = 0.250000   acc = 0.807
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.858  exp loss = 0.974  adjusted loss = 0.974  adv prob = 0.250000   acc = 0.774
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.159  exp loss = 0.117  adjusted loss = 0.117  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.219
Weighted Spurious Score = 1.219
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_64.csv
logged to wandb
Current lr: 0.000010


Epoch [65]:
Training:
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.015  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 702]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 548]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1540]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.023  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 768]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 477]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1550]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 436]:	loss = 0.011  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 713]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 525]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1526]:	loss = 0.006  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 430]:	loss = 0.026  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 770]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 532]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1468]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 409]:	loss = 0.016  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 493]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1557]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.022  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 721]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 401]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 757]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1540]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.028  exp loss = 0.053  adjusted loss = 0.053  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 699]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1560]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.020  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 783]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1489]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.019  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 752]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 482]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1551]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_65.csv
logged to wandb
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 37]:	loss = 0.017  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 78]:	loss = 0.010  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 45]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 135]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_65.csv
logged to wandb
Average incurred loss: 0.349  
Average sample loss: 0.346  
Average acc: 0.882  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.054  exp loss = 0.047  adjusted loss = 0.047  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.572  exp loss = 0.680  adjusted loss = 0.680  adv prob = 0.250000   acc = 0.794
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.801  exp loss = 0.895  adjusted loss = 0.895  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.152  exp loss = 0.111  adjusted loss = 0.111  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.227
Weighted Spurious Score = 1.232
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_65.csv
logged to wandb
Current lr: 0.000010


Epoch [66]:
Training:
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 401]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 404]:	loss = 0.016  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 396]:	loss = 0.018  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 757]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 495]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1552]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 404]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.012  
Average sample loss: 0.012  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 393]:	loss = 0.044  exp loss = 0.064  adjusted loss = 0.064  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 813]:	loss = 0.012  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 500]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1494]:	loss = 0.006  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 445]:	loss = 0.013  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 710]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1524]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 448]:	loss = 0.016  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 763]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1471]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.015  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 715]:	loss = 0.004  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 477]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1600]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 443]:	loss = 0.029  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 0, forest2water2 = 1  [n = 708]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 530]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1519]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.007  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 720]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 539]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1526]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_66.csv
logged to wandb
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 41]:	loss = 0.018  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 67]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 45]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 142]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_66.csv
logged to wandb
Average incurred loss: 0.341  
Average sample loss: 0.339  
Average acc: 0.887  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.047  exp loss = 0.040  adjusted loss = 0.040  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.541  exp loss = 0.639  adjusted loss = 0.639  adv prob = 0.250000   acc = 0.809
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.856  exp loss = 0.973  adjusted loss = 0.973  adv prob = 0.250000   acc = 0.774
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.160  exp loss = 0.118  adjusted loss = 0.118  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.218
Weighted Spurious Score = 1.217
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_66.csv
logged to wandb
Current lr: 0.000010


Epoch [67]:
Training:
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.015  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.007  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 535]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1528]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.031  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 731]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1549]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.018  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 798]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 528]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1466]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 441]:	loss = 0.017  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 728]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1513]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 442]:	loss = 0.018  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 742]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1504]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.009  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 709]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 497]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1577]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 394]:	loss = 0.014  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 725]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1565]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 435]:	loss = 0.022  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 406]:	loss = 0.013  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 759]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 486]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1549]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.020  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 761]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_67.csv
logged to wandb
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 43]:	loss = 0.028  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 73]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 46]:	loss = 0.003  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_67.csv
logged to wandb
Average incurred loss: 0.356  
Average sample loss: 0.354  
Average acc: 0.881  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.052  exp loss = 0.045  adjusted loss = 0.045  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.588  exp loss = 0.693  adjusted loss = 0.693  adv prob = 0.250000   acc = 0.792
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.819  exp loss = 0.910  adjusted loss = 0.910  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.148  exp loss = 0.108  adjusted loss = 0.108  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.227
Weighted Spurious Score = 1.233
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_67.csv
logged to wandb
Current lr: 0.000010


Epoch [68]:
Training:
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 392]:	loss = 0.019  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 531]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1555]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 778]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 461]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.020  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 529]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.012  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 754]:	loss = 0.007  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1535]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.012  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 730]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1555]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.016  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 701]:	loss = 0.005  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1576]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 734]:	loss = 0.004  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 545]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1506]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 446]:	loss = 0.036  exp loss = 0.056  adjusted loss = 0.056  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 0, forest2water2 = 1  [n = 778]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1460]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 459]:	loss = 0.017  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 734]:	loss = 0.008  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.004  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1502]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 400]:	loss = 0.015  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 754]:	loss = 0.005  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1539]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_68.csv
logged to wandb
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 35]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 77]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 39]:	loss = 0.003  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 144]:	loss = 0.003  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_68.csv
logged to wandb
Average incurred loss: 0.335  
Average sample loss: 0.332  
Average acc: 0.892  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.042  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.503  exp loss = 0.597  adjusted loss = 0.597  adv prob = 0.250000   acc = 0.826
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.932  exp loss = 1.060  adjusted loss = 1.060  adv prob = 0.250000   acc = 0.752
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.177  exp loss = 0.131  adjusted loss = 0.131  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.222
Weighted Spurious Score = 1.204
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_68.csv
logged to wandb
Current lr: 0.000010


Epoch [69]:
Training:
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.020  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 714]:	loss = 0.004  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1538]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.012  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 719]:	loss = 0.004  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 491]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1576]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.018  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 717]:	loss = 0.006  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 510]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1559]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.015  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 747]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 495]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.024  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1550]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.015  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.004  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1533]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 437]:	loss = 0.014  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1491]:	loss = 0.004  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.016  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 758]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 527]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1488]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.013  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 760]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 516]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1519]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 404]:	loss = 0.018  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 778]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.007  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.998
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_69.csv
logged to wandb
Average incurred loss: 0.009  
Average sample loss: 0.008  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 35]:	loss = 0.006  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 62]:	loss = 0.001  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 48]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 150]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.993

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_69.csv
logged to wandb
Average incurred loss: 0.336  
Average sample loss: 0.333  
Average acc: 0.887  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.036  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.488  exp loss = 0.580  adjusted loss = 0.580  adv prob = 0.250000   acc = 0.822
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 1.008  exp loss = 1.153  adjusted loss = 1.153  adv prob = 0.250000   acc = 0.729
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.185  exp loss = 0.137  adjusted loss = 0.137  adv prob = 0.250000   acc = 0.940
Spurious Score = 1.239
Weighted Spurious Score = 1.217
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_69.csv
logged to wandb
Current lr: 0.000010


Epoch [70]:
Training:
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.013  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 750]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.012  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 766]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.029  exp loss = 0.036  adjusted loss = 0.036  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 792]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 474]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1511]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.027  exp loss = 0.033  adjusted loss = 0.033  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1555]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.011  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 519]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.017  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 751]:	loss = 0.007  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1527]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 701]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1554]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 440]:	loss = 0.019  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 525]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1506]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1552]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.018  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 500]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1558]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_70.csv
logged to wandb
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 50]:	loss = 0.028  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 76]:	loss = 0.010  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 46]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 123]:	loss = 0.002  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_70.csv
logged to wandb
Average incurred loss: 0.360  
Average sample loss: 0.358  
Average acc: 0.875  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.056  exp loss = 0.048  adjusted loss = 0.048  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.605  exp loss = 0.720  adjusted loss = 0.720  adv prob = 0.250000   acc = 0.777
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.788  exp loss = 0.880  adjusted loss = 0.880  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.146  exp loss = 0.106  adjusted loss = 0.106  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.239
Weighted Spurious Score = 1.251
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_70.csv
logged to wandb
Current lr: 0.000010


Epoch [71]:
Training:
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 441]:	loss = 0.010  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 483]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 394]:	loss = 0.019  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1567]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 454]:	loss = 0.014  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 718]:	loss = 0.004  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 400]:	loss = 0.018  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 774]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1508]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.015  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 488]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1575]:	loss = 0.008  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.021  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 778]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1501]:	loss = 0.006  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 386]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 746]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 547]:	loss = 0.008  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1521]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.014  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1512]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.014  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1551]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.024  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_71.csv
logged to wandb
Average incurred loss: 0.011  
Average sample loss: 0.011  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 41]:	loss = 0.005  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 68]:	loss = 0.037  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 1, forest2water2 = 0  [n = 45]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 141]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_71.csv
logged to wandb
Average incurred loss: 0.357  
Average sample loss: 0.354  
Average acc: 0.879  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.052  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.591  exp loss = 0.696  adjusted loss = 0.696  adv prob = 0.250000   acc = 0.783
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.813  exp loss = 0.908  adjusted loss = 0.908  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.150  exp loss = 0.109  adjusted loss = 0.109  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.237
Weighted Spurious Score = 1.247
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_71.csv
logged to wandb
Current lr: 0.000010


Epoch [72]:
Training:
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 436]:	loss = 0.012  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 734]:	loss = 0.005  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 529]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1501]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.009  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 479]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1545]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 426]:	loss = 0.018  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 511]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.023  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 742]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1532]:	loss = 0.007  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.019  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 736]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 437]:	loss = 0.020  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1509]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1550]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 392]:	loss = 0.012  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 749]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.018  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 497]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 381]:	loss = 0.016  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 745]:	loss = 0.003  exp loss = 0.001  adjusted loss = 0.001  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1562]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_72.csv
logged to wandb
Average incurred loss: 0.009  
Average sample loss: 0.012  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 45]:	loss = 0.034  exp loss = 0.027  adjusted loss = 0.027  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 0, forest2water2 = 1  [n = 82]:	loss = 0.008  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 36]:	loss = 0.002  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 132]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_72.csv
logged to wandb
Average incurred loss: 0.346  
Average sample loss: 0.343  
Average acc: 0.887  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.047  exp loss = 0.040  adjusted loss = 0.040  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.551  exp loss = 0.652  adjusted loss = 0.652  adv prob = 0.250000   acc = 0.809
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.861  exp loss = 0.970  adjusted loss = 0.970  adv prob = 0.250000   acc = 0.774
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.159  exp loss = 0.116  adjusted loss = 0.116  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.218
Weighted Spurious Score = 1.217
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_72.csv
logged to wandb
Current lr: 0.000010


Epoch [73]:
Training:
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.021  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1533]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 438]:	loss = 0.016  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 747]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 540]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1475]:	loss = 0.005  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.008  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 728]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1553]:	loss = 0.006  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.020  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 757]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1504]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 438]:	loss = 0.021  exp loss = 0.037  adjusted loss = 0.037  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 717]:	loss = 0.009  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 486]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1559]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.015  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 763]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1515]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.021  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 513]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 409]:	loss = 0.013  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 749]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1522]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 397]:	loss = 0.019  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 726]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1578]:	loss = 0.007  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.024  exp loss = 0.052  adjusted loss = 0.052  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 762]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1527]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_73.csv
logged to wandb
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 34]:	loss = 0.003  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 73]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 38]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 150]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_73.csv
logged to wandb
Average incurred loss: 0.346  
Average sample loss: 0.343  
Average acc: 0.886  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.045  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.548  exp loss = 0.647  adjusted loss = 0.647  adv prob = 0.250000   acc = 0.807
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.881  exp loss = 0.984  adjusted loss = 0.984  adv prob = 0.250000   acc = 0.767
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.159  exp loss = 0.116  adjusted loss = 0.116  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.225
Weighted Spurious Score = 1.222
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_73.csv
logged to wandb
Current lr: 0.000010


Epoch [74]:
Training:
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.017  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.006  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1539]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.014  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 751]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1515]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 431]:	loss = 0.017  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 745]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 380]:	loss = 0.034  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 782]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 500]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1538]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 407]:	loss = 0.024  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 533]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1538]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.012  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 751]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1532]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.018  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 750]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 506]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1528]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.009  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1535]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 430]:	loss = 0.013  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 720]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 510]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1540]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_74.csv
logged to wandb
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 34]:	loss = 0.009  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 77]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 52]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 132]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_74.csv
logged to wandb
Average incurred loss: 0.341  
Average sample loss: 0.338  
Average acc: 0.887  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.041  exp loss = 0.034  adjusted loss = 0.034  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.519  exp loss = 0.615  adjusted loss = 0.615  adv prob = 0.250000   acc = 0.815
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.935  exp loss = 1.051  adjusted loss = 1.051  adv prob = 0.250000   acc = 0.744
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.174  exp loss = 0.127  adjusted loss = 0.127  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.236
Weighted Spurious Score = 1.219
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_74.csv
logged to wandb
Current lr: 0.000010


Epoch [75]:
Training:
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 389]:	loss = 0.014  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1544]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 403]:	loss = 0.014  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 764]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1531]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.015  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 750]:	loss = 0.006  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.012  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1524]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 394]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 726]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1577]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 435]:	loss = 0.015  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 718]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 493]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1554]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 406]:	loss = 0.010  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 538]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.023  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 714]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 531]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1539]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 439]:	loss = 0.016  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 759]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1499]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 426]:	loss = 0.012  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 755]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1497]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_75.csv
logged to wandb
Average incurred loss: 0.008  
Average sample loss: 0.008  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 47]:	loss = 0.037  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 74]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 40]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 134]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_75.csv
logged to wandb
Average incurred loss: 0.378  
Average sample loss: 0.376  
Average acc: 0.875  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.058  exp loss = 0.050  adjusted loss = 0.050  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.652  exp loss = 0.765  adjusted loss = 0.765  adv prob = 0.250000   acc = 0.775
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.781  exp loss = 0.872  adjusted loss = 0.872  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.140  exp loss = 0.101  adjusted loss = 0.101  adv prob = 0.250000   acc = 0.962
Spurious Score = 1.246
Weighted Spurious Score = 1.256
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_75.csv
logged to wandb
Current lr: 0.000010


Epoch [76]:
Training:
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 421]:	loss = 0.025  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 727]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 510]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1542]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 452]:	loss = 0.013  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 717]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 526]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1505]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 430]:	loss = 0.010  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 740]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 523]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1507]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 434]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 706]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 544]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1516]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 367]:	loss = 0.016  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 775]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1538]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 361]:	loss = 0.007  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 742]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 498]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1599]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 445]:	loss = 0.015  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 751]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 488]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1516]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.013  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 787]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1484]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 398]:	loss = 0.015  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 725]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1576]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 423]:	loss = 0.016  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 735]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 502]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1540]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_76.csv
logged to wandb
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 43]:	loss = 0.017  exp loss = 0.030  adjusted loss = 0.030  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 79]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 39]:	loss = 0.002  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 134]:	loss = 0.002  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_76.csv
logged to wandb
Average incurred loss: 0.361  
Average sample loss: 0.358  
Average acc: 0.882  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.051  exp loss = 0.044  adjusted loss = 0.044  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.599  exp loss = 0.712  adjusted loss = 0.712  adv prob = 0.250000   acc = 0.794
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.823  exp loss = 0.905  adjusted loss = 0.905  adv prob = 0.250000   acc = 0.774
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.149  exp loss = 0.107  adjusted loss = 0.107  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.234
Weighted Spurious Score = 1.237
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_76.csv
logged to wandb
Current lr: 0.000010


Epoch [77]:
Training:
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 435]:	loss = 0.020  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 736]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1505]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 420]:	loss = 0.015  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 780]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 530]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1470]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.020  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 708]:	loss = 0.004  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 517]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1558]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 428]:	loss = 0.010  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 712]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 493]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1567]:	loss = 0.006  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 419]:	loss = 0.016  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 708]:	loss = 0.005  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1555]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.016  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 765]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 504]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1515]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 385]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 790]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1516]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.018  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 781]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 454]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 395]:	loss = 0.012  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 724]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 536]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1545]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 712]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 525]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1545]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_77.csv
logged to wandb
Average incurred loss: 0.003  
Average sample loss: 0.003  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 41]:	loss = 0.006  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 68]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 46]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 140]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_77.csv
logged to wandb
Average incurred loss: 0.344  
Average sample loss: 0.341  
Average acc: 0.889  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.038  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.514  exp loss = 0.610  adjusted loss = 0.610  adv prob = 0.250000   acc = 0.822
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.987  exp loss = 1.128  adjusted loss = 1.128  adv prob = 0.250000   acc = 0.737
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.179  exp loss = 0.131  adjusted loss = 0.131  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.238
Weighted Spurious Score = 1.216
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_77.csv
logged to wandb
Current lr: 0.000010


Epoch [78]:
Training:
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.015  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 470]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1559]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.015  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 747]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 507]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1514]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 380]:	loss = 0.015  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 769]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 510]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 412]:	loss = 0.013  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 540]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1516]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 451]:	loss = 0.021  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 0, forest2water2 = 1  [n = 724]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 539]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1486]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 398]:	loss = 0.025  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 793]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1485]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.011  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 751]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 488]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1543]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.012  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 696]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 532]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1540]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.010  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 464]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1578]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.010  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 708]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1558]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_78.csv
logged to wandb
Average incurred loss: 0.005  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 31]:	loss = 0.008  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 65]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 62]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 137]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_78.csv
logged to wandb
Average incurred loss: 0.337  
Average sample loss: 0.334  
Average acc: 0.892  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.032  exp loss = 0.026  adjusted loss = 0.026  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.470  exp loss = 0.561  adjusted loss = 0.561  adv prob = 0.250000   acc = 0.837
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 1.079  exp loss = 1.231  adjusted loss = 1.231  adv prob = 0.250000   acc = 0.722
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.200  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 0.940
Spurious Score = 1.234
Weighted Spurious Score = 1.202
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_78.csv
logged to wandb
Current lr: 0.000010


Epoch [79]:
Training:
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.015  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.004  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 531]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1495]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 422]:	loss = 0.014  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 759]:	loss = 0.004  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 500]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1519]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 408]:	loss = 0.011  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 768]:	loss = 0.007  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 541]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1483]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 699]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.007  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1581]:	loss = 0.006  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.013  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 702]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1555]:	loss = 0.006  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 433]:	loss = 0.018  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 730]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1532]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 455]:	loss = 0.009  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 729]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 457]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1559]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 368]:	loss = 0.012  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 764]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 519]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1549]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 434]:	loss = 0.023  exp loss = 0.041  adjusted loss = 0.041  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 763]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 525]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1478]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 378]:	loss = 0.014  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 749]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 510]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1563]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_79.csv
logged to wandb
Average incurred loss: 0.004  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 33]:	loss = 0.004  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 65]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 54]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 143]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_79.csv
logged to wandb
Average incurred loss: 0.338  
Average sample loss: 0.336  
Average acc: 0.891  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.033  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.484  exp loss = 0.582  adjusted loss = 0.582  adv prob = 0.250000   acc = 0.833
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 1.051  exp loss = 1.181  adjusted loss = 1.181  adv prob = 0.250000   acc = 0.722
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.188  exp loss = 0.139  adjusted loss = 0.139  adv prob = 0.250000   acc = 0.940
Spurious Score = 1.237
Weighted Spurious Score = 1.207
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_79.csv
logged to wandb
Current lr: 0.000010


Epoch [80]:
Training:
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 449]:	loss = 0.016  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 0, forest2water2 = 1  [n = 765]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 489]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1497]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 452]:	loss = 0.014  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.007  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 485]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 431]:	loss = 0.010  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 725]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1526]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 385]:	loss = 0.009  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 728]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 531]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1556]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.010  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1546]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.016  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.004  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.008  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 753]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1520]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.021  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1524]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 384]:	loss = 0.012  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 750]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 524]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1542]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.010  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 728]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 528]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_80.csv
logged to wandb
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 32]:	loss = 0.005  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 69]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 38]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 156]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_80.csv
logged to wandb
Average incurred loss: 0.350  
Average sample loss: 0.347  
Average acc: 0.887  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.042  exp loss = 0.035  adjusted loss = 0.035  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.540  exp loss = 0.639  adjusted loss = 0.639  adv prob = 0.250000   acc = 0.815
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.942  exp loss = 1.043  adjusted loss = 1.043  adv prob = 0.250000   acc = 0.744
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.171  exp loss = 0.124  adjusted loss = 0.124  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.237
Weighted Spurious Score = 1.221
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_80.csv
logged to wandb
Current lr: 0.000010


Epoch [81]:
Training:
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 393]:	loss = 0.008  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 695]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 514]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1598]:	loss = 0.006  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 397]:	loss = 0.011  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 539]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1508]:	loss = 0.004  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 415]:	loss = 0.012  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 751]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 426]:	loss = 0.018  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 802]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 468]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1504]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.009  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 528]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1523]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 424]:	loss = 0.008  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 749]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 526]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1501]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 409]:	loss = 0.014  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 0.998  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.024  exp loss = 0.038  adjusted loss = 0.038  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 722]:	loss = 0.010  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1527]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 444]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 485]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1548]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.009  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 520]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1545]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_81.csv
logged to wandb
Average incurred loss: 0.015  
Average sample loss: 0.015  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 43]:	loss = 0.073  exp loss = 0.028  adjusted loss = 0.028  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 64]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 50]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 138]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_81.csv
logged to wandb
Average incurred loss: 0.353  
Average sample loss: 0.350  
Average acc: 0.886  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.036  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.524  exp loss = 0.616  adjusted loss = 0.616  adv prob = 0.250000   acc = 0.818
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 1.041  exp loss = 1.165  adjusted loss = 1.165  adv prob = 0.250000   acc = 0.722
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.178  exp loss = 0.131  adjusted loss = 0.131  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.254
Weighted Spurious Score = 1.226
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_81.csv
logged to wandb
Current lr: 0.000010


Epoch [82]:
Training:
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 428]:	loss = 0.015  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 724]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1547]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.010  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 512]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 411]:	loss = 0.009  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 744]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1537]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 436]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 743]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 511]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1510]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 430]:	loss = 0.017  exp loss = 0.013  adjusted loss = 0.013  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 736]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 505]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 425]:	loss = 0.010  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 525]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1502]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 405]:	loss = 0.008  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1541]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 399]:	loss = 0.008  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 747]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 518]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1536]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 410]:	loss = 0.016  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 732]:	loss = 0.005  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1555]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 416]:	loss = 0.025  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 759]:	loss = 0.007  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 496]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_82.csv
logged to wandb
Average incurred loss: 0.009  
Average sample loss: 0.009  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 27]:	loss = 0.046  exp loss = 0.019  adjusted loss = 0.019  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 71]:	loss = 0.001  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 55]:	loss = 0.008  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 142]:	loss = 0.006  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_82.csv
logged to wandb
Average incurred loss: 0.343  
Average sample loss: 0.340  
Average acc: 0.888  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.035  exp loss = 0.029  adjusted loss = 0.029  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.503  exp loss = 0.593  adjusted loss = 0.593  adv prob = 0.250000   acc = 0.824
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 1.021  exp loss = 1.145  adjusted loss = 1.145  adv prob = 0.250000   acc = 0.722
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.185  exp loss = 0.136  adjusted loss = 0.136  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.249
Weighted Spurious Score = 1.219
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_82.csv
logged to wandb
Current lr: 0.000010


Epoch [83]:
Training:
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 394]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 714]:	loss = 0.003  exp loss = 0.001  adjusted loss = 0.001  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 533]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1559]:	loss = 0.005  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 433]:	loss = 0.019  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 718]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1527]:	loss = 0.004  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 429]:	loss = 0.011  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 739]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 515]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1517]:	loss = 0.005  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 390]:	loss = 0.015  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 778]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 503]:	loss = 0.003  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1529]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 442]:	loss = 0.007  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 698]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 511]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1549]:	loss = 0.005  exp loss = 0.007  adjusted loss = 0.007  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 396]:	loss = 0.016  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 783]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 508]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1513]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 452]:	loss = 0.012  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 499]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1516]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 413]:	loss = 0.018  exp loss = 0.018  adjusted loss = 0.018  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 736]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 533]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1518]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.007  
Average sample loss: 0.007  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.019  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 741]:	loss = 0.008  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 501]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1526]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 384]:	loss = 0.011  exp loss = 0.008  adjusted loss = 0.008  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 759]:	loss = 0.005  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 487]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1570]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_83.csv
logged to wandb
Average incurred loss: 0.005  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 33]:	loss = 0.004  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 85]:	loss = 0.009  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 44]:	loss = 0.002  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.002  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_83.csv
logged to wandb
Average incurred loss: 0.352  
Average sample loss: 0.350  
Average acc: 0.885  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.044  exp loss = 0.036  adjusted loss = 0.036  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.556  exp loss = 0.659  adjusted loss = 0.659  adv prob = 0.250000   acc = 0.807
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.907  exp loss = 1.013  adjusted loss = 1.013  adv prob = 0.250000   acc = 0.752
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.165  exp loss = 0.119  adjusted loss = 0.119  adv prob = 0.250000   acc = 0.955
Spurious Score = 1.242
Weighted Spurious Score = 1.229
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_83.csv
logged to wandb
Current lr: 0.000010


Epoch [84]:
Training:
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 433]:	loss = 0.012  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 776]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 476]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1515]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 417]:	loss = 0.013  exp loss = 0.015  adjusted loss = 0.015  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 756]:	loss = 0.006  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 495]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1532]:	loss = 0.005  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 388]:	loss = 0.007  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 0, forest2water2 = 1  [n = 728]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 521]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1563]:	loss = 0.004  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 403]:	loss = 0.016  exp loss = 0.010  adjusted loss = 0.010  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 796]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 517]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1484]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.006  
Average sample loss: 0.006  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 432]:	loss = 0.018  exp loss = 0.021  adjusted loss = 0.021  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 707]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 526]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1535]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 414]:	loss = 0.012  exp loss = 0.012  adjusted loss = 0.012  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 725]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 562]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1499]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 426]:	loss = 0.017  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 748]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 487]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1539]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.008  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 718]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 509]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1555]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 402]:	loss = 0.011  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 0, forest2water2 = 1  [n = 723]:	loss = 0.002  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 522]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1553]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 0.999  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 418]:	loss = 0.009  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 745]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 492]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1545]:	loss = 0.005  exp loss = 0.005  adjusted loss = 0.005  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_train_epoch_84.csv
logged to wandb
Average incurred loss: 0.002  
Average sample loss: 0.002  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 47]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 62]:	loss = 0.002  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 49]:	loss = 0.002  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 137]:	loss = 0.002  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_val_epoch_84.csv
logged to wandb
Average incurred loss: 0.352  
Average sample loss: 0.350  
Average acc: 0.891  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.039  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.543  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 0.822
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.968  exp loss = 1.097  adjusted loss = 1.097  adv prob = 0.250000   acc = 0.752
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.171  exp loss = 0.124  adjusted loss = 0.124  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.227
Weighted Spurious Score = 1.211
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_33_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_100_epochs_300_lr_1e-05_weight_decay_0.0/model_outputs/output_test_epoch_84.csv
logged to wandb
Current lr: 0.000010


Epoch [85]:
Training:
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 427]:	loss = 0.019  exp loss = 0.011  adjusted loss = 0.011  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 733]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 468]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1572]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.005  
Average sample loss: 0.005  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 389]:	loss = 0.007  exp loss = 0.006  adjusted loss = 0.006  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 765]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 551]:	loss = 0.003  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1495]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.004  
Average sample loss: 0.004  
Average acc: 1.000  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 406]:	loss = 0.012  exp loss = 0.009  adjusted loss = 0.009  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 737]:	loss = 0.003  exp loss = 0.002  adjusted loss = 0.002  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 527]:	loss = 0.004  exp loss = 0.004  adjusted loss = 0.004  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1530]:	loss = 0.004  exp loss = 0.003  adjusted loss = 0.003  adv prob = 0.250000   acc = 1.000
