wandb: Currently logged in as: gaotang (use `wandb login --relogin` to force relogin)
wandb: wandb version 0.12.21 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.10.8
wandb: Syncing run colorful-sky-65
wandb: ‚≠êÔ∏è View project at https://wandb.ai/gaotang/spurious_CUB
wandb: üöÄ View run at https://wandb.ai/gaotang/spurious_CUB/runs/37j0z3ds
wandb: Run data is saved locally in wandb/run-20220716_181208-37j0z3ds
wandb: Run `wandb off` to turn off syncing.
Dataset: CUB
Shift type: confounder
Wandb: True
Project name: spurious
Target name: waterbird_complete95
Confounder names: ['forest2water2']
Up weight: 50
Resume: False
Minority fraction: None
Imbalance ratio: None
Fraction: 1.0
Root dir: ./cub
Reweight groups: False
Augment data: False
Val fraction: 0.1
Loss type: erm
Alpha: 0.2
Generalization adjustment: 0.0
Automatic adjustment: False
Robust step size: 0.01
Joint dro alpha: 1
Use normalized loss: False
Btl: False
Hinge: False
Model: resnet50
Train from scratch: False
N epochs: 100
Batch size: 64
Lr: 1e-05
Scheduler: False
Weight decay: 1.0
Gamma: 0.1
Minimum variational weight: 0
Seed: 0
Show progress: False
Log dir: results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs
Log every: 50
Save step: 10
Save best: False
Save last: False
Use bert params: 1
Num folds per sweep: 5
Num sweeps: 4
Q: 0.7
Metadata csv name: metadata.csv
Fold: None
Metadata path: results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/metadata_aug.csv
Aug col: wrong_1_times

Reading './cub/data/waterbird_complete95_forest2water2/metadata.csv'
length of train_data:  4795
length of test_data:  5794
length of val_data:  1199
args fold:  None
len 4795 275
Up-weight factor: 50
Training Data...
    waterbird_complete95 = 0, forest2water2 = 0: n = 3848
    waterbird_complete95 = 0, forest2water2 = 1: n = 3834
    waterbird_complete95 = 1, forest2water2 = 0: n = 2606
    waterbird_complete95 = 1, forest2water2 = 1: n = 8257
Validation Data...
    waterbird_complete95 = 0, forest2water2 = 0: n = 467
    waterbird_complete95 = 0, forest2water2 = 1: n = 466
    waterbird_complete95 = 1, forest2water2 = 0: n = 133
    waterbird_complete95 = 1, forest2water2 = 1: n = 133
Test Data...
    waterbird_complete95 = 0, forest2water2 = 0: n = 2255
    waterbird_complete95 = 0, forest2water2 = 1: n = 2255
    waterbird_complete95 = 1, forest2water2 = 0: n = 642
    waterbird_complete95 = 1, forest2water2 = 1: n = 642

Epoch [0]:
Training:
/home/gaotang/jtt/venv/lib/python3.6/site-packages/torch/nn/modules/module.py:795: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Average incurred loss: 0.719  
Average sample loss: 0.719  
Average acc: 0.466  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 700]:	loss = 0.670  exp loss = 0.726  adjusted loss = 0.726  adv prob = 0.250000   acc = 0.604
  waterbird_complete95 = 0, forest2water2 = 1  [n = 690]:	loss = 0.610  exp loss = 0.672  adjusted loss = 0.672  adv prob = 0.250000   acc = 0.777
  waterbird_complete95 = 1, forest2water2 = 0  [n = 450]:	loss = 0.712  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 0.460
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1360]:	loss = 0.803  exp loss = 0.724  adjusted loss = 0.724  adv prob = 0.250000   acc = 0.239
Average incurred loss: 0.685  
Average sample loss: 0.685  
Average acc: 0.559  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 653]:	loss = 0.826  exp loss = 0.854  adjusted loss = 0.854  adv prob = 0.250000   acc = 0.193
  waterbird_complete95 = 0, forest2water2 = 1  [n = 661]:	loss = 0.756  exp loss = 0.776  adjusted loss = 0.776  adv prob = 0.250000   acc = 0.337
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.565  exp loss = 0.538  adjusted loss = 0.538  adv prob = 0.250000   acc = 0.900
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1438]:	loss = 0.625  exp loss = 0.591  adjusted loss = 0.591  adv prob = 0.250000   acc = 0.721
Average incurred loss: 0.665  
Average sample loss: 0.665  
Average acc: 0.579  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 643]:	loss = 0.892  exp loss = 0.902  adjusted loss = 0.902  adv prob = 0.250000   acc = 0.076
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.823  exp loss = 0.834  adjusted loss = 0.834  adv prob = 0.250000   acc = 0.155
  waterbird_complete95 = 1, forest2water2 = 0  [n = 450]:	loss = 0.482  exp loss = 0.467  adjusted loss = 0.467  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1447]:	loss = 0.549  exp loss = 0.537  adjusted loss = 0.537  adv prob = 0.250000   acc = 0.865
Average incurred loss: 0.662  
Average sample loss: 0.662  
Average acc: 0.585  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 676]:	loss = 0.889  exp loss = 0.880  adjusted loss = 0.880  adv prob = 0.250000   acc = 0.084
  waterbird_complete95 = 0, forest2water2 = 1  [n = 666]:	loss = 0.820  exp loss = 0.820  adjusted loss = 0.820  adv prob = 0.250000   acc = 0.174
  waterbird_complete95 = 1, forest2water2 = 0  [n = 450]:	loss = 0.475  exp loss = 0.481  adjusted loss = 0.481  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1408]:	loss = 0.539  exp loss = 0.538  adjusted loss = 0.538  adv prob = 0.250000   acc = 0.887
Average incurred loss: 0.654  
Average sample loss: 0.654  
Average acc: 0.601  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 659]:	loss = 0.893  exp loss = 0.893  adjusted loss = 0.893  adv prob = 0.250000   acc = 0.088
  waterbird_complete95 = 0, forest2water2 = 1  [n = 655]:	loss = 0.825  exp loss = 0.815  adjusted loss = 0.815  adv prob = 0.250000   acc = 0.179
  waterbird_complete95 = 1, forest2water2 = 0  [n = 454]:	loss = 0.462  exp loss = 0.460  adjusted loss = 0.460  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1432]:	loss = 0.527  exp loss = 0.525  adjusted loss = 0.525  adv prob = 0.250000   acc = 0.903
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_0.csv
logged to wandb
Average incurred loss: 0.644  
Average sample loss: 0.644  
Average acc: 0.611  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 517]:	loss = 0.900  exp loss = 0.886  adjusted loss = 0.886  adv prob = 0.250000   acc = 0.072
  waterbird_complete95 = 0, forest2water2 = 1  [n = 502]:	loss = 0.818  exp loss = 0.811  adjusted loss = 0.811  adv prob = 0.250000   acc = 0.165
  waterbird_complete95 = 1, forest2water2 = 0  [n = 354]:	loss = 0.450  exp loss = 0.443  adjusted loss = 0.443  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1172]:	loss = 0.514  exp loss = 0.500  adjusted loss = 0.500  adv prob = 0.250000   acc = 0.922

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_0.csv
logged to wandb
Average incurred loss: 0.770  
Average sample loss: 0.771  
Average acc: 0.347  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.905  exp loss = 0.902  adjusted loss = 0.902  adv prob = 0.250000   acc = 0.096
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.809  exp loss = 0.812  adjusted loss = 0.812  adv prob = 0.250000   acc = 0.245
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.447  exp loss = 0.468  adjusted loss = 0.468  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.488  exp loss = 0.483  adjusted loss = 0.483  adv prob = 0.250000   acc = 0.962
Spurious Score = 0.872
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_0.csv
logged to wandb
Current lr: 0.000010


Epoch [1]:
Training:
Average incurred loss: 0.639  
Average sample loss: 0.639  
Average acc: 0.610  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.884  exp loss = 0.869  adjusted loss = 0.869  adv prob = 0.250000   acc = 0.087
  waterbird_complete95 = 0, forest2water2 = 1  [n = 659]:	loss = 0.798  exp loss = 0.788  adjusted loss = 0.788  adv prob = 0.250000   acc = 0.232
  waterbird_complete95 = 1, forest2water2 = 0  [n = 451]:	loss = 0.449  exp loss = 0.446  adjusted loss = 0.446  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1422]:	loss = 0.511  exp loss = 0.512  adjusted loss = 0.512  adv prob = 0.250000   acc = 0.907
Average incurred loss: 0.635  
Average sample loss: 0.635  
Average acc: 0.618  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 658]:	loss = 0.879  exp loss = 0.873  adjusted loss = 0.873  adv prob = 0.250000   acc = 0.082
  waterbird_complete95 = 0, forest2water2 = 1  [n = 649]:	loss = 0.796  exp loss = 0.799  adjusted loss = 0.799  adv prob = 0.250000   acc = 0.257
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.441  exp loss = 0.428  adjusted loss = 0.428  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1427]:	loss = 0.511  exp loss = 0.513  adjusted loss = 0.513  adv prob = 0.250000   acc = 0.905
Average incurred loss: 0.628  
Average sample loss: 0.628  
Average acc: 0.625  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 656]:	loss = 0.878  exp loss = 0.882  adjusted loss = 0.882  adv prob = 0.250000   acc = 0.101
  waterbird_complete95 = 0, forest2water2 = 1  [n = 646]:	loss = 0.782  exp loss = 0.773  adjusted loss = 0.773  adv prob = 0.250000   acc = 0.283
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.432  exp loss = 0.433  adjusted loss = 0.433  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1458]:	loss = 0.507  exp loss = 0.509  adjusted loss = 0.509  adv prob = 0.250000   acc = 0.900
Average incurred loss: 0.623  
Average sample loss: 0.623  
Average acc: 0.630  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 700]:	loss = 0.863  exp loss = 0.850  adjusted loss = 0.850  adv prob = 0.250000   acc = 0.114
  waterbird_complete95 = 0, forest2water2 = 1  [n = 655]:	loss = 0.772  exp loss = 0.768  adjusted loss = 0.768  adv prob = 0.250000   acc = 0.327
  waterbird_complete95 = 1, forest2water2 = 0  [n = 472]:	loss = 0.423  exp loss = 0.417  adjusted loss = 0.417  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1373]:	loss = 0.499  exp loss = 0.500  adjusted loss = 0.500  adv prob = 0.250000   acc = 0.911
Average incurred loss: 0.619  
Average sample loss: 0.619  
Average acc: 0.647  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 652]:	loss = 0.846  exp loss = 0.858  adjusted loss = 0.858  adv prob = 0.250000   acc = 0.156
  waterbird_complete95 = 0, forest2water2 = 1  [n = 692]:	loss = 0.745  exp loss = 0.734  adjusted loss = 0.734  adv prob = 0.250000   acc = 0.393
  waterbird_complete95 = 1, forest2water2 = 0  [n = 422]:	loss = 0.429  exp loss = 0.427  adjusted loss = 0.427  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1434]:	loss = 0.510  exp loss = 0.515  adjusted loss = 0.515  adv prob = 0.250000   acc = 0.891
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_1.csv
logged to wandb
Average incurred loss: 0.612  
Average sample loss: 0.612  
Average acc: 0.663  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 514]:	loss = 0.839  exp loss = 0.848  adjusted loss = 0.848  adv prob = 0.250000   acc = 0.189
  waterbird_complete95 = 0, forest2water2 = 1  [n = 533]:	loss = 0.738  exp loss = 0.741  adjusted loss = 0.741  adv prob = 0.250000   acc = 0.403
  waterbird_complete95 = 1, forest2water2 = 0  [n = 355]:	loss = 0.431  exp loss = 0.428  adjusted loss = 0.428  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1143]:	loss = 0.507  exp loss = 0.509  adjusted loss = 0.509  adv prob = 0.250000   acc = 0.895

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_1.csv
logged to wandb
Average incurred loss: 0.724  
Average sample loss: 0.725  
Average acc: 0.439  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.855  exp loss = 0.855  adjusted loss = 0.855  adv prob = 0.250000   acc = 0.173
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.748  exp loss = 0.758  adjusted loss = 0.758  adv prob = 0.250000   acc = 0.410
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.428  exp loss = 0.451  adjusted loss = 0.451  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.479  exp loss = 0.471  adjusted loss = 0.471  adv prob = 0.250000   acc = 0.940
Spurious Score = 0.807
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_1.csv
logged to wandb
Current lr: 0.000010


Epoch [2]:
Training:
Average incurred loss: 0.606  
Average sample loss: 0.606  
Average acc: 0.664  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 643]:	loss = 0.843  exp loss = 0.838  adjusted loss = 0.838  adv prob = 0.250000   acc = 0.174
  waterbird_complete95 = 0, forest2water2 = 1  [n = 652]:	loss = 0.743  exp loss = 0.759  adjusted loss = 0.759  adv prob = 0.250000   acc = 0.400
  waterbird_complete95 = 1, forest2water2 = 0  [n = 427]:	loss = 0.415  exp loss = 0.411  adjusted loss = 0.411  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1478]:	loss = 0.497  exp loss = 0.495  adjusted loss = 0.495  adv prob = 0.250000   acc = 0.897
Average incurred loss: 0.607  
Average sample loss: 0.607  
Average acc: 0.655  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.838  exp loss = 0.824  adjusted loss = 0.824  adv prob = 0.250000   acc = 0.154
  waterbird_complete95 = 0, forest2water2 = 1  [n = 695]:	loss = 0.736  exp loss = 0.725  adjusted loss = 0.725  adv prob = 0.250000   acc = 0.426
  waterbird_complete95 = 1, forest2water2 = 0  [n = 453]:	loss = 0.418  exp loss = 0.423  adjusted loss = 0.423  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1384]:	loss = 0.492  exp loss = 0.498  adjusted loss = 0.498  adv prob = 0.250000   acc = 0.898
Average incurred loss: 0.593  
Average sample loss: 0.593  
Average acc: 0.689  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 663]:	loss = 0.811  exp loss = 0.819  adjusted loss = 0.819  adv prob = 0.250000   acc = 0.249
  waterbird_complete95 = 0, forest2water2 = 1  [n = 649]:	loss = 0.712  exp loss = 0.706  adjusted loss = 0.706  adv prob = 0.250000   acc = 0.476
  waterbird_complete95 = 1, forest2water2 = 0  [n = 444]:	loss = 0.409  exp loss = 0.400  adjusted loss = 0.400  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1444]:	loss = 0.495  exp loss = 0.486  adjusted loss = 0.486  adv prob = 0.250000   acc = 0.891
Average incurred loss: 0.591  
Average sample loss: 0.591  
Average acc: 0.682  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 679]:	loss = 0.824  exp loss = 0.805  adjusted loss = 0.805  adv prob = 0.250000   acc = 0.231
  waterbird_complete95 = 0, forest2water2 = 1  [n = 661]:	loss = 0.709  exp loss = 0.701  adjusted loss = 0.701  adv prob = 0.250000   acc = 0.499
  waterbird_complete95 = 1, forest2water2 = 0  [n = 468]:	loss = 0.403  exp loss = 0.405  adjusted loss = 0.405  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1392]:	loss = 0.485  exp loss = 0.487  adjusted loss = 0.487  adv prob = 0.250000   acc = 0.883
Average incurred loss: 0.584  
Average sample loss: 0.584  
Average acc: 0.697  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 650]:	loss = 0.802  exp loss = 0.790  adjusted loss = 0.790  adv prob = 0.250000   acc = 0.274
  waterbird_complete95 = 0, forest2water2 = 1  [n = 683]:	loss = 0.698  exp loss = 0.693  adjusted loss = 0.693  adv prob = 0.250000   acc = 0.502
  waterbird_complete95 = 1, forest2water2 = 0  [n = 470]:	loss = 0.400  exp loss = 0.385  adjusted loss = 0.385  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1397]:	loss = 0.488  exp loss = 0.487  adjusted loss = 0.487  adv prob = 0.250000   acc = 0.893
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_2.csv
logged to wandb
Average incurred loss: 0.580  
Average sample loss: 0.581  
Average acc: 0.706  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 545]:	loss = 0.812  exp loss = 0.811  adjusted loss = 0.811  adv prob = 0.250000   acc = 0.284
  waterbird_complete95 = 0, forest2water2 = 1  [n = 494]:	loss = 0.689  exp loss = 0.693  adjusted loss = 0.693  adv prob = 0.250000   acc = 0.534
  waterbird_complete95 = 1, forest2water2 = 0  [n = 344]:	loss = 0.398  exp loss = 0.411  adjusted loss = 0.411  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1162]:	loss = 0.480  exp loss = 0.473  adjusted loss = 0.473  adv prob = 0.250000   acc = 0.892

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_2.csv
logged to wandb
Average incurred loss: 0.698  
Average sample loss: 0.698  
Average acc: 0.497  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.829  exp loss = 0.832  adjusted loss = 0.832  adv prob = 0.250000   acc = 0.242
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.719  exp loss = 0.734  adjusted loss = 0.734  adv prob = 0.250000   acc = 0.491
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.404  exp loss = 0.426  adjusted loss = 0.426  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.456  exp loss = 0.448  adjusted loss = 0.448  adv prob = 0.250000   acc = 0.940
Spurious Score = 0.809
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_2.csv
logged to wandb
Current lr: 0.000010


Epoch [3]:
Training:
Average incurred loss: 0.577  
Average sample loss: 0.577  
Average acc: 0.713  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 689]:	loss = 0.801  exp loss = 0.789  adjusted loss = 0.789  adv prob = 0.250000   acc = 0.305
  waterbird_complete95 = 0, forest2water2 = 1  [n = 654]:	loss = 0.694  exp loss = 0.688  adjusted loss = 0.688  adv prob = 0.250000   acc = 0.531
  waterbird_complete95 = 1, forest2water2 = 0  [n = 446]:	loss = 0.394  exp loss = 0.402  adjusted loss = 0.402  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1411]:	loss = 0.472  exp loss = 0.467  adjusted loss = 0.467  adv prob = 0.250000   acc = 0.906
Average incurred loss: 0.574  
Average sample loss: 0.574  
Average acc: 0.714  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 635]:	loss = 0.784  exp loss = 0.786  adjusted loss = 0.786  adv prob = 0.250000   acc = 0.332
  waterbird_complete95 = 0, forest2water2 = 1  [n = 686]:	loss = 0.686  exp loss = 0.668  adjusted loss = 0.668  adv prob = 0.250000   acc = 0.557
  waterbird_complete95 = 1, forest2water2 = 0  [n = 463]:	loss = 0.398  exp loss = 0.393  adjusted loss = 0.393  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1416]:	loss = 0.484  exp loss = 0.484  adjusted loss = 0.484  adv prob = 0.250000   acc = 0.872
Average incurred loss: 0.567  
Average sample loss: 0.567  
Average acc: 0.724  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 678]:	loss = 0.784  exp loss = 0.770  adjusted loss = 0.770  adv prob = 0.250000   acc = 0.333
  waterbird_complete95 = 0, forest2water2 = 1  [n = 667]:	loss = 0.673  exp loss = 0.666  adjusted loss = 0.666  adv prob = 0.250000   acc = 0.592
  waterbird_complete95 = 1, forest2water2 = 0  [n = 451]:	loss = 0.378  exp loss = 0.379  adjusted loss = 0.379  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1404]:	loss = 0.473  exp loss = 0.477  adjusted loss = 0.477  adv prob = 0.250000   acc = 0.890
Average incurred loss: 0.560  
Average sample loss: 0.560  
Average acc: 0.734  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 632]:	loss = 0.801  exp loss = 0.789  adjusted loss = 0.789  adv prob = 0.250000   acc = 0.297
  waterbird_complete95 = 0, forest2water2 = 1  [n = 634]:	loss = 0.667  exp loss = 0.666  adjusted loss = 0.666  adv prob = 0.250000   acc = 0.606
  waterbird_complete95 = 1, forest2water2 = 0  [n = 445]:	loss = 0.378  exp loss = 0.371  adjusted loss = 0.371  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1489]:	loss = 0.467  exp loss = 0.454  adjusted loss = 0.454  adv prob = 0.250000   acc = 0.899
Average incurred loss: 0.559  
Average sample loss: 0.559  
Average acc: 0.718  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 672]:	loss = 0.794  exp loss = 0.775  adjusted loss = 0.775  adv prob = 0.250000   acc = 0.318
  waterbird_complete95 = 0, forest2water2 = 1  [n = 650]:	loss = 0.678  exp loss = 0.673  adjusted loss = 0.673  adv prob = 0.250000   acc = 0.566
  waterbird_complete95 = 1, forest2water2 = 0  [n = 444]:	loss = 0.362  exp loss = 0.356  adjusted loss = 0.356  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1434]:	loss = 0.455  exp loss = 0.456  adjusted loss = 0.456  adv prob = 0.250000   acc = 0.888
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_3.csv
logged to wandb
Average incurred loss: 0.557  
Average sample loss: 0.557  
Average acc: 0.737  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 542]:	loss = 0.782  exp loss = 0.796  adjusted loss = 0.796  adv prob = 0.250000   acc = 0.354
  waterbird_complete95 = 0, forest2water2 = 1  [n = 543]:	loss = 0.663  exp loss = 0.656  adjusted loss = 0.656  adv prob = 0.250000   acc = 0.606
  waterbird_complete95 = 1, forest2water2 = 0  [n = 357]:	loss = 0.366  exp loss = 0.364  adjusted loss = 0.364  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1103]:	loss = 0.455  exp loss = 0.453  adjusted loss = 0.453  adv prob = 0.250000   acc = 0.908

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_3.csv
logged to wandb
Average incurred loss: 0.669  
Average sample loss: 0.669  
Average acc: 0.552  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.791  exp loss = 0.797  adjusted loss = 0.797  adv prob = 0.250000   acc = 0.308
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.690  exp loss = 0.707  adjusted loss = 0.707  adv prob = 0.250000   acc = 0.567
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.394  exp loss = 0.417  adjusted loss = 0.417  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.441  exp loss = 0.433  adjusted loss = 0.433  adv prob = 0.250000   acc = 0.940
Spurious Score = 0.812
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_3.csv
logged to wandb
Current lr: 0.000010


Epoch [4]:
Training:
Average incurred loss: 0.552  
Average sample loss: 0.552  
Average acc: 0.757  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 651]:	loss = 0.760  exp loss = 0.762  adjusted loss = 0.762  adv prob = 0.250000   acc = 0.416
  waterbird_complete95 = 0, forest2water2 = 1  [n = 670]:	loss = 0.653  exp loss = 0.630  adjusted loss = 0.630  adv prob = 0.250000   acc = 0.648
  waterbird_complete95 = 1, forest2water2 = 0  [n = 437]:	loss = 0.379  exp loss = 0.369  adjusted loss = 0.369  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1442]:	loss = 0.463  exp loss = 0.462  adjusted loss = 0.462  adv prob = 0.250000   acc = 0.895
Average incurred loss: 0.551  
Average sample loss: 0.551  
Average acc: 0.759  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 665]:	loss = 0.758  exp loss = 0.746  adjusted loss = 0.746  adv prob = 0.250000   acc = 0.424
  waterbird_complete95 = 0, forest2water2 = 1  [n = 684]:	loss = 0.652  exp loss = 0.631  adjusted loss = 0.631  adv prob = 0.250000   acc = 0.642
  waterbird_complete95 = 1, forest2water2 = 0  [n = 437]:	loss = 0.367  exp loss = 0.371  adjusted loss = 0.371  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1414]:	loss = 0.463  exp loss = 0.460  adjusted loss = 0.460  adv prob = 0.250000   acc = 0.902
Average incurred loss: 0.544  
Average sample loss: 0.544  
Average acc: 0.761  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 696]:	loss = 0.748  exp loss = 0.734  adjusted loss = 0.734  adv prob = 0.250000   acc = 0.435
  waterbird_complete95 = 0, forest2water2 = 1  [n = 655]:	loss = 0.624  exp loss = 0.606  adjusted loss = 0.606  adv prob = 0.250000   acc = 0.692
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.370  exp loss = 0.357  adjusted loss = 0.357  adv prob = 0.250000   acc = 0.973
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1408]:	loss = 0.459  exp loss = 0.461  adjusted loss = 0.461  adv prob = 0.250000   acc = 0.887
Average incurred loss: 0.538  
Average sample loss: 0.538  
Average acc: 0.776  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 641]:	loss = 0.750  exp loss = 0.736  adjusted loss = 0.736  adv prob = 0.250000   acc = 0.448
  waterbird_complete95 = 0, forest2water2 = 1  [n = 642]:	loss = 0.623  exp loss = 0.614  adjusted loss = 0.614  adv prob = 0.250000   acc = 0.704
  waterbird_complete95 = 1, forest2water2 = 0  [n = 485]:	loss = 0.366  exp loss = 0.360  adjusted loss = 0.360  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1432]:	loss = 0.462  exp loss = 0.461  adjusted loss = 0.461  adv prob = 0.250000   acc = 0.885
Average incurred loss: 0.529  
Average sample loss: 0.529  
Average acc: 0.766  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.747  exp loss = 0.735  adjusted loss = 0.735  adv prob = 0.250000   acc = 0.430
  waterbird_complete95 = 0, forest2water2 = 1  [n = 650]:	loss = 0.626  exp loss = 0.614  adjusted loss = 0.614  adv prob = 0.250000   acc = 0.692
  waterbird_complete95 = 1, forest2water2 = 0  [n = 442]:	loss = 0.351  exp loss = 0.335  adjusted loss = 0.335  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1438]:	loss = 0.438  exp loss = 0.438  adjusted loss = 0.438  adv prob = 0.250000   acc = 0.891
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_4.csv
logged to wandb
Average incurred loss: 0.531  
Average sample loss: 0.531  
Average acc: 0.772  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 525]:	loss = 0.757  exp loss = 0.755  adjusted loss = 0.755  adv prob = 0.250000   acc = 0.446
  waterbird_complete95 = 0, forest2water2 = 1  [n = 533]:	loss = 0.621  exp loss = 0.607  adjusted loss = 0.607  adv prob = 0.250000   acc = 0.689
  waterbird_complete95 = 1, forest2water2 = 0  [n = 364]:	loss = 0.337  exp loss = 0.346  adjusted loss = 0.346  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1123]:	loss = 0.446  exp loss = 0.441  adjusted loss = 0.441  adv prob = 0.250000   acc = 0.893

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_4.csv
logged to wandb
Average incurred loss: 0.653  
Average sample loss: 0.653  
Average acc: 0.590  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.777  exp loss = 0.785  adjusted loss = 0.785  adv prob = 0.250000   acc = 0.377
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.674  exp loss = 0.694  adjusted loss = 0.694  adv prob = 0.250000   acc = 0.599
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.373  exp loss = 0.396  adjusted loss = 0.396  adv prob = 0.250000   acc = 0.962
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.422  exp loss = 0.414  adjusted loss = 0.414  adv prob = 0.250000   acc = 0.940
Spurious Score = 0.843
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_4.csv
logged to wandb
Current lr: 0.000010


Epoch [5]:
Training:
Average incurred loss: 0.526  
Average sample loss: 0.526  
Average acc: 0.781  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 667]:	loss = 0.740  exp loss = 0.740  adjusted loss = 0.740  adv prob = 0.250000   acc = 0.478
  waterbird_complete95 = 0, forest2water2 = 1  [n = 696]:	loss = 0.628  exp loss = 0.613  adjusted loss = 0.613  adv prob = 0.250000   acc = 0.682
  waterbird_complete95 = 1, forest2water2 = 0  [n = 424]:	loss = 0.335  exp loss = 0.327  adjusted loss = 0.327  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1413]:	loss = 0.432  exp loss = 0.425  adjusted loss = 0.425  adv prob = 0.250000   acc = 0.912
Average incurred loss: 0.525  
Average sample loss: 0.525  
Average acc: 0.788  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.730  exp loss = 0.713  adjusted loss = 0.713  adv prob = 0.250000   acc = 0.490
  waterbird_complete95 = 0, forest2water2 = 1  [n = 646]:	loss = 0.602  exp loss = 0.587  adjusted loss = 0.587  adv prob = 0.250000   acc = 0.745
  waterbird_complete95 = 1, forest2water2 = 0  [n = 452]:	loss = 0.353  exp loss = 0.355  adjusted loss = 0.355  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1434]:	loss = 0.450  exp loss = 0.442  adjusted loss = 0.442  adv prob = 0.250000   acc = 0.885
Average incurred loss: 0.526  
Average sample loss: 0.526  
Average acc: 0.782  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 699]:	loss = 0.735  exp loss = 0.722  adjusted loss = 0.722  adv prob = 0.250000   acc = 0.469
  waterbird_complete95 = 0, forest2water2 = 1  [n = 661]:	loss = 0.604  exp loss = 0.590  adjusted loss = 0.590  adv prob = 0.250000   acc = 0.735
  waterbird_complete95 = 1, forest2water2 = 0  [n = 456]:	loss = 0.342  exp loss = 0.328  adjusted loss = 0.328  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1384]:	loss = 0.444  exp loss = 0.439  adjusted loss = 0.439  adv prob = 0.250000   acc = 0.896
Average incurred loss: 0.512  
Average sample loss: 0.512  
Average acc: 0.801  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 644]:	loss = 0.708  exp loss = 0.702  adjusted loss = 0.702  adv prob = 0.250000   acc = 0.522
  waterbird_complete95 = 0, forest2water2 = 1  [n = 627]:	loss = 0.581  exp loss = 0.584  adjusted loss = 0.584  adv prob = 0.250000   acc = 0.770
  waterbird_complete95 = 1, forest2water2 = 0  [n = 462]:	loss = 0.352  exp loss = 0.348  adjusted loss = 0.348  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1467]:	loss = 0.447  exp loss = 0.433  adjusted loss = 0.433  adv prob = 0.250000   acc = 0.883
Average incurred loss: 0.516  
Average sample loss: 0.516  
Average acc: 0.785  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 684]:	loss = 0.739  exp loss = 0.718  adjusted loss = 0.718  adv prob = 0.250000   acc = 0.472
  waterbird_complete95 = 0, forest2water2 = 1  [n = 670]:	loss = 0.597  exp loss = 0.588  adjusted loss = 0.588  adv prob = 0.250000   acc = 0.733
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.338  exp loss = 0.350  adjusted loss = 0.350  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1405]:	loss = 0.425  exp loss = 0.415  adjusted loss = 0.415  adv prob = 0.250000   acc = 0.902
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_5.csv
logged to wandb
Average incurred loss: 0.503  
Average sample loss: 0.503  
Average acc: 0.817  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 486]:	loss = 0.700  exp loss = 0.693  adjusted loss = 0.693  adv prob = 0.250000   acc = 0.601
  waterbird_complete95 = 0, forest2water2 = 1  [n = 534]:	loss = 0.592  exp loss = 0.581  adjusted loss = 0.581  adv prob = 0.250000   acc = 0.742
  waterbird_complete95 = 1, forest2water2 = 0  [n = 371]:	loss = 0.330  exp loss = 0.322  adjusted loss = 0.322  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1154]:	loss = 0.435  exp loss = 0.443  adjusted loss = 0.443  adv prob = 0.250000   acc = 0.891

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_5.csv
logged to wandb
Average incurred loss: 0.622  
Average sample loss: 0.622  
Average acc: 0.660  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.734  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.482
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.639  exp loss = 0.662  adjusted loss = 0.662  adv prob = 0.250000   acc = 0.678
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.369  exp loss = 0.394  adjusted loss = 0.394  adv prob = 0.250000   acc = 0.947
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.416  exp loss = 0.407  adjusted loss = 0.407  adv prob = 0.250000   acc = 0.932
Spurious Score = 0.870
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_5.csv
logged to wandb
Current lr: 0.000010


Epoch [6]:
Training:
Average incurred loss: 0.501  
Average sample loss: 0.501  
Average acc: 0.813  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 664]:	loss = 0.717  exp loss = 0.684  adjusted loss = 0.684  adv prob = 0.250000   acc = 0.536
  waterbird_complete95 = 0, forest2water2 = 1  [n = 675]:	loss = 0.573  exp loss = 0.570  adjusted loss = 0.570  adv prob = 0.250000   acc = 0.784
  waterbird_complete95 = 1, forest2water2 = 0  [n = 457]:	loss = 0.320  exp loss = 0.318  adjusted loss = 0.318  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1404]:	loss = 0.423  exp loss = 0.422  adjusted loss = 0.422  adv prob = 0.250000   acc = 0.904
Average incurred loss: 0.501  
Average sample loss: 0.501  
Average acc: 0.810  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 631]:	loss = 0.699  exp loss = 0.674  adjusted loss = 0.674  adv prob = 0.250000   acc = 0.547
  waterbird_complete95 = 0, forest2water2 = 1  [n = 666]:	loss = 0.588  exp loss = 0.590  adjusted loss = 0.590  adv prob = 0.250000   acc = 0.772
  waterbird_complete95 = 1, forest2water2 = 0  [n = 484]:	loss = 0.326  exp loss = 0.314  adjusted loss = 0.314  adv prob = 0.250000   acc = 0.973
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1419]:	loss = 0.431  exp loss = 0.433  adjusted loss = 0.433  adv prob = 0.250000   acc = 0.889
Average incurred loss: 0.496  
Average sample loss: 0.496  
Average acc: 0.814  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 664]:	loss = 0.708  exp loss = 0.701  adjusted loss = 0.701  adv prob = 0.250000   acc = 0.544
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.584  exp loss = 0.570  adjusted loss = 0.570  adv prob = 0.250000   acc = 0.762
  waterbird_complete95 = 1, forest2water2 = 0  [n = 453]:	loss = 0.319  exp loss = 0.318  adjusted loss = 0.318  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1423]:	loss = 0.414  exp loss = 0.414  adjusted loss = 0.414  adv prob = 0.250000   acc = 0.910
Average incurred loss: 0.495  
Average sample loss: 0.495  
Average acc: 0.813  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 644]:	loss = 0.716  exp loss = 0.703  adjusted loss = 0.703  adv prob = 0.250000   acc = 0.534
  waterbird_complete95 = 0, forest2water2 = 1  [n = 672]:	loss = 0.573  exp loss = 0.575  adjusted loss = 0.575  adv prob = 0.250000   acc = 0.802
  waterbird_complete95 = 1, forest2water2 = 0  [n = 457]:	loss = 0.317  exp loss = 0.320  adjusted loss = 0.320  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1427]:	loss = 0.415  exp loss = 0.410  adjusted loss = 0.410  adv prob = 0.250000   acc = 0.891
Average incurred loss: 0.492  
Average sample loss: 0.492  
Average acc: 0.815  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 687]:	loss = 0.687  exp loss = 0.665  adjusted loss = 0.665  adv prob = 0.250000   acc = 0.581
  waterbird_complete95 = 0, forest2water2 = 1  [n = 643]:	loss = 0.574  exp loss = 0.571  adjusted loss = 0.571  adv prob = 0.250000   acc = 0.768
  waterbird_complete95 = 1, forest2water2 = 0  [n = 405]:	loss = 0.319  exp loss = 0.325  adjusted loss = 0.325  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1465]:	loss = 0.413  exp loss = 0.408  adjusted loss = 0.408  adv prob = 0.250000   acc = 0.902
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_6.csv
logged to wandb
Average incurred loss: 0.493  
Average sample loss: 0.493  
Average acc: 0.814  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 558]:	loss = 0.697  exp loss = 0.702  adjusted loss = 0.702  adv prob = 0.250000   acc = 0.554
  waterbird_complete95 = 0, forest2water2 = 1  [n = 518]:	loss = 0.563  exp loss = 0.533  adjusted loss = 0.533  adv prob = 0.250000   acc = 0.774
  waterbird_complete95 = 1, forest2water2 = 0  [n = 350]:	loss = 0.319  exp loss = 0.314  adjusted loss = 0.314  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1119]:	loss = 0.414  exp loss = 0.415  adjusted loss = 0.415  adv prob = 0.250000   acc = 0.911

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_6.csv
logged to wandb
Average incurred loss: 0.592  
Average sample loss: 0.592  
Average acc: 0.711  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.694  exp loss = 0.704  adjusted loss = 0.704  adv prob = 0.250000   acc = 0.576
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.606  exp loss = 0.631  adjusted loss = 0.631  adv prob = 0.250000   acc = 0.715
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.367  exp loss = 0.392  adjusted loss = 0.392  adv prob = 0.250000   acc = 0.947
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.412  exp loss = 0.403  adjusted loss = 0.403  adv prob = 0.250000   acc = 0.932
Spurious Score = 0.908
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_6.csv
logged to wandb
Current lr: 0.000010


Epoch [7]:
Training:
Average incurred loss: 0.488  
Average sample loss: 0.488  
Average acc: 0.814  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.688  exp loss = 0.667  adjusted loss = 0.667  adv prob = 0.250000   acc = 0.573
  waterbird_complete95 = 0, forest2water2 = 1  [n = 652]:	loss = 0.543  exp loss = 0.526  adjusted loss = 0.526  adv prob = 0.250000   acc = 0.799
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.323  exp loss = 0.318  adjusted loss = 0.318  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1437]:	loss = 0.421  exp loss = 0.419  adjusted loss = 0.419  adv prob = 0.250000   acc = 0.884
Average incurred loss: 0.479  
Average sample loss: 0.479  
Average acc: 0.827  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 698]:	loss = 0.666  exp loss = 0.652  adjusted loss = 0.652  adv prob = 0.250000   acc = 0.586
  waterbird_complete95 = 0, forest2water2 = 1  [n = 651]:	loss = 0.545  exp loss = 0.533  adjusted loss = 0.533  adv prob = 0.250000   acc = 0.820
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.298  exp loss = 0.297  adjusted loss = 0.297  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1403]:	loss = 0.413  exp loss = 0.418  adjusted loss = 0.418  adv prob = 0.250000   acc = 0.897
Average incurred loss: 0.477  
Average sample loss: 0.477  
Average acc: 0.840  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 678]:	loss = 0.672  exp loss = 0.652  adjusted loss = 0.652  adv prob = 0.250000   acc = 0.618
  waterbird_complete95 = 0, forest2water2 = 1  [n = 653]:	loss = 0.539  exp loss = 0.527  adjusted loss = 0.527  adv prob = 0.250000   acc = 0.827
  waterbird_complete95 = 1, forest2water2 = 0  [n = 453]:	loss = 0.307  exp loss = 0.312  adjusted loss = 0.312  adv prob = 0.250000   acc = 0.967
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1416]:	loss = 0.410  exp loss = 0.404  adjusted loss = 0.404  adv prob = 0.250000   acc = 0.911
Average incurred loss: 0.465  
Average sample loss: 0.465  
Average acc: 0.854  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 641]:	loss = 0.646  exp loss = 0.648  adjusted loss = 0.648  adv prob = 0.250000   acc = 0.658
  waterbird_complete95 = 0, forest2water2 = 1  [n = 650]:	loss = 0.526  exp loss = 0.528  adjusted loss = 0.528  adv prob = 0.250000   acc = 0.848
  waterbird_complete95 = 1, forest2water2 = 0  [n = 444]:	loss = 0.308  exp loss = 0.293  adjusted loss = 0.293  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1465]:	loss = 0.405  exp loss = 0.408  adjusted loss = 0.408  adv prob = 0.250000   acc = 0.904
Average incurred loss: 0.474  
Average sample loss: 0.474  
Average acc: 0.822  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 651]:	loss = 0.677  exp loss = 0.680  adjusted loss = 0.680  adv prob = 0.250000   acc = 0.588
  waterbird_complete95 = 0, forest2water2 = 1  [n = 688]:	loss = 0.550  exp loss = 0.554  adjusted loss = 0.554  adv prob = 0.250000   acc = 0.795
  waterbird_complete95 = 1, forest2water2 = 0  [n = 446]:	loss = 0.306  exp loss = 0.292  adjusted loss = 0.292  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1415]:	loss = 0.396  exp loss = 0.390  adjusted loss = 0.390  adv prob = 0.250000   acc = 0.893
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_7.csv
logged to wandb
Average incurred loss: 0.467  
Average sample loss: 0.466  
Average acc: 0.846  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 510]:	loss = 0.651  exp loss = 0.628  adjusted loss = 0.628  adv prob = 0.250000   acc = 0.647
  waterbird_complete95 = 0, forest2water2 = 1  [n = 540]:	loss = 0.539  exp loss = 0.550  adjusted loss = 0.550  adv prob = 0.250000   acc = 0.831
  waterbird_complete95 = 1, forest2water2 = 0  [n = 374]:	loss = 0.305  exp loss = 0.317  adjusted loss = 0.317  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1121]:	loss = 0.402  exp loss = 0.395  adjusted loss = 0.395  adv prob = 0.250000   acc = 0.899

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_7.csv
logged to wandb
Average incurred loss: 0.575  
Average sample loss: 0.575  
Average acc: 0.725  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.670  exp loss = 0.682  adjusted loss = 0.682  adv prob = 0.250000   acc = 0.608
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.591  exp loss = 0.617  adjusted loss = 0.617  adv prob = 0.250000   acc = 0.723
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.358  exp loss = 0.383  adjusted loss = 0.383  adv prob = 0.250000   acc = 0.940
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.400  exp loss = 0.390  adjusted loss = 0.390  adv prob = 0.250000   acc = 0.925
Spurious Score = 0.922
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_7.csv
logged to wandb
Current lr: 0.000010


Epoch [8]:
Training:
Average incurred loss: 0.463  
Average sample loss: 0.463  
Average acc: 0.847  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 642]:	loss = 0.666  exp loss = 0.671  adjusted loss = 0.671  adv prob = 0.250000   acc = 0.609
  waterbird_complete95 = 0, forest2water2 = 1  [n = 681]:	loss = 0.519  exp loss = 0.518  adjusted loss = 0.518  adv prob = 0.250000   acc = 0.860
  waterbird_complete95 = 1, forest2water2 = 0  [n = 445]:	loss = 0.290  exp loss = 0.279  adjusted loss = 0.279  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1432]:	loss = 0.398  exp loss = 0.391  adjusted loss = 0.391  adv prob = 0.250000   acc = 0.905
Average incurred loss: 0.455  
Average sample loss: 0.455  
Average acc: 0.849  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 671]:	loss = 0.637  exp loss = 0.619  adjusted loss = 0.619  adv prob = 0.250000   acc = 0.653
  waterbird_complete95 = 0, forest2water2 = 1  [n = 616]:	loss = 0.516  exp loss = 0.519  adjusted loss = 0.519  adv prob = 0.250000   acc = 0.851
  waterbird_complete95 = 1, forest2water2 = 0  [n = 462]:	loss = 0.290  exp loss = 0.282  adjusted loss = 0.282  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1451]:	loss = 0.398  exp loss = 0.393  adjusted loss = 0.393  adv prob = 0.250000   acc = 0.901
Average incurred loss: 0.461  
Average sample loss: 0.461  
Average acc: 0.838  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 669]:	loss = 0.662  exp loss = 0.654  adjusted loss = 0.654  adv prob = 0.250000   acc = 0.610
  waterbird_complete95 = 0, forest2water2 = 1  [n = 719]:	loss = 0.529  exp loss = 0.524  adjusted loss = 0.524  adv prob = 0.250000   acc = 0.828
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.283  exp loss = 0.288  adjusted loss = 0.288  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1372]:	loss = 0.384  exp loss = 0.383  adjusted loss = 0.383  adv prob = 0.250000   acc = 0.907
Average incurred loss: 0.451  
Average sample loss: 0.451  
Average acc: 0.853  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 656]:	loss = 0.623  exp loss = 0.624  adjusted loss = 0.624  adv prob = 0.250000   acc = 0.681
  waterbird_complete95 = 0, forest2water2 = 1  [n = 658]:	loss = 0.500  exp loss = 0.486  adjusted loss = 0.486  adv prob = 0.250000   acc = 0.857
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.299  exp loss = 0.295  adjusted loss = 0.295  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1428]:	loss = 0.398  exp loss = 0.397  adjusted loss = 0.397  adv prob = 0.250000   acc = 0.891
Average incurred loss: 0.446  
Average sample loss: 0.446  
Average acc: 0.863  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 663]:	loss = 0.626  exp loss = 0.626  adjusted loss = 0.626  adv prob = 0.250000   acc = 0.677
  waterbird_complete95 = 0, forest2water2 = 1  [n = 659]:	loss = 0.503  exp loss = 0.495  adjusted loss = 0.495  adv prob = 0.250000   acc = 0.853
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.298  exp loss = 0.302  adjusted loss = 0.302  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1420]:	loss = 0.384  exp loss = 0.386  adjusted loss = 0.386  adv prob = 0.250000   acc = 0.915
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_8.csv
logged to wandb
Average incurred loss: 0.445  
Average sample loss: 0.445  
Average acc: 0.861  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 547]:	loss = 0.634  exp loss = 0.625  adjusted loss = 0.625  adv prob = 0.250000   acc = 0.671
  waterbird_complete95 = 0, forest2water2 = 1  [n = 501]:	loss = 0.491  exp loss = 0.501  adjusted loss = 0.501  adv prob = 0.250000   acc = 0.882
  waterbird_complete95 = 1, forest2water2 = 0  [n = 343]:	loss = 0.285  exp loss = 0.293  adjusted loss = 0.293  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1154]:	loss = 0.383  exp loss = 0.385  adjusted loss = 0.385  adv prob = 0.250000   acc = 0.906

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_8.csv
logged to wandb
Average incurred loss: 0.557  
Average sample loss: 0.557  
Average acc: 0.746  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.642  exp loss = 0.655  adjusted loss = 0.655  adv prob = 0.250000   acc = 0.651
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.577  exp loss = 0.605  adjusted loss = 0.605  adv prob = 0.250000   acc = 0.734
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.355  exp loss = 0.382  adjusted loss = 0.382  adv prob = 0.250000   acc = 0.940
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.388  exp loss = 0.379  adjusted loss = 0.379  adv prob = 0.250000   acc = 0.932
Spurious Score = 0.946
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_8.csv
logged to wandb
Current lr: 0.000010


Epoch [9]:
Training:
Average incurred loss: 0.436  
Average sample loss: 0.436  
Average acc: 0.864  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 637]:	loss = 0.619  exp loss = 0.610  adjusted loss = 0.610  adv prob = 0.250000   acc = 0.686
  waterbird_complete95 = 0, forest2water2 = 1  [n = 658]:	loss = 0.494  exp loss = 0.486  adjusted loss = 0.486  adv prob = 0.250000   acc = 0.854
  waterbird_complete95 = 1, forest2water2 = 0  [n = 482]:	loss = 0.274  exp loss = 0.262  adjusted loss = 0.262  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1423]:	loss = 0.382  exp loss = 0.383  adjusted loss = 0.383  adv prob = 0.250000   acc = 0.909
Average incurred loss: 0.440  
Average sample loss: 0.440  
Average acc: 0.866  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 673]:	loss = 0.640  exp loss = 0.619  adjusted loss = 0.619  adv prob = 0.250000   acc = 0.658
  waterbird_complete95 = 0, forest2water2 = 1  [n = 699]:	loss = 0.491  exp loss = 0.469  adjusted loss = 0.469  adv prob = 0.250000   acc = 0.884
  waterbird_complete95 = 1, forest2water2 = 0  [n = 406]:	loss = 0.276  exp loss = 0.268  adjusted loss = 0.268  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1422]:	loss = 0.367  exp loss = 0.362  adjusted loss = 0.362  adv prob = 0.250000   acc = 0.921
Average incurred loss: 0.436  
Average sample loss: 0.436  
Average acc: 0.856  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 663]:	loss = 0.617  exp loss = 0.607  adjusted loss = 0.607  adv prob = 0.250000   acc = 0.673
  waterbird_complete95 = 0, forest2water2 = 1  [n = 666]:	loss = 0.478  exp loss = 0.488  adjusted loss = 0.488  adv prob = 0.250000   acc = 0.871
  waterbird_complete95 = 1, forest2water2 = 0  [n = 454]:	loss = 0.276  exp loss = 0.268  adjusted loss = 0.268  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1417]:	loss = 0.383  exp loss = 0.385  adjusted loss = 0.385  adv prob = 0.250000   acc = 0.898
Average incurred loss: 0.431  
Average sample loss: 0.431  
Average acc: 0.861  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 654]:	loss = 0.606  exp loss = 0.598  adjusted loss = 0.598  adv prob = 0.250000   acc = 0.687
  waterbird_complete95 = 0, forest2water2 = 1  [n = 647]:	loss = 0.482  exp loss = 0.500  adjusted loss = 0.500  adv prob = 0.250000   acc = 0.864
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.272  exp loss = 0.254  adjusted loss = 0.254  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1441]:	loss = 0.380  exp loss = 0.379  adjusted loss = 0.379  adv prob = 0.250000   acc = 0.901
Average incurred loss: 0.430  
Average sample loss: 0.430  
Average acc: 0.868  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 687]:	loss = 0.607  exp loss = 0.610  adjusted loss = 0.610  adv prob = 0.250000   acc = 0.689
  waterbird_complete95 = 0, forest2water2 = 1  [n = 611]:	loss = 0.478  exp loss = 0.458  adjusted loss = 0.458  adv prob = 0.250000   acc = 0.890
  waterbird_complete95 = 1, forest2water2 = 0  [n = 468]:	loss = 0.275  exp loss = 0.273  adjusted loss = 0.273  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1434]:	loss = 0.376  exp loss = 0.367  adjusted loss = 0.367  adv prob = 0.250000   acc = 0.907
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_9.csv
logged to wandb
Average incurred loss: 0.424  
Average sample loss: 0.424  
Average acc: 0.875  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 534]:	loss = 0.601  exp loss = 0.601  adjusted loss = 0.601  adv prob = 0.250000   acc = 0.706
  waterbird_complete95 = 0, forest2water2 = 1  [n = 553]:	loss = 0.481  exp loss = 0.475  adjusted loss = 0.475  adv prob = 0.250000   acc = 0.892
  waterbird_complete95 = 1, forest2water2 = 0  [n = 338]:	loss = 0.266  exp loss = 0.262  adjusted loss = 0.262  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1120]:	loss = 0.359  exp loss = 0.366  adjusted loss = 0.366  adv prob = 0.250000   acc = 0.917

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_9.csv
logged to wandb
Average incurred loss: 0.548  
Average sample loss: 0.548  
Average acc: 0.750  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.631  exp loss = 0.645  adjusted loss = 0.645  adv prob = 0.250000   acc = 0.664
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.578  exp loss = 0.609  adjusted loss = 0.609  adv prob = 0.250000   acc = 0.725
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.338  exp loss = 0.364  adjusted loss = 0.364  adv prob = 0.250000   acc = 0.947
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.364  exp loss = 0.355  adjusted loss = 0.355  adv prob = 0.250000   acc = 0.940
Spurious Score = 0.959
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_9.csv
logged to wandb
Current lr: 0.000010


Epoch [10]:
Training:
Average incurred loss: 0.426  
Average sample loss: 0.426  
Average acc: 0.864  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 665]:	loss = 0.599  exp loss = 0.574  adjusted loss = 0.574  adv prob = 0.250000   acc = 0.698
  waterbird_complete95 = 0, forest2water2 = 1  [n = 654]:	loss = 0.475  exp loss = 0.475  adjusted loss = 0.475  adv prob = 0.250000   acc = 0.869
  waterbird_complete95 = 1, forest2water2 = 0  [n = 437]:	loss = 0.268  exp loss = 0.253  adjusted loss = 0.253  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1444]:	loss = 0.372  exp loss = 0.352  adjusted loss = 0.352  adv prob = 0.250000   acc = 0.904
Average incurred loss: 0.413  
Average sample loss: 0.413  
Average acc: 0.876  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 627]:	loss = 0.595  exp loss = 0.586  adjusted loss = 0.586  adv prob = 0.250000   acc = 0.691
  waterbird_complete95 = 0, forest2water2 = 1  [n = 678]:	loss = 0.455  exp loss = 0.453  adjusted loss = 0.453  adv prob = 0.250000   acc = 0.894
  waterbird_complete95 = 1, forest2water2 = 0  [n = 442]:	loss = 0.260  exp loss = 0.233  adjusted loss = 0.233  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1453]:	loss = 0.362  exp loss = 0.352  adjusted loss = 0.352  adv prob = 0.250000   acc = 0.914
Average incurred loss: 0.411  
Average sample loss: 0.411  
Average acc: 0.881  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 637]:	loss = 0.598  exp loss = 0.592  adjusted loss = 0.592  adv prob = 0.250000   acc = 0.684
  waterbird_complete95 = 0, forest2water2 = 1  [n = 655]:	loss = 0.448  exp loss = 0.450  adjusted loss = 0.450  adv prob = 0.250000   acc = 0.911
  waterbird_complete95 = 1, forest2water2 = 0  [n = 480]:	loss = 0.265  exp loss = 0.255  adjusted loss = 0.255  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1428]:	loss = 0.359  exp loss = 0.357  adjusted loss = 0.357  adv prob = 0.250000   acc = 0.919
Average incurred loss: 0.407  
Average sample loss: 0.407  
Average acc: 0.884  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 679]:	loss = 0.587  exp loss = 0.590  adjusted loss = 0.590  adv prob = 0.250000   acc = 0.732
  waterbird_complete95 = 0, forest2water2 = 1  [n = 645]:	loss = 0.448  exp loss = 0.445  adjusted loss = 0.445  adv prob = 0.250000   acc = 0.918
  waterbird_complete95 = 1, forest2water2 = 0  [n = 475]:	loss = 0.251  exp loss = 0.252  adjusted loss = 0.252  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1401]:	loss = 0.353  exp loss = 0.351  adjusted loss = 0.351  adv prob = 0.250000   acc = 0.907
Average incurred loss: 0.409  
Average sample loss: 0.409  
Average acc: 0.878  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 669]:	loss = 0.590  exp loss = 0.569  adjusted loss = 0.569  adv prob = 0.250000   acc = 0.694
  waterbird_complete95 = 0, forest2water2 = 1  [n = 695]:	loss = 0.455  exp loss = 0.438  adjusted loss = 0.438  adv prob = 0.250000   acc = 0.901
  waterbird_complete95 = 1, forest2water2 = 0  [n = 436]:	loss = 0.250  exp loss = 0.247  adjusted loss = 0.247  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1400]:	loss = 0.350  exp loss = 0.341  adjusted loss = 0.341  adv prob = 0.250000   acc = 0.921
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_10.csv
logged to wandb
Average incurred loss: 0.409  
Average sample loss: 0.409  
Average acc: 0.885  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 571]:	loss = 0.580  exp loss = 0.562  adjusted loss = 0.562  adv prob = 0.250000   acc = 0.723
  waterbird_complete95 = 0, forest2water2 = 1  [n = 507]:	loss = 0.446  exp loss = 0.449  adjusted loss = 0.449  adv prob = 0.250000   acc = 0.893
  waterbird_complete95 = 1, forest2water2 = 0  [n = 336]:	loss = 0.255  exp loss = 0.249  adjusted loss = 0.249  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1131]:	loss = 0.353  exp loss = 0.342  adjusted loss = 0.342  adv prob = 0.250000   acc = 0.934

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_10.csv
logged to wandb
Average incurred loss: 0.528  
Average sample loss: 0.528  
Average acc: 0.776  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.602  exp loss = 0.617  adjusted loss = 0.617  adv prob = 0.250000   acc = 0.709
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.555  exp loss = 0.586  adjusted loss = 0.586  adv prob = 0.250000   acc = 0.753
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.337  exp loss = 0.363  adjusted loss = 0.363  adv prob = 0.250000   acc = 0.932
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.362  exp loss = 0.352  adjusted loss = 0.352  adv prob = 0.250000   acc = 0.932
Spurious Score = 0.974
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_10.csv
logged to wandb
Current lr: 0.000010


Epoch [11]:
Training:
Average incurred loss: 0.407  
Average sample loss: 0.407  
Average acc: 0.879  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 662]:	loss = 0.575  exp loss = 0.546  adjusted loss = 0.546  adv prob = 0.250000   acc = 0.721
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.438  exp loss = 0.432  adjusted loss = 0.432  adv prob = 0.250000   acc = 0.911
  waterbird_complete95 = 1, forest2water2 = 0  [n = 461]:	loss = 0.263  exp loss = 0.274  adjusted loss = 0.274  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1417]:	loss = 0.361  exp loss = 0.360  adjusted loss = 0.360  adv prob = 0.250000   acc = 0.906
Average incurred loss: 0.397  
Average sample loss: 0.397  
Average acc: 0.893  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 650]:	loss = 0.555  exp loss = 0.532  adjusted loss = 0.532  adv prob = 0.250000   acc = 0.740
  waterbird_complete95 = 0, forest2water2 = 1  [n = 659]:	loss = 0.428  exp loss = 0.421  adjusted loss = 0.421  adv prob = 0.250000   acc = 0.927
  waterbird_complete95 = 1, forest2water2 = 0  [n = 439]:	loss = 0.252  exp loss = 0.253  adjusted loss = 0.253  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1452]:	loss = 0.356  exp loss = 0.353  adjusted loss = 0.353  adv prob = 0.250000   acc = 0.917
Average incurred loss: 0.394  
Average sample loss: 0.394  
Average acc: 0.889  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 633]:	loss = 0.568  exp loss = 0.548  adjusted loss = 0.548  adv prob = 0.250000   acc = 0.749
  waterbird_complete95 = 0, forest2water2 = 1  [n = 679]:	loss = 0.427  exp loss = 0.421  adjusted loss = 0.421  adv prob = 0.250000   acc = 0.895
  waterbird_complete95 = 1, forest2water2 = 0  [n = 437]:	loss = 0.249  exp loss = 0.257  adjusted loss = 0.257  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1451]:	loss = 0.346  exp loss = 0.329  adjusted loss = 0.329  adv prob = 0.250000   acc = 0.917
Average incurred loss: 0.387  
Average sample loss: 0.387  
Average acc: 0.894  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 697]:	loss = 0.556  exp loss = 0.550  adjusted loss = 0.550  adv prob = 0.250000   acc = 0.733
  waterbird_complete95 = 0, forest2water2 = 1  [n = 646]:	loss = 0.430  exp loss = 0.433  adjusted loss = 0.433  adv prob = 0.250000   acc = 0.913
  waterbird_complete95 = 1, forest2water2 = 0  [n = 449]:	loss = 0.232  exp loss = 0.214  adjusted loss = 0.214  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1408]:	loss = 0.334  exp loss = 0.316  adjusted loss = 0.316  adv prob = 0.250000   acc = 0.933
Average incurred loss: 0.387  
Average sample loss: 0.387  
Average acc: 0.897  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.555  exp loss = 0.548  adjusted loss = 0.548  adv prob = 0.250000   acc = 0.751
  waterbird_complete95 = 0, forest2water2 = 1  [n = 652]:	loss = 0.413  exp loss = 0.418  adjusted loss = 0.418  adv prob = 0.250000   acc = 0.933
  waterbird_complete95 = 1, forest2water2 = 0  [n = 468]:	loss = 0.253  exp loss = 0.228  adjusted loss = 0.228  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1412]:	loss = 0.339  exp loss = 0.338  adjusted loss = 0.338  adv prob = 0.250000   acc = 0.925
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_11.csv
logged to wandb
Average incurred loss: 0.384  
Average sample loss: 0.384  
Average acc: 0.892  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 538]:	loss = 0.545  exp loss = 0.544  adjusted loss = 0.544  adv prob = 0.250000   acc = 0.755
  waterbird_complete95 = 0, forest2water2 = 1  [n = 538]:	loss = 0.417  exp loss = 0.413  adjusted loss = 0.413  adv prob = 0.250000   acc = 0.920
  waterbird_complete95 = 1, forest2water2 = 0  [n = 352]:	loss = 0.235  exp loss = 0.237  adjusted loss = 0.237  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1117]:	loss = 0.337  exp loss = 0.337  adjusted loss = 0.337  adv prob = 0.250000   acc = 0.916

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_11.csv
logged to wandb
Average incurred loss: 0.511  
Average sample loss: 0.511  
Average acc: 0.785  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.577  exp loss = 0.592  adjusted loss = 0.592  adv prob = 0.250000   acc = 0.730
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.543  exp loss = 0.576  adjusted loss = 0.576  adv prob = 0.250000   acc = 0.758
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.332  exp loss = 0.358  adjusted loss = 0.358  adv prob = 0.250000   acc = 0.917
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.347  exp loss = 0.337  adjusted loss = 0.337  adv prob = 0.250000   acc = 0.940
Spurious Score = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_11.csv
logged to wandb
Current lr: 0.000010


Epoch [12]:
Training:
Average incurred loss: 0.383  
Average sample loss: 0.383  
Average acc: 0.892  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.540  exp loss = 0.531  adjusted loss = 0.531  adv prob = 0.250000   acc = 0.750
  waterbird_complete95 = 0, forest2water2 = 1  [n = 658]:	loss = 0.410  exp loss = 0.388  adjusted loss = 0.388  adv prob = 0.250000   acc = 0.918
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.236  exp loss = 0.238  adjusted loss = 0.238  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1433]:	loss = 0.342  exp loss = 0.347  adjusted loss = 0.347  adv prob = 0.250000   acc = 0.916
Average incurred loss: 0.377  
Average sample loss: 0.377  
Average acc: 0.908  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 649]:	loss = 0.539  exp loss = 0.542  adjusted loss = 0.542  adv prob = 0.250000   acc = 0.760
  waterbird_complete95 = 0, forest2water2 = 1  [n = 702]:	loss = 0.409  exp loss = 0.392  adjusted loss = 0.392  adv prob = 0.250000   acc = 0.930
  waterbird_complete95 = 1, forest2water2 = 0  [n = 425]:	loss = 0.225  exp loss = 0.221  adjusted loss = 0.221  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1424]:	loss = 0.332  exp loss = 0.316  adjusted loss = 0.316  adv prob = 0.250000   acc = 0.938
Average incurred loss: 0.375  
Average sample loss: 0.375  
Average acc: 0.905  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 658]:	loss = 0.536  exp loss = 0.508  adjusted loss = 0.508  adv prob = 0.250000   acc = 0.769
  waterbird_complete95 = 0, forest2water2 = 1  [n = 668]:	loss = 0.391  exp loss = 0.365  adjusted loss = 0.365  adv prob = 0.250000   acc = 0.940
  waterbird_complete95 = 1, forest2water2 = 0  [n = 461]:	loss = 0.249  exp loss = 0.263  adjusted loss = 0.263  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1413]:	loss = 0.333  exp loss = 0.319  adjusted loss = 0.319  adv prob = 0.250000   acc = 0.926
Average incurred loss: 0.364  
Average sample loss: 0.364  
Average acc: 0.911  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 636]:	loss = 0.513  exp loss = 0.516  adjusted loss = 0.516  adv prob = 0.250000   acc = 0.783
  waterbird_complete95 = 0, forest2water2 = 1  [n = 628]:	loss = 0.383  exp loss = 0.379  adjusted loss = 0.379  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 1, forest2water2 = 0  [n = 480]:	loss = 0.237  exp loss = 0.229  adjusted loss = 0.229  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1456]:	loss = 0.333  exp loss = 0.319  adjusted loss = 0.319  adv prob = 0.250000   acc = 0.926
Average incurred loss: 0.374  
Average sample loss: 0.374  
Average acc: 0.898  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 709]:	loss = 0.547  exp loss = 0.536  adjusted loss = 0.536  adv prob = 0.250000   acc = 0.753
  waterbird_complete95 = 0, forest2water2 = 1  [n = 662]:	loss = 0.408  exp loss = 0.412  adjusted loss = 0.412  adv prob = 0.250000   acc = 0.918
  waterbird_complete95 = 1, forest2water2 = 0  [n = 431]:	loss = 0.221  exp loss = 0.217  adjusted loss = 0.217  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1398]:	loss = 0.318  exp loss = 0.309  adjusted loss = 0.309  adv prob = 0.250000   acc = 0.931
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_12.csv
logged to wandb
Average incurred loss: 0.368  
Average sample loss: 0.369  
Average acc: 0.906  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 528]:	loss = 0.525  exp loss = 0.525  adjusted loss = 0.525  adv prob = 0.250000   acc = 0.767
  waterbird_complete95 = 0, forest2water2 = 1  [n = 516]:	loss = 0.390  exp loss = 0.400  adjusted loss = 0.400  adv prob = 0.250000   acc = 0.942
  waterbird_complete95 = 1, forest2water2 = 0  [n = 368]:	loss = 0.235  exp loss = 0.221  adjusted loss = 0.221  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1133]:	loss = 0.328  exp loss = 0.329  adjusted loss = 0.329  adv prob = 0.250000   acc = 0.928

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_12.csv
logged to wandb
Average incurred loss: 0.482  
Average sample loss: 0.482  
Average acc: 0.809  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.530  exp loss = 0.545  adjusted loss = 0.545  adv prob = 0.250000   acc = 0.773
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.514  exp loss = 0.547  adjusted loss = 0.547  adv prob = 0.250000   acc = 0.779
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.339  exp loss = 0.367  adjusted loss = 0.367  adv prob = 0.250000   acc = 0.917
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.343  exp loss = 0.334  adjusted loss = 0.334  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.005
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_12.csv
logged to wandb
Current lr: 0.000010


Epoch [13]:
Training:
Average incurred loss: 0.356  
Average sample loss: 0.356  
Average acc: 0.917  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 647]:	loss = 0.502  exp loss = 0.479  adjusted loss = 0.479  adv prob = 0.250000   acc = 0.801
  waterbird_complete95 = 0, forest2water2 = 1  [n = 641]:	loss = 0.383  exp loss = 0.377  adjusted loss = 0.377  adv prob = 0.250000   acc = 0.933
  waterbird_complete95 = 1, forest2water2 = 0  [n = 476]:	loss = 0.235  exp loss = 0.226  adjusted loss = 0.226  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1436]:	loss = 0.318  exp loss = 0.312  adjusted loss = 0.312  adv prob = 0.250000   acc = 0.937
Average incurred loss: 0.359  
Average sample loss: 0.359  
Average acc: 0.907  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 662]:	loss = 0.522  exp loss = 0.523  adjusted loss = 0.523  adv prob = 0.250000   acc = 0.767
  waterbird_complete95 = 0, forest2water2 = 1  [n = 678]:	loss = 0.387  exp loss = 0.380  adjusted loss = 0.380  adv prob = 0.250000   acc = 0.931
  waterbird_complete95 = 1, forest2water2 = 0  [n = 438]:	loss = 0.215  exp loss = 0.215  adjusted loss = 0.215  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1422]:	loss = 0.313  exp loss = 0.312  adjusted loss = 0.312  adv prob = 0.250000   acc = 0.934
Average incurred loss: 0.353  
Average sample loss: 0.353  
Average acc: 0.912  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 664]:	loss = 0.512  exp loss = 0.480  adjusted loss = 0.480  adv prob = 0.250000   acc = 0.780
  waterbird_complete95 = 0, forest2water2 = 1  [n = 625]:	loss = 0.363  exp loss = 0.346  adjusted loss = 0.346  adv prob = 0.250000   acc = 0.947
  waterbird_complete95 = 1, forest2water2 = 0  [n = 471]:	loss = 0.228  exp loss = 0.213  adjusted loss = 0.213  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1440]:	loss = 0.317  exp loss = 0.314  adjusted loss = 0.314  adv prob = 0.250000   acc = 0.934
Average incurred loss: 0.352  
Average sample loss: 0.352  
Average acc: 0.913  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 644]:	loss = 0.513  exp loss = 0.513  adjusted loss = 0.513  adv prob = 0.250000   acc = 0.770
  waterbird_complete95 = 0, forest2water2 = 1  [n = 673]:	loss = 0.383  exp loss = 0.396  adjusted loss = 0.396  adv prob = 0.250000   acc = 0.936
  waterbird_complete95 = 1, forest2water2 = 0  [n = 449]:	loss = 0.216  exp loss = 0.199  adjusted loss = 0.199  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1434]:	loss = 0.308  exp loss = 0.294  adjusted loss = 0.294  adv prob = 0.250000   acc = 0.942
Average incurred loss: 0.356  
Average sample loss: 0.356  
Average acc: 0.906  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 708]:	loss = 0.521  exp loss = 0.500  adjusted loss = 0.500  adv prob = 0.250000   acc = 0.764
  waterbird_complete95 = 0, forest2water2 = 1  [n = 695]:	loss = 0.386  exp loss = 0.355  adjusted loss = 0.355  adv prob = 0.250000   acc = 0.937
  waterbird_complete95 = 1, forest2water2 = 0  [n = 433]:	loss = 0.206  exp loss = 0.199  adjusted loss = 0.199  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1364]:	loss = 0.302  exp loss = 0.313  adjusted loss = 0.313  adv prob = 0.250000   acc = 0.935
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_13.csv
logged to wandb
Average incurred loss: 0.343  
Average sample loss: 0.343  
Average acc: 0.919  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 523]:	loss = 0.478  exp loss = 0.510  adjusted loss = 0.510  adv prob = 0.250000   acc = 0.815
  waterbird_complete95 = 0, forest2water2 = 1  [n = 522]:	loss = 0.356  exp loss = 0.355  adjusted loss = 0.355  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 1, forest2water2 = 0  [n = 339]:	loss = 0.215  exp loss = 0.221  adjusted loss = 0.221  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1161]:	loss = 0.314  exp loss = 0.315  adjusted loss = 0.315  adv prob = 0.250000   acc = 0.926

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_13.csv
logged to wandb
Average incurred loss: 0.465  
Average sample loss: 0.465  
Average acc: 0.821  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.504  exp loss = 0.520  adjusted loss = 0.520  adv prob = 0.250000   acc = 0.797
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.500  exp loss = 0.535  adjusted loss = 0.535  adv prob = 0.250000   acc = 0.785
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.339  exp loss = 0.367  adjusted loss = 0.367  adv prob = 0.250000   acc = 0.910
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.334  exp loss = 0.325  adjusted loss = 0.325  adv prob = 0.250000   acc = 0.940
Spurious Score = 1.024
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_13.csv
logged to wandb
Current lr: 0.000010


Epoch [14]:
Training:
Average incurred loss: 0.344  
Average sample loss: 0.344  
Average acc: 0.918  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 665]:	loss = 0.495  exp loss = 0.466  adjusted loss = 0.466  adv prob = 0.250000   acc = 0.786
  waterbird_complete95 = 0, forest2water2 = 1  [n = 652]:	loss = 0.354  exp loss = 0.341  adjusted loss = 0.341  adv prob = 0.250000   acc = 0.959
  waterbird_complete95 = 1, forest2water2 = 0  [n = 483]:	loss = 0.223  exp loss = 0.210  adjusted loss = 0.210  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1400]:	loss = 0.310  exp loss = 0.310  adjusted loss = 0.310  adv prob = 0.250000   acc = 0.939
Average incurred loss: 0.337  
Average sample loss: 0.337  
Average acc: 0.928  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 651]:	loss = 0.476  exp loss = 0.451  adjusted loss = 0.451  adv prob = 0.250000   acc = 0.811
  waterbird_complete95 = 0, forest2water2 = 1  [n = 658]:	loss = 0.355  exp loss = 0.349  adjusted loss = 0.349  adv prob = 0.250000   acc = 0.962
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.212  exp loss = 0.206  adjusted loss = 0.206  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1451]:	loss = 0.304  exp loss = 0.314  adjusted loss = 0.314  adv prob = 0.250000   acc = 0.946
Average incurred loss: 0.331  
Average sample loss: 0.331  
Average acc: 0.925  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 660]:	loss = 0.478  exp loss = 0.458  adjusted loss = 0.458  adv prob = 0.250000   acc = 0.806
  waterbird_complete95 = 0, forest2water2 = 1  [n = 659]:	loss = 0.351  exp loss = 0.349  adjusted loss = 0.349  adv prob = 0.250000   acc = 0.958
  waterbird_complete95 = 1, forest2water2 = 0  [n = 452]:	loss = 0.201  exp loss = 0.203  adjusted loss = 0.203  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1429]:	loss = 0.295  exp loss = 0.296  adjusted loss = 0.296  adv prob = 0.250000   acc = 0.943
Average incurred loss: 0.333  
Average sample loss: 0.333  
Average acc: 0.922  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 691]:	loss = 0.483  exp loss = 0.496  adjusted loss = 0.496  adv prob = 0.250000   acc = 0.795
  waterbird_complete95 = 0, forest2water2 = 1  [n = 637]:	loss = 0.347  exp loss = 0.333  adjusted loss = 0.333  adv prob = 0.250000   acc = 0.958
  waterbird_complete95 = 1, forest2water2 = 0  [n = 468]:	loss = 0.202  exp loss = 0.188  adjusted loss = 0.188  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1404]:	loss = 0.296  exp loss = 0.283  adjusted loss = 0.283  adv prob = 0.250000   acc = 0.944
Average incurred loss: 0.329  
Average sample loss: 0.329  
Average acc: 0.929  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 656]:	loss = 0.474  exp loss = 0.447  adjusted loss = 0.447  adv prob = 0.250000   acc = 0.809
  waterbird_complete95 = 0, forest2water2 = 1  [n = 668]:	loss = 0.348  exp loss = 0.325  adjusted loss = 0.325  adv prob = 0.250000   acc = 0.951
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.211  exp loss = 0.210  adjusted loss = 0.210  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1436]:	loss = 0.290  exp loss = 0.293  adjusted loss = 0.293  adv prob = 0.250000   acc = 0.954
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_14.csv
logged to wandb
Average incurred loss: 0.333  
Average sample loss: 0.333  
Average acc: 0.919  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 525]:	loss = 0.486  exp loss = 0.482  adjusted loss = 0.482  adv prob = 0.250000   acc = 0.779
  waterbird_complete95 = 0, forest2water2 = 1  [n = 560]:	loss = 0.359  exp loss = 0.354  adjusted loss = 0.354  adv prob = 0.250000   acc = 0.954
  waterbird_complete95 = 1, forest2water2 = 0  [n = 323]:	loss = 0.195  exp loss = 0.179  adjusted loss = 0.179  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1137]:	loss = 0.288  exp loss = 0.286  adjusted loss = 0.286  adv prob = 0.250000   acc = 0.945

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_14.csv
logged to wandb
Average incurred loss: 0.469  
Average sample loss: 0.469  
Average acc: 0.809  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.511  exp loss = 0.527  adjusted loss = 0.527  adv prob = 0.250000   acc = 0.784
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.521  exp loss = 0.558  adjusted loss = 0.558  adv prob = 0.250000   acc = 0.766
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.315  exp loss = 0.341  adjusted loss = 0.341  adv prob = 0.250000   acc = 0.910
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.300  exp loss = 0.291  adjusted loss = 0.291  adv prob = 0.250000   acc = 0.947
Spurious Score = 1.033
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_14.csv
logged to wandb
Current lr: 0.000010


Epoch [15]:
Training:
Average incurred loss: 0.328  
Average sample loss: 0.328  
Average acc: 0.927  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 675]:	loss = 0.472  exp loss = 0.437  adjusted loss = 0.437  adv prob = 0.250000   acc = 0.799
  waterbird_complete95 = 0, forest2water2 = 1  [n = 659]:	loss = 0.339  exp loss = 0.332  adjusted loss = 0.332  adv prob = 0.250000   acc = 0.959
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.212  exp loss = 0.200  adjusted loss = 0.200  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1425]:	loss = 0.290  exp loss = 0.290  adjusted loss = 0.290  adv prob = 0.250000   acc = 0.956
Average incurred loss: 0.323  
Average sample loss: 0.323  
Average acc: 0.927  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 680]:	loss = 0.467  exp loss = 0.451  adjusted loss = 0.451  adv prob = 0.250000   acc = 0.807
  waterbird_complete95 = 0, forest2water2 = 1  [n = 646]:	loss = 0.330  exp loss = 0.342  adjusted loss = 0.342  adv prob = 0.250000   acc = 0.963
  waterbird_complete95 = 1, forest2water2 = 0  [n = 459]:	loss = 0.202  exp loss = 0.189  adjusted loss = 0.189  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1415]:	loss = 0.289  exp loss = 0.286  adjusted loss = 0.286  adv prob = 0.250000   acc = 0.946
Average incurred loss: 0.314  
Average sample loss: 0.314  
Average acc: 0.932  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 665]:	loss = 0.444  exp loss = 0.441  adjusted loss = 0.441  adv prob = 0.250000   acc = 0.824
  waterbird_complete95 = 0, forest2water2 = 1  [n = 629]:	loss = 0.320  exp loss = 0.307  adjusted loss = 0.307  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 1, forest2water2 = 0  [n = 457]:	loss = 0.200  exp loss = 0.201  adjusted loss = 0.201  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1449]:	loss = 0.287  exp loss = 0.286  adjusted loss = 0.286  adv prob = 0.250000   acc = 0.946
Average incurred loss: 0.310  
Average sample loss: 0.310  
Average acc: 0.945  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 628]:	loss = 0.443  exp loss = 0.443  adjusted loss = 0.443  adv prob = 0.250000   acc = 0.841
  waterbird_complete95 = 0, forest2water2 = 1  [n = 701]:	loss = 0.335  exp loss = 0.341  adjusted loss = 0.341  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 1, forest2water2 = 0  [n = 484]:	loss = 0.183  exp loss = 0.173  adjusted loss = 0.173  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1387]:	loss = 0.280  exp loss = 0.272  adjusted loss = 0.272  adv prob = 0.250000   acc = 0.959
Average incurred loss: 0.312  
Average sample loss: 0.312  
Average acc: 0.936  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 672]:	loss = 0.455  exp loss = 0.458  adjusted loss = 0.458  adv prob = 0.250000   acc = 0.823
  waterbird_complete95 = 0, forest2water2 = 1  [n = 662]:	loss = 0.323  exp loss = 0.335  adjusted loss = 0.335  adv prob = 0.250000   acc = 0.973
  waterbird_complete95 = 1, forest2water2 = 0  [n = 429]:	loss = 0.186  exp loss = 0.172  adjusted loss = 0.172  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1437]:	loss = 0.278  exp loss = 0.278  adjusted loss = 0.278  adv prob = 0.250000   acc = 0.953
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_15.csv
logged to wandb
Average incurred loss: 0.309  
Average sample loss: 0.309  
Average acc: 0.933  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 528]:	loss = 0.447  exp loss = 0.428  adjusted loss = 0.428  adv prob = 0.250000   acc = 0.813
  waterbird_complete95 = 0, forest2water2 = 1  [n = 537]:	loss = 0.323  exp loss = 0.322  adjusted loss = 0.322  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 1, forest2water2 = 0  [n = 336]:	loss = 0.198  exp loss = 0.184  adjusted loss = 0.184  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1144]:	loss = 0.270  exp loss = 0.258  adjusted loss = 0.258  adv prob = 0.250000   acc = 0.953

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_15.csv
logged to wandb
Average incurred loss: 0.436  
Average sample loss: 0.436  
Average acc: 0.835  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.457  exp loss = 0.473  adjusted loss = 0.473  adv prob = 0.250000   acc = 0.824
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.478  exp loss = 0.514  adjusted loss = 0.514  adv prob = 0.250000   acc = 0.798
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.336  exp loss = 0.365  adjusted loss = 0.365  adv prob = 0.250000   acc = 0.910
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.314  exp loss = 0.304  adjusted loss = 0.304  adv prob = 0.250000   acc = 0.925
Spurious Score = 1.024
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_15.csv
logged to wandb
Current lr: 0.000010


Epoch [16]:
Training:
Average incurred loss: 0.303  
Average sample loss: 0.303  
Average acc: 0.944  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 639]:	loss = 0.441  exp loss = 0.448  adjusted loss = 0.448  adv prob = 0.250000   acc = 0.820
  waterbird_complete95 = 0, forest2water2 = 1  [n = 687]:	loss = 0.314  exp loss = 0.316  adjusted loss = 0.316  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 1, forest2water2 = 0  [n = 450]:	loss = 0.191  exp loss = 0.178  adjusted loss = 0.178  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1424]:	loss = 0.270  exp loss = 0.260  adjusted loss = 0.260  adv prob = 0.250000   acc = 0.965
Average incurred loss: 0.302  
Average sample loss: 0.302  
Average acc: 0.940  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 679]:	loss = 0.432  exp loss = 0.433  adjusted loss = 0.433  adv prob = 0.250000   acc = 0.838
  waterbird_complete95 = 0, forest2water2 = 1  [n = 634]:	loss = 0.310  exp loss = 0.295  adjusted loss = 0.295  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 1, forest2water2 = 0  [n = 485]:	loss = 0.195  exp loss = 0.191  adjusted loss = 0.191  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1402]:	loss = 0.273  exp loss = 0.273  adjusted loss = 0.273  adv prob = 0.250000   acc = 0.955
Average incurred loss: 0.303  
Average sample loss: 0.303  
Average acc: 0.938  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 632]:	loss = 0.442  exp loss = 0.452  adjusted loss = 0.452  adv prob = 0.250000   acc = 0.831
  waterbird_complete95 = 0, forest2water2 = 1  [n = 678]:	loss = 0.311  exp loss = 0.298  adjusted loss = 0.298  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 1, forest2water2 = 0  [n = 427]:	loss = 0.183  exp loss = 0.177  adjusted loss = 0.177  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1463]:	loss = 0.275  exp loss = 0.271  adjusted loss = 0.271  adv prob = 0.250000   acc = 0.951
Average incurred loss: 0.295  
Average sample loss: 0.295  
Average acc: 0.948  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 690]:	loss = 0.428  exp loss = 0.412  adjusted loss = 0.412  adv prob = 0.250000   acc = 0.848
  waterbird_complete95 = 0, forest2water2 = 1  [n = 649]:	loss = 0.306  exp loss = 0.294  adjusted loss = 0.294  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 1, forest2water2 = 0  [n = 427]:	loss = 0.184  exp loss = 0.182  adjusted loss = 0.182  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1434]:	loss = 0.259  exp loss = 0.260  adjusted loss = 0.260  adv prob = 0.250000   acc = 0.971
Average incurred loss: 0.293  
Average sample loss: 0.293  
Average acc: 0.947  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 683]:	loss = 0.427  exp loss = 0.418  adjusted loss = 0.418  adv prob = 0.250000   acc = 0.849
  waterbird_complete95 = 0, forest2water2 = 1  [n = 656]:	loss = 0.299  exp loss = 0.299  adjusted loss = 0.299  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 1, forest2water2 = 0  [n = 456]:	loss = 0.180  exp loss = 0.178  adjusted loss = 0.178  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1405]:	loss = 0.261  exp loss = 0.258  adjusted loss = 0.258  adv prob = 0.250000   acc = 0.960
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_16.csv
logged to wandb
Average incurred loss: 0.288  
Average sample loss: 0.288  
Average acc: 0.951  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 525]:	loss = 0.408  exp loss = 0.382  adjusted loss = 0.382  adv prob = 0.250000   acc = 0.867
  waterbird_complete95 = 0, forest2water2 = 1  [n = 530]:	loss = 0.300  exp loss = 0.304  adjusted loss = 0.304  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 1, forest2water2 = 0  [n = 361]:	loss = 0.180  exp loss = 0.175  adjusted loss = 0.175  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1129]:	loss = 0.262  exp loss = 0.254  adjusted loss = 0.254  adv prob = 0.250000   acc = 0.961

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_16.csv
logged to wandb
Average incurred loss: 0.427  
Average sample loss: 0.426  
Average acc: 0.836  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.443  exp loss = 0.460  adjusted loss = 0.460  adv prob = 0.250000   acc = 0.829
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.474  exp loss = 0.511  adjusted loss = 0.511  adv prob = 0.250000   acc = 0.796
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.330  exp loss = 0.359  adjusted loss = 0.359  adv prob = 0.250000   acc = 0.910
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.301  exp loss = 0.291  adjusted loss = 0.291  adv prob = 0.250000   acc = 0.925
Spurious Score = 1.028
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_16.csv
logged to wandb
Current lr: 0.000010


Epoch [17]:
Training:
Average incurred loss: 0.291  
Average sample loss: 0.291  
Average acc: 0.949  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 673]:	loss = 0.425  exp loss = 0.408  adjusted loss = 0.408  adv prob = 0.250000   acc = 0.842
  waterbird_complete95 = 0, forest2water2 = 1  [n = 646]:	loss = 0.291  exp loss = 0.279  adjusted loss = 0.279  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 1, forest2water2 = 0  [n = 436]:	loss = 0.187  exp loss = 0.188  adjusted loss = 0.188  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1445]:	loss = 0.260  exp loss = 0.264  adjusted loss = 0.264  adv prob = 0.250000   acc = 0.971
Average incurred loss: 0.283  
Average sample loss: 0.283  
Average acc: 0.950  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 681]:	loss = 0.402  exp loss = 0.401  adjusted loss = 0.401  adv prob = 0.250000   acc = 0.860
  waterbird_complete95 = 0, forest2water2 = 1  [n = 640]:	loss = 0.290  exp loss = 0.295  adjusted loss = 0.295  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 1, forest2water2 = 0  [n = 449]:	loss = 0.180  exp loss = 0.176  adjusted loss = 0.176  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1430]:	loss = 0.255  exp loss = 0.245  adjusted loss = 0.245  adv prob = 0.250000   acc = 0.966
Average incurred loss: 0.277  
Average sample loss: 0.277  
Average acc: 0.955  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 621]:	loss = 0.388  exp loss = 0.363  adjusted loss = 0.363  adv prob = 0.250000   acc = 0.865
  waterbird_complete95 = 0, forest2water2 = 1  [n = 678]:	loss = 0.291  exp loss = 0.266  adjusted loss = 0.266  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 1, forest2water2 = 0  [n = 467]:	loss = 0.181  exp loss = 0.184  adjusted loss = 0.184  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1434]:	loss = 0.255  exp loss = 0.251  adjusted loss = 0.251  adv prob = 0.250000   acc = 0.969
Average incurred loss: 0.281  
Average sample loss: 0.281  
Average acc: 0.954  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 682]:	loss = 0.410  exp loss = 0.405  adjusted loss = 0.405  adv prob = 0.250000   acc = 0.871
  waterbird_complete95 = 0, forest2water2 = 1  [n = 661]:	loss = 0.293  exp loss = 0.294  adjusted loss = 0.294  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 1, forest2water2 = 0  [n = 451]:	loss = 0.170  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1406]:	loss = 0.248  exp loss = 0.250  adjusted loss = 0.250  adv prob = 0.250000   acc = 0.968
Average incurred loss: 0.276  
Average sample loss: 0.276  
Average acc: 0.954  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 672]:	loss = 0.401  exp loss = 0.386  adjusted loss = 0.386  adv prob = 0.250000   acc = 0.854
  waterbird_complete95 = 0, forest2water2 = 1  [n = 666]:	loss = 0.290  exp loss = 0.284  adjusted loss = 0.284  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 1, forest2water2 = 0  [n = 445]:	loss = 0.173  exp loss = 0.166  adjusted loss = 0.166  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1417]:	loss = 0.244  exp loss = 0.241  adjusted loss = 0.241  adv prob = 0.250000   acc = 0.974
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_17.csv
logged to wandb
Average incurred loss: 0.274  
Average sample loss: 0.274  
Average acc: 0.952  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 519]:	loss = 0.410  exp loss = 0.393  adjusted loss = 0.393  adv prob = 0.250000   acc = 0.850
  waterbird_complete95 = 0, forest2water2 = 1  [n = 543]:	loss = 0.272  exp loss = 0.269  adjusted loss = 0.269  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 1, forest2water2 = 0  [n = 358]:	loss = 0.171  exp loss = 0.168  adjusted loss = 0.168  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1125]:	loss = 0.246  exp loss = 0.237  adjusted loss = 0.237  adv prob = 0.250000   acc = 0.964

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_17.csv
logged to wandb
Average incurred loss: 0.420  
Average sample loss: 0.419  
Average acc: 0.832  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.429  exp loss = 0.447  adjusted loss = 0.447  adv prob = 0.250000   acc = 0.831
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.477  exp loss = 0.516  adjusted loss = 0.516  adv prob = 0.250000   acc = 0.781
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.325  exp loss = 0.352  adjusted loss = 0.352  adv prob = 0.250000   acc = 0.910
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.281  exp loss = 0.271  adjusted loss = 0.271  adv prob = 0.250000   acc = 0.940
Spurious Score = 1.047
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_17.csv
logged to wandb
Current lr: 0.000010


Epoch [18]:
Training:
Average incurred loss: 0.273  
Average sample loss: 0.273  
Average acc: 0.957  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.395  exp loss = 0.382  adjusted loss = 0.382  adv prob = 0.250000   acc = 0.869
  waterbird_complete95 = 0, forest2water2 = 1  [n = 696]:	loss = 0.288  exp loss = 0.281  adjusted loss = 0.281  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 1, forest2water2 = 0  [n = 433]:	loss = 0.170  exp loss = 0.164  adjusted loss = 0.164  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1401]:	loss = 0.238  exp loss = 0.242  adjusted loss = 0.242  adv prob = 0.250000   acc = 0.975
Average incurred loss: 0.272  
Average sample loss: 0.272  
Average acc: 0.953  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 660]:	loss = 0.395  exp loss = 0.361  adjusted loss = 0.361  adv prob = 0.250000   acc = 0.856
  waterbird_complete95 = 0, forest2water2 = 1  [n = 653]:	loss = 0.267  exp loss = 0.245  adjusted loss = 0.245  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 1, forest2water2 = 0  [n = 462]:	loss = 0.175  exp loss = 0.169  adjusted loss = 0.169  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1425]:	loss = 0.249  exp loss = 0.252  adjusted loss = 0.252  adv prob = 0.250000   acc = 0.966
Average incurred loss: 0.269  
Average sample loss: 0.269  
Average acc: 0.957  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.379  exp loss = 0.376  adjusted loss = 0.376  adv prob = 0.250000   acc = 0.873
  waterbird_complete95 = 0, forest2water2 = 1  [n = 645]:	loss = 0.277  exp loss = 0.280  adjusted loss = 0.280  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 1, forest2water2 = 0  [n = 472]:	loss = 0.180  exp loss = 0.172  adjusted loss = 0.172  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1415]:	loss = 0.243  exp loss = 0.239  adjusted loss = 0.239  adv prob = 0.250000   acc = 0.970
Average incurred loss: 0.265  
Average sample loss: 0.265  
Average acc: 0.956  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 654]:	loss = 0.387  exp loss = 0.373  adjusted loss = 0.373  adv prob = 0.250000   acc = 0.872
  waterbird_complete95 = 0, forest2water2 = 1  [n = 658]:	loss = 0.260  exp loss = 0.249  adjusted loss = 0.249  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 1, forest2water2 = 0  [n = 418]:	loss = 0.158  exp loss = 0.146  adjusted loss = 0.146  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1470]:	loss = 0.243  exp loss = 0.232  adjusted loss = 0.232  adv prob = 0.250000   acc = 0.967
Average incurred loss: 0.263  
Average sample loss: 0.263  
Average acc: 0.961  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 684]:	loss = 0.387  exp loss = 0.382  adjusted loss = 0.382  adv prob = 0.250000   acc = 0.874
  waterbird_complete95 = 0, forest2water2 = 1  [n = 683]:	loss = 0.274  exp loss = 0.259  adjusted loss = 0.259  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.165  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1392]:	loss = 0.229  exp loss = 0.222  adjusted loss = 0.222  adv prob = 0.250000   acc = 0.977
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_18.csv
logged to wandb
Average incurred loss: 0.254  
Average sample loss: 0.254  
Average acc: 0.968  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 512]:	loss = 0.353  exp loss = 0.351  adjusted loss = 0.351  adv prob = 0.250000   acc = 0.898
  waterbird_complete95 = 0, forest2water2 = 1  [n = 499]:	loss = 0.247  exp loss = 0.248  adjusted loss = 0.248  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 1, forest2water2 = 0  [n = 380]:	loss = 0.166  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1154]:	loss = 0.243  exp loss = 0.236  adjusted loss = 0.236  adv prob = 0.250000   acc = 0.978

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_18.csv
logged to wandb
Average incurred loss: 0.394  
Average sample loss: 0.393  
Average acc: 0.859  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.387  exp loss = 0.405  adjusted loss = 0.405  adv prob = 0.250000   acc = 0.876
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.443  exp loss = 0.481  adjusted loss = 0.481  adv prob = 0.250000   acc = 0.809
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.344  exp loss = 0.375  adjusted loss = 0.375  adv prob = 0.250000   acc = 0.902
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.291  exp loss = 0.281  adjusted loss = 0.281  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.057
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_18.csv
logged to wandb
Current lr: 0.000010


Epoch [19]:
Training:
Average incurred loss: 0.258  
Average sample loss: 0.258  
Average acc: 0.963  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 657]:	loss = 0.378  exp loss = 0.382  adjusted loss = 0.382  adv prob = 0.250000   acc = 0.875
  waterbird_complete95 = 0, forest2water2 = 1  [n = 679]:	loss = 0.265  exp loss = 0.274  adjusted loss = 0.274  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 1, forest2water2 = 0  [n = 402]:	loss = 0.160  exp loss = 0.153  adjusted loss = 0.153  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1462]:	loss = 0.228  exp loss = 0.228  adjusted loss = 0.228  adv prob = 0.250000   acc = 0.982
Average incurred loss: 0.259  
Average sample loss: 0.259  
Average acc: 0.965  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 665]:	loss = 0.377  exp loss = 0.379  adjusted loss = 0.379  adv prob = 0.250000   acc = 0.874
  waterbird_complete95 = 0, forest2water2 = 1  [n = 669]:	loss = 0.262  exp loss = 0.250  adjusted loss = 0.250  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.162  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1425]:	loss = 0.233  exp loss = 0.232  adjusted loss = 0.232  adv prob = 0.250000   acc = 0.985
Average incurred loss: 0.250  
Average sample loss: 0.250  
Average acc: 0.966  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.362  exp loss = 0.349  adjusted loss = 0.349  adv prob = 0.250000   acc = 0.880
  waterbird_complete95 = 0, forest2water2 = 1  [n = 670]:	loss = 0.254  exp loss = 0.236  adjusted loss = 0.236  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 447]:	loss = 0.158  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1415]:	loss = 0.224  exp loss = 0.235  adjusted loss = 0.235  adv prob = 0.250000   acc = 0.981
Average incurred loss: 0.250  
Average sample loss: 0.250  
Average acc: 0.963  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 690]:	loss = 0.357  exp loss = 0.353  adjusted loss = 0.353  adv prob = 0.250000   acc = 0.878
  waterbird_complete95 = 0, forest2water2 = 1  [n = 619]:	loss = 0.249  exp loss = 0.255  adjusted loss = 0.255  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 1, forest2water2 = 0  [n = 482]:	loss = 0.166  exp loss = 0.151  adjusted loss = 0.151  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1409]:	loss = 0.226  exp loss = 0.222  adjusted loss = 0.222  adv prob = 0.250000   acc = 0.979
Average incurred loss: 0.247  
Average sample loss: 0.247  
Average acc: 0.968  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 643]:	loss = 0.361  exp loss = 0.345  adjusted loss = 0.345  adv prob = 0.250000   acc = 0.885
  waterbird_complete95 = 0, forest2water2 = 1  [n = 678]:	loss = 0.246  exp loss = 0.234  adjusted loss = 0.234  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 1, forest2water2 = 0  [n = 455]:	loss = 0.157  exp loss = 0.170  adjusted loss = 0.170  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1424]:	loss = 0.225  exp loss = 0.229  adjusted loss = 0.229  adv prob = 0.250000   acc = 0.985
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_19.csv
logged to wandb
Average incurred loss: 0.244  
Average sample loss: 0.244  
Average acc: 0.969  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 525]:	loss = 0.348  exp loss = 0.361  adjusted loss = 0.361  adv prob = 0.250000   acc = 0.895
  waterbird_complete95 = 0, forest2water2 = 1  [n = 519]:	loss = 0.246  exp loss = 0.242  adjusted loss = 0.242  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 1, forest2water2 = 0  [n = 379]:	loss = 0.160  exp loss = 0.153  adjusted loss = 0.153  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1122]:	loss = 0.222  exp loss = 0.210  adjusted loss = 0.210  adv prob = 0.250000   acc = 0.983

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_19.csv
logged to wandb
Average incurred loss: 0.378  
Average sample loss: 0.377  
Average acc: 0.867  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.364  exp loss = 0.381  adjusted loss = 0.381  adv prob = 0.250000   acc = 0.880
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.424  exp loss = 0.461  adjusted loss = 0.461  adv prob = 0.250000   acc = 0.826
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.351  exp loss = 0.384  adjusted loss = 0.384  adv prob = 0.250000   acc = 0.895
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.293  exp loss = 0.282  adjusted loss = 0.282  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.053
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_19.csv
logged to wandb
Current lr: 0.000010


Epoch [20]:
Training:
Average incurred loss: 0.242  
Average sample loss: 0.242  
Average acc: 0.970  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 672]:	loss = 0.353  exp loss = 0.350  adjusted loss = 0.350  adv prob = 0.250000   acc = 0.882
  waterbird_complete95 = 0, forest2water2 = 1  [n = 659]:	loss = 0.242  exp loss = 0.238  adjusted loss = 0.238  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 459]:	loss = 0.156  exp loss = 0.157  adjusted loss = 0.157  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1410]:	loss = 0.216  exp loss = 0.210  adjusted loss = 0.210  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.243  
Average sample loss: 0.243  
Average acc: 0.966  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 662]:	loss = 0.359  exp loss = 0.327  adjusted loss = 0.327  adv prob = 0.250000   acc = 0.879
  waterbird_complete95 = 0, forest2water2 = 1  [n = 691]:	loss = 0.246  exp loss = 0.240  adjusted loss = 0.240  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 1, forest2water2 = 0  [n = 433]:	loss = 0.152  exp loss = 0.155  adjusted loss = 0.155  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1414]:	loss = 0.214  exp loss = 0.216  adjusted loss = 0.216  adv prob = 0.250000   acc = 0.983
Average incurred loss: 0.237  
Average sample loss: 0.237  
Average acc: 0.969  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 650]:	loss = 0.331  exp loss = 0.335  adjusted loss = 0.335  adv prob = 0.250000   acc = 0.892
  waterbird_complete95 = 0, forest2water2 = 1  [n = 628]:	loss = 0.231  exp loss = 0.218  adjusted loss = 0.218  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 453]:	loss = 0.162  exp loss = 0.159  adjusted loss = 0.159  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1469]:	loss = 0.220  exp loss = 0.214  adjusted loss = 0.214  adv prob = 0.250000   acc = 0.982
Average incurred loss: 0.240  
Average sample loss: 0.240  
Average acc: 0.969  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 658]:	loss = 0.353  exp loss = 0.310  adjusted loss = 0.310  adv prob = 0.250000   acc = 0.883
  waterbird_complete95 = 0, forest2water2 = 1  [n = 668]:	loss = 0.241  exp loss = 0.230  adjusted loss = 0.230  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 1, forest2water2 = 0  [n = 432]:	loss = 0.153  exp loss = 0.146  adjusted loss = 0.146  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1442]:	loss = 0.213  exp loss = 0.211  adjusted loss = 0.211  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.235  
Average sample loss: 0.235  
Average acc: 0.977  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 681]:	loss = 0.337  exp loss = 0.312  adjusted loss = 0.312  adv prob = 0.250000   acc = 0.918
  waterbird_complete95 = 0, forest2water2 = 1  [n = 668]:	loss = 0.245  exp loss = 0.231  adjusted loss = 0.231  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 0  [n = 438]:	loss = 0.149  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1413]:	loss = 0.207  exp loss = 0.205  adjusted loss = 0.205  adv prob = 0.250000   acc = 0.991
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_20.csv
logged to wandb
Average incurred loss: 0.234  
Average sample loss: 0.234  
Average acc: 0.972  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 525]:	loss = 0.335  exp loss = 0.326  adjusted loss = 0.326  adv prob = 0.250000   acc = 0.903
  waterbird_complete95 = 0, forest2water2 = 1  [n = 520]:	loss = 0.231  exp loss = 0.219  adjusted loss = 0.219  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 391]:	loss = 0.154  exp loss = 0.146  adjusted loss = 0.146  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1109]:	loss = 0.216  exp loss = 0.217  adjusted loss = 0.217  adv prob = 0.250000   acc = 0.982

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_20.csv
logged to wandb
Average incurred loss: 0.370  
Average sample loss: 0.369  
Average acc: 0.869  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.346  exp loss = 0.364  adjusted loss = 0.364  adv prob = 0.250000   acc = 0.893
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.420  exp loss = 0.457  adjusted loss = 0.457  adv prob = 0.250000   acc = 0.826
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.359  exp loss = 0.393  adjusted loss = 0.393  adv prob = 0.250000   acc = 0.872
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.286  exp loss = 0.274  adjusted loss = 0.274  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.075
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_20.csv
logged to wandb
Current lr: 0.000010


Epoch [21]:
Training:
Average incurred loss: 0.232  
Average sample loss: 0.232  
Average acc: 0.974  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 671]:	loss = 0.328  exp loss = 0.343  adjusted loss = 0.343  adv prob = 0.250000   acc = 0.908
  waterbird_complete95 = 0, forest2water2 = 1  [n = 652]:	loss = 0.236  exp loss = 0.236  adjusted loss = 0.236  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 1, forest2water2 = 0  [n = 474]:	loss = 0.152  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1403]:	loss = 0.210  exp loss = 0.208  adjusted loss = 0.208  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.229  
Average sample loss: 0.229  
Average acc: 0.977  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 678]:	loss = 0.331  exp loss = 0.307  adjusted loss = 0.307  adv prob = 0.250000   acc = 0.909
  waterbird_complete95 = 0, forest2water2 = 1  [n = 646]:	loss = 0.227  exp loss = 0.217  adjusted loss = 0.217  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 439]:	loss = 0.149  exp loss = 0.143  adjusted loss = 0.143  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1437]:	loss = 0.206  exp loss = 0.198  adjusted loss = 0.198  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.228  
Average sample loss: 0.228  
Average acc: 0.974  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 642]:	loss = 0.333  exp loss = 0.345  adjusted loss = 0.345  adv prob = 0.250000   acc = 0.896
  waterbird_complete95 = 0, forest2water2 = 1  [n = 687]:	loss = 0.234  exp loss = 0.220  adjusted loss = 0.220  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 457]:	loss = 0.149  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1414]:	loss = 0.203  exp loss = 0.199  adjusted loss = 0.199  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.223  
Average sample loss: 0.223  
Average acc: 0.980  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 630]:	loss = 0.310  exp loss = 0.288  adjusted loss = 0.288  adv prob = 0.250000   acc = 0.932
  waterbird_complete95 = 0, forest2water2 = 1  [n = 671]:	loss = 0.224  exp loss = 0.206  adjusted loss = 0.206  adv prob = 0.250000   acc = 0.991
  waterbird_complete95 = 1, forest2water2 = 0  [n = 443]:	loss = 0.151  exp loss = 0.162  adjusted loss = 0.162  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1456]:	loss = 0.207  exp loss = 0.207  adjusted loss = 0.207  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.223  
Average sample loss: 0.223  
Average acc: 0.972  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 704]:	loss = 0.328  exp loss = 0.343  adjusted loss = 0.343  adv prob = 0.250000   acc = 0.893
  waterbird_complete95 = 0, forest2water2 = 1  [n = 619]:	loss = 0.216  exp loss = 0.199  adjusted loss = 0.199  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 1, forest2water2 = 0  [n = 447]:	loss = 0.147  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1430]:	loss = 0.199  exp loss = 0.200  adjusted loss = 0.200  adv prob = 0.250000   acc = 0.994
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_21.csv
logged to wandb
Average incurred loss: 0.225  
Average sample loss: 0.225  
Average acc: 0.972  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 523]:	loss = 0.346  exp loss = 0.344  adjusted loss = 0.344  adv prob = 0.250000   acc = 0.887
  waterbird_complete95 = 0, forest2water2 = 1  [n = 559]:	loss = 0.222  exp loss = 0.213  adjusted loss = 0.213  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 346]:	loss = 0.137  exp loss = 0.127  adjusted loss = 0.127  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1117]:	loss = 0.196  exp loss = 0.202  adjusted loss = 0.202  adv prob = 0.250000   acc = 0.990

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_21.csv
logged to wandb
Average incurred loss: 0.371  
Average sample loss: 0.370  
Average acc: 0.862  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.345  exp loss = 0.361  adjusted loss = 0.361  adv prob = 0.250000   acc = 0.887
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.433  exp loss = 0.472  adjusted loss = 0.472  adv prob = 0.250000   acc = 0.809
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.348  exp loss = 0.381  adjusted loss = 0.381  adv prob = 0.250000   acc = 0.887
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.264  exp loss = 0.253  adjusted loss = 0.253  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.072
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_21.csv
logged to wandb
Current lr: 0.000010


Epoch [22]:
Training:
Average incurred loss: 0.220  
Average sample loss: 0.220  
Average acc: 0.978  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 704]:	loss = 0.320  exp loss = 0.323  adjusted loss = 0.323  adv prob = 0.250000   acc = 0.918
  waterbird_complete95 = 0, forest2water2 = 1  [n = 654]:	loss = 0.224  exp loss = 0.221  adjusted loss = 0.221  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 443]:	loss = 0.136  exp loss = 0.129  adjusted loss = 0.129  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1399]:	loss = 0.195  exp loss = 0.186  adjusted loss = 0.186  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.220  
Average sample loss: 0.220  
Average acc: 0.977  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 695]:	loss = 0.318  exp loss = 0.317  adjusted loss = 0.317  adv prob = 0.250000   acc = 0.912
  waterbird_complete95 = 0, forest2water2 = 1  [n = 652]:	loss = 0.219  exp loss = 0.199  adjusted loss = 0.199  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.145  exp loss = 0.153  adjusted loss = 0.153  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1405]:	loss = 0.195  exp loss = 0.202  adjusted loss = 0.202  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.216  
Average sample loss: 0.216  
Average acc: 0.979  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 652]:	loss = 0.306  exp loss = 0.309  adjusted loss = 0.309  adv prob = 0.250000   acc = 0.913
  waterbird_complete95 = 0, forest2water2 = 1  [n = 666]:	loss = 0.211  exp loss = 0.225  adjusted loss = 0.225  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 464]:	loss = 0.150  exp loss = 0.133  adjusted loss = 0.133  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1418]:	loss = 0.198  exp loss = 0.183  adjusted loss = 0.183  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.214  
Average sample loss: 0.214  
Average acc: 0.975  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 658]:	loss = 0.324  exp loss = 0.305  adjusted loss = 0.305  adv prob = 0.250000   acc = 0.906
  waterbird_complete95 = 0, forest2water2 = 1  [n = 702]:	loss = 0.209  exp loss = 0.217  adjusted loss = 0.217  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 420]:	loss = 0.141  exp loss = 0.127  adjusted loss = 0.127  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1420]:	loss = 0.188  exp loss = 0.183  adjusted loss = 0.183  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.210  
Average sample loss: 0.210  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 636]:	loss = 0.281  exp loss = 0.280  adjusted loss = 0.280  adv prob = 0.250000   acc = 0.929
  waterbird_complete95 = 0, forest2water2 = 1  [n = 614]:	loss = 0.193  exp loss = 0.185  adjusted loss = 0.185  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 472]:	loss = 0.150  exp loss = 0.140  adjusted loss = 0.140  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1478]:	loss = 0.206  exp loss = 0.210  adjusted loss = 0.210  adv prob = 0.250000   acc = 0.991
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_22.csv
logged to wandb
Average incurred loss: 0.211  
Average sample loss: 0.211  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 503]:	loss = 0.310  exp loss = 0.284  adjusted loss = 0.284  adv prob = 0.250000   acc = 0.922
  waterbird_complete95 = 0, forest2water2 = 1  [n = 546]:	loss = 0.206  exp loss = 0.199  adjusted loss = 0.199  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 359]:	loss = 0.145  exp loss = 0.147  adjusted loss = 0.147  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1137]:	loss = 0.191  exp loss = 0.189  adjusted loss = 0.189  adv prob = 0.250000   acc = 0.995

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_22.csv
logged to wandb
Average incurred loss: 0.352  
Average sample loss: 0.351  
Average acc: 0.877  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.317  exp loss = 0.333  adjusted loss = 0.333  adv prob = 0.250000   acc = 0.912
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.409  exp loss = 0.446  adjusted loss = 0.446  adv prob = 0.250000   acc = 0.828
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.363  exp loss = 0.397  adjusted loss = 0.397  adv prob = 0.250000   acc = 0.872
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.267  exp loss = 0.256  adjusted loss = 0.256  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.085
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_22.csv
logged to wandb
Current lr: 0.000010


Epoch [23]:
Training:
Average incurred loss: 0.210  
Average sample loss: 0.210  
Average acc: 0.975  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 664]:	loss = 0.313  exp loss = 0.307  adjusted loss = 0.307  adv prob = 0.250000   acc = 0.898
  waterbird_complete95 = 0, forest2water2 = 1  [n = 674]:	loss = 0.206  exp loss = 0.197  adjusted loss = 0.197  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 459]:	loss = 0.134  exp loss = 0.137  adjusted loss = 0.137  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1403]:	loss = 0.188  exp loss = 0.186  adjusted loss = 0.186  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.213  
Average sample loss: 0.213  
Average acc: 0.975  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 679]:	loss = 0.316  exp loss = 0.308  adjusted loss = 0.308  adv prob = 0.250000   acc = 0.900
  waterbird_complete95 = 0, forest2water2 = 1  [n = 695]:	loss = 0.217  exp loss = 0.203  adjusted loss = 0.203  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 0  [n = 444]:	loss = 0.133  exp loss = 0.127  adjusted loss = 0.127  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1382]:	loss = 0.185  exp loss = 0.174  adjusted loss = 0.174  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.203  
Average sample loss: 0.203  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 699]:	loss = 0.288  exp loss = 0.270  adjusted loss = 0.270  adv prob = 0.250000   acc = 0.927
  waterbird_complete95 = 0, forest2water2 = 1  [n = 666]:	loss = 0.210  exp loss = 0.198  adjusted loss = 0.198  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 408]:	loss = 0.139  exp loss = 0.129  adjusted loss = 0.129  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1427]:	loss = 0.176  exp loss = 0.178  adjusted loss = 0.178  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.204  
Average sample loss: 0.204  
Average acc: 0.984  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 663]:	loss = 0.284  exp loss = 0.256  adjusted loss = 0.256  adv prob = 0.250000   acc = 0.934
  waterbird_complete95 = 0, forest2water2 = 1  [n = 629]:	loss = 0.191  exp loss = 0.181  adjusted loss = 0.181  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 457]:	loss = 0.148  exp loss = 0.147  adjusted loss = 0.147  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1451]:	loss = 0.192  exp loss = 0.188  adjusted loss = 0.188  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.205  
Average sample loss: 0.205  
Average acc: 0.980  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 636]:	loss = 0.287  exp loss = 0.260  adjusted loss = 0.260  adv prob = 0.250000   acc = 0.921
  waterbird_complete95 = 0, forest2water2 = 1  [n = 652]:	loss = 0.195  exp loss = 0.179  adjusted loss = 0.179  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.143  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1446]:	loss = 0.194  exp loss = 0.194  adjusted loss = 0.194  adv prob = 0.250000   acc = 0.992
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_23.csv
logged to wandb
Average incurred loss: 0.204  
Average sample loss: 0.204  
Average acc: 0.981  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 507]:	loss = 0.292  exp loss = 0.278  adjusted loss = 0.278  adv prob = 0.250000   acc = 0.927
  waterbird_complete95 = 0, forest2water2 = 1  [n = 518]:	loss = 0.186  exp loss = 0.182  adjusted loss = 0.182  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 372]:	loss = 0.148  exp loss = 0.151  adjusted loss = 0.151  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1148]:	loss = 0.191  exp loss = 0.192  adjusted loss = 0.192  adv prob = 0.250000   acc = 0.990

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_23.csv
logged to wandb
Average incurred loss: 0.342  
Average sample loss: 0.341  
Average acc: 0.883  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.297  exp loss = 0.312  adjusted loss = 0.312  adv prob = 0.250000   acc = 0.921
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.396  exp loss = 0.431  adjusted loss = 0.431  adv prob = 0.250000   acc = 0.839
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.381  exp loss = 0.418  adjusted loss = 0.418  adv prob = 0.250000   acc = 0.857
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.272  exp loss = 0.260  adjusted loss = 0.260  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.093
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_23.csv
logged to wandb
Current lr: 0.000010


Epoch [24]:
Training:
Average incurred loss: 0.200  
Average sample loss: 0.200  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 662]:	loss = 0.286  exp loss = 0.288  adjusted loss = 0.288  adv prob = 0.250000   acc = 0.924
  waterbird_complete95 = 0, forest2water2 = 1  [n = 665]:	loss = 0.197  exp loss = 0.197  adjusted loss = 0.197  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 424]:	loss = 0.133  exp loss = 0.121  adjusted loss = 0.121  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1449]:	loss = 0.181  exp loss = 0.178  adjusted loss = 0.178  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.202  
Average sample loss: 0.202  
Average acc: 0.978  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 664]:	loss = 0.296  exp loss = 0.298  adjusted loss = 0.298  adv prob = 0.250000   acc = 0.925
  waterbird_complete95 = 0, forest2water2 = 1  [n = 694]:	loss = 0.204  exp loss = 0.210  adjusted loss = 0.210  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 430]:	loss = 0.128  exp loss = 0.125  adjusted loss = 0.125  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1412]:	loss = 0.180  exp loss = 0.166  adjusted loss = 0.166  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.198  
Average sample loss: 0.198  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 649]:	loss = 0.286  exp loss = 0.263  adjusted loss = 0.263  adv prob = 0.250000   acc = 0.929
  waterbird_complete95 = 0, forest2water2 = 1  [n = 679]:	loss = 0.193  exp loss = 0.185  adjusted loss = 0.185  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.137  exp loss = 0.135  adjusted loss = 0.135  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1406]:	loss = 0.180  exp loss = 0.182  adjusted loss = 0.182  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.198  
Average sample loss: 0.198  
Average acc: 0.981  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 693]:	loss = 0.285  exp loss = 0.290  adjusted loss = 0.290  adv prob = 0.250000   acc = 0.925
  waterbird_complete95 = 0, forest2water2 = 1  [n = 623]:	loss = 0.189  exp loss = 0.177  adjusted loss = 0.177  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 454]:	loss = 0.141  exp loss = 0.140  adjusted loss = 0.140  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1430]:	loss = 0.178  exp loss = 0.169  adjusted loss = 0.169  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.193  
Average sample loss: 0.193  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 634]:	loss = 0.272  exp loss = 0.252  adjusted loss = 0.252  adv prob = 0.250000   acc = 0.924
  waterbird_complete95 = 0, forest2water2 = 1  [n = 681]:	loss = 0.192  exp loss = 0.186  adjusted loss = 0.186  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.137  exp loss = 0.133  adjusted loss = 0.133  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1444]:	loss = 0.175  exp loss = 0.172  adjusted loss = 0.172  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_24.csv
logged to wandb
Average incurred loss: 0.195  
Average sample loss: 0.195  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 546]:	loss = 0.277  exp loss = 0.271  adjusted loss = 0.271  adv prob = 0.250000   acc = 0.927
  waterbird_complete95 = 0, forest2water2 = 1  [n = 492]:	loss = 0.184  exp loss = 0.169  adjusted loss = 0.169  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 391]:	loss = 0.137  exp loss = 0.133  adjusted loss = 0.133  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1116]:	loss = 0.180  exp loss = 0.187  adjusted loss = 0.187  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_24.csv
logged to wandb
Average incurred loss: 0.326  
Average sample loss: 0.325  
Average acc: 0.894  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.274  exp loss = 0.288  adjusted loss = 0.288  adv prob = 0.250000   acc = 0.929
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.374  exp loss = 0.409  adjusted loss = 0.409  adv prob = 0.250000   acc = 0.861
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.395  exp loss = 0.436  adjusted loss = 0.436  adv prob = 0.250000   acc = 0.850
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.276  exp loss = 0.263  adjusted loss = 0.263  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.089
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_24.csv
logged to wandb
Current lr: 0.000010


Epoch [25]:
Training:
Average incurred loss: 0.197  
Average sample loss: 0.197  
Average acc: 0.981  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 638]:	loss = 0.294  exp loss = 0.259  adjusted loss = 0.259  adv prob = 0.250000   acc = 0.918
  waterbird_complete95 = 0, forest2water2 = 1  [n = 703]:	loss = 0.191  exp loss = 0.171  adjusted loss = 0.171  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.135  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1418]:	loss = 0.175  exp loss = 0.179  adjusted loss = 0.179  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.189  
Average sample loss: 0.189  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 632]:	loss = 0.266  exp loss = 0.263  adjusted loss = 0.263  adv prob = 0.250000   acc = 0.924
  waterbird_complete95 = 0, forest2water2 = 1  [n = 655]:	loss = 0.180  exp loss = 0.167  adjusted loss = 0.167  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.140  exp loss = 0.135  adjusted loss = 0.135  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1455]:	loss = 0.176  exp loss = 0.176  adjusted loss = 0.176  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.193  
Average sample loss: 0.193  
Average acc: 0.978  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 685]:	loss = 0.283  exp loss = 0.288  adjusted loss = 0.288  adv prob = 0.250000   acc = 0.915
  waterbird_complete95 = 0, forest2water2 = 1  [n = 668]:	loss = 0.192  exp loss = 0.182  adjusted loss = 0.182  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 428]:	loss = 0.126  exp loss = 0.124  adjusted loss = 0.124  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1419]:	loss = 0.170  exp loss = 0.171  adjusted loss = 0.171  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.188  
Average sample loss: 0.188  
Average acc: 0.984  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 672]:	loss = 0.274  exp loss = 0.277  adjusted loss = 0.277  adv prob = 0.250000   acc = 0.929
  waterbird_complete95 = 0, forest2water2 = 1  [n = 681]:	loss = 0.188  exp loss = 0.196  adjusted loss = 0.196  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 472]:	loss = 0.131  exp loss = 0.123  adjusted loss = 0.123  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1375]:	loss = 0.165  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.190  
Average sample loss: 0.190  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 675]:	loss = 0.263  exp loss = 0.266  adjusted loss = 0.266  adv prob = 0.250000   acc = 0.942
  waterbird_complete95 = 0, forest2water2 = 1  [n = 624]:	loss = 0.180  exp loss = 0.161  adjusted loss = 0.161  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 451]:	loss = 0.137  exp loss = 0.136  adjusted loss = 0.136  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1450]:	loss = 0.177  exp loss = 0.179  adjusted loss = 0.179  adv prob = 0.250000   acc = 0.990
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_25.csv
logged to wandb
Average incurred loss: 0.189  
Average sample loss: 0.189  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 546]:	loss = 0.263  exp loss = 0.242  adjusted loss = 0.242  adv prob = 0.250000   acc = 0.938
  waterbird_complete95 = 0, forest2water2 = 1  [n = 503]:	loss = 0.181  exp loss = 0.171  adjusted loss = 0.171  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 356]:	loss = 0.134  exp loss = 0.134  adjusted loss = 0.134  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1140]:	loss = 0.173  exp loss = 0.176  adjusted loss = 0.176  adv prob = 0.250000   acc = 0.993

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_25.csv
logged to wandb
Average incurred loss: 0.330  
Average sample loss: 0.329  
Average acc: 0.891  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.278  exp loss = 0.292  adjusted loss = 0.292  adv prob = 0.250000   acc = 0.927
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.383  exp loss = 0.419  adjusted loss = 0.419  adv prob = 0.250000   acc = 0.852
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.386  exp loss = 0.422  adjusted loss = 0.422  adv prob = 0.250000   acc = 0.857
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.268  exp loss = 0.255  adjusted loss = 0.255  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.088
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_25.csv
logged to wandb
Current lr: 0.000010


Epoch [26]:
Training:
Average incurred loss: 0.188  
Average sample loss: 0.188  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 667]:	loss = 0.261  exp loss = 0.242  adjusted loss = 0.242  adv prob = 0.250000   acc = 0.936
  waterbird_complete95 = 0, forest2water2 = 1  [n = 648]:	loss = 0.180  exp loss = 0.168  adjusted loss = 0.168  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 444]:	loss = 0.134  exp loss = 0.134  adjusted loss = 0.134  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1441]:	loss = 0.174  exp loss = 0.186  adjusted loss = 0.186  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.189  
Average sample loss: 0.189  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 657]:	loss = 0.258  exp loss = 0.232  adjusted loss = 0.232  adv prob = 0.250000   acc = 0.945
  waterbird_complete95 = 0, forest2water2 = 1  [n = 658]:	loss = 0.191  exp loss = 0.162  adjusted loss = 0.162  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 430]:	loss = 0.136  exp loss = 0.145  adjusted loss = 0.145  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1455]:	loss = 0.173  exp loss = 0.180  adjusted loss = 0.180  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.182  
Average sample loss: 0.182  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 647]:	loss = 0.249  exp loss = 0.244  adjusted loss = 0.244  adv prob = 0.250000   acc = 0.947
  waterbird_complete95 = 0, forest2water2 = 1  [n = 655]:	loss = 0.180  exp loss = 0.170  adjusted loss = 0.170  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 454]:	loss = 0.135  exp loss = 0.138  adjusted loss = 0.138  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1444]:	loss = 0.167  exp loss = 0.163  adjusted loss = 0.163  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.184  
Average sample loss: 0.184  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 666]:	loss = 0.264  exp loss = 0.252  adjusted loss = 0.252  adv prob = 0.250000   acc = 0.935
  waterbird_complete95 = 0, forest2water2 = 1  [n = 676]:	loss = 0.185  exp loss = 0.184  adjusted loss = 0.184  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 469]:	loss = 0.126  exp loss = 0.124  adjusted loss = 0.124  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1389]:	loss = 0.166  exp loss = 0.159  adjusted loss = 0.159  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.186  
Average sample loss: 0.186  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 692]:	loss = 0.275  exp loss = 0.232  adjusted loss = 0.232  adv prob = 0.250000   acc = 0.929
  waterbird_complete95 = 0, forest2water2 = 1  [n = 650]:	loss = 0.180  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 477]:	loss = 0.129  exp loss = 0.128  adjusted loss = 0.128  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1381]:	loss = 0.165  exp loss = 0.169  adjusted loss = 0.169  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_26.csv
logged to wandb
Average incurred loss: 0.189  
Average sample loss: 0.189  
Average acc: 0.985  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 519]:	loss = 0.276  exp loss = 0.275  adjusted loss = 0.275  adv prob = 0.250000   acc = 0.931
  waterbird_complete95 = 0, forest2water2 = 1  [n = 547]:	loss = 0.186  exp loss = 0.180  adjusted loss = 0.180  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 332]:	loss = 0.129  exp loss = 0.119  adjusted loss = 0.119  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1147]:	loss = 0.168  exp loss = 0.159  adjusted loss = 0.159  adv prob = 0.250000   acc = 0.997

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_26.csv
logged to wandb
Average incurred loss: 0.337  
Average sample loss: 0.336  
Average acc: 0.883  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.288  exp loss = 0.304  adjusted loss = 0.304  adv prob = 0.250000   acc = 0.921
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.408  exp loss = 0.446  adjusted loss = 0.446  adv prob = 0.250000   acc = 0.835
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.362  exp loss = 0.396  adjusted loss = 0.396  adv prob = 0.250000   acc = 0.872
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.238  exp loss = 0.226  adjusted loss = 0.226  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.086
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_26.csv
logged to wandb
Current lr: 0.000010


Epoch [27]:
Training:
Average incurred loss: 0.179  
Average sample loss: 0.179  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 646]:	loss = 0.248  exp loss = 0.249  adjusted loss = 0.249  adv prob = 0.250000   acc = 0.940
  waterbird_complete95 = 0, forest2water2 = 1  [n = 675]:	loss = 0.178  exp loss = 0.185  adjusted loss = 0.185  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 470]:	loss = 0.132  exp loss = 0.117  adjusted loss = 0.117  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1409]:	loss = 0.164  exp loss = 0.150  adjusted loss = 0.150  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.178  
Average sample loss: 0.178  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 654]:	loss = 0.246  exp loss = 0.242  adjusted loss = 0.242  adv prob = 0.250000   acc = 0.942
  waterbird_complete95 = 0, forest2water2 = 1  [n = 684]:	loss = 0.181  exp loss = 0.164  adjusted loss = 0.164  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 456]:	loss = 0.129  exp loss = 0.128  adjusted loss = 0.128  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1406]:	loss = 0.161  exp loss = 0.160  adjusted loss = 0.160  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.184  
Average sample loss: 0.184  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 679]:	loss = 0.267  exp loss = 0.269  adjusted loss = 0.269  adv prob = 0.250000   acc = 0.929
  waterbird_complete95 = 0, forest2water2 = 1  [n = 679]:	loss = 0.182  exp loss = 0.180  adjusted loss = 0.180  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 429]:	loss = 0.137  exp loss = 0.128  adjusted loss = 0.128  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1413]:	loss = 0.160  exp loss = 0.160  adjusted loss = 0.160  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.179  
Average sample loss: 0.179  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 654]:	loss = 0.246  exp loss = 0.250  adjusted loss = 0.250  adv prob = 0.250000   acc = 0.950
  waterbird_complete95 = 0, forest2water2 = 1  [n = 643]:	loss = 0.165  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.133  exp loss = 0.126  adjusted loss = 0.126  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1437]:	loss = 0.170  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.180  
Average sample loss: 0.180  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 679]:	loss = 0.253  exp loss = 0.273  adjusted loss = 0.273  adv prob = 0.250000   acc = 0.926
  waterbird_complete95 = 0, forest2water2 = 1  [n = 627]:	loss = 0.163  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 411]:	loss = 0.132  exp loss = 0.129  adjusted loss = 0.129  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1483]:	loss = 0.167  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_27.csv
logged to wandb
Average incurred loss: 0.182  
Average sample loss: 0.182  
Average acc: 0.985  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 536]:	loss = 0.263  exp loss = 0.253  adjusted loss = 0.253  adv prob = 0.250000   acc = 0.942
  waterbird_complete95 = 0, forest2water2 = 1  [n = 526]:	loss = 0.172  exp loss = 0.169  adjusted loss = 0.169  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 374]:	loss = 0.131  exp loss = 0.124  adjusted loss = 0.124  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1109]:	loss = 0.164  exp loss = 0.159  adjusted loss = 0.159  adv prob = 0.250000   acc = 0.995

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_27.csv
logged to wandb
Average incurred loss: 0.328  
Average sample loss: 0.327  
Average acc: 0.887  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.272  exp loss = 0.286  adjusted loss = 0.286  adv prob = 0.250000   acc = 0.925
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.392  exp loss = 0.429  adjusted loss = 0.429  adv prob = 0.250000   acc = 0.848
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.380  exp loss = 0.416  adjusted loss = 0.416  adv prob = 0.250000   acc = 0.850
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.247  exp loss = 0.235  adjusted loss = 0.235  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.094
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_27.csv
logged to wandb
Current lr: 0.000010


Epoch [28]:
Training:
Average incurred loss: 0.178  
Average sample loss: 0.178  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 661]:	loss = 0.258  exp loss = 0.244  adjusted loss = 0.244  adv prob = 0.250000   acc = 0.927
  waterbird_complete95 = 0, forest2water2 = 1  [n = 674]:	loss = 0.168  exp loss = 0.162  adjusted loss = 0.162  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 464]:	loss = 0.132  exp loss = 0.132  adjusted loss = 0.132  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1401]:	loss = 0.160  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.183  
Average sample loss: 0.183  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 673]:	loss = 0.259  exp loss = 0.231  adjusted loss = 0.231  adv prob = 0.250000   acc = 0.938
  waterbird_complete95 = 0, forest2water2 = 1  [n = 649]:	loss = 0.169  exp loss = 0.153  adjusted loss = 0.153  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 437]:	loss = 0.130  exp loss = 0.134  adjusted loss = 0.134  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1441]:	loss = 0.169  exp loss = 0.175  adjusted loss = 0.175  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.177  
Average sample loss: 0.177  
Average acc: 0.984  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 682]:	loss = 0.252  exp loss = 0.225  adjusted loss = 0.225  adv prob = 0.250000   acc = 0.935
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.171  exp loss = 0.152  adjusted loss = 0.152  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 452]:	loss = 0.132  exp loss = 0.134  adjusted loss = 0.134  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1406]:	loss = 0.158  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.173  
Average sample loss: 0.173  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 649]:	loss = 0.246  exp loss = 0.252  adjusted loss = 0.252  adv prob = 0.250000   acc = 0.949
  waterbird_complete95 = 0, forest2water2 = 1  [n = 705]:	loss = 0.172  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 453]:	loss = 0.128  exp loss = 0.122  adjusted loss = 0.122  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1393]:	loss = 0.154  exp loss = 0.155  adjusted loss = 0.155  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.171  
Average sample loss: 0.171  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 693]:	loss = 0.233  exp loss = 0.244  adjusted loss = 0.244  adv prob = 0.250000   acc = 0.954
  waterbird_complete95 = 0, forest2water2 = 1  [n = 625]:	loss = 0.161  exp loss = 0.168  adjusted loss = 0.168  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 429]:	loss = 0.128  exp loss = 0.116  adjusted loss = 0.116  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1453]:	loss = 0.159  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 0.995
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_28.csv
logged to wandb
Average incurred loss: 0.170  
Average sample loss: 0.170  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 490]:	loss = 0.219  exp loss = 0.226  adjusted loss = 0.226  adv prob = 0.250000   acc = 0.965
  waterbird_complete95 = 0, forest2water2 = 1  [n = 521]:	loss = 0.156  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 371]:	loss = 0.138  exp loss = 0.128  adjusted loss = 0.128  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1163]:	loss = 0.166  exp loss = 0.159  adjusted loss = 0.159  adv prob = 0.250000   acc = 0.994

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_28.csv
logged to wandb
Average incurred loss: 0.312  
Average sample loss: 0.311  
Average acc: 0.897  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.246  exp loss = 0.258  adjusted loss = 0.258  adv prob = 0.250000   acc = 0.938
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.368  exp loss = 0.403  adjusted loss = 0.403  adv prob = 0.250000   acc = 0.867
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.407  exp loss = 0.450  adjusted loss = 0.450  adv prob = 0.250000   acc = 0.827
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.256  exp loss = 0.244  adjusted loss = 0.244  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.104
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_28.csv
logged to wandb
Current lr: 0.000010


Epoch [29]:
Training:
Average incurred loss: 0.176  
Average sample loss: 0.176  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 669]:	loss = 0.242  exp loss = 0.229  adjusted loss = 0.229  adv prob = 0.250000   acc = 0.946
  waterbird_complete95 = 0, forest2water2 = 1  [n = 644]:	loss = 0.168  exp loss = 0.154  adjusted loss = 0.154  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 454]:	loss = 0.128  exp loss = 0.133  adjusted loss = 0.133  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1433]:	loss = 0.165  exp loss = 0.173  adjusted loss = 0.173  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.174  
Average sample loss: 0.174  
Average acc: 0.985  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 675]:	loss = 0.254  exp loss = 0.257  adjusted loss = 0.257  adv prob = 0.250000   acc = 0.942
  waterbird_complete95 = 0, forest2water2 = 1  [n = 695]:	loss = 0.171  exp loss = 0.171  adjusted loss = 0.171  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 436]:	loss = 0.128  exp loss = 0.118  adjusted loss = 0.118  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1394]:	loss = 0.152  exp loss = 0.145  adjusted loss = 0.145  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.170  
Average sample loss: 0.170  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.232  exp loss = 0.225  adjusted loss = 0.225  adv prob = 0.250000   acc = 0.952
  waterbird_complete95 = 0, forest2water2 = 1  [n = 662]:	loss = 0.163  exp loss = 0.152  adjusted loss = 0.152  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 445]:	loss = 0.129  exp loss = 0.131  adjusted loss = 0.131  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1423]:	loss = 0.157  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.171  
Average sample loss: 0.171  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 653]:	loss = 0.245  exp loss = 0.229  adjusted loss = 0.229  adv prob = 0.250000   acc = 0.942
  waterbird_complete95 = 0, forest2water2 = 1  [n = 680]:	loss = 0.162  exp loss = 0.166  adjusted loss = 0.166  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 463]:	loss = 0.133  exp loss = 0.132  adjusted loss = 0.132  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1404]:	loss = 0.153  exp loss = 0.141  adjusted loss = 0.141  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.174  
Average sample loss: 0.174  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 654]:	loss = 0.247  exp loss = 0.237  adjusted loss = 0.237  adv prob = 0.250000   acc = 0.945
  waterbird_complete95 = 0, forest2water2 = 1  [n = 655]:	loss = 0.158  exp loss = 0.150  adjusted loss = 0.150  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 430]:	loss = 0.132  exp loss = 0.130  adjusted loss = 0.130  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1461]:	loss = 0.160  exp loss = 0.164  adjusted loss = 0.164  adv prob = 0.250000   acc = 0.996
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_29.csv
logged to wandb
Average incurred loss: 0.165  
Average sample loss: 0.165  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 527]:	loss = 0.212  exp loss = 0.192  adjusted loss = 0.192  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 498]:	loss = 0.156  exp loss = 0.155  adjusted loss = 0.155  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 378]:	loss = 0.132  exp loss = 0.131  adjusted loss = 0.131  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1142]:	loss = 0.159  exp loss = 0.147  adjusted loss = 0.147  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_29.csv
logged to wandb
Average incurred loss: 0.317  
Average sample loss: 0.316  
Average acc: 0.898  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.253  exp loss = 0.266  adjusted loss = 0.266  adv prob = 0.250000   acc = 0.936
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.376  exp loss = 0.410  adjusted loss = 0.410  adv prob = 0.250000   acc = 0.869
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.401  exp loss = 0.440  adjusted loss = 0.440  adv prob = 0.250000   acc = 0.835
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.252  exp loss = 0.240  adjusted loss = 0.240  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.097
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_29.csv
logged to wandb
Current lr: 0.000010


Epoch [30]:
Training:
Average incurred loss: 0.172  
Average sample loss: 0.172  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 655]:	loss = 0.241  exp loss = 0.252  adjusted loss = 0.252  adv prob = 0.250000   acc = 0.948
  waterbird_complete95 = 0, forest2water2 = 1  [n = 688]:	loss = 0.165  exp loss = 0.163  adjusted loss = 0.163  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.125  exp loss = 0.130  adjusted loss = 0.130  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1417]:	loss = 0.157  exp loss = 0.146  adjusted loss = 0.146  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.167  
Average sample loss: 0.167  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 682]:	loss = 0.229  exp loss = 0.221  adjusted loss = 0.221  adv prob = 0.250000   acc = 0.962
  waterbird_complete95 = 0, forest2water2 = 1  [n = 642]:	loss = 0.161  exp loss = 0.168  adjusted loss = 0.168  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 433]:	loss = 0.128  exp loss = 0.129  adjusted loss = 0.129  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1443]:	loss = 0.153  exp loss = 0.146  adjusted loss = 0.146  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.167  
Average sample loss: 0.167  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 693]:	loss = 0.232  exp loss = 0.226  adjusted loss = 0.226  adv prob = 0.250000   acc = 0.958
  waterbird_complete95 = 0, forest2water2 = 1  [n = 669]:	loss = 0.165  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 472]:	loss = 0.127  exp loss = 0.135  adjusted loss = 0.135  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1366]:	loss = 0.149  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.169  
Average sample loss: 0.169  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 629]:	loss = 0.229  exp loss = 0.197  adjusted loss = 0.197  adv prob = 0.250000   acc = 0.955
  waterbird_complete95 = 0, forest2water2 = 1  [n = 673]:	loss = 0.155  exp loss = 0.132  adjusted loss = 0.132  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 470]:	loss = 0.136  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1428]:	loss = 0.160  exp loss = 0.166  adjusted loss = 0.166  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.166  
Average sample loss: 0.166  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 658]:	loss = 0.222  exp loss = 0.210  adjusted loss = 0.210  adv prob = 0.250000   acc = 0.954
  waterbird_complete95 = 0, forest2water2 = 1  [n = 645]:	loss = 0.156  exp loss = 0.146  adjusted loss = 0.146  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 443]:	loss = 0.135  exp loss = 0.141  adjusted loss = 0.141  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1454]:	loss = 0.154  exp loss = 0.154  adjusted loss = 0.154  adv prob = 0.250000   acc = 0.998
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_30.csv
logged to wandb
Average incurred loss: 0.166  
Average sample loss: 0.166  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 531]:	loss = 0.222  exp loss = 0.223  adjusted loss = 0.223  adv prob = 0.250000   acc = 0.960
  waterbird_complete95 = 0, forest2water2 = 1  [n = 517]:	loss = 0.155  exp loss = 0.153  adjusted loss = 0.153  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 348]:	loss = 0.131  exp loss = 0.129  adjusted loss = 0.129  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1149]:	loss = 0.155  exp loss = 0.151  adjusted loss = 0.151  adv prob = 0.250000   acc = 0.995

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_30.csv
logged to wandb
Average incurred loss: 0.310  
Average sample loss: 0.309  
Average acc: 0.902  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.243  exp loss = 0.255  adjusted loss = 0.255  adv prob = 0.250000   acc = 0.942
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.363  exp loss = 0.397  adjusted loss = 0.397  adv prob = 0.250000   acc = 0.876
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.413  exp loss = 0.454  adjusted loss = 0.454  adv prob = 0.250000   acc = 0.827
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.258  exp loss = 0.246  adjusted loss = 0.246  adv prob = 0.250000   acc = 0.925
Spurious Score = 1.097
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_30.csv
logged to wandb
Current lr: 0.000010


Epoch [31]:
Training:
Average incurred loss: 0.168  
Average sample loss: 0.168  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 693]:	loss = 0.236  exp loss = 0.230  adjusted loss = 0.230  adv prob = 0.250000   acc = 0.944
  waterbird_complete95 = 0, forest2water2 = 1  [n = 649]:	loss = 0.160  exp loss = 0.151  adjusted loss = 0.151  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.132  exp loss = 0.133  adjusted loss = 0.133  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1418]:	loss = 0.149  exp loss = 0.147  adjusted loss = 0.147  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.167  
Average sample loss: 0.167  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 652]:	loss = 0.222  exp loss = 0.234  adjusted loss = 0.234  adv prob = 0.250000   acc = 0.963
  waterbird_complete95 = 0, forest2water2 = 1  [n = 649]:	loss = 0.154  exp loss = 0.147  adjusted loss = 0.147  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.132  exp loss = 0.128  adjusted loss = 0.128  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1459]:	loss = 0.158  exp loss = 0.148  adjusted loss = 0.148  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.165  
Average sample loss: 0.165  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.227  exp loss = 0.236  adjusted loss = 0.236  adv prob = 0.250000   acc = 0.961
  waterbird_complete95 = 0, forest2water2 = 1  [n = 682]:	loss = 0.162  exp loss = 0.172  adjusted loss = 0.172  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 442]:	loss = 0.125  exp loss = 0.117  adjusted loss = 0.117  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1406]:	loss = 0.149  exp loss = 0.139  adjusted loss = 0.139  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.169  
Average sample loss: 0.169  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 683]:	loss = 0.234  exp loss = 0.237  adjusted loss = 0.237  adv prob = 0.250000   acc = 0.943
  waterbird_complete95 = 0, forest2water2 = 1  [n = 653]:	loss = 0.160  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 451]:	loss = 0.130  exp loss = 0.122  adjusted loss = 0.122  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1413]:	loss = 0.154  exp loss = 0.140  adjusted loss = 0.140  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.164  
Average sample loss: 0.164  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 648]:	loss = 0.219  exp loss = 0.211  adjusted loss = 0.211  adv prob = 0.250000   acc = 0.961
  waterbird_complete95 = 0, forest2water2 = 1  [n = 674]:	loss = 0.159  exp loss = 0.152  adjusted loss = 0.152  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 443]:	loss = 0.130  exp loss = 0.133  adjusted loss = 0.133  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1435]:	loss = 0.153  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_31.csv
logged to wandb
Average incurred loss: 0.169  
Average sample loss: 0.169  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 502]:	loss = 0.229  exp loss = 0.201  adjusted loss = 0.201  adv prob = 0.250000   acc = 0.954
  waterbird_complete95 = 0, forest2water2 = 1  [n = 527]:	loss = 0.153  exp loss = 0.136  adjusted loss = 0.136  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 390]:	loss = 0.136  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1126]:	loss = 0.162  exp loss = 0.167  adjusted loss = 0.167  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_31.csv
logged to wandb
Average incurred loss: 0.295  
Average sample loss: 0.294  
Average acc: 0.914  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.218  exp loss = 0.229  adjusted loss = 0.229  adv prob = 0.250000   acc = 0.959
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.334  exp loss = 0.366  adjusted loss = 0.366  adv prob = 0.250000   acc = 0.893
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.449  exp loss = 0.496  adjusted loss = 0.496  adv prob = 0.250000   acc = 0.820
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.275  exp loss = 0.263  adjusted loss = 0.263  adv prob = 0.250000   acc = 0.925
Spurious Score = 1.100
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_31.csv
logged to wandb
Current lr: 0.000010


Epoch [32]:
Training:
Average incurred loss: 0.166  
Average sample loss: 0.166  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 684]:	loss = 0.226  exp loss = 0.227  adjusted loss = 0.227  adv prob = 0.250000   acc = 0.949
  waterbird_complete95 = 0, forest2water2 = 1  [n = 675]:	loss = 0.167  exp loss = 0.159  adjusted loss = 0.159  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 447]:	loss = 0.124  exp loss = 0.119  adjusted loss = 0.119  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1394]:	loss = 0.148  exp loss = 0.148  adjusted loss = 0.148  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.166  
Average sample loss: 0.166  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 654]:	loss = 0.215  exp loss = 0.215  adjusted loss = 0.215  adv prob = 0.250000   acc = 0.969
  waterbird_complete95 = 0, forest2water2 = 1  [n = 621]:	loss = 0.148  exp loss = 0.145  adjusted loss = 0.145  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 469]:	loss = 0.138  exp loss = 0.141  adjusted loss = 0.141  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1456]:	loss = 0.161  exp loss = 0.161  adjusted loss = 0.161  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.164  
Average sample loss: 0.164  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 663]:	loss = 0.212  exp loss = 0.206  adjusted loss = 0.206  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 664]:	loss = 0.160  exp loss = 0.154  adjusted loss = 0.154  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 436]:	loss = 0.132  exp loss = 0.131  adjusted loss = 0.131  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1437]:	loss = 0.153  exp loss = 0.155  adjusted loss = 0.155  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.168  
Average sample loss: 0.168  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 660]:	loss = 0.230  exp loss = 0.206  adjusted loss = 0.206  adv prob = 0.250000   acc = 0.955
  waterbird_complete95 = 0, forest2water2 = 1  [n = 668]:	loss = 0.157  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 457]:	loss = 0.135  exp loss = 0.136  adjusted loss = 0.136  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1415]:	loss = 0.154  exp loss = 0.155  adjusted loss = 0.155  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.163  
Average sample loss: 0.163  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 653]:	loss = 0.219  exp loss = 0.205  adjusted loss = 0.205  adv prob = 0.250000   acc = 0.966
  waterbird_complete95 = 0, forest2water2 = 1  [n = 676]:	loss = 0.155  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 449]:	loss = 0.132  exp loss = 0.123  adjusted loss = 0.123  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1422]:	loss = 0.151  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 0.996
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_32.csv
logged to wandb
Average incurred loss: 0.166  
Average sample loss: 0.166  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 534]:	loss = 0.229  exp loss = 0.223  adjusted loss = 0.223  adv prob = 0.250000   acc = 0.951
  waterbird_complete95 = 0, forest2water2 = 1  [n = 530]:	loss = 0.155  exp loss = 0.157  adjusted loss = 0.157  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 348]:	loss = 0.133  exp loss = 0.128  adjusted loss = 0.128  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1133]:	loss = 0.151  exp loss = 0.138  adjusted loss = 0.138  adv prob = 0.250000   acc = 0.995

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_32.csv
logged to wandb
Average incurred loss: 0.318  
Average sample loss: 0.317  
Average acc: 0.897  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.250  exp loss = 0.262  adjusted loss = 0.262  adv prob = 0.250000   acc = 0.936
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.384  exp loss = 0.417  adjusted loss = 0.417  adv prob = 0.250000   acc = 0.867
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.403  exp loss = 0.440  adjusted loss = 0.440  adv prob = 0.250000   acc = 0.827
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.244  exp loss = 0.232  adjusted loss = 0.232  adv prob = 0.250000   acc = 0.940
Spurious Score = 1.107
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_32.csv
logged to wandb
Current lr: 0.000010


Epoch [33]:
Training:
Average incurred loss: 0.171  
Average sample loss: 0.171  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 649]:	loss = 0.234  exp loss = 0.212  adjusted loss = 0.212  adv prob = 0.250000   acc = 0.954
  waterbird_complete95 = 0, forest2water2 = 1  [n = 666]:	loss = 0.159  exp loss = 0.143  adjusted loss = 0.143  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 454]:	loss = 0.136  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1431]:	loss = 0.158  exp loss = 0.166  adjusted loss = 0.166  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.167  
Average sample loss: 0.167  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 682]:	loss = 0.224  exp loss = 0.206  adjusted loss = 0.206  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 676]:	loss = 0.165  exp loss = 0.151  adjusted loss = 0.151  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.131  exp loss = 0.136  adjusted loss = 0.136  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1394]:	loss = 0.152  exp loss = 0.155  adjusted loss = 0.155  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.165  
Average sample loss: 0.165  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 677]:	loss = 0.213  exp loss = 0.224  adjusted loss = 0.224  adv prob = 0.250000   acc = 0.966
  waterbird_complete95 = 0, forest2water2 = 1  [n = 645]:	loss = 0.157  exp loss = 0.163  adjusted loss = 0.163  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 453]:	loss = 0.137  exp loss = 0.132  adjusted loss = 0.132  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1425]:	loss = 0.153  exp loss = 0.145  adjusted loss = 0.145  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.166  
Average sample loss: 0.166  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 642]:	loss = 0.216  exp loss = 0.219  adjusted loss = 0.219  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 650]:	loss = 0.151  exp loss = 0.148  adjusted loss = 0.148  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 435]:	loss = 0.144  exp loss = 0.136  adjusted loss = 0.136  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1473]:	loss = 0.158  exp loss = 0.155  adjusted loss = 0.155  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.161  
Average sample loss: 0.161  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 636]:	loss = 0.207  exp loss = 0.207  adjusted loss = 0.207  adv prob = 0.250000   acc = 0.973
  waterbird_complete95 = 0, forest2water2 = 1  [n = 663]:	loss = 0.152  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 451]:	loss = 0.132  exp loss = 0.130  adjusted loss = 0.130  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1450]:	loss = 0.155  exp loss = 0.147  adjusted loss = 0.147  adv prob = 0.250000   acc = 0.998
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_33.csv
logged to wandb
Average incurred loss: 0.168  
Average sample loss: 0.168  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 562]:	loss = 0.233  exp loss = 0.228  adjusted loss = 0.228  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 0, forest2water2 = 1  [n = 534]:	loss = 0.168  exp loss = 0.159  adjusted loss = 0.159  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 365]:	loss = 0.131  exp loss = 0.129  adjusted loss = 0.129  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1084]:	loss = 0.148  exp loss = 0.142  adjusted loss = 0.142  adv prob = 0.250000   acc = 0.995

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_33.csv
logged to wandb
Average incurred loss: 0.319  
Average sample loss: 0.318  
Average acc: 0.898  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.250  exp loss = 0.261  adjusted loss = 0.261  adv prob = 0.250000   acc = 0.940
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.386  exp loss = 0.420  adjusted loss = 0.420  adv prob = 0.250000   acc = 0.867
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.404  exp loss = 0.438  adjusted loss = 0.438  adv prob = 0.250000   acc = 0.827
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.243  exp loss = 0.232  adjusted loss = 0.232  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.105
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_33.csv
logged to wandb
Current lr: 0.000010


Epoch [34]:
Training:
Average incurred loss: 0.170  
Average sample loss: 0.170  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 713]:	loss = 0.224  exp loss = 0.211  adjusted loss = 0.211  adv prob = 0.250000   acc = 0.959
  waterbird_complete95 = 0, forest2water2 = 1  [n = 627]:	loss = 0.165  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 454]:	loss = 0.135  exp loss = 0.132  adjusted loss = 0.132  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1406]:	loss = 0.156  exp loss = 0.157  adjusted loss = 0.157  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.169  
Average sample loss: 0.169  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 651]:	loss = 0.224  exp loss = 0.202  adjusted loss = 0.202  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 670]:	loss = 0.155  exp loss = 0.153  adjusted loss = 0.153  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.133  exp loss = 0.134  adjusted loss = 0.134  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1431]:	loss = 0.161  exp loss = 0.157  adjusted loss = 0.157  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.166  
Average sample loss: 0.166  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 650]:	loss = 0.214  exp loss = 0.212  adjusted loss = 0.212  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 677]:	loss = 0.161  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 450]:	loss = 0.140  exp loss = 0.136  adjusted loss = 0.136  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1423]:	loss = 0.154  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.166  
Average sample loss: 0.166  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 645]:	loss = 0.219  exp loss = 0.220  adjusted loss = 0.220  adv prob = 0.250000   acc = 0.963
  waterbird_complete95 = 0, forest2water2 = 1  [n = 670]:	loss = 0.154  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.144  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1419]:	loss = 0.156  exp loss = 0.146  adjusted loss = 0.146  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.164  
Average sample loss: 0.164  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 671]:	loss = 0.219  exp loss = 0.216  adjusted loss = 0.216  adv prob = 0.250000   acc = 0.961
  waterbird_complete95 = 0, forest2water2 = 1  [n = 679]:	loss = 0.161  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.134  exp loss = 0.130  adjusted loss = 0.130  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1409]:	loss = 0.150  exp loss = 0.147  adjusted loss = 0.147  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_34.csv
logged to wandb
Average incurred loss: 0.161  
Average sample loss: 0.161  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 518]:	loss = 0.199  exp loss = 0.201  adjusted loss = 0.201  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 511]:	loss = 0.150  exp loss = 0.150  adjusted loss = 0.150  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 347]:	loss = 0.141  exp loss = 0.138  adjusted loss = 0.138  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1169]:	loss = 0.156  exp loss = 0.152  adjusted loss = 0.152  adv prob = 0.250000   acc = 0.998

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_34.csv
logged to wandb
Average incurred loss: 0.310  
Average sample loss: 0.309  
Average acc: 0.907  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.236  exp loss = 0.247  adjusted loss = 0.247  adv prob = 0.250000   acc = 0.955
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.366  exp loss = 0.398  adjusted loss = 0.398  adv prob = 0.250000   acc = 0.876
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.427  exp loss = 0.465  adjusted loss = 0.465  adv prob = 0.250000   acc = 0.820
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.255  exp loss = 0.245  adjusted loss = 0.245  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.113
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_34.csv
logged to wandb
Current lr: 0.000010


Epoch [35]:
Training:
Average incurred loss: 0.164  
Average sample loss: 0.164  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 665]:	loss = 0.212  exp loss = 0.205  adjusted loss = 0.205  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 0, forest2water2 = 1  [n = 666]:	loss = 0.158  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 419]:	loss = 0.140  exp loss = 0.131  adjusted loss = 0.131  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1450]:	loss = 0.153  exp loss = 0.147  adjusted loss = 0.147  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.166  
Average sample loss: 0.166  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 679]:	loss = 0.209  exp loss = 0.215  adjusted loss = 0.215  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 657]:	loss = 0.167  exp loss = 0.164  adjusted loss = 0.164  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 1, forest2water2 = 0  [n = 469]:	loss = 0.141  exp loss = 0.137  adjusted loss = 0.137  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1395]:	loss = 0.153  exp loss = 0.150  adjusted loss = 0.150  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.170  
Average sample loss: 0.170  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 643]:	loss = 0.220  exp loss = 0.200  adjusted loss = 0.200  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 0, forest2water2 = 1  [n = 649]:	loss = 0.150  exp loss = 0.136  adjusted loss = 0.136  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 451]:	loss = 0.140  exp loss = 0.146  adjusted loss = 0.146  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1457]:	loss = 0.166  exp loss = 0.163  adjusted loss = 0.163  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.169  
Average sample loss: 0.169  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 714]:	loss = 0.227  exp loss = 0.214  adjusted loss = 0.214  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.166  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 443]:	loss = 0.133  exp loss = 0.131  adjusted loss = 0.131  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1383]:	loss = 0.152  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.166  
Average sample loss: 0.166  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 638]:	loss = 0.212  exp loss = 0.208  adjusted loss = 0.208  adv prob = 0.250000   acc = 0.967
  waterbird_complete95 = 0, forest2water2 = 1  [n = 664]:	loss = 0.155  exp loss = 0.150  adjusted loss = 0.150  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 454]:	loss = 0.148  exp loss = 0.142  adjusted loss = 0.142  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1444]:	loss = 0.157  exp loss = 0.153  adjusted loss = 0.153  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_35.csv
logged to wandb
Average incurred loss: 0.170  
Average sample loss: 0.170  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 509]:	loss = 0.219  exp loss = 0.214  adjusted loss = 0.214  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 0, forest2water2 = 1  [n = 538]:	loss = 0.159  exp loss = 0.141  adjusted loss = 0.141  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 370]:	loss = 0.145  exp loss = 0.150  adjusted loss = 0.150  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1128]:	loss = 0.161  exp loss = 0.161  adjusted loss = 0.161  adv prob = 0.250000   acc = 0.997

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_35.csv
logged to wandb
Average incurred loss: 0.298  
Average sample loss: 0.297  
Average acc: 0.917  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.217  exp loss = 0.227  adjusted loss = 0.227  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.341  exp loss = 0.370  adjusted loss = 0.370  adv prob = 0.250000   acc = 0.895
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.458  exp loss = 0.497  adjusted loss = 0.497  adv prob = 0.250000   acc = 0.812
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.271  exp loss = 0.260  adjusted loss = 0.260  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.111
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_35.csv
logged to wandb
Current lr: 0.000010


Epoch [36]:
Training:
Average incurred loss: 0.167  
Average sample loss: 0.167  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 659]:	loss = 0.217  exp loss = 0.203  adjusted loss = 0.203  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 676]:	loss = 0.159  exp loss = 0.151  adjusted loss = 0.151  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 460]:	loss = 0.143  exp loss = 0.145  adjusted loss = 0.145  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1405]:	loss = 0.155  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.167  
Average sample loss: 0.167  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 642]:	loss = 0.220  exp loss = 0.226  adjusted loss = 0.226  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 0, forest2water2 = 1  [n = 691]:	loss = 0.160  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 451]:	loss = 0.143  exp loss = 0.130  adjusted loss = 0.130  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1416]:	loss = 0.154  exp loss = 0.148  adjusted loss = 0.148  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.168  
Average sample loss: 0.168  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 677]:	loss = 0.212  exp loss = 0.219  adjusted loss = 0.219  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 636]:	loss = 0.155  exp loss = 0.147  adjusted loss = 0.147  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.141  exp loss = 0.138  adjusted loss = 0.138  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1447]:	loss = 0.162  exp loss = 0.161  adjusted loss = 0.161  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.171  
Average sample loss: 0.171  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.223  exp loss = 0.221  adjusted loss = 0.221  adv prob = 0.250000   acc = 0.955
  waterbird_complete95 = 0, forest2water2 = 1  [n = 670]:	loss = 0.162  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 451]:	loss = 0.147  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1411]:	loss = 0.158  exp loss = 0.154  adjusted loss = 0.154  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.167  
Average sample loss: 0.167  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 669]:	loss = 0.207  exp loss = 0.193  adjusted loss = 0.193  adv prob = 0.250000   acc = 0.973
  waterbird_complete95 = 0, forest2water2 = 1  [n = 644]:	loss = 0.157  exp loss = 0.154  adjusted loss = 0.154  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 432]:	loss = 0.145  exp loss = 0.146  adjusted loss = 0.146  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1455]:	loss = 0.160  exp loss = 0.160  adjusted loss = 0.160  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_36.csv
logged to wandb
Average incurred loss: 0.169  
Average sample loss: 0.169  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 533]:	loss = 0.211  exp loss = 0.225  adjusted loss = 0.225  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 517]:	loss = 0.159  exp loss = 0.169  adjusted loss = 0.169  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 372]:	loss = 0.143  exp loss = 0.131  adjusted loss = 0.131  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1123]:	loss = 0.162  exp loss = 0.157  adjusted loss = 0.157  adv prob = 0.250000   acc = 0.995

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_36.csv
logged to wandb
Average incurred loss: 0.321  
Average sample loss: 0.320  
Average acc: 0.903  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.249  exp loss = 0.260  adjusted loss = 0.260  adv prob = 0.250000   acc = 0.951
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.391  exp loss = 0.423  adjusted loss = 0.423  adv prob = 0.250000   acc = 0.867
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.410  exp loss = 0.441  adjusted loss = 0.441  adv prob = 0.250000   acc = 0.835
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.242  exp loss = 0.232  adjusted loss = 0.232  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.107
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_36.csv
logged to wandb
Current lr: 0.000010


Epoch [37]:
Training:
Average incurred loss: 0.168  
Average sample loss: 0.168  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 654]:	loss = 0.212  exp loss = 0.222  adjusted loss = 0.222  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 689]:	loss = 0.163  exp loss = 0.159  adjusted loss = 0.159  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 435]:	loss = 0.142  exp loss = 0.138  adjusted loss = 0.138  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1422]:	loss = 0.158  exp loss = 0.151  adjusted loss = 0.151  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.172  
Average sample loss: 0.172  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 665]:	loss = 0.220  exp loss = 0.183  adjusted loss = 0.183  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 666]:	loss = 0.164  exp loss = 0.159  adjusted loss = 0.159  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 442]:	loss = 0.153  exp loss = 0.150  adjusted loss = 0.150  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1427]:	loss = 0.160  exp loss = 0.164  adjusted loss = 0.164  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.169  
Average sample loss: 0.169  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 649]:	loss = 0.205  exp loss = 0.187  adjusted loss = 0.187  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 647]:	loss = 0.157  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.149  exp loss = 0.150  adjusted loss = 0.150  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1446]:	loss = 0.165  exp loss = 0.169  adjusted loss = 0.169  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.173  
Average sample loss: 0.173  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 667]:	loss = 0.219  exp loss = 0.216  adjusted loss = 0.216  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 0, forest2water2 = 1  [n = 664]:	loss = 0.164  exp loss = 0.168  adjusted loss = 0.168  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 468]:	loss = 0.146  exp loss = 0.138  adjusted loss = 0.138  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1401]:	loss = 0.163  exp loss = 0.154  adjusted loss = 0.154  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.167  
Average sample loss: 0.167  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 672]:	loss = 0.197  exp loss = 0.201  adjusted loss = 0.201  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 646]:	loss = 0.165  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 452]:	loss = 0.149  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1430]:	loss = 0.160  exp loss = 0.154  adjusted loss = 0.154  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_37.csv
logged to wandb
Average incurred loss: 0.173  
Average sample loss: 0.173  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 541]:	loss = 0.220  exp loss = 0.210  adjusted loss = 0.210  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 0, forest2water2 = 1  [n = 522]:	loss = 0.163  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 351]:	loss = 0.148  exp loss = 0.147  adjusted loss = 0.147  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1131]:	loss = 0.162  exp loss = 0.157  adjusted loss = 0.157  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_37.csv
logged to wandb
Average incurred loss: 0.311  
Average sample loss: 0.310  
Average acc: 0.912  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.234  exp loss = 0.245  adjusted loss = 0.245  adv prob = 0.250000   acc = 0.959
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.366  exp loss = 0.396  adjusted loss = 0.396  adv prob = 0.250000   acc = 0.886
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.441  exp loss = 0.474  adjusted loss = 0.474  adv prob = 0.250000   acc = 0.812
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.260  exp loss = 0.250  adjusted loss = 0.250  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.114
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_37.csv
logged to wandb
Current lr: 0.000010


Epoch [38]:
Training:
Average incurred loss: 0.173  
Average sample loss: 0.173  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 620]:	loss = 0.205  exp loss = 0.196  adjusted loss = 0.196  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 635]:	loss = 0.153  exp loss = 0.153  adjusted loss = 0.153  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 483]:	loss = 0.158  exp loss = 0.150  adjusted loss = 0.150  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1462]:	loss = 0.172  exp loss = 0.163  adjusted loss = 0.163  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.174  
Average sample loss: 0.174  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 690]:	loss = 0.222  exp loss = 0.219  adjusted loss = 0.219  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 655]:	loss = 0.169  exp loss = 0.169  adjusted loss = 0.169  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 460]:	loss = 0.154  exp loss = 0.144  adjusted loss = 0.144  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1395]:	loss = 0.160  exp loss = 0.154  adjusted loss = 0.154  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.171  
Average sample loss: 0.171  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 646]:	loss = 0.213  exp loss = 0.213  adjusted loss = 0.213  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 676]:	loss = 0.161  exp loss = 0.161  adjusted loss = 0.161  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 436]:	loss = 0.151  exp loss = 0.151  adjusted loss = 0.151  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1442]:	loss = 0.162  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.173  
Average sample loss: 0.173  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 671]:	loss = 0.225  exp loss = 0.197  adjusted loss = 0.197  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 666]:	loss = 0.158  exp loss = 0.150  adjusted loss = 0.150  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 414]:	loss = 0.150  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1449]:	loss = 0.162  exp loss = 0.161  adjusted loss = 0.161  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.176  
Average sample loss: 0.176  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 698]:	loss = 0.218  exp loss = 0.211  adjusted loss = 0.211  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 0, forest2water2 = 1  [n = 653]:	loss = 0.170  exp loss = 0.164  adjusted loss = 0.164  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 455]:	loss = 0.152  exp loss = 0.146  adjusted loss = 0.146  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1394]:	loss = 0.165  exp loss = 0.163  adjusted loss = 0.163  adv prob = 0.250000   acc = 0.996
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_38.csv
logged to wandb
Average incurred loss: 0.173  
Average sample loss: 0.173  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 523]:	loss = 0.208  exp loss = 0.194  adjusted loss = 0.194  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 549]:	loss = 0.171  exp loss = 0.178  adjusted loss = 0.178  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 358]:	loss = 0.147  exp loss = 0.140  adjusted loss = 0.140  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1115]:	loss = 0.166  exp loss = 0.161  adjusted loss = 0.161  adv prob = 0.250000   acc = 0.995

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_38.csv
logged to wandb
Average incurred loss: 0.320  
Average sample loss: 0.319  
Average acc: 0.908  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.245  exp loss = 0.256  adjusted loss = 0.256  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.380  exp loss = 0.410  adjusted loss = 0.410  adv prob = 0.250000   acc = 0.880
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.433  exp loss = 0.460  adjusted loss = 0.460  adv prob = 0.250000   acc = 0.812
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.257  exp loss = 0.248  adjusted loss = 0.248  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.117
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_38.csv
logged to wandb
Current lr: 0.000010


Epoch [39]:
Training:
Average incurred loss: 0.170  
Average sample loss: 0.170  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 637]:	loss = 0.200  exp loss = 0.200  adjusted loss = 0.200  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 676]:	loss = 0.164  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 430]:	loss = 0.155  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1457]:	loss = 0.164  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.175  
Average sample loss: 0.175  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 672]:	loss = 0.213  exp loss = 0.203  adjusted loss = 0.203  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.167  exp loss = 0.153  adjusted loss = 0.153  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 459]:	loss = 0.153  exp loss = 0.159  adjusted loss = 0.159  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1409]:	loss = 0.168  exp loss = 0.171  adjusted loss = 0.171  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.176  
Average sample loss: 0.176  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.220  exp loss = 0.228  adjusted loss = 0.228  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 646]:	loss = 0.158  exp loss = 0.155  adjusted loss = 0.155  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 449]:	loss = 0.156  exp loss = 0.149  adjusted loss = 0.149  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1435]:	loss = 0.169  exp loss = 0.164  adjusted loss = 0.164  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.174  
Average sample loss: 0.174  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 646]:	loss = 0.210  exp loss = 0.229  adjusted loss = 0.229  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 0, forest2water2 = 1  [n = 668]:	loss = 0.163  exp loss = 0.168  adjusted loss = 0.168  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 449]:	loss = 0.160  exp loss = 0.151  adjusted loss = 0.151  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1437]:	loss = 0.167  exp loss = 0.159  adjusted loss = 0.159  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.180  
Average sample loss: 0.180  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 702]:	loss = 0.224  exp loss = 0.226  adjusted loss = 0.226  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 0, forest2water2 = 1  [n = 652]:	loss = 0.174  exp loss = 0.181  adjusted loss = 0.181  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.155  exp loss = 0.143  adjusted loss = 0.143  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1398]:	loss = 0.169  exp loss = 0.161  adjusted loss = 0.161  adv prob = 0.250000   acc = 0.994
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_39.csv
logged to wandb
Average incurred loss: 0.181  
Average sample loss: 0.181  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 521]:	loss = 0.222  exp loss = 0.215  adjusted loss = 0.215  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 532]:	loss = 0.168  exp loss = 0.150  adjusted loss = 0.150  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 371]:	loss = 0.161  exp loss = 0.164  adjusted loss = 0.164  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1121]:	loss = 0.174  exp loss = 0.179  adjusted loss = 0.179  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_39.csv
logged to wandb
Average incurred loss: 0.304  
Average sample loss: 0.303  
Average acc: 0.918  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.219  exp loss = 0.229  adjusted loss = 0.229  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.343  exp loss = 0.370  adjusted loss = 0.370  adv prob = 0.250000   acc = 0.901
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.482  exp loss = 0.515  adjusted loss = 0.515  adv prob = 0.250000   acc = 0.789
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.285  exp loss = 0.276  adjusted loss = 0.276  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.124
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_39.csv
logged to wandb
Current lr: 0.000010


Epoch [40]:
Training:
Average incurred loss: 0.180  
Average sample loss: 0.180  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 657]:	loss = 0.212  exp loss = 0.216  adjusted loss = 0.216  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 646]:	loss = 0.168  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 460]:	loss = 0.163  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1437]:	loss = 0.176  exp loss = 0.169  adjusted loss = 0.169  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.179  
Average sample loss: 0.179  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 643]:	loss = 0.210  exp loss = 0.212  adjusted loss = 0.212  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 644]:	loss = 0.162  exp loss = 0.170  adjusted loss = 0.170  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 471]:	loss = 0.165  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1442]:	loss = 0.177  exp loss = 0.168  adjusted loss = 0.168  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.182  
Average sample loss: 0.182  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.214  exp loss = 0.196  adjusted loss = 0.196  adv prob = 0.250000   acc = 0.973
  waterbird_complete95 = 0, forest2water2 = 1  [n = 656]:	loss = 0.175  exp loss = 0.158  adjusted loss = 0.158  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 460]:	loss = 0.163  exp loss = 0.167  adjusted loss = 0.167  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1416]:	loss = 0.177  exp loss = 0.182  adjusted loss = 0.182  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.180  
Average sample loss: 0.180  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 644]:	loss = 0.225  exp loss = 0.221  adjusted loss = 0.221  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 0, forest2water2 = 1  [n = 724]:	loss = 0.179  exp loss = 0.169  adjusted loss = 0.169  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 447]:	loss = 0.157  exp loss = 0.163  adjusted loss = 0.163  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1385]:	loss = 0.168  exp loss = 0.173  adjusted loss = 0.173  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.183  
Average sample loss: 0.183  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 682]:	loss = 0.220  exp loss = 0.214  adjusted loss = 0.214  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 643]:	loss = 0.172  exp loss = 0.166  adjusted loss = 0.166  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 435]:	loss = 0.164  exp loss = 0.160  adjusted loss = 0.160  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1440]:	loss = 0.176  exp loss = 0.168  adjusted loss = 0.168  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_40.csv
logged to wandb
Average incurred loss: 0.184  
Average sample loss: 0.184  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 554]:	loss = 0.233  exp loss = 0.228  adjusted loss = 0.228  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 521]:	loss = 0.171  exp loss = 0.166  adjusted loss = 0.166  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 333]:	loss = 0.161  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1137]:	loss = 0.172  exp loss = 0.168  adjusted loss = 0.168  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_40.csv
logged to wandb
Average incurred loss: 0.317  
Average sample loss: 0.316  
Average acc: 0.914  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.240  exp loss = 0.251  adjusted loss = 0.251  adv prob = 0.250000   acc = 0.961
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.368  exp loss = 0.396  adjusted loss = 0.396  adv prob = 0.250000   acc = 0.893
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.455  exp loss = 0.479  adjusted loss = 0.479  adv prob = 0.250000   acc = 0.805
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.272  exp loss = 0.264  adjusted loss = 0.264  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.116
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_40.csv
logged to wandb
Current lr: 0.000010


Epoch [41]:
Training:
Average incurred loss: 0.180  
Average sample loss: 0.180  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 663]:	loss = 0.204  exp loss = 0.184  adjusted loss = 0.184  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 661]:	loss = 0.175  exp loss = 0.156  adjusted loss = 0.156  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.165  exp loss = 0.170  adjusted loss = 0.170  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1435]:	loss = 0.175  exp loss = 0.180  adjusted loss = 0.180  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.187  
Average sample loss: 0.187  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 626]:	loss = 0.224  exp loss = 0.225  adjusted loss = 0.225  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 0, forest2water2 = 1  [n = 697]:	loss = 0.178  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 437]:	loss = 0.170  exp loss = 0.167  adjusted loss = 0.167  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1440]:	loss = 0.180  exp loss = 0.180  adjusted loss = 0.180  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.186  
Average sample loss: 0.186  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 675]:	loss = 0.223  exp loss = 0.222  adjusted loss = 0.222  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 646]:	loss = 0.173  exp loss = 0.176  adjusted loss = 0.176  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.168  exp loss = 0.168  adjusted loss = 0.168  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1421]:	loss = 0.180  exp loss = 0.173  adjusted loss = 0.173  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.187  
Average sample loss: 0.187  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 682]:	loss = 0.222  exp loss = 0.201  adjusted loss = 0.201  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 644]:	loss = 0.174  exp loss = 0.154  adjusted loss = 0.154  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 442]:	loss = 0.172  exp loss = 0.178  adjusted loss = 0.178  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1432]:	loss = 0.180  exp loss = 0.191  adjusted loss = 0.191  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.187  
Average sample loss: 0.187  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.227  exp loss = 0.219  adjusted loss = 0.219  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 661]:	loss = 0.174  exp loss = 0.164  adjusted loss = 0.164  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 457]:	loss = 0.169  exp loss = 0.172  adjusted loss = 0.172  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1414]:	loss = 0.180  exp loss = 0.183  adjusted loss = 0.183  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_41.csv
logged to wandb
Average incurred loss: 0.189  
Average sample loss: 0.188  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 534]:	loss = 0.229  exp loss = 0.229  adjusted loss = 0.229  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 525]:	loss = 0.176  exp loss = 0.173  adjusted loss = 0.173  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 371]:	loss = 0.168  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1115]:	loss = 0.182  exp loss = 0.179  adjusted loss = 0.179  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_41.csv
logged to wandb
Average incurred loss: 0.319  
Average sample loss: 0.319  
Average acc: 0.914  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.243  exp loss = 0.254  adjusted loss = 0.254  adv prob = 0.250000   acc = 0.961
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.367  exp loss = 0.394  adjusted loss = 0.394  adv prob = 0.250000   acc = 0.893
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.459  exp loss = 0.479  adjusted loss = 0.479  adv prob = 0.250000   acc = 0.805
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.281  exp loss = 0.272  adjusted loss = 0.272  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.116
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_41.csv
logged to wandb
Current lr: 0.000010


Epoch [42]:
Training:
Average incurred loss: 0.188  
Average sample loss: 0.188  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 691]:	loss = 0.220  exp loss = 0.228  adjusted loss = 0.228  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 627]:	loss = 0.173  exp loss = 0.172  adjusted loss = 0.172  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.171  exp loss = 0.169  adjusted loss = 0.169  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1434]:	loss = 0.184  exp loss = 0.179  adjusted loss = 0.179  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.189  
Average sample loss: 0.189  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 647]:	loss = 0.216  exp loss = 0.217  adjusted loss = 0.217  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 641]:	loss = 0.171  exp loss = 0.165  adjusted loss = 0.165  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.175  exp loss = 0.174  adjusted loss = 0.174  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1454]:	loss = 0.188  exp loss = 0.188  adjusted loss = 0.188  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.188  
Average sample loss: 0.188  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 633]:	loss = 0.219  exp loss = 0.216  adjusted loss = 0.216  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 718]:	loss = 0.188  exp loss = 0.193  adjusted loss = 0.193  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 464]:	loss = 0.169  exp loss = 0.161  adjusted loss = 0.161  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1385]:	loss = 0.181  exp loss = 0.170  adjusted loss = 0.170  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.191  
Average sample loss: 0.191  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 663]:	loss = 0.224  exp loss = 0.225  adjusted loss = 0.225  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 0, forest2water2 = 1  [n = 647]:	loss = 0.176  exp loss = 0.173  adjusted loss = 0.173  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.178  exp loss = 0.170  adjusted loss = 0.170  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1424]:	loss = 0.187  exp loss = 0.179  adjusted loss = 0.179  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.190  
Average sample loss: 0.190  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 673]:	loss = 0.225  exp loss = 0.216  adjusted loss = 0.216  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 671]:	loss = 0.182  exp loss = 0.176  adjusted loss = 0.176  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 421]:	loss = 0.176  exp loss = 0.177  adjusted loss = 0.177  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1435]:	loss = 0.182  exp loss = 0.186  adjusted loss = 0.186  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_42.csv
logged to wandb
Average incurred loss: 0.193  
Average sample loss: 0.193  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 541]:	loss = 0.228  exp loss = 0.219  adjusted loss = 0.219  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 530]:	loss = 0.186  exp loss = 0.182  adjusted loss = 0.182  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 349]:	loss = 0.175  exp loss = 0.168  adjusted loss = 0.168  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1125]:	loss = 0.184  exp loss = 0.181  adjusted loss = 0.181  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_42.csv
logged to wandb
Average incurred loss: 0.328  
Average sample loss: 0.327  
Average acc: 0.912  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.252  exp loss = 0.263  adjusted loss = 0.263  adv prob = 0.250000   acc = 0.959
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.379  exp loss = 0.405  adjusted loss = 0.405  adv prob = 0.250000   acc = 0.888
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.458  exp loss = 0.475  adjusted loss = 0.475  adv prob = 0.250000   acc = 0.805
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.283  exp loss = 0.275  adjusted loss = 0.275  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.117
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_42.csv
logged to wandb
Current lr: 0.000010


Epoch [43]:
Training:
Average incurred loss: 0.195  
Average sample loss: 0.195  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 655]:	loss = 0.213  exp loss = 0.204  adjusted loss = 0.204  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 0, forest2water2 = 1  [n = 624]:	loss = 0.176  exp loss = 0.166  adjusted loss = 0.166  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 452]:	loss = 0.185  exp loss = 0.191  adjusted loss = 0.191  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1469]:	loss = 0.197  exp loss = 0.197  adjusted loss = 0.197  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.194  
Average sample loss: 0.194  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 638]:	loss = 0.224  exp loss = 0.206  adjusted loss = 0.206  adv prob = 0.250000   acc = 0.980
  waterbird_complete95 = 0, forest2water2 = 1  [n = 675]:	loss = 0.181  exp loss = 0.173  adjusted loss = 0.173  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.181  exp loss = 0.182  adjusted loss = 0.182  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1439]:	loss = 0.191  exp loss = 0.192  adjusted loss = 0.192  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.194  
Average sample loss: 0.194  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 667]:	loss = 0.228  exp loss = 0.233  adjusted loss = 0.233  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 691]:	loss = 0.191  exp loss = 0.192  adjusted loss = 0.192  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 413]:	loss = 0.175  exp loss = 0.170  adjusted loss = 0.170  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1429]:	loss = 0.186  exp loss = 0.181  adjusted loss = 0.181  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.195  
Average sample loss: 0.195  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 690]:	loss = 0.234  exp loss = 0.236  adjusted loss = 0.236  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 667]:	loss = 0.188  exp loss = 0.176  adjusted loss = 0.176  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 455]:	loss = 0.178  exp loss = 0.180  adjusted loss = 0.180  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1388]:	loss = 0.185  exp loss = 0.188  adjusted loss = 0.188  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.200  
Average sample loss: 0.200  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 669]:	loss = 0.231  exp loss = 0.223  adjusted loss = 0.223  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 645]:	loss = 0.183  exp loss = 0.173  adjusted loss = 0.173  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 444]:	loss = 0.184  exp loss = 0.183  adjusted loss = 0.183  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1442]:	loss = 0.198  exp loss = 0.198  adjusted loss = 0.198  adv prob = 0.250000   acc = 0.996
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_43.csv
logged to wandb
Average incurred loss: 0.199  
Average sample loss: 0.199  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 529]:	loss = 0.226  exp loss = 0.233  adjusted loss = 0.233  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 0, forest2water2 = 1  [n = 532]:	loss = 0.192  exp loss = 0.189  adjusted loss = 0.189  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 394]:	loss = 0.182  exp loss = 0.180  adjusted loss = 0.180  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1090]:	loss = 0.195  exp loss = 0.182  adjusted loss = 0.182  adv prob = 0.250000   acc = 0.997

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_43.csv
logged to wandb
Average incurred loss: 0.334  
Average sample loss: 0.333  
Average acc: 0.914  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.259  exp loss = 0.269  adjusted loss = 0.269  adv prob = 0.250000   acc = 0.961
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.388  exp loss = 0.413  adjusted loss = 0.413  adv prob = 0.250000   acc = 0.886
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.459  exp loss = 0.474  adjusted loss = 0.474  adv prob = 0.250000   acc = 0.827
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.284  exp loss = 0.278  adjusted loss = 0.278  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.105
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_43.csv
logged to wandb
Current lr: 0.000010


Epoch [44]:
Training:
Average incurred loss: 0.200  
Average sample loss: 0.200  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 624]:	loss = 0.230  exp loss = 0.224  adjusted loss = 0.224  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 664]:	loss = 0.177  exp loss = 0.170  adjusted loss = 0.170  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 467]:	loss = 0.187  exp loss = 0.186  adjusted loss = 0.186  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1445]:	loss = 0.202  exp loss = 0.199  adjusted loss = 0.199  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.202  
Average sample loss: 0.202  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 706]:	loss = 0.241  exp loss = 0.231  adjusted loss = 0.231  adv prob = 0.250000   acc = 0.990
  waterbird_complete95 = 0, forest2water2 = 1  [n = 668]:	loss = 0.196  exp loss = 0.189  adjusted loss = 0.189  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 435]:	loss = 0.184  exp loss = 0.181  adjusted loss = 0.181  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1391]:	loss = 0.190  exp loss = 0.190  adjusted loss = 0.190  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.203  
Average sample loss: 0.203  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 669]:	loss = 0.235  exp loss = 0.230  adjusted loss = 0.230  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 658]:	loss = 0.191  exp loss = 0.192  adjusted loss = 0.192  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 433]:	loss = 0.190  exp loss = 0.180  adjusted loss = 0.180  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1440]:	loss = 0.197  exp loss = 0.190  adjusted loss = 0.190  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.204  
Average sample loss: 0.204  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 635]:	loss = 0.236  exp loss = 0.224  adjusted loss = 0.224  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 698]:	loss = 0.192  exp loss = 0.182  adjusted loss = 0.182  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 453]:	loss = 0.192  exp loss = 0.191  adjusted loss = 0.191  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1414]:	loss = 0.200  exp loss = 0.200  adjusted loss = 0.200  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.204  
Average sample loss: 0.204  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 700]:	loss = 0.234  exp loss = 0.224  adjusted loss = 0.224  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 654]:	loss = 0.200  exp loss = 0.190  adjusted loss = 0.190  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 454]:	loss = 0.189  exp loss = 0.189  adjusted loss = 0.189  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1392]:	loss = 0.197  exp loss = 0.198  adjusted loss = 0.198  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_44.csv
logged to wandb
Average incurred loss: 0.208  
Average sample loss: 0.208  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 514]:	loss = 0.222  exp loss = 0.215  adjusted loss = 0.215  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 492]:	loss = 0.185  exp loss = 0.176  adjusted loss = 0.176  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 364]:	loss = 0.201  exp loss = 0.204  adjusted loss = 0.204  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1175]:	loss = 0.214  exp loss = 0.215  adjusted loss = 0.215  adv prob = 0.250000   acc = 0.993

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_44.csv
logged to wandb
Average incurred loss: 0.321  
Average sample loss: 0.320  
Average acc: 0.914  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.237  exp loss = 0.247  adjusted loss = 0.247  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.352  exp loss = 0.375  adjusted loss = 0.375  adv prob = 0.250000   acc = 0.903
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.507  exp loss = 0.526  adjusted loss = 0.526  adv prob = 0.250000   acc = 0.752
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.319  exp loss = 0.314  adjusted loss = 0.314  adv prob = 0.250000   acc = 0.917
Spurious Score = 1.140
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_44.csv
logged to wandb
Current lr: 0.000010


Epoch [45]:
Training:
Average incurred loss: 0.206  
Average sample loss: 0.206  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 700]:	loss = 0.234  exp loss = 0.238  adjusted loss = 0.238  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 632]:	loss = 0.194  exp loss = 0.198  adjusted loss = 0.198  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.192  exp loss = 0.185  adjusted loss = 0.185  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1427]:	loss = 0.203  exp loss = 0.191  adjusted loss = 0.191  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.206  
Average sample loss: 0.206  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 626]:	loss = 0.226  exp loss = 0.237  adjusted loss = 0.237  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 0, forest2water2 = 1  [n = 675]:	loss = 0.191  exp loss = 0.193  adjusted loss = 0.193  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 459]:	loss = 0.196  exp loss = 0.190  adjusted loss = 0.190  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1440]:	loss = 0.206  exp loss = 0.203  adjusted loss = 0.203  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.209  
Average sample loss: 0.209  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 638]:	loss = 0.235  exp loss = 0.237  adjusted loss = 0.237  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 682]:	loss = 0.198  exp loss = 0.189  adjusted loss = 0.189  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 449]:	loss = 0.199  exp loss = 0.200  adjusted loss = 0.200  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1431]:	loss = 0.207  exp loss = 0.209  adjusted loss = 0.209  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.210  
Average sample loss: 0.210  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 673]:	loss = 0.234  exp loss = 0.239  adjusted loss = 0.239  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 0, forest2water2 = 1  [n = 647]:	loss = 0.199  exp loss = 0.204  adjusted loss = 0.204  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 455]:	loss = 0.199  exp loss = 0.196  adjusted loss = 0.196  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1425]:	loss = 0.207  exp loss = 0.198  adjusted loss = 0.198  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.215  
Average sample loss: 0.215  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 665]:	loss = 0.249  exp loss = 0.236  adjusted loss = 0.236  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 670]:	loss = 0.201  exp loss = 0.197  adjusted loss = 0.197  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 453]:	loss = 0.200  exp loss = 0.200  adjusted loss = 0.200  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1412]:	loss = 0.210  exp loss = 0.212  adjusted loss = 0.212  adv prob = 0.250000   acc = 0.996
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_45.csv
logged to wandb
Average incurred loss: 0.214  
Average sample loss: 0.214  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 546]:	loss = 0.255  exp loss = 0.254  adjusted loss = 0.254  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 528]:	loss = 0.197  exp loss = 0.204  adjusted loss = 0.204  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 349]:	loss = 0.199  exp loss = 0.193  adjusted loss = 0.193  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1122]:	loss = 0.206  exp loss = 0.196  adjusted loss = 0.196  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_45.csv
logged to wandb
Average incurred loss: 0.346  
Average sample loss: 0.346  
Average acc: 0.907  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.273  exp loss = 0.285  adjusted loss = 0.285  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.401  exp loss = 0.424  adjusted loss = 0.424  adv prob = 0.250000   acc = 0.869
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.463  exp loss = 0.469  adjusted loss = 0.469  adv prob = 0.250000   acc = 0.835
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.296  exp loss = 0.292  adjusted loss = 0.292  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.109
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_45.csv
logged to wandb
Current lr: 0.000010


Epoch [46]:
Training:
Average incurred loss: 0.215  
Average sample loss: 0.215  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 633]:	loss = 0.236  exp loss = 0.238  adjusted loss = 0.238  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 656]:	loss = 0.196  exp loss = 0.208  adjusted loss = 0.208  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 480]:	loss = 0.209  exp loss = 0.199  adjusted loss = 0.199  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1431]:	loss = 0.216  exp loss = 0.207  adjusted loss = 0.207  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.217  
Average sample loss: 0.217  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 667]:	loss = 0.250  exp loss = 0.247  adjusted loss = 0.247  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 0, forest2water2 = 1  [n = 675]:	loss = 0.204  exp loss = 0.207  adjusted loss = 0.207  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 430]:	loss = 0.205  exp loss = 0.194  adjusted loss = 0.194  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1428]:	loss = 0.211  exp loss = 0.204  adjusted loss = 0.204  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.218  
Average sample loss: 0.218  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 657]:	loss = 0.247  exp loss = 0.236  adjusted loss = 0.236  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 0, forest2water2 = 1  [n = 663]:	loss = 0.202  exp loss = 0.193  adjusted loss = 0.193  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 461]:	loss = 0.208  exp loss = 0.207  adjusted loss = 0.207  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1419]:	loss = 0.216  exp loss = 0.217  adjusted loss = 0.217  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.218  
Average sample loss: 0.218  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 681]:	loss = 0.243  exp loss = 0.251  adjusted loss = 0.251  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 662]:	loss = 0.209  exp loss = 0.219  adjusted loss = 0.219  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 435]:	loss = 0.206  exp loss = 0.193  adjusted loss = 0.193  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1422]:	loss = 0.213  exp loss = 0.201  adjusted loss = 0.201  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.225  
Average sample loss: 0.225  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 683]:	loss = 0.261  exp loss = 0.247  adjusted loss = 0.247  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 0, forest2water2 = 1  [n = 670]:	loss = 0.213  exp loss = 0.201  adjusted loss = 0.201  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 443]:	loss = 0.208  exp loss = 0.211  adjusted loss = 0.211  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1404]:	loss = 0.218  exp loss = 0.221  adjusted loss = 0.221  adv prob = 0.250000   acc = 0.994
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_46.csv
logged to wandb
Average incurred loss: 0.222  
Average sample loss: 0.222  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 527]:	loss = 0.246  exp loss = 0.242  adjusted loss = 0.242  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 508]:	loss = 0.202  exp loss = 0.194  adjusted loss = 0.194  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 357]:	loss = 0.212  exp loss = 0.220  adjusted loss = 0.220  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1153]:	loss = 0.223  exp loss = 0.226  adjusted loss = 0.226  adv prob = 0.250000   acc = 0.997

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_46.csv
logged to wandb
Average incurred loss: 0.338  
Average sample loss: 0.337  
Average acc: 0.909  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.257  exp loss = 0.269  adjusted loss = 0.269  adv prob = 0.250000   acc = 0.966
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.373  exp loss = 0.395  adjusted loss = 0.395  adv prob = 0.250000   acc = 0.891
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.507  exp loss = 0.514  adjusted loss = 0.514  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.331  exp loss = 0.328  adjusted loss = 0.328  adv prob = 0.250000   acc = 0.902
Spurious Score = 1.117
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_46.csv
logged to wandb
Current lr: 0.000010


Epoch [47]:
Training:
Average incurred loss: 0.222  
Average sample loss: 0.222  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 607]:	loss = 0.254  exp loss = 0.240  adjusted loss = 0.240  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 0, forest2water2 = 1  [n = 716]:	loss = 0.205  exp loss = 0.199  adjusted loss = 0.199  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 426]:	loss = 0.215  exp loss = 0.217  adjusted loss = 0.217  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1451]:	loss = 0.219  exp loss = 0.224  adjusted loss = 0.224  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.228  
Average sample loss: 0.228  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 713]:	loss = 0.259  exp loss = 0.253  adjusted loss = 0.253  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 0, forest2water2 = 1  [n = 628]:	loss = 0.215  exp loss = 0.215  adjusted loss = 0.215  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 451]:	loss = 0.213  exp loss = 0.205  adjusted loss = 0.205  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1408]:	loss = 0.224  exp loss = 0.217  adjusted loss = 0.217  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.228  
Average sample loss: 0.228  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 694]:	loss = 0.251  exp loss = 0.245  adjusted loss = 0.245  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 626]:	loss = 0.213  exp loss = 0.208  adjusted loss = 0.208  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 469]:	loss = 0.221  exp loss = 0.215  adjusted loss = 0.215  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1411]:	loss = 0.225  exp loss = 0.220  adjusted loss = 0.220  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.230  
Average sample loss: 0.230  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 646]:	loss = 0.254  exp loss = 0.262  adjusted loss = 0.262  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 670]:	loss = 0.213  exp loss = 0.203  adjusted loss = 0.203  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 424]:	loss = 0.216  exp loss = 0.214  adjusted loss = 0.214  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1460]:	loss = 0.232  exp loss = 0.225  adjusted loss = 0.225  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.233  
Average sample loss: 0.233  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 677]:	loss = 0.263  exp loss = 0.262  adjusted loss = 0.262  adv prob = 0.250000   acc = 0.979
  waterbird_complete95 = 0, forest2water2 = 1  [n = 666]:	loss = 0.222  exp loss = 0.224  adjusted loss = 0.224  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 454]:	loss = 0.220  exp loss = 0.213  adjusted loss = 0.213  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1403]:	loss = 0.227  exp loss = 0.224  adjusted loss = 0.224  adv prob = 0.250000   acc = 0.998
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_47.csv
logged to wandb
Average incurred loss: 0.233  
Average sample loss: 0.234  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 511]:	loss = 0.249  exp loss = 0.250  adjusted loss = 0.250  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 528]:	loss = 0.221  exp loss = 0.220  adjusted loss = 0.220  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 382]:	loss = 0.225  exp loss = 0.222  adjusted loss = 0.222  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1124]:	loss = 0.235  exp loss = 0.229  adjusted loss = 0.229  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_47.csv
logged to wandb
Average incurred loss: 0.356  
Average sample loss: 0.355  
Average acc: 0.904  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.282  exp loss = 0.295  adjusted loss = 0.295  adv prob = 0.250000   acc = 0.961
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.400  exp loss = 0.422  adjusted loss = 0.422  adv prob = 0.250000   acc = 0.873
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.490  exp loss = 0.491  adjusted loss = 0.491  adv prob = 0.250000   acc = 0.812
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.328  exp loss = 0.326  adjusted loss = 0.326  adv prob = 0.250000   acc = 0.902
Spurious Score = 1.106
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_47.csv
logged to wandb
Current lr: 0.000010


Epoch [48]:
Training:
Average incurred loss: 0.234  
Average sample loss: 0.234  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 695]:	loss = 0.260  exp loss = 0.257  adjusted loss = 0.257  adv prob = 0.250000   acc = 0.987
  waterbird_complete95 = 0, forest2water2 = 1  [n = 649]:	loss = 0.225  exp loss = 0.219  adjusted loss = 0.219  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.224  exp loss = 0.220  adjusted loss = 0.220  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1416]:	loss = 0.230  exp loss = 0.229  adjusted loss = 0.229  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.236  
Average sample loss: 0.236  
Average acc: 0.995  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 661]:	loss = 0.258  exp loss = 0.263  adjusted loss = 0.263  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 0, forest2water2 = 1  [n = 674]:	loss = 0.224  exp loss = 0.229  adjusted loss = 0.229  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 432]:	loss = 0.222  exp loss = 0.215  adjusted loss = 0.215  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1433]:	loss = 0.235  exp loss = 0.223  adjusted loss = 0.223  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.238  
Average sample loss: 0.238  
Average acc: 0.996  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 649]:	loss = 0.264  exp loss = 0.245  adjusted loss = 0.245  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 676]:	loss = 0.222  exp loss = 0.219  adjusted loss = 0.219  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 479]:	loss = 0.232  exp loss = 0.228  adjusted loss = 0.228  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1396]:	loss = 0.236  exp loss = 0.243  adjusted loss = 0.243  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.245  
Average sample loss: 0.245  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 680]:	loss = 0.274  exp loss = 0.249  adjusted loss = 0.249  adv prob = 0.250000   acc = 0.969
  waterbird_complete95 = 0, forest2water2 = 1  [n = 655]:	loss = 0.230  exp loss = 0.203  adjusted loss = 0.203  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 460]:	loss = 0.235  exp loss = 0.248  adjusted loss = 0.248  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1405]:	loss = 0.241  exp loss = 0.253  adjusted loss = 0.253  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.245  
Average sample loss: 0.245  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 638]:	loss = 0.270  exp loss = 0.262  adjusted loss = 0.262  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 663]:	loss = 0.222  exp loss = 0.214  adjusted loss = 0.214  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 446]:	loss = 0.240  exp loss = 0.239  adjusted loss = 0.239  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1453]:	loss = 0.245  exp loss = 0.244  adjusted loss = 0.244  adv prob = 0.250000   acc = 0.994
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_48.csv
logged to wandb
Average incurred loss: 0.246  
Average sample loss: 0.246  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 525]:	loss = 0.273  exp loss = 0.264  adjusted loss = 0.264  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 0, forest2water2 = 1  [n = 517]:	loss = 0.227  exp loss = 0.219  adjusted loss = 0.219  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 349]:	loss = 0.239  exp loss = 0.241  adjusted loss = 0.241  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1154]:	loss = 0.245  exp loss = 0.246  adjusted loss = 0.246  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_48.csv
logged to wandb
Average incurred loss: 0.357  
Average sample loss: 0.356  
Average acc: 0.907  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.280  exp loss = 0.293  adjusted loss = 0.293  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.393  exp loss = 0.414  adjusted loss = 0.414  adv prob = 0.250000   acc = 0.882
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.508  exp loss = 0.506  adjusted loss = 0.506  adv prob = 0.250000   acc = 0.805
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.351  exp loss = 0.350  adjusted loss = 0.350  adv prob = 0.250000   acc = 0.902
Spurious Score = 1.106
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_48.csv
logged to wandb
Current lr: 0.000010


Epoch [49]:
Training:
Average incurred loss: 0.246  
Average sample loss: 0.246  
Average acc: 0.997  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 603]:	loss = 0.257  exp loss = 0.252  adjusted loss = 0.252  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.219  exp loss = 0.215  adjusted loss = 0.215  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 459]:	loss = 0.247  exp loss = 0.249  adjusted loss = 0.249  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1478]:	loss = 0.252  exp loss = 0.250  adjusted loss = 0.250  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.250  
Average sample loss: 0.250  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 673]:	loss = 0.279  exp loss = 0.265  adjusted loss = 0.265  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 647]:	loss = 0.228  exp loss = 0.223  adjusted loss = 0.223  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 453]:	loss = 0.240  exp loss = 0.237  adjusted loss = 0.237  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1427]:	loss = 0.249  exp loss = 0.253  adjusted loss = 0.253  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.255  
Average sample loss: 0.255  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 689]:	loss = 0.290  exp loss = 0.284  adjusted loss = 0.284  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 671]:	loss = 0.246  exp loss = 0.238  adjusted loss = 0.238  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 438]:	loss = 0.241  exp loss = 0.240  adjusted loss = 0.240  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1402]:	loss = 0.247  exp loss = 0.244  adjusted loss = 0.244  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.256  
Average sample loss: 0.256  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 693]:	loss = 0.275  exp loss = 0.286  adjusted loss = 0.286  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 618]:	loss = 0.238  exp loss = 0.238  adjusted loss = 0.238  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 455]:	loss = 0.247  exp loss = 0.241  adjusted loss = 0.241  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1434]:	loss = 0.257  exp loss = 0.246  adjusted loss = 0.246  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.256  
Average sample loss: 0.256  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 693]:	loss = 0.287  exp loss = 0.300  adjusted loss = 0.300  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 681]:	loss = 0.252  exp loss = 0.255  adjusted loss = 0.255  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.239  exp loss = 0.233  adjusted loss = 0.233  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1386]:	loss = 0.248  exp loss = 0.239  adjusted loss = 0.239  adv prob = 0.250000   acc = 0.998
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_49.csv
logged to wandb
Average incurred loss: 0.259  
Average sample loss: 0.259  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 497]:	loss = 0.282  exp loss = 0.268  adjusted loss = 0.268  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 0, forest2water2 = 1  [n = 557]:	loss = 0.244  exp loss = 0.228  adjusted loss = 0.228  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 361]:	loss = 0.250  exp loss = 0.259  adjusted loss = 0.259  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1130]:	loss = 0.258  exp loss = 0.263  adjusted loss = 0.263  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_49.csv
logged to wandb
Average incurred loss: 0.364  
Average sample loss: 0.364  
Average acc: 0.910  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.289  exp loss = 0.302  adjusted loss = 0.302  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.397  exp loss = 0.417  adjusted loss = 0.417  adv prob = 0.250000   acc = 0.884
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.518  exp loss = 0.515  adjusted loss = 0.515  adv prob = 0.250000   acc = 0.805
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.361  exp loss = 0.361  adjusted loss = 0.361  adv prob = 0.250000   acc = 0.902
Spurious Score = 1.107
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_49.csv
logged to wandb
Current lr: 0.000010


Epoch [50]:
Training:
Average incurred loss: 0.261  
Average sample loss: 0.261  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 646]:	loss = 0.290  exp loss = 0.279  adjusted loss = 0.279  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 691]:	loss = 0.246  exp loss = 0.233  adjusted loss = 0.233  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 443]:	loss = 0.251  exp loss = 0.254  adjusted loss = 0.254  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1420]:	loss = 0.258  exp loss = 0.259  adjusted loss = 0.259  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.263  
Average sample loss: 0.263  
Average acc: 0.994  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 693]:	loss = 0.284  exp loss = 0.290  adjusted loss = 0.290  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 0, forest2water2 = 1  [n = 622]:	loss = 0.245  exp loss = 0.244  adjusted loss = 0.244  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.254  exp loss = 0.255  adjusted loss = 0.255  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1427]:	loss = 0.263  exp loss = 0.258  adjusted loss = 0.258  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.268  
Average sample loss: 0.268  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 674]:	loss = 0.297  exp loss = 0.289  adjusted loss = 0.289  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 0, forest2water2 = 1  [n = 659]:	loss = 0.250  exp loss = 0.243  adjusted loss = 0.243  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 433]:	loss = 0.255  exp loss = 0.253  adjusted loss = 0.253  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1434]:	loss = 0.267  exp loss = 0.266  adjusted loss = 0.266  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.269  
Average sample loss: 0.269  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 658]:	loss = 0.292  exp loss = 0.285  adjusted loss = 0.285  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 657]:	loss = 0.250  exp loss = 0.248  adjusted loss = 0.248  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 447]:	loss = 0.258  exp loss = 0.255  adjusted loss = 0.255  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1438]:	loss = 0.270  exp loss = 0.265  adjusted loss = 0.265  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.269  
Average sample loss: 0.269  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 658]:	loss = 0.293  exp loss = 0.291  adjusted loss = 0.291  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 0, forest2water2 = 1  [n = 682]:	loss = 0.258  exp loss = 0.246  adjusted loss = 0.246  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 455]:	loss = 0.256  exp loss = 0.265  adjusted loss = 0.265  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1405]:	loss = 0.268  exp loss = 0.271  adjusted loss = 0.271  adv prob = 0.250000   acc = 0.994
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_50.csv
logged to wandb
Average incurred loss: 0.272  
Average sample loss: 0.272  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 519]:	loss = 0.294  exp loss = 0.302  adjusted loss = 0.302  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 523]:	loss = 0.253  exp loss = 0.255  adjusted loss = 0.255  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 370]:	loss = 0.264  exp loss = 0.257  adjusted loss = 0.257  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1133]:	loss = 0.273  exp loss = 0.261  adjusted loss = 0.261  adv prob = 0.250000   acc = 0.995

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_50.csv
logged to wandb
Average incurred loss: 0.386  
Average sample loss: 0.385  
Average acc: 0.894  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.318  exp loss = 0.332  adjusted loss = 0.332  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.429  exp loss = 0.448  adjusted loss = 0.448  adv prob = 0.250000   acc = 0.856
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.499  exp loss = 0.490  adjusted loss = 0.490  adv prob = 0.250000   acc = 0.797
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.358  exp loss = 0.359  adjusted loss = 0.359  adv prob = 0.250000   acc = 0.902
Spurious Score = 1.125
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_50.csv
logged to wandb
Current lr: 0.000010


Epoch [51]:
Training:
Average incurred loss: 0.275  
Average sample loss: 0.275  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 634]:	loss = 0.298  exp loss = 0.289  adjusted loss = 0.289  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.251  exp loss = 0.249  adjusted loss = 0.249  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 462]:	loss = 0.264  exp loss = 0.260  adjusted loss = 0.260  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1444]:	loss = 0.280  exp loss = 0.281  adjusted loss = 0.281  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.277  
Average sample loss: 0.277  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 677]:	loss = 0.305  exp loss = 0.290  adjusted loss = 0.290  adv prob = 0.250000   acc = 0.969
  waterbird_complete95 = 0, forest2water2 = 1  [n = 661]:	loss = 0.262  exp loss = 0.260  adjusted loss = 0.260  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 431]:	loss = 0.260  exp loss = 0.260  adjusted loss = 0.260  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1431]:	loss = 0.275  exp loss = 0.278  adjusted loss = 0.278  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.280  
Average sample loss: 0.280  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 674]:	loss = 0.310  exp loss = 0.312  adjusted loss = 0.312  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 678]:	loss = 0.267  exp loss = 0.262  adjusted loss = 0.262  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 470]:	loss = 0.265  exp loss = 0.257  adjusted loss = 0.257  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1378]:	loss = 0.277  exp loss = 0.273  adjusted loss = 0.273  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.284  
Average sample loss: 0.284  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 639]:	loss = 0.303  exp loss = 0.303  adjusted loss = 0.303  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 663]:	loss = 0.267  exp loss = 0.261  adjusted loss = 0.261  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 452]:	loss = 0.276  exp loss = 0.268  adjusted loss = 0.268  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1446]:	loss = 0.287  exp loss = 0.280  adjusted loss = 0.280  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.284  
Average sample loss: 0.284  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 709]:	loss = 0.317  exp loss = 0.313  adjusted loss = 0.313  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 651]:	loss = 0.270  exp loss = 0.270  adjusted loss = 0.270  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 425]:	loss = 0.268  exp loss = 0.268  adjusted loss = 0.268  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1415]:	loss = 0.279  exp loss = 0.275  adjusted loss = 0.275  adv prob = 0.250000   acc = 0.998
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_51.csv
logged to wandb
Average incurred loss: 0.287  
Average sample loss: 0.287  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 515]:	loss = 0.314  exp loss = 0.293  adjusted loss = 0.293  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 521]:	loss = 0.262  exp loss = 0.252  adjusted loss = 0.252  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 366]:	loss = 0.277  exp loss = 0.278  adjusted loss = 0.278  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1143]:	loss = 0.290  exp loss = 0.291  adjusted loss = 0.291  adv prob = 0.250000   acc = 0.997

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_51.csv
logged to wandb
Average incurred loss: 0.389  
Average sample loss: 0.388  
Average acc: 0.897  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.316  exp loss = 0.329  adjusted loss = 0.329  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.422  exp loss = 0.440  adjusted loss = 0.440  adv prob = 0.250000   acc = 0.867
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.528  exp loss = 0.521  adjusted loss = 0.521  adv prob = 0.250000   acc = 0.767
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.386  exp loss = 0.386  adjusted loss = 0.386  adv prob = 0.250000   acc = 0.902
Spurious Score = 1.142
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_51.csv
logged to wandb
Current lr: 0.000010


Epoch [52]:
Training:
Average incurred loss: 0.289  
Average sample loss: 0.289  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 643]:	loss = 0.307  exp loss = 0.305  adjusted loss = 0.305  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 656]:	loss = 0.271  exp loss = 0.273  adjusted loss = 0.273  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 474]:	loss = 0.278  exp loss = 0.274  adjusted loss = 0.274  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1427]:	loss = 0.293  exp loss = 0.286  adjusted loss = 0.286  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.290  
Average sample loss: 0.290  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 694]:	loss = 0.330  exp loss = 0.322  adjusted loss = 0.322  adv prob = 0.250000   acc = 0.973
  waterbird_complete95 = 0, forest2water2 = 1  [n = 698]:	loss = 0.281  exp loss = 0.274  adjusted loss = 0.274  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 406]:	loss = 0.272  exp loss = 0.268  adjusted loss = 0.268  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1402]:	loss = 0.280  exp loss = 0.282  adjusted loss = 0.282  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.295  
Average sample loss: 0.295  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 646]:	loss = 0.317  exp loss = 0.307  adjusted loss = 0.307  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 633]:	loss = 0.265  exp loss = 0.258  adjusted loss = 0.258  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 465]:	loss = 0.287  exp loss = 0.290  adjusted loss = 0.290  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1456]:	loss = 0.301  exp loss = 0.304  adjusted loss = 0.304  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.297  
Average sample loss: 0.297  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 686]:	loss = 0.333  exp loss = 0.324  adjusted loss = 0.324  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 678]:	loss = 0.283  exp loss = 0.278  adjusted loss = 0.278  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.277  exp loss = 0.277  adjusted loss = 0.277  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1395]:	loss = 0.292  exp loss = 0.288  adjusted loss = 0.288  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.298  
Average sample loss: 0.298  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.315  exp loss = 0.328  adjusted loss = 0.328  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 0, forest2water2 = 1  [n = 628]:	loss = 0.280  exp loss = 0.282  adjusted loss = 0.282  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 465]:	loss = 0.287  exp loss = 0.274  adjusted loss = 0.274  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1437]:	loss = 0.303  exp loss = 0.295  adjusted loss = 0.295  adv prob = 0.250000   acc = 0.996
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_52.csv
logged to wandb
Average incurred loss: 0.301  
Average sample loss: 0.301  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 509]:	loss = 0.332  exp loss = 0.325  adjusted loss = 0.325  adv prob = 0.250000   acc = 0.955
  waterbird_complete95 = 0, forest2water2 = 1  [n = 541]:	loss = 0.279  exp loss = 0.277  adjusted loss = 0.277  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 355]:	loss = 0.285  exp loss = 0.279  adjusted loss = 0.279  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1140]:	loss = 0.302  exp loss = 0.299  adjusted loss = 0.299  adv prob = 0.250000   acc = 0.995

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_52.csv
logged to wandb
Average incurred loss: 0.402  
Average sample loss: 0.402  
Average acc: 0.892  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.336  exp loss = 0.350  adjusted loss = 0.350  adv prob = 0.250000   acc = 0.953
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.438  exp loss = 0.452  adjusted loss = 0.452  adv prob = 0.250000   acc = 0.867
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.525  exp loss = 0.520  adjusted loss = 0.520  adv prob = 0.250000   acc = 0.752
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.385  exp loss = 0.384  adjusted loss = 0.384  adv prob = 0.250000   acc = 0.910
Spurious Score = 1.151
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_52.csv
logged to wandb
Current lr: 0.000010


Epoch [53]:
Training:
Average incurred loss: 0.299  
Average sample loss: 0.299  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 662]:	loss = 0.318  exp loss = 0.323  adjusted loss = 0.323  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 0, forest2water2 = 1  [n = 646]:	loss = 0.284  exp loss = 0.293  adjusted loss = 0.293  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 473]:	loss = 0.289  exp loss = 0.286  adjusted loss = 0.286  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1419]:	loss = 0.301  exp loss = 0.286  adjusted loss = 0.286  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.303  
Average sample loss: 0.303  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 682]:	loss = 0.343  exp loss = 0.331  adjusted loss = 0.331  adv prob = 0.250000   acc = 0.960
  waterbird_complete95 = 0, forest2water2 = 1  [n = 697]:	loss = 0.294  exp loss = 0.283  adjusted loss = 0.283  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 425]:	loss = 0.282  exp loss = 0.291  adjusted loss = 0.291  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1396]:	loss = 0.295  exp loss = 0.297  adjusted loss = 0.297  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.308  
Average sample loss: 0.308  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 622]:	loss = 0.347  exp loss = 0.341  adjusted loss = 0.341  adv prob = 0.250000   acc = 0.958
  waterbird_complete95 = 0, forest2water2 = 1  [n = 689]:	loss = 0.280  exp loss = 0.279  adjusted loss = 0.279  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 449]:	loss = 0.292  exp loss = 0.288  adjusted loss = 0.288  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1440]:	loss = 0.309  exp loss = 0.308  adjusted loss = 0.308  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.307  
Average sample loss: 0.307  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 703]:	loss = 0.341  exp loss = 0.326  adjusted loss = 0.326  adv prob = 0.250000   acc = 0.967
  waterbird_complete95 = 0, forest2water2 = 1  [n = 671]:	loss = 0.297  exp loss = 0.292  adjusted loss = 0.292  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 438]:	loss = 0.289  exp loss = 0.295  adjusted loss = 0.295  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1388]:	loss = 0.299  exp loss = 0.300  adjusted loss = 0.300  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.308  
Average sample loss: 0.308  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 669]:	loss = 0.332  exp loss = 0.340  adjusted loss = 0.340  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 0, forest2water2 = 1  [n = 640]:	loss = 0.287  exp loss = 0.280  adjusted loss = 0.280  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 476]:	loss = 0.296  exp loss = 0.296  adjusted loss = 0.296  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1415]:	loss = 0.310  exp loss = 0.306  adjusted loss = 0.306  adv prob = 0.250000   acc = 0.996
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_53.csv
logged to wandb
Average incurred loss: 0.309  
Average sample loss: 0.309  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 510]:	loss = 0.321  exp loss = 0.311  adjusted loss = 0.311  adv prob = 0.250000   acc = 0.984
  waterbird_complete95 = 0, forest2water2 = 1  [n = 491]:	loss = 0.282  exp loss = 0.276  adjusted loss = 0.276  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 345]:	loss = 0.304  exp loss = 0.308  adjusted loss = 0.308  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1199]:	loss = 0.317  exp loss = 0.315  adjusted loss = 0.315  adv prob = 0.250000   acc = 0.994

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_53.csv
logged to wandb
Average incurred loss: 0.400  
Average sample loss: 0.400  
Average acc: 0.897  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.331  exp loss = 0.343  adjusted loss = 0.343  adv prob = 0.250000   acc = 0.966
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.425  exp loss = 0.435  adjusted loss = 0.435  adv prob = 0.250000   acc = 0.871
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.550  exp loss = 0.544  adjusted loss = 0.544  adv prob = 0.250000   acc = 0.759
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.409  exp loss = 0.405  adjusted loss = 0.405  adv prob = 0.250000   acc = 0.887
Spurious Score = 1.136
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_53.csv
logged to wandb
Current lr: 0.000010


Epoch [54]:
Training:
Average incurred loss: 0.310  
Average sample loss: 0.310  
Average acc: 0.992  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 646]:	loss = 0.342  exp loss = 0.332  adjusted loss = 0.332  adv prob = 0.250000   acc = 0.967
  waterbird_complete95 = 0, forest2water2 = 1  [n = 704]:	loss = 0.299  exp loss = 0.290  adjusted loss = 0.290  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 447]:	loss = 0.294  exp loss = 0.290  adjusted loss = 0.290  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1403]:	loss = 0.306  exp loss = 0.309  adjusted loss = 0.309  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.315  
Average sample loss: 0.315  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 675]:	loss = 0.352  exp loss = 0.348  adjusted loss = 0.348  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 0, forest2water2 = 1  [n = 661]:	loss = 0.293  exp loss = 0.288  adjusted loss = 0.288  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 446]:	loss = 0.299  exp loss = 0.299  adjusted loss = 0.299  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1418]:	loss = 0.312  exp loss = 0.308  adjusted loss = 0.308  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.317  
Average sample loss: 0.317  
Average acc: 0.991  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 645]:	loss = 0.337  exp loss = 0.344  adjusted loss = 0.344  adv prob = 0.250000   acc = 0.975
  waterbird_complete95 = 0, forest2water2 = 1  [n = 642]:	loss = 0.295  exp loss = 0.288  adjusted loss = 0.288  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.312  exp loss = 0.306  adjusted loss = 0.306  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1465]:	loss = 0.320  exp loss = 0.316  adjusted loss = 0.316  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.319  
Average sample loss: 0.319  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 664]:	loss = 0.347  exp loss = 0.339  adjusted loss = 0.339  adv prob = 0.250000   acc = 0.967
  waterbird_complete95 = 0, forest2water2 = 1  [n = 654]:	loss = 0.300  exp loss = 0.286  adjusted loss = 0.286  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 469]:	loss = 0.310  exp loss = 0.308  adjusted loss = 0.308  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1413]:	loss = 0.317  exp loss = 0.322  adjusted loss = 0.322  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.321  
Average sample loss: 0.321  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 686]:	loss = 0.357  exp loss = 0.351  adjusted loss = 0.351  adv prob = 0.250000   acc = 0.956
  waterbird_complete95 = 0, forest2water2 = 1  [n = 662]:	loss = 0.306  exp loss = 0.310  adjusted loss = 0.310  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 452]:	loss = 0.301  exp loss = 0.294  adjusted loss = 0.294  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1400]:	loss = 0.316  exp loss = 0.306  adjusted loss = 0.306  adv prob = 0.250000   acc = 0.994
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_54.csv
logged to wandb
Average incurred loss: 0.324  
Average sample loss: 0.324  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 532]:	loss = 0.357  exp loss = 0.350  adjusted loss = 0.350  adv prob = 0.250000   acc = 0.966
  waterbird_complete95 = 0, forest2water2 = 1  [n = 511]:	loss = 0.299  exp loss = 0.297  adjusted loss = 0.297  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 344]:	loss = 0.314  exp loss = 0.310  adjusted loss = 0.310  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1158]:	loss = 0.323  exp loss = 0.320  adjusted loss = 0.320  adv prob = 0.250000   acc = 0.992

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_54.csv
logged to wandb
Average incurred loss: 0.418  
Average sample loss: 0.418  
Average acc: 0.889  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.358  exp loss = 0.368  adjusted loss = 0.368  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.447  exp loss = 0.456  adjusted loss = 0.456  adv prob = 0.250000   acc = 0.861
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.540  exp loss = 0.539  adjusted loss = 0.539  adv prob = 0.250000   acc = 0.759
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.409  exp loss = 0.404  adjusted loss = 0.404  adv prob = 0.250000   acc = 0.880
Spurious Score = 1.134
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_54.csv
logged to wandb
Current lr: 0.000010


Epoch [55]:
Training:
Average incurred loss: 0.323  
Average sample loss: 0.323  
Average acc: 0.989  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 673]:	loss = 0.362  exp loss = 0.354  adjusted loss = 0.354  adv prob = 0.250000   acc = 0.961
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.301  exp loss = 0.293  adjusted loss = 0.293  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 415]:	loss = 0.311  exp loss = 0.315  adjusted loss = 0.315  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1452]:	loss = 0.319  exp loss = 0.322  adjusted loss = 0.322  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.323  
Average sample loss: 0.323  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 678]:	loss = 0.358  exp loss = 0.357  adjusted loss = 0.357  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 0, forest2water2 = 1  [n = 679]:	loss = 0.313  exp loss = 0.322  adjusted loss = 0.322  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 469]:	loss = 0.309  exp loss = 0.296  adjusted loss = 0.296  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1374]:	loss = 0.317  exp loss = 0.308  adjusted loss = 0.308  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.326  
Average sample loss: 0.326  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 657]:	loss = 0.356  exp loss = 0.354  adjusted loss = 0.354  adv prob = 0.250000   acc = 0.962
  waterbird_complete95 = 0, forest2water2 = 1  [n = 646]:	loss = 0.307  exp loss = 0.301  adjusted loss = 0.301  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 464]:	loss = 0.316  exp loss = 0.313  adjusted loss = 0.313  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1433]:	loss = 0.324  exp loss = 0.324  adjusted loss = 0.324  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.329  
Average sample loss: 0.329  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 672]:	loss = 0.363  exp loss = 0.369  adjusted loss = 0.369  adv prob = 0.250000   acc = 0.967
  waterbird_complete95 = 0, forest2water2 = 1  [n = 637]:	loss = 0.305  exp loss = 0.301  adjusted loss = 0.301  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 479]:	loss = 0.321  exp loss = 0.320  adjusted loss = 0.320  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1412]:	loss = 0.327  exp loss = 0.320  adjusted loss = 0.320  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.330  
Average sample loss: 0.330  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 648]:	loss = 0.359  exp loss = 0.361  adjusted loss = 0.361  adv prob = 0.250000   acc = 0.969
  waterbird_complete95 = 0, forest2water2 = 1  [n = 668]:	loss = 0.313  exp loss = 0.311  adjusted loss = 0.311  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 419]:	loss = 0.320  exp loss = 0.320  adjusted loss = 0.320  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1465]:	loss = 0.328  exp loss = 0.318  adjusted loss = 0.318  adv prob = 0.250000   acc = 0.992
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_55.csv
logged to wandb
Average incurred loss: 0.332  
Average sample loss: 0.332  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 520]:	loss = 0.370  exp loss = 0.373  adjusted loss = 0.373  adv prob = 0.250000   acc = 0.958
  waterbird_complete95 = 0, forest2water2 = 1  [n = 544]:	loss = 0.316  exp loss = 0.311  adjusted loss = 0.311  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 360]:	loss = 0.314  exp loss = 0.309  adjusted loss = 0.309  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1121]:	loss = 0.328  exp loss = 0.340  adjusted loss = 0.340  adv prob = 0.250000   acc = 0.993

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_55.csv
logged to wandb
Average incurred loss: 0.429  
Average sample loss: 0.429  
Average acc: 0.877  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.372  exp loss = 0.381  adjusted loss = 0.381  adv prob = 0.250000   acc = 0.940
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.460  exp loss = 0.470  adjusted loss = 0.470  adv prob = 0.250000   acc = 0.845
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.543  exp loss = 0.545  adjusted loss = 0.545  adv prob = 0.250000   acc = 0.737
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.409  exp loss = 0.403  adjusted loss = 0.403  adv prob = 0.250000   acc = 0.902
Spurious Score = 1.164
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_55.csv
logged to wandb
Current lr: 0.000010


Epoch [56]:
Training:
Average incurred loss: 0.330  
Average sample loss: 0.330  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 637]:	loss = 0.371  exp loss = 0.354  adjusted loss = 0.354  adv prob = 0.250000   acc = 0.953
  waterbird_complete95 = 0, forest2water2 = 1  [n = 693]:	loss = 0.312  exp loss = 0.299  adjusted loss = 0.299  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 453]:	loss = 0.320  exp loss = 0.327  adjusted loss = 0.327  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1417]:	loss = 0.325  exp loss = 0.331  adjusted loss = 0.331  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.336  
Average sample loss: 0.336  
Average acc: 0.988  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 659]:	loss = 0.365  exp loss = 0.342  adjusted loss = 0.342  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 0, forest2water2 = 1  [n = 636]:	loss = 0.315  exp loss = 0.314  adjusted loss = 0.314  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 436]:	loss = 0.325  exp loss = 0.323  adjusted loss = 0.323  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1469]:	loss = 0.334  exp loss = 0.332  adjusted loss = 0.332  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.339  
Average sample loss: 0.339  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 675]:	loss = 0.376  exp loss = 0.370  adjusted loss = 0.370  adv prob = 0.250000   acc = 0.956
  waterbird_complete95 = 0, forest2water2 = 1  [n = 656]:	loss = 0.323  exp loss = 0.317  adjusted loss = 0.317  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 447]:	loss = 0.328  exp loss = 0.325  adjusted loss = 0.325  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1422]:	loss = 0.333  exp loss = 0.329  adjusted loss = 0.329  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.338  
Average sample loss: 0.338  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 674]:	loss = 0.376  exp loss = 0.363  adjusted loss = 0.363  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 0, forest2water2 = 1  [n = 654]:	loss = 0.320  exp loss = 0.317  adjusted loss = 0.317  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 455]:	loss = 0.330  exp loss = 0.328  adjusted loss = 0.328  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1417]:	loss = 0.331  exp loss = 0.329  adjusted loss = 0.329  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.342  
Average sample loss: 0.342  
Average acc: 0.986  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.381  exp loss = 0.392  adjusted loss = 0.392  adv prob = 0.250000   acc = 0.954
  waterbird_complete95 = 0, forest2water2 = 1  [n = 655]:	loss = 0.323  exp loss = 0.315  adjusted loss = 0.315  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.330  exp loss = 0.322  adjusted loss = 0.322  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1409]:	loss = 0.336  exp loss = 0.335  adjusted loss = 0.335  adv prob = 0.250000   acc = 0.991
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_56.csv
logged to wandb
Average incurred loss: 0.338  
Average sample loss: 0.338  
Average acc: 0.990  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 533]:	loss = 0.378  exp loss = 0.378  adjusted loss = 0.378  adv prob = 0.250000   acc = 0.968
  waterbird_complete95 = 0, forest2water2 = 1  [n = 540]:	loss = 0.325  exp loss = 0.324  adjusted loss = 0.324  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 349]:	loss = 0.328  exp loss = 0.323  adjusted loss = 0.323  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1123]:	loss = 0.329  exp loss = 0.328  adjusted loss = 0.328  adv prob = 0.250000   acc = 0.995

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_56.csv
logged to wandb
Average incurred loss: 0.445  
Average sample loss: 0.444  
Average acc: 0.870  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.394  exp loss = 0.401  adjusted loss = 0.401  adv prob = 0.250000   acc = 0.929
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.476  exp loss = 0.487  adjusted loss = 0.487  adv prob = 0.250000   acc = 0.833
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.539  exp loss = 0.543  adjusted loss = 0.543  adv prob = 0.250000   acc = 0.759
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.417  exp loss = 0.410  adjusted loss = 0.410  adv prob = 0.250000   acc = 0.902
Spurious Score = 1.150
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_56.csv
logged to wandb
Current lr: 0.000010


Epoch [57]:
Training:
Average incurred loss: 0.342  
Average sample loss: 0.342  
Average acc: 0.985  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.383  exp loss = 0.376  adjusted loss = 0.376  adv prob = 0.250000   acc = 0.949
  waterbird_complete95 = 0, forest2water2 = 1  [n = 699]:	loss = 0.335  exp loss = 0.330  adjusted loss = 0.330  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 447]:	loss = 0.332  exp loss = 0.332  adjusted loss = 0.332  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1386]:	loss = 0.330  exp loss = 0.337  adjusted loss = 0.337  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.346  
Average sample loss: 0.346  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 679]:	loss = 0.390  exp loss = 0.381  adjusted loss = 0.381  adv prob = 0.250000   acc = 0.948
  waterbird_complete95 = 0, forest2water2 = 1  [n = 691]:	loss = 0.336  exp loss = 0.320  adjusted loss = 0.320  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 436]:	loss = 0.330  exp loss = 0.333  adjusted loss = 0.333  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1394]:	loss = 0.334  exp loss = 0.340  adjusted loss = 0.340  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.349  
Average sample loss: 0.349  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 643]:	loss = 0.385  exp loss = 0.378  adjusted loss = 0.378  adv prob = 0.250000   acc = 0.952
  waterbird_complete95 = 0, forest2water2 = 1  [n = 658]:	loss = 0.329  exp loss = 0.313  adjusted loss = 0.313  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 457]:	loss = 0.341  exp loss = 0.345  adjusted loss = 0.345  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1442]:	loss = 0.345  exp loss = 0.351  adjusted loss = 0.351  adv prob = 0.250000   acc = 0.986
Average incurred loss: 0.350  
Average sample loss: 0.350  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 678]:	loss = 0.392  exp loss = 0.397  adjusted loss = 0.397  adv prob = 0.250000   acc = 0.940
  waterbird_complete95 = 0, forest2water2 = 1  [n = 624]:	loss = 0.325  exp loss = 0.330  adjusted loss = 0.330  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 430]:	loss = 0.343  exp loss = 0.337  adjusted loss = 0.337  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1468]:	loss = 0.343  exp loss = 0.342  adjusted loss = 0.342  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.352  
Average sample loss: 0.352  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 660]:	loss = 0.387  exp loss = 0.389  adjusted loss = 0.389  adv prob = 0.250000   acc = 0.948
  waterbird_complete95 = 0, forest2water2 = 1  [n = 644]:	loss = 0.333  exp loss = 0.340  adjusted loss = 0.340  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 485]:	loss = 0.342  exp loss = 0.327  adjusted loss = 0.327  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1411]:	loss = 0.347  exp loss = 0.337  adjusted loss = 0.337  adv prob = 0.250000   acc = 0.987
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_57.csv
logged to wandb
Average incurred loss: 0.353  
Average sample loss: 0.353  
Average acc: 0.985  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 520]:	loss = 0.399  exp loss = 0.399  adjusted loss = 0.399  adv prob = 0.250000   acc = 0.940
  waterbird_complete95 = 0, forest2water2 = 1  [n = 518]:	loss = 0.327  exp loss = 0.322  adjusted loss = 0.322  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 351]:	loss = 0.340  exp loss = 0.337  adjusted loss = 0.337  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1156]:	loss = 0.347  exp loss = 0.343  adjusted loss = 0.343  adv prob = 0.250000   acc = 0.993

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_57.csv
logged to wandb
Average incurred loss: 0.455  
Average sample loss: 0.455  
Average acc: 0.857  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.407  exp loss = 0.412  adjusted loss = 0.412  adv prob = 0.250000   acc = 0.916
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.486  exp loss = 0.502  adjusted loss = 0.502  adv prob = 0.250000   acc = 0.811
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.545  exp loss = 0.547  adjusted loss = 0.547  adv prob = 0.250000   acc = 0.759
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.423  exp loss = 0.413  adjusted loss = 0.413  adv prob = 0.250000   acc = 0.902
Spurious Score = 1.158
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_57.csv
logged to wandb
Current lr: 0.000010


Epoch [58]:
Training:
Average incurred loss: 0.351  
Average sample loss: 0.351  
Average acc: 0.983  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 677]:	loss = 0.391  exp loss = 0.395  adjusted loss = 0.395  adv prob = 0.250000   acc = 0.944
  waterbird_complete95 = 0, forest2water2 = 1  [n = 640]:	loss = 0.336  exp loss = 0.341  adjusted loss = 0.341  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 456]:	loss = 0.337  exp loss = 0.328  adjusted loss = 0.328  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1427]:	loss = 0.344  exp loss = 0.339  adjusted loss = 0.339  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.353  
Average sample loss: 0.353  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 659]:	loss = 0.392  exp loss = 0.394  adjusted loss = 0.394  adv prob = 0.250000   acc = 0.954
  waterbird_complete95 = 0, forest2water2 = 1  [n = 677]:	loss = 0.342  exp loss = 0.346  adjusted loss = 0.346  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 442]:	loss = 0.340  exp loss = 0.338  adjusted loss = 0.338  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1422]:	loss = 0.343  exp loss = 0.339  adjusted loss = 0.339  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.356  
Average sample loss: 0.356  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 638]:	loss = 0.399  exp loss = 0.387  adjusted loss = 0.387  adv prob = 0.250000   acc = 0.937
  waterbird_complete95 = 0, forest2water2 = 1  [n = 693]:	loss = 0.343  exp loss = 0.336  adjusted loss = 0.336  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.347  exp loss = 0.353  adjusted loss = 0.353  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1421]:	loss = 0.346  exp loss = 0.351  adjusted loss = 0.351  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.361  
Average sample loss: 0.361  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 673]:	loss = 0.400  exp loss = 0.398  adjusted loss = 0.398  adv prob = 0.250000   acc = 0.941
  waterbird_complete95 = 0, forest2water2 = 1  [n = 633]:	loss = 0.342  exp loss = 0.346  adjusted loss = 0.346  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.350  exp loss = 0.339  adjusted loss = 0.339  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1453]:	loss = 0.354  exp loss = 0.343  adjusted loss = 0.343  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.364  
Average sample loss: 0.364  
Average acc: 0.978  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 650]:	loss = 0.410  exp loss = 0.413  adjusted loss = 0.413  adv prob = 0.250000   acc = 0.934
  waterbird_complete95 = 0, forest2water2 = 1  [n = 654]:	loss = 0.340  exp loss = 0.331  adjusted loss = 0.331  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 454]:	loss = 0.354  exp loss = 0.352  adjusted loss = 0.352  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1442]:	loss = 0.358  exp loss = 0.361  adjusted loss = 0.361  adv prob = 0.250000   acc = 0.981
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_58.csv
logged to wandb
Average incurred loss: 0.363  
Average sample loss: 0.363  
Average acc: 0.981  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 551]:	loss = 0.416  exp loss = 0.400  adjusted loss = 0.400  adv prob = 0.250000   acc = 0.918
  waterbird_complete95 = 0, forest2water2 = 1  [n = 537]:	loss = 0.354  exp loss = 0.350  adjusted loss = 0.350  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 365]:	loss = 0.351  exp loss = 0.350  adjusted loss = 0.350  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1092]:	loss = 0.344  exp loss = 0.344  adjusted loss = 0.344  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_58.csv
logged to wandb
Average incurred loss: 0.463  
Average sample loss: 0.464  
Average acc: 0.853  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.418  exp loss = 0.421  adjusted loss = 0.421  adv prob = 0.250000   acc = 0.916
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.491  exp loss = 0.510  adjusted loss = 0.510  adv prob = 0.250000   acc = 0.805
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.554  exp loss = 0.559  adjusted loss = 0.559  adv prob = 0.250000   acc = 0.767
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.434  exp loss = 0.425  adjusted loss = 0.425  adv prob = 0.250000   acc = 0.887
Spurious Score = 1.148
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_58.csv
logged to wandb
Current lr: 0.000010


Epoch [59]:
Training:
Average incurred loss: 0.365  
Average sample loss: 0.365  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 676]:	loss = 0.417  exp loss = 0.424  adjusted loss = 0.424  adv prob = 0.250000   acc = 0.930
  waterbird_complete95 = 0, forest2water2 = 1  [n = 656]:	loss = 0.348  exp loss = 0.351  adjusted loss = 0.351  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 416]:	loss = 0.354  exp loss = 0.338  adjusted loss = 0.338  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1452]:	loss = 0.351  exp loss = 0.338  adjusted loss = 0.338  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.363  
Average sample loss: 0.363  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 653]:	loss = 0.407  exp loss = 0.385  adjusted loss = 0.385  adv prob = 0.250000   acc = 0.937
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.345  exp loss = 0.345  adjusted loss = 0.345  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 442]:	loss = 0.353  exp loss = 0.353  adjusted loss = 0.353  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1445]:	loss = 0.355  exp loss = 0.359  adjusted loss = 0.359  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.370  
Average sample loss: 0.370  
Average acc: 0.977  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 693]:	loss = 0.418  exp loss = 0.427  adjusted loss = 0.427  adv prob = 0.250000   acc = 0.918
  waterbird_complete95 = 0, forest2water2 = 1  [n = 656]:	loss = 0.362  exp loss = 0.348  adjusted loss = 0.348  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 470]:	loss = 0.349  exp loss = 0.349  adjusted loss = 0.349  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1381]:	loss = 0.357  exp loss = 0.359  adjusted loss = 0.359  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.372  
Average sample loss: 0.372  
Average acc: 0.975  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 685]:	loss = 0.418  exp loss = 0.391  adjusted loss = 0.391  adv prob = 0.250000   acc = 0.914
  waterbird_complete95 = 0, forest2water2 = 1  [n = 651]:	loss = 0.365  exp loss = 0.351  adjusted loss = 0.351  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 1, forest2water2 = 0  [n = 467]:	loss = 0.355  exp loss = 0.357  adjusted loss = 0.357  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1397]:	loss = 0.360  exp loss = 0.367  adjusted loss = 0.367  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.371  
Average sample loss: 0.371  
Average acc: 0.982  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 630]:	loss = 0.420  exp loss = 0.413  adjusted loss = 0.413  adv prob = 0.250000   acc = 0.930
  waterbird_complete95 = 0, forest2water2 = 1  [n = 685]:	loss = 0.354  exp loss = 0.349  adjusted loss = 0.349  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.361  exp loss = 0.365  adjusted loss = 0.365  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1427]:	loss = 0.360  exp loss = 0.365  adjusted loss = 0.365  adv prob = 0.250000   acc = 0.992
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_59.csv
logged to wandb
Average incurred loss: 0.376  
Average sample loss: 0.376  
Average acc: 0.977  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 511]:	loss = 0.423  exp loss = 0.417  adjusted loss = 0.417  adv prob = 0.250000   acc = 0.932
  waterbird_complete95 = 0, forest2water2 = 1  [n = 526]:	loss = 0.359  exp loss = 0.362  adjusted loss = 0.362  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 353]:	loss = 0.367  exp loss = 0.370  adjusted loss = 0.370  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1155]:	loss = 0.366  exp loss = 0.360  adjusted loss = 0.360  adv prob = 0.250000   acc = 0.982

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_59.csv
logged to wandb
Average incurred loss: 0.473  
Average sample loss: 0.473  
Average acc: 0.841  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.427  exp loss = 0.427  adjusted loss = 0.427  adv prob = 0.250000   acc = 0.904
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.496  exp loss = 0.516  adjusted loss = 0.516  adv prob = 0.250000   acc = 0.800
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.572  exp loss = 0.581  adjusted loss = 0.581  adv prob = 0.250000   acc = 0.744
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.456  exp loss = 0.446  adjusted loss = 0.446  adv prob = 0.250000   acc = 0.857
Spurious Score = 1.140
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_59.csv
logged to wandb
Current lr: 0.000010


Epoch [60]:
Training:
Average incurred loss: 0.376  
Average sample loss: 0.376  
Average acc: 0.975  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 666]:	loss = 0.423  exp loss = 0.423  adjusted loss = 0.423  adv prob = 0.250000   acc = 0.910
  waterbird_complete95 = 0, forest2water2 = 1  [n = 669]:	loss = 0.368  exp loss = 0.368  adjusted loss = 0.368  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 435]:	loss = 0.363  exp loss = 0.358  adjusted loss = 0.358  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1430]:	loss = 0.362  exp loss = 0.355  adjusted loss = 0.355  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.377  
Average sample loss: 0.377  
Average acc: 0.972  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 688]:	loss = 0.435  exp loss = 0.439  adjusted loss = 0.439  adv prob = 0.250000   acc = 0.891
  waterbird_complete95 = 0, forest2water2 = 1  [n = 682]:	loss = 0.370  exp loss = 0.363  adjusted loss = 0.363  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 0  [n = 438]:	loss = 0.354  exp loss = 0.348  adjusted loss = 0.348  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1392]:	loss = 0.359  exp loss = 0.357  adjusted loss = 0.357  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.382  
Average sample loss: 0.382  
Average acc: 0.975  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 644]:	loss = 0.433  exp loss = 0.447  adjusted loss = 0.447  adv prob = 0.250000   acc = 0.901
  waterbird_complete95 = 0, forest2water2 = 1  [n = 643]:	loss = 0.365  exp loss = 0.364  adjusted loss = 0.364  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 468]:	loss = 0.371  exp loss = 0.363  adjusted loss = 0.363  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1445]:	loss = 0.371  exp loss = 0.370  adjusted loss = 0.370  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.381  
Average sample loss: 0.381  
Average acc: 0.977  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 682]:	loss = 0.434  exp loss = 0.420  adjusted loss = 0.420  adv prob = 0.250000   acc = 0.913
  waterbird_complete95 = 0, forest2water2 = 1  [n = 664]:	loss = 0.372  exp loss = 0.368  adjusted loss = 0.368  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 457]:	loss = 0.364  exp loss = 0.365  adjusted loss = 0.365  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1397]:	loss = 0.365  exp loss = 0.367  adjusted loss = 0.367  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.385  
Average sample loss: 0.385  
Average acc: 0.978  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 647]:	loss = 0.432  exp loss = 0.442  adjusted loss = 0.442  adv prob = 0.250000   acc = 0.917
  waterbird_complete95 = 0, forest2water2 = 1  [n = 643]:	loss = 0.367  exp loss = 0.360  adjusted loss = 0.360  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 447]:	loss = 0.374  exp loss = 0.367  adjusted loss = 0.367  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1463]:	loss = 0.375  exp loss = 0.372  adjusted loss = 0.372  adv prob = 0.250000   acc = 0.988
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_60.csv
logged to wandb
Average incurred loss: 0.385  
Average sample loss: 0.385  
Average acc: 0.977  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 521]:	loss = 0.435  exp loss = 0.418  adjusted loss = 0.418  adv prob = 0.250000   acc = 0.919
  waterbird_complete95 = 0, forest2water2 = 1  [n = 533]:	loss = 0.376  exp loss = 0.363  adjusted loss = 0.363  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 361]:	loss = 0.368  exp loss = 0.371  adjusted loss = 0.371  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1130]:	loss = 0.371  exp loss = 0.376  adjusted loss = 0.376  adv prob = 0.250000   acc = 0.986

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_60.csv
logged to wandb
Average incurred loss: 0.495  
Average sample loss: 0.496  
Average acc: 0.822  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.456  exp loss = 0.454  adjusted loss = 0.454  adv prob = 0.250000   acc = 0.880
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.530  exp loss = 0.550  adjusted loss = 0.550  adv prob = 0.250000   acc = 0.764
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.557  exp loss = 0.563  adjusted loss = 0.563  adv prob = 0.250000   acc = 0.752
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.449  exp loss = 0.439  adjusted loss = 0.439  adv prob = 0.250000   acc = 0.887
Spurious Score = 1.166
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_60.csv
logged to wandb
Current lr: 0.000010


Epoch [61]:
Training:
Average incurred loss: 0.388  
Average sample loss: 0.388  
Average acc: 0.977  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 672]:	loss = 0.428  exp loss = 0.422  adjusted loss = 0.422  adv prob = 0.250000   acc = 0.920
  waterbird_complete95 = 0, forest2water2 = 1  [n = 626]:	loss = 0.380  exp loss = 0.367  adjusted loss = 0.367  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 0  [n = 464]:	loss = 0.370  exp loss = 0.374  adjusted loss = 0.374  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1438]:	loss = 0.378  exp loss = 0.377  adjusted loss = 0.377  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.389  
Average sample loss: 0.389  
Average acc: 0.976  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 656]:	loss = 0.439  exp loss = 0.435  adjusted loss = 0.435  adv prob = 0.250000   acc = 0.918
  waterbird_complete95 = 0, forest2water2 = 1  [n = 668]:	loss = 0.380  exp loss = 0.389  adjusted loss = 0.389  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 0  [n = 449]:	loss = 0.370  exp loss = 0.371  adjusted loss = 0.371  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1427]:	loss = 0.376  exp loss = 0.378  adjusted loss = 0.378  adv prob = 0.250000   acc = 0.987
Average incurred loss: 0.390  
Average sample loss: 0.390  
Average acc: 0.975  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 647]:	loss = 0.443  exp loss = 0.440  adjusted loss = 0.440  adv prob = 0.250000   acc = 0.901
  waterbird_complete95 = 0, forest2water2 = 1  [n = 664]:	loss = 0.378  exp loss = 0.376  adjusted loss = 0.376  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 437]:	loss = 0.379  exp loss = 0.372  adjusted loss = 0.372  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1452]:	loss = 0.375  exp loss = 0.367  adjusted loss = 0.367  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.395  
Average sample loss: 0.395  
Average acc: 0.972  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 660]:	loss = 0.451  exp loss = 0.473  adjusted loss = 0.473  adv prob = 0.250000   acc = 0.888
  waterbird_complete95 = 0, forest2water2 = 1  [n = 662]:	loss = 0.387  exp loss = 0.382  adjusted loss = 0.382  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 472]:	loss = 0.380  exp loss = 0.373  adjusted loss = 0.373  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1406]:	loss = 0.378  exp loss = 0.375  adjusted loss = 0.375  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.398  
Average sample loss: 0.398  
Average acc: 0.970  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 652]:	loss = 0.462  exp loss = 0.447  adjusted loss = 0.447  adv prob = 0.250000   acc = 0.888
  waterbird_complete95 = 0, forest2water2 = 1  [n = 676]:	loss = 0.385  exp loss = 0.383  adjusted loss = 0.383  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 439]:	loss = 0.379  exp loss = 0.388  adjusted loss = 0.388  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1433]:	loss = 0.381  exp loss = 0.378  adjusted loss = 0.378  adv prob = 0.250000   acc = 0.985
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_61.csv
logged to wandb
Average incurred loss: 0.399  
Average sample loss: 0.399  
Average acc: 0.966  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 561]:	loss = 0.467  exp loss = 0.465  adjusted loss = 0.465  adv prob = 0.250000   acc = 0.875
  waterbird_complete95 = 0, forest2water2 = 1  [n = 538]:	loss = 0.395  exp loss = 0.395  adjusted loss = 0.395  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 345]:	loss = 0.378  exp loss = 0.377  adjusted loss = 0.377  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1101]:	loss = 0.373  exp loss = 0.378  adjusted loss = 0.378  adv prob = 0.250000   acc = 0.987

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_61.csv
logged to wandb
Average incurred loss: 0.503  
Average sample loss: 0.504  
Average acc: 0.822  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.461  exp loss = 0.460  adjusted loss = 0.460  adv prob = 0.250000   acc = 0.884
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.530  exp loss = 0.549  adjusted loss = 0.549  adv prob = 0.250000   acc = 0.773
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.584  exp loss = 0.599  adjusted loss = 0.599  adv prob = 0.250000   acc = 0.729
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.475  exp loss = 0.464  adjusted loss = 0.464  adv prob = 0.250000   acc = 0.865
Spurious Score = 1.165
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_61.csv
logged to wandb
Current lr: 0.000010


Epoch [62]:
Training:
Average incurred loss: 0.399  
Average sample loss: 0.399  
Average acc: 0.976  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 653]:	loss = 0.445  exp loss = 0.429  adjusted loss = 0.429  adv prob = 0.250000   acc = 0.916
  waterbird_complete95 = 0, forest2water2 = 1  [n = 654]:	loss = 0.394  exp loss = 0.392  adjusted loss = 0.392  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 461]:	loss = 0.390  exp loss = 0.393  adjusted loss = 0.393  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1432]:	loss = 0.385  exp loss = 0.384  adjusted loss = 0.384  adv prob = 0.250000   acc = 0.986
Average incurred loss: 0.401  
Average sample loss: 0.401  
Average acc: 0.972  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 643]:	loss = 0.456  exp loss = 0.448  adjusted loss = 0.448  adv prob = 0.250000   acc = 0.886
  waterbird_complete95 = 0, forest2water2 = 1  [n = 663]:	loss = 0.391  exp loss = 0.382  adjusted loss = 0.382  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.386  exp loss = 0.394  adjusted loss = 0.394  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1446]:	loss = 0.386  exp loss = 0.388  adjusted loss = 0.388  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.403  
Average sample loss: 0.403  
Average acc: 0.969  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 686]:	loss = 0.469  exp loss = 0.451  adjusted loss = 0.451  adv prob = 0.250000   acc = 0.879
  waterbird_complete95 = 0, forest2water2 = 1  [n = 693]:	loss = 0.399  exp loss = 0.394  adjusted loss = 0.394  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 411]:	loss = 0.377  exp loss = 0.376  adjusted loss = 0.376  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1410]:	loss = 0.381  exp loss = 0.387  adjusted loss = 0.387  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.407  
Average sample loss: 0.407  
Average acc: 0.966  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 660]:	loss = 0.477  exp loss = 0.466  adjusted loss = 0.466  adv prob = 0.250000   acc = 0.858
  waterbird_complete95 = 0, forest2water2 = 1  [n = 664]:	loss = 0.392  exp loss = 0.390  adjusted loss = 0.390  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 0  [n = 477]:	loss = 0.393  exp loss = 0.391  adjusted loss = 0.391  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1399]:	loss = 0.387  exp loss = 0.387  adjusted loss = 0.387  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.412  
Average sample loss: 0.412  
Average acc: 0.966  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 662]:	loss = 0.471  exp loss = 0.457  adjusted loss = 0.457  adv prob = 0.250000   acc = 0.869
  waterbird_complete95 = 0, forest2water2 = 1  [n = 633]:	loss = 0.399  exp loss = 0.400  adjusted loss = 0.400  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.394  exp loss = 0.391  adjusted loss = 0.391  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1439]:	loss = 0.396  exp loss = 0.396  adjusted loss = 0.396  adv prob = 0.250000   acc = 0.986
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_62.csv
logged to wandb
Average incurred loss: 0.411  
Average sample loss: 0.411  
Average acc: 0.969  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 544]:	loss = 0.468  exp loss = 0.454  adjusted loss = 0.454  adv prob = 0.250000   acc = 0.886
  waterbird_complete95 = 0, forest2water2 = 1  [n = 527]:	loss = 0.410  exp loss = 0.401  adjusted loss = 0.401  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 1, forest2water2 = 0  [n = 343]:	loss = 0.396  exp loss = 0.393  adjusted loss = 0.393  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1131]:	loss = 0.388  exp loss = 0.392  adjusted loss = 0.392  adv prob = 0.250000   acc = 0.988

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_62.csv
logged to wandb
Average incurred loss: 0.534  
Average sample loss: 0.536  
Average acc: 0.782  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.502  exp loss = 0.498  adjusted loss = 0.498  adv prob = 0.250000   acc = 0.827
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.582  exp loss = 0.599  adjusted loss = 0.599  adv prob = 0.250000   acc = 0.715
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.556  exp loss = 0.562  adjusted loss = 0.562  adv prob = 0.250000   acc = 0.767
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.459  exp loss = 0.449  adjusted loss = 0.449  adv prob = 0.250000   acc = 0.880
Spurious Score = 1.152
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_62.csv
logged to wandb
Current lr: 0.000010


Epoch [63]:
Training:
Average incurred loss: 0.412  
Average sample loss: 0.412  
Average acc: 0.971  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 643]:	loss = 0.465  exp loss = 0.457  adjusted loss = 0.457  adv prob = 0.250000   acc = 0.888
  waterbird_complete95 = 0, forest2water2 = 1  [n = 698]:	loss = 0.414  exp loss = 0.420  adjusted loss = 0.420  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 463]:	loss = 0.392  exp loss = 0.393  adjusted loss = 0.393  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1396]:	loss = 0.393  exp loss = 0.384  adjusted loss = 0.384  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.414  
Average sample loss: 0.414  
Average acc: 0.965  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 676]:	loss = 0.479  exp loss = 0.471  adjusted loss = 0.471  adv prob = 0.250000   acc = 0.858
  waterbird_complete95 = 0, forest2water2 = 1  [n = 674]:	loss = 0.409  exp loss = 0.411  adjusted loss = 0.411  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 1, forest2water2 = 0  [n = 410]:	loss = 0.395  exp loss = 0.403  adjusted loss = 0.403  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1440]:	loss = 0.390  exp loss = 0.384  adjusted loss = 0.384  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.418  
Average sample loss: 0.418  
Average acc: 0.965  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 664]:	loss = 0.480  exp loss = 0.468  adjusted loss = 0.468  adv prob = 0.250000   acc = 0.866
  waterbird_complete95 = 0, forest2water2 = 1  [n = 630]:	loss = 0.406  exp loss = 0.402  adjusted loss = 0.402  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 483]:	loss = 0.401  exp loss = 0.408  adjusted loss = 0.408  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1423]:	loss = 0.401  exp loss = 0.395  adjusted loss = 0.395  adv prob = 0.250000   acc = 0.986
Average incurred loss: 0.420  
Average sample loss: 0.420  
Average acc: 0.961  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 661]:	loss = 0.492  exp loss = 0.484  adjusted loss = 0.484  adv prob = 0.250000   acc = 0.849
  waterbird_complete95 = 0, forest2water2 = 1  [n = 700]:	loss = 0.415  exp loss = 0.418  adjusted loss = 0.418  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.402  exp loss = 0.394  adjusted loss = 0.394  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1399]:	loss = 0.394  exp loss = 0.397  adjusted loss = 0.397  adv prob = 0.250000   acc = 0.986
Average incurred loss: 0.422  
Average sample loss: 0.422  
Average acc: 0.965  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 667]:	loss = 0.483  exp loss = 0.493  adjusted loss = 0.493  adv prob = 0.250000   acc = 0.861
  waterbird_complete95 = 0, forest2water2 = 1  [n = 634]:	loss = 0.413  exp loss = 0.415  adjusted loss = 0.415  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 1, forest2water2 = 0  [n = 450]:	loss = 0.405  exp loss = 0.398  adjusted loss = 0.398  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1449]:	loss = 0.402  exp loss = 0.399  adjusted loss = 0.399  adv prob = 0.250000   acc = 0.991
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_63.csv
logged to wandb
Average incurred loss: 0.422  
Average sample loss: 0.422  
Average acc: 0.970  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 537]:	loss = 0.475  exp loss = 0.460  adjusted loss = 0.460  adv prob = 0.250000   acc = 0.886
  waterbird_complete95 = 0, forest2water2 = 1  [n = 498]:	loss = 0.418  exp loss = 0.419  adjusted loss = 0.419  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 0  [n = 360]:	loss = 0.407  exp loss = 0.400  adjusted loss = 0.400  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1150]:	loss = 0.404  exp loss = 0.397  adjusted loss = 0.397  adv prob = 0.250000   acc = 0.990

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_63.csv
logged to wandb
Average incurred loss: 0.528  
Average sample loss: 0.530  
Average acc: 0.792  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.489  exp loss = 0.487  adjusted loss = 0.487  adv prob = 0.250000   acc = 0.844
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.551  exp loss = 0.566  adjusted loss = 0.566  adv prob = 0.250000   acc = 0.745
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.602  exp loss = 0.614  adjusted loss = 0.614  adv prob = 0.250000   acc = 0.744
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.514  exp loss = 0.506  adjusted loss = 0.506  adv prob = 0.250000   acc = 0.827
Spurious Score = 1.122
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_63.csv
logged to wandb
Current lr: 0.000010


Epoch [64]:
Training:
Average incurred loss: 0.423  
Average sample loss: 0.423  
Average acc: 0.972  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 648]:	loss = 0.483  exp loss = 0.478  adjusted loss = 0.478  adv prob = 0.250000   acc = 0.883
  waterbird_complete95 = 0, forest2water2 = 1  [n = 665]:	loss = 0.414  exp loss = 0.412  adjusted loss = 0.412  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 480]:	loss = 0.406  exp loss = 0.406  adjusted loss = 0.406  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1407]:	loss = 0.404  exp loss = 0.405  adjusted loss = 0.405  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.428  
Average sample loss: 0.428  
Average acc: 0.963  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 692]:	loss = 0.491  exp loss = 0.486  adjusted loss = 0.486  adv prob = 0.250000   acc = 0.863
  waterbird_complete95 = 0, forest2water2 = 1  [n = 630]:	loss = 0.422  exp loss = 0.424  adjusted loss = 0.424  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 1, forest2water2 = 0  [n = 455]:	loss = 0.408  exp loss = 0.410  adjusted loss = 0.410  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1423]:	loss = 0.407  exp loss = 0.403  adjusted loss = 0.403  adv prob = 0.250000   acc = 0.987
Average incurred loss: 0.427  
Average sample loss: 0.427  
Average acc: 0.963  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.489  exp loss = 0.478  adjusted loss = 0.478  adv prob = 0.250000   acc = 0.850
  waterbird_complete95 = 0, forest2water2 = 1  [n = 653]:	loss = 0.423  exp loss = 0.423  adjusted loss = 0.423  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 442]:	loss = 0.408  exp loss = 0.410  adjusted loss = 0.410  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1437]:	loss = 0.406  exp loss = 0.410  adjusted loss = 0.410  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.430  
Average sample loss: 0.430  
Average acc: 0.963  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 632]:	loss = 0.497  exp loss = 0.500  adjusted loss = 0.500  adv prob = 0.250000   acc = 0.847
  waterbird_complete95 = 0, forest2water2 = 1  [n = 709]:	loss = 0.431  exp loss = 0.423  adjusted loss = 0.423  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 1, forest2water2 = 0  [n = 434]:	loss = 0.406  exp loss = 0.411  adjusted loss = 0.411  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1425]:	loss = 0.408  exp loss = 0.412  adjusted loss = 0.412  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.435  
Average sample loss: 0.435  
Average acc: 0.956  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 671]:	loss = 0.503  exp loss = 0.501  adjusted loss = 0.501  adv prob = 0.250000   acc = 0.829
  waterbird_complete95 = 0, forest2water2 = 1  [n = 659]:	loss = 0.429  exp loss = 0.425  adjusted loss = 0.425  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 0  [n = 438]:	loss = 0.421  exp loss = 0.423  adjusted loss = 0.423  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1432]:	loss = 0.411  exp loss = 0.411  adjusted loss = 0.411  adv prob = 0.250000   acc = 0.983
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_64.csv
logged to wandb
Average incurred loss: 0.438  
Average sample loss: 0.438  
Average acc: 0.953  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 537]:	loss = 0.510  exp loss = 0.506  adjusted loss = 0.506  adv prob = 0.250000   acc = 0.812
  waterbird_complete95 = 0, forest2water2 = 1  [n = 518]:	loss = 0.434  exp loss = 0.431  adjusted loss = 0.431  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 1, forest2water2 = 0  [n = 357]:	loss = 0.418  exp loss = 0.407  adjusted loss = 0.407  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1133]:	loss = 0.412  exp loss = 0.406  adjusted loss = 0.406  adv prob = 0.250000   acc = 0.989

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_64.csv
logged to wandb
Average incurred loss: 0.547  
Average sample loss: 0.548  
Average acc: 0.766  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.513  exp loss = 0.513  adjusted loss = 0.513  adv prob = 0.250000   acc = 0.809
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.576  exp loss = 0.589  adjusted loss = 0.589  adv prob = 0.250000   acc = 0.715
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.600  exp loss = 0.609  adjusted loss = 0.609  adv prob = 0.250000   acc = 0.744
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.511  exp loss = 0.502  adjusted loss = 0.502  adv prob = 0.250000   acc = 0.812
Spurious Score = 1.111
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_64.csv
logged to wandb
Current lr: 0.000010


Epoch [65]:
Training:
Average incurred loss: 0.438  
Average sample loss: 0.438  
Average acc: 0.960  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.518  exp loss = 0.524  adjusted loss = 0.524  adv prob = 0.250000   acc = 0.832
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.427  exp loss = 0.423  adjusted loss = 0.423  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 429]:	loss = 0.422  exp loss = 0.418  adjusted loss = 0.418  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1443]:	loss = 0.412  exp loss = 0.409  adjusted loss = 0.409  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.436  
Average sample loss: 0.436  
Average acc: 0.963  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 681]:	loss = 0.495  exp loss = 0.499  adjusted loss = 0.499  adv prob = 0.250000   acc = 0.847
  waterbird_complete95 = 0, forest2water2 = 1  [n = 656]:	loss = 0.439  exp loss = 0.439  adjusted loss = 0.439  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 0  [n = 439]:	loss = 0.423  exp loss = 0.417  adjusted loss = 0.417  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1424]:	loss = 0.410  exp loss = 0.406  adjusted loss = 0.406  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.441  
Average sample loss: 0.441  
Average acc: 0.957  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 650]:	loss = 0.511  exp loss = 0.513  adjusted loss = 0.513  adv prob = 0.250000   acc = 0.818
  waterbird_complete95 = 0, forest2water2 = 1  [n = 670]:	loss = 0.435  exp loss = 0.434  adjusted loss = 0.434  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 436]:	loss = 0.423  exp loss = 0.422  adjusted loss = 0.422  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1444]:	loss = 0.417  exp loss = 0.422  adjusted loss = 0.422  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.447  
Average sample loss: 0.447  
Average acc: 0.955  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 653]:	loss = 0.522  exp loss = 0.529  adjusted loss = 0.529  adv prob = 0.250000   acc = 0.827
  waterbird_complete95 = 0, forest2water2 = 1  [n = 674]:	loss = 0.442  exp loss = 0.434  adjusted loss = 0.434  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 1, forest2water2 = 0  [n = 463]:	loss = 0.419  exp loss = 0.414  adjusted loss = 0.414  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1410]:	loss = 0.423  exp loss = 0.420  adjusted loss = 0.420  adv prob = 0.250000   acc = 0.984
Average incurred loss: 0.448  
Average sample loss: 0.448  
Average acc: 0.953  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 674]:	loss = 0.522  exp loss = 0.514  adjusted loss = 0.514  adv prob = 0.250000   acc = 0.812
  waterbird_complete95 = 0, forest2water2 = 1  [n = 632]:	loss = 0.434  exp loss = 0.426  adjusted loss = 0.426  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 0  [n = 474]:	loss = 0.433  exp loss = 0.452  adjusted loss = 0.452  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1420]:	loss = 0.423  exp loss = 0.424  adjusted loss = 0.424  adv prob = 0.250000   acc = 0.987
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_65.csv
logged to wandb
Average incurred loss: 0.444  
Average sample loss: 0.444  
Average acc: 0.962  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 522]:	loss = 0.503  exp loss = 0.502  adjusted loss = 0.502  adv prob = 0.250000   acc = 0.854
  waterbird_complete95 = 0, forest2water2 = 1  [n = 542]:	loss = 0.452  exp loss = 0.442  adjusted loss = 0.442  adv prob = 0.250000   acc = 0.989
  waterbird_complete95 = 1, forest2water2 = 0  [n = 365]:	loss = 0.422  exp loss = 0.428  adjusted loss = 0.428  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1116]:	loss = 0.419  exp loss = 0.419  adjusted loss = 0.419  adv prob = 0.250000   acc = 0.987

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_65.csv
logged to wandb
Average incurred loss: 0.574  
Average sample loss: 0.576  
Average acc: 0.731  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.557  exp loss = 0.557  adjusted loss = 0.557  adv prob = 0.250000   acc = 0.754
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.628  exp loss = 0.638  adjusted loss = 0.638  adv prob = 0.250000   acc = 0.646
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.551  exp loss = 0.550  adjusted loss = 0.550  adv prob = 0.250000   acc = 0.812
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.469  exp loss = 0.458  adjusted loss = 0.458  adv prob = 0.250000   acc = 0.872
Spurious Score = 1.115
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_65.csv
logged to wandb
Current lr: 0.000010


Epoch [66]:
Training:
Average incurred loss: 0.449  
Average sample loss: 0.449  
Average acc: 0.951  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 694]:	loss = 0.523  exp loss = 0.514  adjusted loss = 0.514  adv prob = 0.250000   acc = 0.811
  waterbird_complete95 = 0, forest2water2 = 1  [n = 685]:	loss = 0.453  exp loss = 0.447  adjusted loss = 0.447  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 1, forest2water2 = 0  [n = 431]:	loss = 0.425  exp loss = 0.426  adjusted loss = 0.426  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1390]:	loss = 0.418  exp loss = 0.417  adjusted loss = 0.417  adv prob = 0.250000   acc = 0.986
Average incurred loss: 0.450  
Average sample loss: 0.450  
Average acc: 0.956  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 654]:	loss = 0.527  exp loss = 0.533  adjusted loss = 0.533  adv prob = 0.250000   acc = 0.815
  waterbird_complete95 = 0, forest2water2 = 1  [n = 686]:	loss = 0.446  exp loss = 0.445  adjusted loss = 0.445  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 0  [n = 437]:	loss = 0.432  exp loss = 0.429  adjusted loss = 0.429  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1423]:	loss = 0.422  exp loss = 0.419  adjusted loss = 0.419  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.453  
Average sample loss: 0.453  
Average acc: 0.954  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 640]:	loss = 0.527  exp loss = 0.528  adjusted loss = 0.528  adv prob = 0.250000   acc = 0.809
  waterbird_complete95 = 0, forest2water2 = 1  [n = 677]:	loss = 0.450  exp loss = 0.445  adjusted loss = 0.445  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.433  exp loss = 0.425  adjusted loss = 0.425  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1425]:	loss = 0.428  exp loss = 0.428  adjusted loss = 0.428  adv prob = 0.250000   acc = 0.986
Average incurred loss: 0.453  
Average sample loss: 0.453  
Average acc: 0.959  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 656]:	loss = 0.522  exp loss = 0.515  adjusted loss = 0.515  adv prob = 0.250000   acc = 0.832
  waterbird_complete95 = 0, forest2water2 = 1  [n = 636]:	loss = 0.446  exp loss = 0.453  adjusted loss = 0.453  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 1, forest2water2 = 0  [n = 462]:	loss = 0.437  exp loss = 0.439  adjusted loss = 0.439  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1446]:	loss = 0.430  exp loss = 0.421  adjusted loss = 0.421  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.457  
Average sample loss: 0.457  
Average acc: 0.949  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 675]:	loss = 0.531  exp loss = 0.531  adjusted loss = 0.531  adv prob = 0.250000   acc = 0.796
  waterbird_complete95 = 0, forest2water2 = 1  [n = 647]:	loss = 0.454  exp loss = 0.450  adjusted loss = 0.450  adv prob = 0.250000   acc = 0.988
  waterbird_complete95 = 1, forest2water2 = 0  [n = 467]:	loss = 0.431  exp loss = 0.423  adjusted loss = 0.423  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1411]:	loss = 0.432  exp loss = 0.429  adjusted loss = 0.429  adv prob = 0.250000   acc = 0.988
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_66.csv
logged to wandb
Average incurred loss: 0.460  
Average sample loss: 0.460  
Average acc: 0.952  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 529]:	loss = 0.534  exp loss = 0.535  adjusted loss = 0.535  adv prob = 0.250000   acc = 0.803
  waterbird_complete95 = 0, forest2water2 = 1  [n = 503]:	loss = 0.455  exp loss = 0.460  adjusted loss = 0.460  adv prob = 0.250000   acc = 0.992
  waterbird_complete95 = 1, forest2water2 = 0  [n = 351]:	loss = 0.446  exp loss = 0.435  adjusted loss = 0.435  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1162]:	loss = 0.433  exp loss = 0.428  adjusted loss = 0.428  adv prob = 0.250000   acc = 0.989

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_66.csv
logged to wandb
Average incurred loss: 0.556  
Average sample loss: 0.558  
Average acc: 0.771  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.524  exp loss = 0.529  adjusted loss = 0.529  adv prob = 0.250000   acc = 0.812
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.568  exp loss = 0.580  adjusted loss = 0.580  adv prob = 0.250000   acc = 0.745
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.633  exp loss = 0.640  adjusted loss = 0.640  adv prob = 0.250000   acc = 0.722
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.555  exp loss = 0.546  adjusted loss = 0.546  adv prob = 0.250000   acc = 0.767
Spurious Score = 1.076
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_66.csv
logged to wandb
Current lr: 0.000010


Epoch [67]:
Training:
Average incurred loss: 0.457  
Average sample loss: 0.457  
Average acc: 0.956  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 617]:	loss = 0.527  exp loss = 0.528  adjusted loss = 0.528  adv prob = 0.250000   acc = 0.820
  waterbird_complete95 = 0, forest2water2 = 1  [n = 702]:	loss = 0.457  exp loss = 0.450  adjusted loss = 0.450  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 1, forest2water2 = 0  [n = 480]:	loss = 0.435  exp loss = 0.439  adjusted loss = 0.439  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1401]:	loss = 0.433  exp loss = 0.436  adjusted loss = 0.436  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.460  
Average sample loss: 0.460  
Average acc: 0.953  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 641]:	loss = 0.533  exp loss = 0.534  adjusted loss = 0.534  adv prob = 0.250000   acc = 0.796
  waterbird_complete95 = 0, forest2water2 = 1  [n = 665]:	loss = 0.456  exp loss = 0.452  adjusted loss = 0.452  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 0  [n = 425]:	loss = 0.436  exp loss = 0.440  adjusted loss = 0.440  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1469]:	loss = 0.437  exp loss = 0.432  adjusted loss = 0.432  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.466  
Average sample loss: 0.466  
Average acc: 0.946  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 681]:	loss = 0.548  exp loss = 0.552  adjusted loss = 0.552  adv prob = 0.250000   acc = 0.787
  waterbird_complete95 = 0, forest2water2 = 1  [n = 641]:	loss = 0.459  exp loss = 0.458  adjusted loss = 0.458  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 1, forest2water2 = 0  [n = 465]:	loss = 0.452  exp loss = 0.451  adjusted loss = 0.451  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1413]:	loss = 0.434  exp loss = 0.429  adjusted loss = 0.429  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.465  
Average sample loss: 0.465  
Average acc: 0.951  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 676]:	loss = 0.539  exp loss = 0.536  adjusted loss = 0.536  adv prob = 0.250000   acc = 0.802
  waterbird_complete95 = 0, forest2water2 = 1  [n = 662]:	loss = 0.466  exp loss = 0.454  adjusted loss = 0.454  adv prob = 0.250000   acc = 0.982
  waterbird_complete95 = 1, forest2water2 = 0  [n = 450]:	loss = 0.446  exp loss = 0.450  adjusted loss = 0.450  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1412]:	loss = 0.435  exp loss = 0.437  adjusted loss = 0.437  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.472  
Average sample loss: 0.472  
Average acc: 0.941  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 705]:	loss = 0.559  exp loss = 0.560  adjusted loss = 0.560  adv prob = 0.250000   acc = 0.773
  waterbird_complete95 = 0, forest2water2 = 1  [n = 645]:	loss = 0.464  exp loss = 0.456  adjusted loss = 0.456  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 1, forest2water2 = 0  [n = 419]:	loss = 0.448  exp loss = 0.457  adjusted loss = 0.457  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1431]:	loss = 0.440  exp loss = 0.443  adjusted loss = 0.443  adv prob = 0.250000   acc = 0.988
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_67.csv
logged to wandb
Average incurred loss: 0.473  
Average sample loss: 0.473  
Average acc: 0.943  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 528]:	loss = 0.557  exp loss = 0.540  adjusted loss = 0.540  adv prob = 0.250000   acc = 0.773
  waterbird_complete95 = 0, forest2water2 = 1  [n = 519]:	loss = 0.465  exp loss = 0.465  adjusted loss = 0.465  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 1, forest2water2 = 0  [n = 367]:	loss = 0.458  exp loss = 0.457  adjusted loss = 0.457  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1131]:	loss = 0.441  exp loss = 0.438  adjusted loss = 0.438  adv prob = 0.250000   acc = 0.986

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_67.csv
logged to wandb
Average incurred loss: 0.553  
Average sample loss: 0.555  
Average acc: 0.763  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.520  exp loss = 0.529  adjusted loss = 0.529  adv prob = 0.250000   acc = 0.805
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.558  exp loss = 0.570  adjusted loss = 0.570  adv prob = 0.250000   acc = 0.755
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.648  exp loss = 0.650  adjusted loss = 0.650  adv prob = 0.250000   acc = 0.669
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.563  exp loss = 0.552  adjusted loss = 0.552  adv prob = 0.250000   acc = 0.737
Spurious Score = 1.082
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_67.csv
logged to wandb
Current lr: 0.000010


Epoch [68]:
Training:
Average incurred loss: 0.472  
Average sample loss: 0.472  
Average acc: 0.944  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 659]:	loss = 0.552  exp loss = 0.552  adjusted loss = 0.552  adv prob = 0.250000   acc = 0.772
  waterbird_complete95 = 0, forest2water2 = 1  [n = 683]:	loss = 0.473  exp loss = 0.482  adjusted loss = 0.482  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 1, forest2water2 = 0  [n = 447]:	loss = 0.453  exp loss = 0.444  adjusted loss = 0.444  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1411]:	loss = 0.440  exp loss = 0.427  adjusted loss = 0.427  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.473  
Average sample loss: 0.473  
Average acc: 0.950  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 680]:	loss = 0.550  exp loss = 0.545  adjusted loss = 0.545  adv prob = 0.250000   acc = 0.799
  waterbird_complete95 = 0, forest2water2 = 1  [n = 653]:	loss = 0.469  exp loss = 0.465  adjusted loss = 0.465  adv prob = 0.250000   acc = 0.986
  waterbird_complete95 = 1, forest2water2 = 0  [n = 455]:	loss = 0.461  exp loss = 0.467  adjusted loss = 0.467  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1412]:	loss = 0.441  exp loss = 0.442  adjusted loss = 0.442  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.476  
Average sample loss: 0.476  
Average acc: 0.946  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 621]:	loss = 0.555  exp loss = 0.564  adjusted loss = 0.564  adv prob = 0.250000   acc = 0.783
  waterbird_complete95 = 0, forest2water2 = 1  [n = 670]:	loss = 0.473  exp loss = 0.463  adjusted loss = 0.463  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 1, forest2water2 = 0  [n = 465]:	loss = 0.456  exp loss = 0.461  adjusted loss = 0.461  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1444]:	loss = 0.450  exp loss = 0.446  adjusted loss = 0.446  adv prob = 0.250000   acc = 0.987
Average incurred loss: 0.477  
Average sample loss: 0.477  
Average acc: 0.942  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 657]:	loss = 0.558  exp loss = 0.554  adjusted loss = 0.554  adv prob = 0.250000   acc = 0.767
  waterbird_complete95 = 0, forest2water2 = 1  [n = 642]:	loss = 0.468  exp loss = 0.468  adjusted loss = 0.468  adv prob = 0.250000   acc = 0.978
  waterbird_complete95 = 1, forest2water2 = 0  [n = 476]:	loss = 0.462  exp loss = 0.467  adjusted loss = 0.467  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1425]:	loss = 0.449  exp loss = 0.441  adjusted loss = 0.441  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.480  
Average sample loss: 0.480  
Average acc: 0.941  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 712]:	loss = 0.557  exp loss = 0.556  adjusted loss = 0.556  adv prob = 0.250000   acc = 0.784
  waterbird_complete95 = 0, forest2water2 = 1  [n = 648]:	loss = 0.483  exp loss = 0.472  adjusted loss = 0.472  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 1, forest2water2 = 0  [n = 417]:	loss = 0.456  exp loss = 0.454  adjusted loss = 0.454  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1423]:	loss = 0.447  exp loss = 0.449  adjusted loss = 0.449  adv prob = 0.250000   acc = 0.989
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_68.csv
logged to wandb
Average incurred loss: 0.478  
Average sample loss: 0.478  
Average acc: 0.947  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 519]:	loss = 0.559  exp loss = 0.565  adjusted loss = 0.565  adv prob = 0.250000   acc = 0.786
  waterbird_complete95 = 0, forest2water2 = 1  [n = 538]:	loss = 0.480  exp loss = 0.477  adjusted loss = 0.477  adv prob = 0.250000   acc = 0.972
  waterbird_complete95 = 1, forest2water2 = 0  [n = 346]:	loss = 0.466  exp loss = 0.463  adjusted loss = 0.463  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1142]:	loss = 0.445  exp loss = 0.444  adjusted loss = 0.444  adv prob = 0.250000   acc = 0.992

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_68.csv
logged to wandb
Average incurred loss: 0.585  
Average sample loss: 0.586  
Average acc: 0.736  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.569  exp loss = 0.577  adjusted loss = 0.577  adv prob = 0.250000   acc = 0.754
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.616  exp loss = 0.626  adjusted loss = 0.626  adv prob = 0.250000   acc = 0.676
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.598  exp loss = 0.598  adjusted loss = 0.598  adv prob = 0.250000   acc = 0.767
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.516  exp loss = 0.508  adjusted loss = 0.508  adv prob = 0.250000   acc = 0.850
Spurious Score = 1.111
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_68.csv
logged to wandb
Current lr: 0.000010


Epoch [69]:
Training:
Average incurred loss: 0.482  
Average sample loss: 0.482  
Average acc: 0.942  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 651]:	loss = 0.560  exp loss = 0.567  adjusted loss = 0.567  adv prob = 0.250000   acc = 0.770
  waterbird_complete95 = 0, forest2water2 = 1  [n = 650]:	loss = 0.478  exp loss = 0.474  adjusted loss = 0.474  adv prob = 0.250000   acc = 0.977
  waterbird_complete95 = 1, forest2water2 = 0  [n = 459]:	loss = 0.468  exp loss = 0.464  adjusted loss = 0.464  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1440]:	loss = 0.452  exp loss = 0.448  adjusted loss = 0.448  adv prob = 0.250000   acc = 0.985
Average incurred loss: 0.483  
Average sample loss: 0.483  
Average acc: 0.947  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 641]:	loss = 0.558  exp loss = 0.559  adjusted loss = 0.559  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 0, forest2water2 = 1  [n = 678]:	loss = 0.486  exp loss = 0.477  adjusted loss = 0.477  adv prob = 0.250000   acc = 0.981
  waterbird_complete95 = 1, forest2water2 = 0  [n = 447]:	loss = 0.472  exp loss = 0.467  adjusted loss = 0.467  adv prob = 0.250000   acc = 0.993
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1434]:	loss = 0.451  exp loss = 0.449  adjusted loss = 0.449  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.487  
Average sample loss: 0.487  
Average acc: 0.934  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.566  exp loss = 0.562  adjusted loss = 0.562  adv prob = 0.250000   acc = 0.744
  waterbird_complete95 = 0, forest2water2 = 1  [n = 645]:	loss = 0.486  exp loss = 0.484  adjusted loss = 0.484  adv prob = 0.250000   acc = 0.961
  waterbird_complete95 = 1, forest2water2 = 0  [n = 455]:	loss = 0.467  exp loss = 0.468  adjusted loss = 0.468  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1432]:	loss = 0.456  exp loss = 0.456  adjusted loss = 0.456  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.488  
Average sample loss: 0.488  
Average acc: 0.936  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 678]:	loss = 0.571  exp loss = 0.570  adjusted loss = 0.570  adv prob = 0.250000   acc = 0.760
  waterbird_complete95 = 0, forest2water2 = 1  [n = 647]:	loss = 0.485  exp loss = 0.486  adjusted loss = 0.486  adv prob = 0.250000   acc = 0.955
  waterbird_complete95 = 1, forest2water2 = 0  [n = 427]:	loss = 0.466  exp loss = 0.460  adjusted loss = 0.460  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1448]:	loss = 0.457  exp loss = 0.455  adjusted loss = 0.455  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.491  
Average sample loss: 0.491  
Average acc: 0.933  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.586  exp loss = 0.596  adjusted loss = 0.596  adv prob = 0.250000   acc = 0.720
  waterbird_complete95 = 0, forest2water2 = 1  [n = 677]:	loss = 0.484  exp loss = 0.479  adjusted loss = 0.479  adv prob = 0.250000   acc = 0.976
  waterbird_complete95 = 1, forest2water2 = 0  [n = 430]:	loss = 0.468  exp loss = 0.463  adjusted loss = 0.463  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1425]:	loss = 0.457  exp loss = 0.452  adjusted loss = 0.452  adv prob = 0.250000   acc = 0.992
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_69.csv
logged to wandb
Average incurred loss: 0.493  
Average sample loss: 0.493  
Average acc: 0.931  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 542]:	loss = 0.577  exp loss = 0.571  adjusted loss = 0.571  adv prob = 0.250000   acc = 0.729
  waterbird_complete95 = 0, forest2water2 = 1  [n = 537]:	loss = 0.495  exp loss = 0.497  adjusted loss = 0.497  adv prob = 0.250000   acc = 0.963
  waterbird_complete95 = 1, forest2water2 = 0  [n = 388]:	loss = 0.476  exp loss = 0.480  adjusted loss = 0.480  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1078]:	loss = 0.456  exp loss = 0.456  adjusted loss = 0.456  adv prob = 0.250000   acc = 0.992

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_69.csv
logged to wandb
Average incurred loss: 0.586  
Average sample loss: 0.587  
Average acc: 0.730  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.569  exp loss = 0.578  adjusted loss = 0.578  adv prob = 0.250000   acc = 0.743
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.602  exp loss = 0.616  adjusted loss = 0.616  adv prob = 0.250000   acc = 0.697
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.627  exp loss = 0.624  adjusted loss = 0.624  adv prob = 0.250000   acc = 0.729
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.548  exp loss = 0.542  adjusted loss = 0.542  adv prob = 0.250000   acc = 0.797
Spurious Score = 1.079
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_69.csv
logged to wandb
Current lr: 0.000010


Epoch [70]:
Training:
Average incurred loss: 0.493  
Average sample loss: 0.493  
Average acc: 0.939  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 638]:	loss = 0.575  exp loss = 0.580  adjusted loss = 0.580  adv prob = 0.250000   acc = 0.754
  waterbird_complete95 = 0, forest2water2 = 1  [n = 644]:	loss = 0.486  exp loss = 0.488  adjusted loss = 0.488  adv prob = 0.250000   acc = 0.963
  waterbird_complete95 = 1, forest2water2 = 0  [n = 479]:	loss = 0.480  exp loss = 0.490  adjusted loss = 0.490  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1439]:	loss = 0.464  exp loss = 0.459  adjusted loss = 0.459  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.497  
Average sample loss: 0.497  
Average acc: 0.932  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 677]:	loss = 0.576  exp loss = 0.583  adjusted loss = 0.583  adv prob = 0.250000   acc = 0.743
  waterbird_complete95 = 0, forest2water2 = 1  [n = 665]:	loss = 0.502  exp loss = 0.501  adjusted loss = 0.501  adv prob = 0.250000   acc = 0.965
  waterbird_complete95 = 1, forest2water2 = 0  [n = 439]:	loss = 0.475  exp loss = 0.479  adjusted loss = 0.479  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1419]:	loss = 0.463  exp loss = 0.461  adjusted loss = 0.461  adv prob = 0.250000   acc = 0.984
Average incurred loss: 0.496  
Average sample loss: 0.496  
Average acc: 0.932  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 686]:	loss = 0.586  exp loss = 0.586  adjusted loss = 0.586  adv prob = 0.250000   acc = 0.736
  waterbird_complete95 = 0, forest2water2 = 1  [n = 680]:	loss = 0.495  exp loss = 0.491  adjusted loss = 0.491  adv prob = 0.250000   acc = 0.966
  waterbird_complete95 = 1, forest2water2 = 0  [n = 450]:	loss = 0.475  exp loss = 0.467  adjusted loss = 0.467  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1384]:	loss = 0.460  exp loss = 0.460  adjusted loss = 0.460  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.499  
Average sample loss: 0.499  
Average acc: 0.934  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 645]:	loss = 0.589  exp loss = 0.591  adjusted loss = 0.591  adv prob = 0.250000   acc = 0.726
  waterbird_complete95 = 0, forest2water2 = 1  [n = 673]:	loss = 0.495  exp loss = 0.488  adjusted loss = 0.488  adv prob = 0.250000   acc = 0.969
  waterbird_complete95 = 1, forest2water2 = 0  [n = 445]:	loss = 0.485  exp loss = 0.479  adjusted loss = 0.479  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1437]:	loss = 0.465  exp loss = 0.465  adjusted loss = 0.465  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.500  
Average sample loss: 0.500  
Average acc: 0.933  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 650]:	loss = 0.585  exp loss = 0.579  adjusted loss = 0.579  adv prob = 0.250000   acc = 0.726
  waterbird_complete95 = 0, forest2water2 = 1  [n = 670]:	loss = 0.499  exp loss = 0.500  adjusted loss = 0.500  adv prob = 0.250000   acc = 0.969
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.483  exp loss = 0.471  adjusted loss = 0.471  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1440]:	loss = 0.468  exp loss = 0.463  adjusted loss = 0.463  adv prob = 0.250000   acc = 0.990
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_70.csv
logged to wandb
Average incurred loss: 0.504  
Average sample loss: 0.504  
Average acc: 0.923  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 552]:	loss = 0.587  exp loss = 0.578  adjusted loss = 0.578  adv prob = 0.250000   acc = 0.703
  waterbird_complete95 = 0, forest2water2 = 1  [n = 502]:	loss = 0.506  exp loss = 0.502  adjusted loss = 0.502  adv prob = 0.250000   acc = 0.962
  waterbird_complete95 = 1, forest2water2 = 0  [n = 353]:	loss = 0.481  exp loss = 0.486  adjusted loss = 0.486  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1138]:	loss = 0.470  exp loss = 0.465  adjusted loss = 0.465  adv prob = 0.250000   acc = 0.988

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_70.csv
logged to wandb
Average incurred loss: 0.628  
Average sample loss: 0.629  
Average acc: 0.658  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.629  exp loss = 0.638  adjusted loss = 0.638  adv prob = 0.250000   acc = 0.636
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.685  exp loss = 0.698  adjusted loss = 0.698  adv prob = 0.250000   acc = 0.554
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.565  exp loss = 0.566  adjusted loss = 0.566  adv prob = 0.250000   acc = 0.827
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.486  exp loss = 0.479  adjusted loss = 0.479  adv prob = 0.250000   acc = 0.932
Spurious Score = 1.136
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_70.csv
logged to wandb
Current lr: 0.000010


Epoch [71]:
Training:
Average incurred loss: 0.504  
Average sample loss: 0.504  
Average acc: 0.932  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 637]:	loss = 0.590  exp loss = 0.589  adjusted loss = 0.589  adv prob = 0.250000   acc = 0.719
  waterbird_complete95 = 0, forest2water2 = 1  [n = 652]:	loss = 0.500  exp loss = 0.496  adjusted loss = 0.496  adv prob = 0.250000   acc = 0.965
  waterbird_complete95 = 1, forest2water2 = 0  [n = 444]:	loss = 0.492  exp loss = 0.485  adjusted loss = 0.485  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1467]:	loss = 0.473  exp loss = 0.474  adjusted loss = 0.474  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.508  
Average sample loss: 0.508  
Average acc: 0.920  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 658]:	loss = 0.600  exp loss = 0.599  adjusted loss = 0.599  adv prob = 0.250000   acc = 0.679
  waterbird_complete95 = 0, forest2water2 = 1  [n = 682]:	loss = 0.506  exp loss = 0.496  adjusted loss = 0.496  adv prob = 0.250000   acc = 0.965
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.489  exp loss = 0.488  adjusted loss = 0.488  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1412]:	loss = 0.471  exp loss = 0.472  adjusted loss = 0.472  adv prob = 0.250000   acc = 0.986
Average incurred loss: 0.507  
Average sample loss: 0.507  
Average acc: 0.925  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 658]:	loss = 0.596  exp loss = 0.596  adjusted loss = 0.596  adv prob = 0.250000   acc = 0.705
  waterbird_complete95 = 0, forest2water2 = 1  [n = 693]:	loss = 0.508  exp loss = 0.503  adjusted loss = 0.503  adv prob = 0.250000   acc = 0.962
  waterbird_complete95 = 1, forest2water2 = 0  [n = 456]:	loss = 0.489  exp loss = 0.491  adjusted loss = 0.491  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1393]:	loss = 0.470  exp loss = 0.472  adjusted loss = 0.472  adv prob = 0.250000   acc = 0.986
Average incurred loss: 0.510  
Average sample loss: 0.510  
Average acc: 0.925  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 666]:	loss = 0.593  exp loss = 0.597  adjusted loss = 0.597  adv prob = 0.250000   acc = 0.710
  waterbird_complete95 = 0, forest2water2 = 1  [n = 656]:	loss = 0.513  exp loss = 0.508  adjusted loss = 0.508  adv prob = 0.250000   acc = 0.971
  waterbird_complete95 = 1, forest2water2 = 0  [n = 438]:	loss = 0.487  exp loss = 0.497  adjusted loss = 0.497  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1440]:	loss = 0.478  exp loss = 0.479  adjusted loss = 0.479  adv prob = 0.250000   acc = 0.983
Average incurred loss: 0.511  
Average sample loss: 0.511  
Average acc: 0.926  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 684]:	loss = 0.595  exp loss = 0.596  adjusted loss = 0.596  adv prob = 0.250000   acc = 0.706
  waterbird_complete95 = 0, forest2water2 = 1  [n = 644]:	loss = 0.513  exp loss = 0.510  adjusted loss = 0.510  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 1, forest2water2 = 0  [n = 471]:	loss = 0.498  exp loss = 0.495  adjusted loss = 0.495  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1401]:	loss = 0.473  exp loss = 0.470  adjusted loss = 0.470  adv prob = 0.250000   acc = 0.994
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_71.csv
logged to wandb
Average incurred loss: 0.511  
Average sample loss: 0.511  
Average acc: 0.930  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 545]:	loss = 0.597  exp loss = 0.593  adjusted loss = 0.593  adv prob = 0.250000   acc = 0.719
  waterbird_complete95 = 0, forest2water2 = 1  [n = 507]:	loss = 0.508  exp loss = 0.503  adjusted loss = 0.503  adv prob = 0.250000   acc = 0.966
  waterbird_complete95 = 1, forest2water2 = 0  [n = 349]:	loss = 0.494  exp loss = 0.495  adjusted loss = 0.495  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1144]:	loss = 0.477  exp loss = 0.479  adjusted loss = 0.479  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_71.csv
logged to wandb
Average incurred loss: 0.615  
Average sample loss: 0.617  
Average acc: 0.678  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.615  exp loss = 0.626  adjusted loss = 0.626  adv prob = 0.250000   acc = 0.647
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.655  exp loss = 0.673  adjusted loss = 0.673  adv prob = 0.250000   acc = 0.612
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.585  exp loss = 0.582  adjusted loss = 0.582  adv prob = 0.250000   acc = 0.782
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.505  exp loss = 0.501  adjusted loss = 0.501  adv prob = 0.250000   acc = 0.917
Spurious Score = 1.122
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_71.csv
logged to wandb
Current lr: 0.000010


Epoch [72]:
Training:
Average incurred loss: 0.513  
Average sample loss: 0.513  
Average acc: 0.925  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 680]:	loss = 0.597  exp loss = 0.590  adjusted loss = 0.590  adv prob = 0.250000   acc = 0.690
  waterbird_complete95 = 0, forest2water2 = 1  [n = 649]:	loss = 0.515  exp loss = 0.517  adjusted loss = 0.517  adv prob = 0.250000   acc = 0.974
  waterbird_complete95 = 1, forest2water2 = 0  [n = 468]:	loss = 0.502  exp loss = 0.501  adjusted loss = 0.501  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1403]:	loss = 0.475  exp loss = 0.476  adjusted loss = 0.476  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.516  
Average sample loss: 0.516  
Average acc: 0.920  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 653]:	loss = 0.614  exp loss = 0.605  adjusted loss = 0.605  adv prob = 0.250000   acc = 0.675
  waterbird_complete95 = 0, forest2water2 = 1  [n = 698]:	loss = 0.514  exp loss = 0.515  adjusted loss = 0.515  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 1, forest2water2 = 0  [n = 447]:	loss = 0.500  exp loss = 0.509  adjusted loss = 0.509  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1402]:	loss = 0.477  exp loss = 0.477  adjusted loss = 0.477  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.518  
Average sample loss: 0.518  
Average acc: 0.929  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 642]:	loss = 0.599  exp loss = 0.600  adjusted loss = 0.600  adv prob = 0.250000   acc = 0.713
  waterbird_complete95 = 0, forest2water2 = 1  [n = 648]:	loss = 0.520  exp loss = 0.510  adjusted loss = 0.510  adv prob = 0.250000   acc = 0.948
  waterbird_complete95 = 1, forest2water2 = 0  [n = 450]:	loss = 0.507  exp loss = 0.511  adjusted loss = 0.511  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1460]:	loss = 0.485  exp loss = 0.491  adjusted loss = 0.491  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.520  
Average sample loss: 0.520  
Average acc: 0.915  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 669]:	loss = 0.610  exp loss = 0.606  adjusted loss = 0.606  adv prob = 0.250000   acc = 0.653
  waterbird_complete95 = 0, forest2water2 = 1  [n = 667]:	loss = 0.522  exp loss = 0.525  adjusted loss = 0.525  adv prob = 0.250000   acc = 0.957
  waterbird_complete95 = 1, forest2water2 = 0  [n = 439]:	loss = 0.504  exp loss = 0.499  adjusted loss = 0.499  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1425]:	loss = 0.481  exp loss = 0.477  adjusted loss = 0.477  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.522  
Average sample loss: 0.522  
Average acc: 0.922  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 701]:	loss = 0.605  exp loss = 0.609  adjusted loss = 0.609  adv prob = 0.250000   acc = 0.708
  waterbird_complete95 = 0, forest2water2 = 1  [n = 638]:	loss = 0.525  exp loss = 0.524  adjusted loss = 0.524  adv prob = 0.250000   acc = 0.959
  waterbird_complete95 = 1, forest2water2 = 0  [n = 465]:	loss = 0.503  exp loss = 0.495  adjusted loss = 0.495  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1396]:	loss = 0.485  exp loss = 0.480  adjusted loss = 0.480  adv prob = 0.250000   acc = 0.986
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_72.csv
logged to wandb
Average incurred loss: 0.522  
Average sample loss: 0.522  
Average acc: 0.923  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 503]:	loss = 0.606  exp loss = 0.603  adjusted loss = 0.603  adv prob = 0.250000   acc = 0.704
  waterbird_complete95 = 0, forest2water2 = 1  [n = 534]:	loss = 0.528  exp loss = 0.523  adjusted loss = 0.523  adv prob = 0.250000   acc = 0.944
  waterbird_complete95 = 1, forest2water2 = 0  [n = 337]:	loss = 0.505  exp loss = 0.504  adjusted loss = 0.504  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1171]:	loss = 0.489  exp loss = 0.487  adjusted loss = 0.487  adv prob = 0.250000   acc = 0.985

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_72.csv
logged to wandb
Average incurred loss: 0.596  
Average sample loss: 0.597  
Average acc: 0.711  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.578  exp loss = 0.591  adjusted loss = 0.591  adv prob = 0.250000   acc = 0.709
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.594  exp loss = 0.612  adjusted loss = 0.612  adv prob = 0.250000   acc = 0.717
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.672  exp loss = 0.662  adjusted loss = 0.662  adv prob = 0.250000   acc = 0.654
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.591  exp loss = 0.593  adjusted loss = 0.593  adv prob = 0.250000   acc = 0.759
Spurious Score = 1.071
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_72.csv
logged to wandb
Current lr: 0.000010


Epoch [73]:
Training:
Average incurred loss: 0.521  
Average sample loss: 0.521  
Average acc: 0.921  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 703]:	loss = 0.604  exp loss = 0.598  adjusted loss = 0.598  adv prob = 0.250000   acc = 0.696
  waterbird_complete95 = 0, forest2water2 = 1  [n = 643]:	loss = 0.527  exp loss = 0.525  adjusted loss = 0.525  adv prob = 0.250000   acc = 0.960
  waterbird_complete95 = 1, forest2water2 = 0  [n = 427]:	loss = 0.511  exp loss = 0.516  adjusted loss = 0.516  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1427]:	loss = 0.482  exp loss = 0.477  adjusted loss = 0.477  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.525  
Average sample loss: 0.525  
Average acc: 0.921  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 629]:	loss = 0.613  exp loss = 0.600  adjusted loss = 0.600  adv prob = 0.250000   acc = 0.674
  waterbird_complete95 = 0, forest2water2 = 1  [n = 681]:	loss = 0.528  exp loss = 0.518  adjusted loss = 0.518  adv prob = 0.250000   acc = 0.950
  waterbird_complete95 = 1, forest2water2 = 0  [n = 487]:	loss = 0.507  exp loss = 0.520  adjusted loss = 0.520  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1403]:	loss = 0.491  exp loss = 0.493  adjusted loss = 0.493  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.528  
Average sample loss: 0.528  
Average acc: 0.914  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 631]:	loss = 0.614  exp loss = 0.610  adjusted loss = 0.610  adv prob = 0.250000   acc = 0.648
  waterbird_complete95 = 0, forest2water2 = 1  [n = 658]:	loss = 0.530  exp loss = 0.534  adjusted loss = 0.534  adv prob = 0.250000   acc = 0.941
  waterbird_complete95 = 1, forest2water2 = 0  [n = 461]:	loss = 0.515  exp loss = 0.509  adjusted loss = 0.509  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1450]:	loss = 0.493  exp loss = 0.496  adjusted loss = 0.496  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.531  
Average sample loss: 0.531  
Average acc: 0.903  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 661]:	loss = 0.628  exp loss = 0.625  adjusted loss = 0.625  adv prob = 0.250000   acc = 0.604
  waterbird_complete95 = 0, forest2water2 = 1  [n = 672]:	loss = 0.531  exp loss = 0.529  adjusted loss = 0.529  adv prob = 0.250000   acc = 0.952
  waterbird_complete95 = 1, forest2water2 = 0  [n = 446]:	loss = 0.519  exp loss = 0.515  adjusted loss = 0.515  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1421]:	loss = 0.490  exp loss = 0.492  adjusted loss = 0.492  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.530  
Average sample loss: 0.530  
Average acc: 0.916  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 681]:	loss = 0.619  exp loss = 0.629  adjusted loss = 0.629  adv prob = 0.250000   acc = 0.659
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.531  exp loss = 0.527  adjusted loss = 0.527  adv prob = 0.250000   acc = 0.964
  waterbird_complete95 = 1, forest2water2 = 0  [n = 442]:	loss = 0.518  exp loss = 0.521  adjusted loss = 0.521  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1417]:	loss = 0.490  exp loss = 0.488  adjusted loss = 0.488  adv prob = 0.250000   acc = 0.991
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_73.csv
logged to wandb
Average incurred loss: 0.532  
Average sample loss: 0.532  
Average acc: 0.913  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 543]:	loss = 0.615  exp loss = 0.616  adjusted loss = 0.616  adv prob = 0.250000   acc = 0.665
  waterbird_complete95 = 0, forest2water2 = 1  [n = 520]:	loss = 0.538  exp loss = 0.540  adjusted loss = 0.540  adv prob = 0.250000   acc = 0.944
  waterbird_complete95 = 1, forest2water2 = 0  [n = 343]:	loss = 0.517  exp loss = 0.516  adjusted loss = 0.516  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1139]:	loss = 0.494  exp loss = 0.491  adjusted loss = 0.491  adv prob = 0.250000   acc = 0.991

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_73.csv
logged to wandb
Average incurred loss: 0.621  
Average sample loss: 0.623  
Average acc: 0.671  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.620  exp loss = 0.632  adjusted loss = 0.632  adv prob = 0.250000   acc = 0.640
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.650  exp loss = 0.673  adjusted loss = 0.673  adv prob = 0.250000   acc = 0.614
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.615  exp loss = 0.603  adjusted loss = 0.603  adv prob = 0.250000   acc = 0.767
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.529  exp loss = 0.527  adjusted loss = 0.527  adv prob = 0.250000   acc = 0.887
Spurious Score = 1.106
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_73.csv
logged to wandb
Current lr: 0.000010


Epoch [74]:
Training:
Average incurred loss: 0.532  
Average sample loss: 0.532  
Average acc: 0.913  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 623]:	loss = 0.619  exp loss = 0.614  adjusted loss = 0.614  adv prob = 0.250000   acc = 0.644
  waterbird_complete95 = 0, forest2water2 = 1  [n = 691]:	loss = 0.537  exp loss = 0.532  adjusted loss = 0.532  adv prob = 0.250000   acc = 0.936
  waterbird_complete95 = 1, forest2water2 = 0  [n = 459]:	loss = 0.515  exp loss = 0.518  adjusted loss = 0.518  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1427]:	loss = 0.496  exp loss = 0.502  adjusted loss = 0.502  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.536  
Average sample loss: 0.536  
Average acc: 0.915  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 687]:	loss = 0.620  exp loss = 0.622  adjusted loss = 0.622  adv prob = 0.250000   acc = 0.672
  waterbird_complete95 = 0, forest2water2 = 1  [n = 610]:	loss = 0.536  exp loss = 0.536  adjusted loss = 0.536  adv prob = 0.250000   acc = 0.951
  waterbird_complete95 = 1, forest2water2 = 0  [n = 457]:	loss = 0.525  exp loss = 0.520  adjusted loss = 0.520  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1446]:	loss = 0.499  exp loss = 0.498  adjusted loss = 0.498  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.537  
Average sample loss: 0.537  
Average acc: 0.908  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 637]:	loss = 0.631  exp loss = 0.636  adjusted loss = 0.636  adv prob = 0.250000   acc = 0.625
  waterbird_complete95 = 0, forest2water2 = 1  [n = 679]:	loss = 0.538  exp loss = 0.531  adjusted loss = 0.531  adv prob = 0.250000   acc = 0.940
  waterbird_complete95 = 1, forest2water2 = 0  [n = 437]:	loss = 0.527  exp loss = 0.526  adjusted loss = 0.526  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1447]:	loss = 0.498  exp loss = 0.499  adjusted loss = 0.499  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.539  
Average sample loss: 0.539  
Average acc: 0.908  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 676]:	loss = 0.628  exp loss = 0.629  adjusted loss = 0.629  adv prob = 0.250000   acc = 0.652
  waterbird_complete95 = 0, forest2water2 = 1  [n = 655]:	loss = 0.542  exp loss = 0.546  adjusted loss = 0.546  adv prob = 0.250000   acc = 0.931
  waterbird_complete95 = 1, forest2water2 = 0  [n = 469]:	loss = 0.524  exp loss = 0.523  adjusted loss = 0.523  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1400]:	loss = 0.499  exp loss = 0.498  adjusted loss = 0.498  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.542  
Average sample loss: 0.542  
Average acc: 0.904  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 688]:	loss = 0.626  exp loss = 0.641  adjusted loss = 0.641  adv prob = 0.250000   acc = 0.631
  waterbird_complete95 = 0, forest2water2 = 1  [n = 647]:	loss = 0.550  exp loss = 0.540  adjusted loss = 0.540  adv prob = 0.250000   acc = 0.946
  waterbird_complete95 = 1, forest2water2 = 0  [n = 465]:	loss = 0.529  exp loss = 0.529  adjusted loss = 0.529  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1400]:	loss = 0.500  exp loss = 0.501  adjusted loss = 0.501  adv prob = 0.250000   acc = 0.987
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_74.csv
logged to wandb
Average incurred loss: 0.541  
Average sample loss: 0.541  
Average acc: 0.904  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 537]:	loss = 0.629  exp loss = 0.621  adjusted loss = 0.621  adv prob = 0.250000   acc = 0.628
  waterbird_complete95 = 0, forest2water2 = 1  [n = 552]:	loss = 0.550  exp loss = 0.547  adjusted loss = 0.547  adv prob = 0.250000   acc = 0.944
  waterbird_complete95 = 1, forest2water2 = 0  [n = 319]:	loss = 0.532  exp loss = 0.525  adjusted loss = 0.525  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1137]:	loss = 0.498  exp loss = 0.496  adjusted loss = 0.496  adv prob = 0.250000   acc = 0.988

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_74.csv
logged to wandb
Average incurred loss: 0.655  
Average sample loss: 0.657  
Average acc: 0.585  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.665  exp loss = 0.675  adjusted loss = 0.675  adv prob = 0.250000   acc = 0.514
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.707  exp loss = 0.727  adjusted loss = 0.727  adv prob = 0.250000   acc = 0.483
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.585  exp loss = 0.580  adjusted loss = 0.580  adv prob = 0.250000   acc = 0.842
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.508  exp loss = 0.502  adjusted loss = 0.502  adv prob = 0.250000   acc = 0.940
Spurious Score = 1.097
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_74.csv
logged to wandb
Current lr: 0.000010


Epoch [75]:
Training:
Average incurred loss: 0.544  
Average sample loss: 0.544  
Average acc: 0.901  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.634  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 0.609
  waterbird_complete95 = 0, forest2water2 = 1  [n = 643]:	loss = 0.547  exp loss = 0.546  adjusted loss = 0.546  adv prob = 0.250000   acc = 0.936
  waterbird_complete95 = 1, forest2water2 = 0  [n = 432]:	loss = 0.535  exp loss = 0.533  adjusted loss = 0.533  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1455]:	loss = 0.504  exp loss = 0.500  adjusted loss = 0.500  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.545  
Average sample loss: 0.545  
Average acc: 0.896  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 690]:	loss = 0.631  exp loss = 0.624  adjusted loss = 0.624  adv prob = 0.250000   acc = 0.625
  waterbird_complete95 = 0, forest2water2 = 1  [n = 657]:	loss = 0.551  exp loss = 0.552  adjusted loss = 0.552  adv prob = 0.250000   acc = 0.919
  waterbird_complete95 = 1, forest2water2 = 0  [n = 439]:	loss = 0.535  exp loss = 0.534  adjusted loss = 0.534  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1414]:	loss = 0.503  exp loss = 0.503  adjusted loss = 0.503  adv prob = 0.250000   acc = 0.985
Average incurred loss: 0.544  
Average sample loss: 0.544  
Average acc: 0.906  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 642]:	loss = 0.628  exp loss = 0.623  adjusted loss = 0.623  adv prob = 0.250000   acc = 0.625
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.550  exp loss = 0.548  adjusted loss = 0.548  adv prob = 0.250000   acc = 0.932
  waterbird_complete95 = 1, forest2water2 = 0  [n = 475]:	loss = 0.533  exp loss = 0.529  adjusted loss = 0.529  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1423]:	loss = 0.506  exp loss = 0.505  adjusted loss = 0.505  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.548  
Average sample loss: 0.548  
Average acc: 0.898  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 678]:	loss = 0.636  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 0.597
  waterbird_complete95 = 0, forest2water2 = 1  [n = 632]:	loss = 0.551  exp loss = 0.550  adjusted loss = 0.550  adv prob = 0.250000   acc = 0.945
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.540  exp loss = 0.541  adjusted loss = 0.541  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1449]:	loss = 0.507  exp loss = 0.506  adjusted loss = 0.506  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.548  
Average sample loss: 0.548  
Average acc: 0.907  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 658]:	loss = 0.632  exp loss = 0.627  adjusted loss = 0.627  adv prob = 0.250000   acc = 0.643
  waterbird_complete95 = 0, forest2water2 = 1  [n = 674]:	loss = 0.556  exp loss = 0.547  adjusted loss = 0.547  adv prob = 0.250000   acc = 0.930
  waterbird_complete95 = 1, forest2water2 = 0  [n = 476]:	loss = 0.537  exp loss = 0.544  adjusted loss = 0.544  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1392]:	loss = 0.508  exp loss = 0.508  adjusted loss = 0.508  adv prob = 0.250000   acc = 0.989
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_75.csv
logged to wandb
Average incurred loss: 0.553  
Average sample loss: 0.553  
Average acc: 0.888  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 510]:	loss = 0.640  exp loss = 0.634  adjusted loss = 0.634  adv prob = 0.250000   acc = 0.584
  waterbird_complete95 = 0, forest2water2 = 1  [n = 568]:	loss = 0.565  exp loss = 0.561  adjusted loss = 0.561  adv prob = 0.250000   acc = 0.903
  waterbird_complete95 = 1, forest2water2 = 0  [n = 343]:	loss = 0.537  exp loss = 0.535  adjusted loss = 0.535  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1124]:	loss = 0.512  exp loss = 0.511  adjusted loss = 0.511  adv prob = 0.250000   acc = 0.983

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_75.csv
logged to wandb
Average incurred loss: 0.649  
Average sample loss: 0.651  
Average acc: 0.614  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.659  exp loss = 0.670  adjusted loss = 0.670  adv prob = 0.250000   acc = 0.540
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.684  exp loss = 0.702  adjusted loss = 0.702  adv prob = 0.250000   acc = 0.543
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.605  exp loss = 0.598  adjusted loss = 0.598  adv prob = 0.250000   acc = 0.812
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.537  exp loss = 0.535  adjusted loss = 0.535  adv prob = 0.250000   acc = 0.925
Spurious Score = 1.081
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_75.csv
logged to wandb
Current lr: 0.000010


Epoch [76]:
Training:
Average incurred loss: 0.553  
Average sample loss: 0.553  
Average acc: 0.887  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 688]:	loss = 0.647  exp loss = 0.647  adjusted loss = 0.647  adv prob = 0.250000   acc = 0.571
  waterbird_complete95 = 0, forest2water2 = 1  [n = 657]:	loss = 0.556  exp loss = 0.555  adjusted loss = 0.555  adv prob = 0.250000   acc = 0.927
  waterbird_complete95 = 1, forest2water2 = 0  [n = 435]:	loss = 0.535  exp loss = 0.538  adjusted loss = 0.538  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1420]:	loss = 0.511  exp loss = 0.507  adjusted loss = 0.507  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.553  
Average sample loss: 0.553  
Average acc: 0.900  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 602]:	loss = 0.638  exp loss = 0.646  adjusted loss = 0.646  adv prob = 0.250000   acc = 0.600
  waterbird_complete95 = 0, forest2water2 = 1  [n = 685]:	loss = 0.563  exp loss = 0.563  adjusted loss = 0.563  adv prob = 0.250000   acc = 0.908
  waterbird_complete95 = 1, forest2water2 = 0  [n = 481]:	loss = 0.545  exp loss = 0.545  adjusted loss = 0.545  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1432]:	loss = 0.515  exp loss = 0.513  adjusted loss = 0.513  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.556  
Average sample loss: 0.556  
Average acc: 0.885  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 692]:	loss = 0.649  exp loss = 0.648  adjusted loss = 0.648  adv prob = 0.250000   acc = 0.556
  waterbird_complete95 = 0, forest2water2 = 1  [n = 653]:	loss = 0.560  exp loss = 0.562  adjusted loss = 0.562  adv prob = 0.250000   acc = 0.931
  waterbird_complete95 = 1, forest2water2 = 0  [n = 437]:	loss = 0.538  exp loss = 0.540  adjusted loss = 0.540  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1418]:	loss = 0.514  exp loss = 0.516  adjusted loss = 0.516  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.556  
Average sample loss: 0.556  
Average acc: 0.888  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 664]:	loss = 0.645  exp loss = 0.646  adjusted loss = 0.646  adv prob = 0.250000   acc = 0.566
  waterbird_complete95 = 0, forest2water2 = 1  [n = 663]:	loss = 0.561  exp loss = 0.562  adjusted loss = 0.562  adv prob = 0.250000   acc = 0.917
  waterbird_complete95 = 1, forest2water2 = 0  [n = 435]:	loss = 0.550  exp loss = 0.557  adjusted loss = 0.557  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1438]:	loss = 0.515  exp loss = 0.514  adjusted loss = 0.514  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.560  
Average sample loss: 0.560  
Average acc: 0.887  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 698]:	loss = 0.647  exp loss = 0.651  adjusted loss = 0.651  adv prob = 0.250000   acc = 0.589
  waterbird_complete95 = 0, forest2water2 = 1  [n = 654]:	loss = 0.568  exp loss = 0.567  adjusted loss = 0.567  adv prob = 0.250000   acc = 0.913
  waterbird_complete95 = 1, forest2water2 = 0  [n = 449]:	loss = 0.545  exp loss = 0.550  adjusted loss = 0.550  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1399]:	loss = 0.517  exp loss = 0.516  adjusted loss = 0.516  adv prob = 0.250000   acc = 0.987
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_76.csv
logged to wandb
Average incurred loss: 0.558  
Average sample loss: 0.558  
Average acc: 0.904  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 504]:	loss = 0.638  exp loss = 0.627  adjusted loss = 0.627  adv prob = 0.250000   acc = 0.617
  waterbird_complete95 = 0, forest2water2 = 1  [n = 522]:	loss = 0.570  exp loss = 0.565  adjusted loss = 0.565  adv prob = 0.250000   acc = 0.920
  waterbird_complete95 = 1, forest2water2 = 0  [n = 369]:	loss = 0.551  exp loss = 0.553  adjusted loss = 0.553  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1150]:	loss = 0.519  exp loss = 0.521  adjusted loss = 0.521  adv prob = 0.250000   acc = 0.992

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_76.csv
logged to wandb
Average incurred loss: 0.625  
Average sample loss: 0.626  
Average acc: 0.672  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.623  exp loss = 0.636  adjusted loss = 0.636  adv prob = 0.250000   acc = 0.627
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.633  exp loss = 0.654  adjusted loss = 0.654  adv prob = 0.250000   acc = 0.655
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.653  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 0.714
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.576  exp loss = 0.576  adjusted loss = 0.576  adv prob = 0.250000   acc = 0.850
Spurious Score = 1.079
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_76.csv
logged to wandb
Current lr: 0.000010


Epoch [77]:
Training:
Average incurred loss: 0.561  
Average sample loss: 0.561  
Average acc: 0.881  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 659]:	loss = 0.647  exp loss = 0.636  adjusted loss = 0.636  adv prob = 0.250000   acc = 0.545
  waterbird_complete95 = 0, forest2water2 = 1  [n = 685]:	loss = 0.572  exp loss = 0.577  adjusted loss = 0.577  adv prob = 0.250000   acc = 0.911
  waterbird_complete95 = 1, forest2water2 = 0  [n = 460]:	loss = 0.546  exp loss = 0.552  adjusted loss = 0.552  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1396]:	loss = 0.519  exp loss = 0.520  adjusted loss = 0.520  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.562  
Average sample loss: 0.562  
Average acc: 0.892  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 643]:	loss = 0.652  exp loss = 0.655  adjusted loss = 0.655  adv prob = 0.250000   acc = 0.580
  waterbird_complete95 = 0, forest2water2 = 1  [n = 690]:	loss = 0.571  exp loss = 0.567  adjusted loss = 0.567  adv prob = 0.250000   acc = 0.914
  waterbird_complete95 = 1, forest2water2 = 0  [n = 439]:	loss = 0.545  exp loss = 0.551  adjusted loss = 0.551  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1428]:	loss = 0.522  exp loss = 0.520  adjusted loss = 0.520  adv prob = 0.250000   acc = 0.987
Average incurred loss: 0.568  
Average sample loss: 0.568  
Average acc: 0.873  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 662]:	loss = 0.658  exp loss = 0.655  adjusted loss = 0.655  adv prob = 0.250000   acc = 0.523
  waterbird_complete95 = 0, forest2water2 = 1  [n = 652]:	loss = 0.576  exp loss = 0.577  adjusted loss = 0.577  adv prob = 0.250000   acc = 0.885
  waterbird_complete95 = 1, forest2water2 = 0  [n = 444]:	loss = 0.555  exp loss = 0.559  adjusted loss = 0.559  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1442]:	loss = 0.526  exp loss = 0.527  adjusted loss = 0.527  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.566  
Average sample loss: 0.566  
Average acc: 0.882  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.652  exp loss = 0.667  adjusted loss = 0.667  adv prob = 0.250000   acc = 0.558
  waterbird_complete95 = 0, forest2water2 = 1  [n = 652]:	loss = 0.575  exp loss = 0.571  adjusted loss = 0.571  adv prob = 0.250000   acc = 0.897
  waterbird_complete95 = 1, forest2water2 = 0  [n = 446]:	loss = 0.558  exp loss = 0.551  adjusted loss = 0.551  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1434]:	loss = 0.523  exp loss = 0.523  adjusted loss = 0.523  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.568  
Average sample loss: 0.568  
Average acc: 0.881  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 657]:	loss = 0.657  exp loss = 0.655  adjusted loss = 0.655  adv prob = 0.250000   acc = 0.537
  waterbird_complete95 = 0, forest2water2 = 1  [n = 657]:	loss = 0.576  exp loss = 0.584  adjusted loss = 0.584  adv prob = 0.250000   acc = 0.903
  waterbird_complete95 = 1, forest2water2 = 0  [n = 469]:	loss = 0.554  exp loss = 0.548  adjusted loss = 0.548  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1417]:	loss = 0.528  exp loss = 0.526  adjusted loss = 0.526  adv prob = 0.250000   acc = 0.990
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_77.csv
logged to wandb
Average incurred loss: 0.568  
Average sample loss: 0.568  
Average acc: 0.881  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 559]:	loss = 0.645  exp loss = 0.645  adjusted loss = 0.645  adv prob = 0.250000   acc = 0.567
  waterbird_complete95 = 0, forest2water2 = 1  [n = 498]:	loss = 0.583  exp loss = 0.580  adjusted loss = 0.580  adv prob = 0.250000   acc = 0.906
  waterbird_complete95 = 1, forest2water2 = 0  [n = 348]:	loss = 0.559  exp loss = 0.566  adjusted loss = 0.566  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1140]:	loss = 0.526  exp loss = 0.520  adjusted loss = 0.520  adv prob = 0.250000   acc = 0.987

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_77.csv
logged to wandb
Average incurred loss: 0.650  
Average sample loss: 0.652  
Average acc: 0.602  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.654  exp loss = 0.667  adjusted loss = 0.667  adv prob = 0.250000   acc = 0.529
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.671  exp loss = 0.691  adjusted loss = 0.691  adv prob = 0.250000   acc = 0.564
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.644  exp loss = 0.634  adjusted loss = 0.634  adv prob = 0.250000   acc = 0.729
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.572  exp loss = 0.570  adjusted loss = 0.570  adv prob = 0.250000   acc = 0.865
Spurious Score = 1.077
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_77.csv
logged to wandb
Current lr: 0.000010


Epoch [78]:
Training:
Average incurred loss: 0.571  
Average sample loss: 0.571  
Average acc: 0.877  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.658  exp loss = 0.659  adjusted loss = 0.659  adv prob = 0.250000   acc = 0.536
  waterbird_complete95 = 0, forest2water2 = 1  [n = 630]:	loss = 0.580  exp loss = 0.583  adjusted loss = 0.583  adv prob = 0.250000   acc = 0.897
  waterbird_complete95 = 1, forest2water2 = 0  [n = 444]:	loss = 0.560  exp loss = 0.558  adjusted loss = 0.558  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1456]:	loss = 0.530  exp loss = 0.526  adjusted loss = 0.526  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.573  
Average sample loss: 0.573  
Average acc: 0.865  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 672]:	loss = 0.657  exp loss = 0.655  adjusted loss = 0.655  adv prob = 0.250000   acc = 0.531
  waterbird_complete95 = 0, forest2water2 = 1  [n = 695]:	loss = 0.589  exp loss = 0.583  adjusted loss = 0.583  adv prob = 0.250000   acc = 0.855
  waterbird_complete95 = 1, forest2water2 = 0  [n = 436]:	loss = 0.556  exp loss = 0.551  adjusted loss = 0.551  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1397]:	loss = 0.529  exp loss = 0.529  adjusted loss = 0.529  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.576  
Average sample loss: 0.576  
Average acc: 0.878  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 642]:	loss = 0.665  exp loss = 0.672  adjusted loss = 0.672  adv prob = 0.250000   acc = 0.526
  waterbird_complete95 = 0, forest2water2 = 1  [n = 695]:	loss = 0.589  exp loss = 0.588  adjusted loss = 0.588  adv prob = 0.250000   acc = 0.892
  waterbird_complete95 = 1, forest2water2 = 0  [n = 452]:	loss = 0.562  exp loss = 0.571  adjusted loss = 0.571  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1411]:	loss = 0.532  exp loss = 0.528  adjusted loss = 0.528  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.575  
Average sample loss: 0.575  
Average acc: 0.872  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 678]:	loss = 0.661  exp loss = 0.656  adjusted loss = 0.656  adv prob = 0.250000   acc = 0.518
  waterbird_complete95 = 0, forest2water2 = 1  [n = 644]:	loss = 0.586  exp loss = 0.582  adjusted loss = 0.582  adv prob = 0.250000   acc = 0.901
  waterbird_complete95 = 1, forest2water2 = 0  [n = 460]:	loss = 0.560  exp loss = 0.564  adjusted loss = 0.564  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1418]:	loss = 0.534  exp loss = 0.534  adjusted loss = 0.534  adv prob = 0.250000   acc = 0.987
Average incurred loss: 0.576  
Average sample loss: 0.576  
Average acc: 0.867  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 688]:	loss = 0.661  exp loss = 0.666  adjusted loss = 0.666  adv prob = 0.250000   acc = 0.523
  waterbird_complete95 = 0, forest2water2 = 1  [n = 641]:	loss = 0.586  exp loss = 0.587  adjusted loss = 0.587  adv prob = 0.250000   acc = 0.872
  waterbird_complete95 = 1, forest2water2 = 0  [n = 456]:	loss = 0.563  exp loss = 0.567  adjusted loss = 0.567  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1415]:	loss = 0.534  exp loss = 0.534  adjusted loss = 0.534  adv prob = 0.250000   acc = 0.990
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_78.csv
logged to wandb
Average incurred loss: 0.575  
Average sample loss: 0.575  
Average acc: 0.888  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 498]:	loss = 0.656  exp loss = 0.654  adjusted loss = 0.654  adv prob = 0.250000   acc = 0.570
  waterbird_complete95 = 0, forest2water2 = 1  [n = 529]:	loss = 0.590  exp loss = 0.589  adjusted loss = 0.589  adv prob = 0.250000   acc = 0.885
  waterbird_complete95 = 1, forest2water2 = 0  [n = 358]:	loss = 0.573  exp loss = 0.572  adjusted loss = 0.572  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1160]:	loss = 0.534  exp loss = 0.533  adjusted loss = 0.533  adv prob = 0.250000   acc = 0.991

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_78.csv
logged to wandb
Average incurred loss: 0.653  
Average sample loss: 0.654  
Average acc: 0.601  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.660  exp loss = 0.671  adjusted loss = 0.671  adv prob = 0.250000   acc = 0.531
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.677  exp loss = 0.696  adjusted loss = 0.696  adv prob = 0.250000   acc = 0.543
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.635  exp loss = 0.627  adjusted loss = 0.627  adv prob = 0.250000   acc = 0.759
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.565  exp loss = 0.560  adjusted loss = 0.560  adv prob = 0.250000   acc = 0.887
Spurious Score = 1.089
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_78.csv
logged to wandb
Current lr: 0.000010


Epoch [79]:
Training:
Average incurred loss: 0.579  
Average sample loss: 0.579  
Average acc: 0.866  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.667  exp loss = 0.672  adjusted loss = 0.672  adv prob = 0.250000   acc = 0.500
  waterbird_complete95 = 0, forest2water2 = 1  [n = 681]:	loss = 0.593  exp loss = 0.586  adjusted loss = 0.586  adv prob = 0.250000   acc = 0.883
  waterbird_complete95 = 1, forest2water2 = 0  [n = 463]:	loss = 0.564  exp loss = 0.569  adjusted loss = 0.569  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1386]:	loss = 0.535  exp loss = 0.536  adjusted loss = 0.536  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.581  
Average sample loss: 0.581  
Average acc: 0.867  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.667  exp loss = 0.665  adjusted loss = 0.665  adv prob = 0.250000   acc = 0.509
  waterbird_complete95 = 0, forest2water2 = 1  [n = 644]:	loss = 0.593  exp loss = 0.590  adjusted loss = 0.590  adv prob = 0.250000   acc = 0.882
  waterbird_complete95 = 1, forest2water2 = 0  [n = 437]:	loss = 0.565  exp loss = 0.576  adjusted loss = 0.576  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1449]:	loss = 0.541  exp loss = 0.537  adjusted loss = 0.537  adv prob = 0.250000   acc = 0.986
Average incurred loss: 0.582  
Average sample loss: 0.582  
Average acc: 0.865  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 676]:	loss = 0.665  exp loss = 0.655  adjusted loss = 0.655  adv prob = 0.250000   acc = 0.515
  waterbird_complete95 = 0, forest2water2 = 1  [n = 639]:	loss = 0.597  exp loss = 0.599  adjusted loss = 0.599  adv prob = 0.250000   acc = 0.858
  waterbird_complete95 = 1, forest2water2 = 0  [n = 469]:	loss = 0.572  exp loss = 0.575  adjusted loss = 0.575  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1416]:	loss = 0.539  exp loss = 0.534  adjusted loss = 0.534  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.583  
Average sample loss: 0.583  
Average acc: 0.867  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 662]:	loss = 0.667  exp loss = 0.663  adjusted loss = 0.663  adv prob = 0.250000   acc = 0.509
  waterbird_complete95 = 0, forest2water2 = 1  [n = 652]:	loss = 0.597  exp loss = 0.598  adjusted loss = 0.598  adv prob = 0.250000   acc = 0.876
  waterbird_complete95 = 1, forest2water2 = 0  [n = 433]:	loss = 0.573  exp loss = 0.578  adjusted loss = 0.578  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1453]:	loss = 0.542  exp loss = 0.537  adjusted loss = 0.537  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.585  
Average sample loss: 0.585  
Average acc: 0.857  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 648]:	loss = 0.671  exp loss = 0.677  adjusted loss = 0.677  adv prob = 0.250000   acc = 0.486
  waterbird_complete95 = 0, forest2water2 = 1  [n = 690]:	loss = 0.604  exp loss = 0.600  adjusted loss = 0.600  adv prob = 0.250000   acc = 0.862
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.569  exp loss = 0.563  adjusted loss = 0.563  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1404]:	loss = 0.542  exp loss = 0.540  adjusted loss = 0.540  adv prob = 0.250000   acc = 0.979
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_79.csv
logged to wandb
Average incurred loss: 0.588  
Average sample loss: 0.588  
Average acc: 0.850  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 522]:	loss = 0.677  exp loss = 0.677  adjusted loss = 0.677  adv prob = 0.250000   acc = 0.462
  waterbird_complete95 = 0, forest2water2 = 1  [n = 528]:	loss = 0.601  exp loss = 0.598  adjusted loss = 0.598  adv prob = 0.250000   acc = 0.843
  waterbird_complete95 = 1, forest2water2 = 0  [n = 346]:	loss = 0.574  exp loss = 0.579  adjusted loss = 0.579  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1149]:	loss = 0.546  exp loss = 0.545  adjusted loss = 0.545  adv prob = 0.250000   acc = 0.985

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_79.csv
logged to wandb
Average incurred loss: 0.671  
Average sample loss: 0.673  
Average acc: 0.555  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.683  exp loss = 0.694  adjusted loss = 0.694  adv prob = 0.250000   acc = 0.450
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.699  exp loss = 0.712  adjusted loss = 0.712  adv prob = 0.250000   acc = 0.481
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.630  exp loss = 0.627  adjusted loss = 0.627  adv prob = 0.250000   acc = 0.827
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.572  exp loss = 0.570  adjusted loss = 0.570  adv prob = 0.250000   acc = 0.917
Spurious Score = 1.045
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_79.csv
logged to wandb
Current lr: 0.000010


Epoch [80]:
Training:
Average incurred loss: 0.589  
Average sample loss: 0.589  
Average acc: 0.860  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 646]:	loss = 0.676  exp loss = 0.675  adjusted loss = 0.675  adv prob = 0.250000   acc = 0.485
  waterbird_complete95 = 0, forest2water2 = 1  [n = 667]:	loss = 0.605  exp loss = 0.603  adjusted loss = 0.603  adv prob = 0.250000   acc = 0.853
  waterbird_complete95 = 1, forest2water2 = 0  [n = 430]:	loss = 0.576  exp loss = 0.584  adjusted loss = 0.584  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1457]:	loss = 0.546  exp loss = 0.546  adjusted loss = 0.546  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.589  
Average sample loss: 0.589  
Average acc: 0.853  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 681]:	loss = 0.669  exp loss = 0.668  adjusted loss = 0.668  adv prob = 0.250000   acc = 0.501
  waterbird_complete95 = 0, forest2water2 = 1  [n = 639]:	loss = 0.608  exp loss = 0.606  adjusted loss = 0.606  adv prob = 0.250000   acc = 0.826
  waterbird_complete95 = 1, forest2water2 = 0  [n = 456]:	loss = 0.574  exp loss = 0.569  adjusted loss = 0.569  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1424]:	loss = 0.547  exp loss = 0.549  adjusted loss = 0.549  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.592  
Average sample loss: 0.592  
Average acc: 0.853  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 676]:	loss = 0.674  exp loss = 0.672  adjusted loss = 0.672  adv prob = 0.250000   acc = 0.472
  waterbird_complete95 = 0, forest2water2 = 1  [n = 657]:	loss = 0.610  exp loss = 0.603  adjusted loss = 0.603  adv prob = 0.250000   acc = 0.861
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.571  exp loss = 0.567  adjusted loss = 0.567  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1419]:	loss = 0.551  exp loss = 0.551  adjusted loss = 0.551  adv prob = 0.250000   acc = 0.985
Average incurred loss: 0.591  
Average sample loss: 0.591  
Average acc: 0.854  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.674  exp loss = 0.671  adjusted loss = 0.671  adv prob = 0.250000   acc = 0.469
  waterbird_complete95 = 0, forest2water2 = 1  [n = 653]:	loss = 0.609  exp loss = 0.609  adjusted loss = 0.609  adv prob = 0.250000   acc = 0.851
  waterbird_complete95 = 1, forest2water2 = 0  [n = 424]:	loss = 0.577  exp loss = 0.579  adjusted loss = 0.579  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1453]:	loss = 0.548  exp loss = 0.547  adjusted loss = 0.547  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.593  
Average sample loss: 0.593  
Average acc: 0.860  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 663]:	loss = 0.679  exp loss = 0.682  adjusted loss = 0.682  adv prob = 0.250000   acc = 0.489
  waterbird_complete95 = 0, forest2water2 = 1  [n = 656]:	loss = 0.610  exp loss = 0.615  adjusted loss = 0.615  adv prob = 0.250000   acc = 0.851
  waterbird_complete95 = 1, forest2water2 = 0  [n = 495]:	loss = 0.578  exp loss = 0.585  adjusted loss = 0.585  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1386]:	loss = 0.550  exp loss = 0.546  adjusted loss = 0.546  adv prob = 0.250000   acc = 0.991
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_80.csv
logged to wandb
Average incurred loss: 0.593  
Average sample loss: 0.594  
Average acc: 0.848  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 512]:	loss = 0.680  exp loss = 0.680  adjusted loss = 0.680  adv prob = 0.250000   acc = 0.455
  waterbird_complete95 = 0, forest2water2 = 1  [n = 562]:	loss = 0.613  exp loss = 0.610  adjusted loss = 0.610  adv prob = 0.250000   acc = 0.824
  waterbird_complete95 = 1, forest2water2 = 0  [n = 353]:	loss = 0.579  exp loss = 0.577  adjusted loss = 0.577  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1118]:	loss = 0.549  exp loss = 0.550  adjusted loss = 0.550  adv prob = 0.250000   acc = 0.991

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_80.csv
logged to wandb
Average incurred loss: 0.657  
Average sample loss: 0.658  
Average acc: 0.603  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.661  exp loss = 0.672  adjusted loss = 0.672  adv prob = 0.250000   acc = 0.531
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.664  exp loss = 0.680  adjusted loss = 0.680  adv prob = 0.250000   acc = 0.588
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.660  exp loss = 0.651  adjusted loss = 0.651  adv prob = 0.250000   acc = 0.722
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.615  exp loss = 0.612  adjusted loss = 0.612  adv prob = 0.250000   acc = 0.789
Spurious Score = 1.008
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_80.csv
logged to wandb
Current lr: 0.000010


Epoch [81]:
Training:
Average incurred loss: 0.597  
Average sample loss: 0.597  
Average acc: 0.843  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 669]:	loss = 0.684  exp loss = 0.681  adjusted loss = 0.681  adv prob = 0.250000   acc = 0.442
  waterbird_complete95 = 0, forest2water2 = 1  [n = 638]:	loss = 0.611  exp loss = 0.615  adjusted loss = 0.615  adv prob = 0.250000   acc = 0.829
  waterbird_complete95 = 1, forest2water2 = 0  [n = 467]:	loss = 0.582  exp loss = 0.590  adjusted loss = 0.590  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1426]:	loss = 0.556  exp loss = 0.558  adjusted loss = 0.558  adv prob = 0.250000   acc = 0.986
Average incurred loss: 0.598  
Average sample loss: 0.598  
Average acc: 0.844  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 655]:	loss = 0.682  exp loss = 0.682  adjusted loss = 0.682  adv prob = 0.250000   acc = 0.438
  waterbird_complete95 = 0, forest2water2 = 1  [n = 668]:	loss = 0.617  exp loss = 0.609  adjusted loss = 0.609  adv prob = 0.250000   acc = 0.828
  waterbird_complete95 = 1, forest2water2 = 0  [n = 461]:	loss = 0.587  exp loss = 0.586  adjusted loss = 0.586  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1416]:	loss = 0.554  exp loss = 0.554  adjusted loss = 0.554  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.597  
Average sample loss: 0.597  
Average acc: 0.853  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 687]:	loss = 0.676  exp loss = 0.674  adjusted loss = 0.674  adv prob = 0.250000   acc = 0.482
  waterbird_complete95 = 0, forest2water2 = 1  [n = 652]:	loss = 0.618  exp loss = 0.615  adjusted loss = 0.615  adv prob = 0.250000   acc = 0.845
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.584  exp loss = 0.587  adjusted loss = 0.587  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1421]:	loss = 0.553  exp loss = 0.554  adjusted loss = 0.554  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.601  
Average sample loss: 0.601  
Average acc: 0.842  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 654]:	loss = 0.681  exp loss = 0.680  adjusted loss = 0.680  adv prob = 0.250000   acc = 0.476
  waterbird_complete95 = 0, forest2water2 = 1  [n = 689]:	loss = 0.626  exp loss = 0.627  adjusted loss = 0.627  adv prob = 0.250000   acc = 0.788
  waterbird_complete95 = 1, forest2water2 = 0  [n = 445]:	loss = 0.580  exp loss = 0.577  adjusted loss = 0.577  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1412]:	loss = 0.558  exp loss = 0.557  adjusted loss = 0.557  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.602  
Average sample loss: 0.602  
Average acc: 0.833  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 664]:	loss = 0.686  exp loss = 0.691  adjusted loss = 0.691  adv prob = 0.250000   acc = 0.417
  waterbird_complete95 = 0, forest2water2 = 1  [n = 647]:	loss = 0.621  exp loss = 0.617  adjusted loss = 0.617  adv prob = 0.250000   acc = 0.810
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.584  exp loss = 0.582  adjusted loss = 0.582  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1449]:	loss = 0.561  exp loss = 0.557  adjusted loss = 0.557  adv prob = 0.250000   acc = 0.983
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_81.csv
logged to wandb
Average incurred loss: 0.603  
Average sample loss: 0.603  
Average acc: 0.840  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 519]:	loss = 0.686  exp loss = 0.684  adjusted loss = 0.684  adv prob = 0.250000   acc = 0.441
  waterbird_complete95 = 0, forest2water2 = 1  [n = 540]:	loss = 0.625  exp loss = 0.623  adjusted loss = 0.623  adv prob = 0.250000   acc = 0.819
  waterbird_complete95 = 1, forest2water2 = 0  [n = 353]:	loss = 0.589  exp loss = 0.588  adjusted loss = 0.588  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1133]:	loss = 0.559  exp loss = 0.556  adjusted loss = 0.556  adv prob = 0.250000   acc = 0.982

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_81.csv
logged to wandb
Average incurred loss: 0.646  
Average sample loss: 0.647  
Average acc: 0.642  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.648  exp loss = 0.658  adjusted loss = 0.658  adv prob = 0.250000   acc = 0.567
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.629  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 0.691
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.686  exp loss = 0.676  adjusted loss = 0.676  adv prob = 0.250000   acc = 0.662
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.655  exp loss = 0.659  adjusted loss = 0.659  adv prob = 0.250000   acc = 0.714
Spurious Score = 0.948
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_81.csv
logged to wandb
Current lr: 0.000010


Epoch [82]:
Training:
Average incurred loss: 0.605  
Average sample loss: 0.605  
Average acc: 0.843  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 655]:	loss = 0.685  exp loss = 0.686  adjusted loss = 0.686  adv prob = 0.250000   acc = 0.441
  waterbird_complete95 = 0, forest2water2 = 1  [n = 651]:	loss = 0.628  exp loss = 0.625  adjusted loss = 0.625  adv prob = 0.250000   acc = 0.822
  waterbird_complete95 = 1, forest2water2 = 0  [n = 435]:	loss = 0.589  exp loss = 0.589  adjusted loss = 0.589  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1459]:	loss = 0.563  exp loss = 0.563  adjusted loss = 0.563  adv prob = 0.250000   acc = 0.986
Average incurred loss: 0.606  
Average sample loss: 0.606  
Average acc: 0.837  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 659]:	loss = 0.686  exp loss = 0.688  adjusted loss = 0.688  adv prob = 0.250000   acc = 0.440
  waterbird_complete95 = 0, forest2water2 = 1  [n = 656]:	loss = 0.629  exp loss = 0.618  adjusted loss = 0.618  adv prob = 0.250000   acc = 0.788
  waterbird_complete95 = 1, forest2water2 = 0  [n = 479]:	loss = 0.589  exp loss = 0.591  adjusted loss = 0.591  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1406]:	loss = 0.563  exp loss = 0.563  adjusted loss = 0.563  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.605  
Average sample loss: 0.605  
Average acc: 0.835  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 638]:	loss = 0.688  exp loss = 0.690  adjusted loss = 0.690  adv prob = 0.250000   acc = 0.417
  waterbird_complete95 = 0, forest2water2 = 1  [n = 669]:	loss = 0.627  exp loss = 0.625  adjusted loss = 0.625  adv prob = 0.250000   acc = 0.795
  waterbird_complete95 = 1, forest2water2 = 0  [n = 469]:	loss = 0.587  exp loss = 0.584  adjusted loss = 0.584  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1424]:	loss = 0.564  exp loss = 0.564  adjusted loss = 0.564  adv prob = 0.250000   acc = 0.987
Average incurred loss: 0.609  
Average sample loss: 0.609  
Average acc: 0.823  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 679]:	loss = 0.694  exp loss = 0.699  adjusted loss = 0.699  adv prob = 0.250000   acc = 0.396
  waterbird_complete95 = 0, forest2water2 = 1  [n = 644]:	loss = 0.630  exp loss = 0.625  adjusted loss = 0.625  adv prob = 0.250000   acc = 0.781
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.595  exp loss = 0.596  adjusted loss = 0.596  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1419]:	loss = 0.564  exp loss = 0.563  adjusted loss = 0.563  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.611  
Average sample loss: 0.611  
Average acc: 0.818  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 669]:	loss = 0.691  exp loss = 0.698  adjusted loss = 0.698  adv prob = 0.250000   acc = 0.416
  waterbird_complete95 = 0, forest2water2 = 1  [n = 676]:	loss = 0.636  exp loss = 0.635  adjusted loss = 0.635  adv prob = 0.250000   acc = 0.750
  waterbird_complete95 = 1, forest2water2 = 0  [n = 432]:	loss = 0.592  exp loss = 0.596  adjusted loss = 0.596  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1423]:	loss = 0.568  exp loss = 0.565  adjusted loss = 0.565  adv prob = 0.250000   acc = 0.985
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_82.csv
logged to wandb
Average incurred loss: 0.611  
Average sample loss: 0.611  
Average acc: 0.822  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 548]:	loss = 0.694  exp loss = 0.697  adjusted loss = 0.697  adv prob = 0.250000   acc = 0.398
  waterbird_complete95 = 0, forest2water2 = 1  [n = 538]:	loss = 0.633  exp loss = 0.630  adjusted loss = 0.630  adv prob = 0.250000   acc = 0.781
  waterbird_complete95 = 1, forest2water2 = 0  [n = 333]:	loss = 0.589  exp loss = 0.595  adjusted loss = 0.595  adv prob = 0.250000   acc = 0.997
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1126]:	loss = 0.566  exp loss = 0.561  adjusted loss = 0.561  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_82.csv
logged to wandb
Average incurred loss: 0.662  
Average sample loss: 0.663  
Average acc: 0.591  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.667  exp loss = 0.675  adjusted loss = 0.675  adv prob = 0.250000   acc = 0.516
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.660  exp loss = 0.675  adjusted loss = 0.675  adv prob = 0.250000   acc = 0.590
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.670  exp loss = 0.661  adjusted loss = 0.661  adv prob = 0.250000   acc = 0.714
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.639  exp loss = 0.637  adjusted loss = 0.637  adv prob = 0.250000   acc = 0.737
Spurious Score = 0.961
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_82.csv
logged to wandb
Current lr: 0.000010


Epoch [83]:
Training:
Average incurred loss: 0.615  
Average sample loss: 0.615  
Average acc: 0.808  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 686]:	loss = 0.697  exp loss = 0.700  adjusted loss = 0.700  adv prob = 0.250000   acc = 0.399
  waterbird_complete95 = 0, forest2water2 = 1  [n = 697]:	loss = 0.641  exp loss = 0.639  adjusted loss = 0.639  adv prob = 0.250000   acc = 0.737
  waterbird_complete95 = 1, forest2water2 = 0  [n = 445]:	loss = 0.596  exp loss = 0.598  adjusted loss = 0.598  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1372]:	loss = 0.567  exp loss = 0.567  adjusted loss = 0.567  adv prob = 0.250000   acc = 0.987
Average incurred loss: 0.612  
Average sample loss: 0.612  
Average acc: 0.827  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 661]:	loss = 0.693  exp loss = 0.694  adjusted loss = 0.694  adv prob = 0.250000   acc = 0.410
  waterbird_complete95 = 0, forest2water2 = 1  [n = 644]:	loss = 0.636  exp loss = 0.637  adjusted loss = 0.637  adv prob = 0.250000   acc = 0.759
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.598  exp loss = 0.596  adjusted loss = 0.596  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1429]:	loss = 0.569  exp loss = 0.569  adjusted loss = 0.569  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.616  
Average sample loss: 0.616  
Average acc: 0.807  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 707]:	loss = 0.697  exp loss = 0.697  adjusted loss = 0.697  adv prob = 0.250000   acc = 0.392
  waterbird_complete95 = 0, forest2water2 = 1  [n = 666]:	loss = 0.641  exp loss = 0.640  adjusted loss = 0.640  adv prob = 0.250000   acc = 0.743
  waterbird_complete95 = 1, forest2water2 = 0  [n = 432]:	loss = 0.591  exp loss = 0.598  adjusted loss = 0.598  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1395]:	loss = 0.572  exp loss = 0.570  adjusted loss = 0.570  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.615  
Average sample loss: 0.615  
Average acc: 0.817  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 641]:	loss = 0.697  exp loss = 0.704  adjusted loss = 0.704  adv prob = 0.250000   acc = 0.362
  waterbird_complete95 = 0, forest2water2 = 1  [n = 672]:	loss = 0.639  exp loss = 0.635  adjusted loss = 0.635  adv prob = 0.250000   acc = 0.768
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.597  exp loss = 0.601  adjusted loss = 0.601  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1429]:	loss = 0.574  exp loss = 0.574  adjusted loss = 0.574  adv prob = 0.250000   acc = 0.987
Average incurred loss: 0.617  
Average sample loss: 0.617  
Average acc: 0.810  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 649]:	loss = 0.697  exp loss = 0.697  adjusted loss = 0.697  adv prob = 0.250000   acc = 0.379
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.643  exp loss = 0.636  adjusted loss = 0.636  adv prob = 0.250000   acc = 0.726
  waterbird_complete95 = 1, forest2water2 = 0  [n = 425]:	loss = 0.594  exp loss = 0.594  adjusted loss = 0.594  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1466]:	loss = 0.578  exp loss = 0.578  adjusted loss = 0.578  adv prob = 0.250000   acc = 0.984
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_83.csv
logged to wandb
Average incurred loss: 0.617  
Average sample loss: 0.617  
Average acc: 0.820  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 504]:	loss = 0.698  exp loss = 0.697  adjusted loss = 0.697  adv prob = 0.250000   acc = 0.377
  waterbird_complete95 = 0, forest2water2 = 1  [n = 495]:	loss = 0.640  exp loss = 0.640  adjusted loss = 0.640  adv prob = 0.250000   acc = 0.735
  waterbird_complete95 = 1, forest2water2 = 0  [n = 380]:	loss = 0.599  exp loss = 0.600  adjusted loss = 0.600  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1166]:	loss = 0.577  exp loss = 0.575  adjusted loss = 0.575  adv prob = 0.250000   acc = 0.988

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_83.csv
logged to wandb
Average incurred loss: 0.663  
Average sample loss: 0.664  
Average acc: 0.588  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.668  exp loss = 0.675  adjusted loss = 0.675  adv prob = 0.250000   acc = 0.512
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.657  exp loss = 0.670  adjusted loss = 0.670  adv prob = 0.250000   acc = 0.603
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.677  exp loss = 0.667  adjusted loss = 0.667  adv prob = 0.250000   acc = 0.707
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.657  exp loss = 0.654  adjusted loss = 0.654  adv prob = 0.250000   acc = 0.684
Spurious Score = 0.913
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_83.csv
logged to wandb
Current lr: 0.000010


Epoch [84]:
Training:
Average incurred loss: 0.619  
Average sample loss: 0.619  
Average acc: 0.799  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 678]:	loss = 0.699  exp loss = 0.697  adjusted loss = 0.697  adv prob = 0.250000   acc = 0.366
  waterbird_complete95 = 0, forest2water2 = 1  [n = 687]:	loss = 0.646  exp loss = 0.648  adjusted loss = 0.648  adv prob = 0.250000   acc = 0.703
  waterbird_complete95 = 1, forest2water2 = 0  [n = 452]:	loss = 0.598  exp loss = 0.599  adjusted loss = 0.599  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1383]:	loss = 0.573  exp loss = 0.569  adjusted loss = 0.569  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.623  
Average sample loss: 0.623  
Average acc: 0.798  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 648]:	loss = 0.708  exp loss = 0.714  adjusted loss = 0.714  adv prob = 0.250000   acc = 0.344
  waterbird_complete95 = 0, forest2water2 = 1  [n = 664]:	loss = 0.645  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 0.700
  waterbird_complete95 = 1, forest2water2 = 0  [n = 445]:	loss = 0.605  exp loss = 0.604  adjusted loss = 0.604  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1443]:	loss = 0.579  exp loss = 0.579  adjusted loss = 0.579  adv prob = 0.250000   acc = 0.985
Average incurred loss: 0.622  
Average sample loss: 0.622  
Average acc: 0.805  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 635]:	loss = 0.699  exp loss = 0.692  adjusted loss = 0.692  adv prob = 0.250000   acc = 0.348
  waterbird_complete95 = 0, forest2water2 = 1  [n = 624]:	loss = 0.649  exp loss = 0.649  adjusted loss = 0.649  adv prob = 0.250000   acc = 0.694
  waterbird_complete95 = 1, forest2water2 = 0  [n = 474]:	loss = 0.606  exp loss = 0.605  adjusted loss = 0.605  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1467]:	loss = 0.581  exp loss = 0.583  adjusted loss = 0.583  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.623  
Average sample loss: 0.623  
Average acc: 0.798  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 694]:	loss = 0.701  exp loss = 0.704  adjusted loss = 0.704  adv prob = 0.250000   acc = 0.353
  waterbird_complete95 = 0, forest2water2 = 1  [n = 647]:	loss = 0.651  exp loss = 0.648  adjusted loss = 0.648  adv prob = 0.250000   acc = 0.723
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.599  exp loss = 0.600  adjusted loss = 0.600  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1401]:	loss = 0.580  exp loss = 0.581  adjusted loss = 0.581  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.624  
Average sample loss: 0.624  
Average acc: 0.789  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 689]:	loss = 0.700  exp loss = 0.697  adjusted loss = 0.697  adv prob = 0.250000   acc = 0.382
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.654  exp loss = 0.655  adjusted loss = 0.655  adv prob = 0.250000   acc = 0.641
  waterbird_complete95 = 1, forest2water2 = 0  [n = 436]:	loss = 0.599  exp loss = 0.596  adjusted loss = 0.596  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1415]:	loss = 0.581  exp loss = 0.578  adjusted loss = 0.578  adv prob = 0.250000   acc = 0.991
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_84.csv
logged to wandb
Average incurred loss: 0.626  
Average sample loss: 0.626  
Average acc: 0.790  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 504]:	loss = 0.707  exp loss = 0.703  adjusted loss = 0.703  adv prob = 0.250000   acc = 0.333
  waterbird_complete95 = 0, forest2water2 = 1  [n = 552]:	loss = 0.653  exp loss = 0.652  adjusted loss = 0.652  adv prob = 0.250000   acc = 0.683
  waterbird_complete95 = 1, forest2water2 = 0  [n = 341]:	loss = 0.602  exp loss = 0.600  adjusted loss = 0.600  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1148]:	loss = 0.584  exp loss = 0.583  adjusted loss = 0.583  adv prob = 0.250000   acc = 0.979

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_84.csv
logged to wandb
Average incurred loss: 0.671  
Average sample loss: 0.672  
Average acc: 0.561  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.679  exp loss = 0.687  adjusted loss = 0.687  adv prob = 0.250000   acc = 0.460
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.669  exp loss = 0.682  adjusted loss = 0.682  adv prob = 0.250000   acc = 0.569
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.672  exp loss = 0.664  adjusted loss = 0.664  adv prob = 0.250000   acc = 0.722
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.648  exp loss = 0.648  adjusted loss = 0.648  adv prob = 0.250000   acc = 0.729
Spurious Score = 0.922
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_84.csv
logged to wandb
Current lr: 0.000010


Epoch [85]:
Training:
Average incurred loss: 0.625  
Average sample loss: 0.625  
Average acc: 0.802  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 662]:	loss = 0.703  exp loss = 0.705  adjusted loss = 0.705  adv prob = 0.250000   acc = 0.358
  waterbird_complete95 = 0, forest2water2 = 1  [n = 633]:	loss = 0.651  exp loss = 0.656  adjusted loss = 0.656  adv prob = 0.250000   acc = 0.705
  waterbird_complete95 = 1, forest2water2 = 0  [n = 469]:	loss = 0.606  exp loss = 0.606  adjusted loss = 0.606  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1436]:	loss = 0.583  exp loss = 0.585  adjusted loss = 0.585  adv prob = 0.250000   acc = 0.985
Average incurred loss: 0.628  
Average sample loss: 0.628  
Average acc: 0.790  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 642]:	loss = 0.708  exp loss = 0.713  adjusted loss = 0.713  adv prob = 0.250000   acc = 0.324
  waterbird_complete95 = 0, forest2water2 = 1  [n = 669]:	loss = 0.655  exp loss = 0.655  adjusted loss = 0.655  adv prob = 0.250000   acc = 0.670
  waterbird_complete95 = 1, forest2water2 = 0  [n = 469]:	loss = 0.607  exp loss = 0.612  adjusted loss = 0.612  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1420]:	loss = 0.585  exp loss = 0.585  adjusted loss = 0.585  adv prob = 0.250000   acc = 0.987
Average incurred loss: 0.630  
Average sample loss: 0.630  
Average acc: 0.767  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 669]:	loss = 0.710  exp loss = 0.710  adjusted loss = 0.710  adv prob = 0.250000   acc = 0.320
  waterbird_complete95 = 0, forest2water2 = 1  [n = 710]:	loss = 0.658  exp loss = 0.660  adjusted loss = 0.660  adv prob = 0.250000   acc = 0.615
  waterbird_complete95 = 1, forest2water2 = 0  [n = 439]:	loss = 0.601  exp loss = 0.605  adjusted loss = 0.605  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1382]:	loss = 0.586  exp loss = 0.585  adjusted loss = 0.585  adv prob = 0.250000   acc = 0.987
Average incurred loss: 0.631  
Average sample loss: 0.631  
Average acc: 0.767  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 694]:	loss = 0.707  exp loss = 0.711  adjusted loss = 0.711  adv prob = 0.250000   acc = 0.310
  waterbird_complete95 = 0, forest2water2 = 1  [n = 667]:	loss = 0.661  exp loss = 0.663  adjusted loss = 0.663  adv prob = 0.250000   acc = 0.627
  waterbird_complete95 = 1, forest2water2 = 0  [n = 419]:	loss = 0.607  exp loss = 0.608  adjusted loss = 0.608  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1420]:	loss = 0.587  exp loss = 0.586  adjusted loss = 0.586  adv prob = 0.250000   acc = 0.988
Average incurred loss: 0.631  
Average sample loss: 0.631  
Average acc: 0.777  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 663]:	loss = 0.709  exp loss = 0.713  adjusted loss = 0.713  adv prob = 0.250000   acc = 0.324
  waterbird_complete95 = 0, forest2water2 = 1  [n = 643]:	loss = 0.661  exp loss = 0.661  adjusted loss = 0.661  adv prob = 0.250000   acc = 0.613
  waterbird_complete95 = 1, forest2water2 = 0  [n = 472]:	loss = 0.608  exp loss = 0.604  adjusted loss = 0.604  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1422]:	loss = 0.590  exp loss = 0.587  adjusted loss = 0.587  adv prob = 0.250000   acc = 0.989
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_85.csv
logged to wandb
Average incurred loss: 0.631  
Average sample loss: 0.631  
Average acc: 0.774  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 518]:	loss = 0.708  exp loss = 0.705  adjusted loss = 0.705  adv prob = 0.250000   acc = 0.299
  waterbird_complete95 = 0, forest2water2 = 1  [n = 512]:	loss = 0.662  exp loss = 0.661  adjusted loss = 0.661  adv prob = 0.250000   acc = 0.609
  waterbird_complete95 = 1, forest2water2 = 0  [n = 338]:	loss = 0.609  exp loss = 0.608  adjusted loss = 0.608  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1177]:	loss = 0.590  exp loss = 0.594  adjusted loss = 0.594  adv prob = 0.250000   acc = 0.989

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_85.csv
logged to wandb
Average incurred loss: 0.706  
Average sample loss: 0.707  
Average acc: 0.411  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.722  exp loss = 0.726  adjusted loss = 0.726  adv prob = 0.250000   acc = 0.253
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.740  exp loss = 0.748  adjusted loss = 0.748  adv prob = 0.250000   acc = 0.270
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.637  exp loss = 0.639  adjusted loss = 0.639  adv prob = 0.250000   acc = 0.910
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.602  exp loss = 0.600  adjusted loss = 0.600  adv prob = 0.250000   acc = 0.962
Spurious Score = 1.030
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_85.csv
logged to wandb
Current lr: 0.000010


Epoch [86]:
Training:
Average incurred loss: 0.634  
Average sample loss: 0.634  
Average acc: 0.761  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 658]:	loss = 0.712  exp loss = 0.715  adjusted loss = 0.715  adv prob = 0.250000   acc = 0.283
  waterbird_complete95 = 0, forest2water2 = 1  [n = 681]:	loss = 0.665  exp loss = 0.665  adjusted loss = 0.665  adv prob = 0.250000   acc = 0.590
  waterbird_complete95 = 1, forest2water2 = 0  [n = 442]:	loss = 0.611  exp loss = 0.612  adjusted loss = 0.612  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1419]:	loss = 0.590  exp loss = 0.589  adjusted loss = 0.589  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.634  
Average sample loss: 0.634  
Average acc: 0.772  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 666]:	loss = 0.710  exp loss = 0.711  adjusted loss = 0.711  adv prob = 0.250000   acc = 0.311
  waterbird_complete95 = 0, forest2water2 = 1  [n = 640]:	loss = 0.664  exp loss = 0.665  adjusted loss = 0.665  adv prob = 0.250000   acc = 0.597
  waterbird_complete95 = 1, forest2water2 = 0  [n = 444]:	loss = 0.608  exp loss = 0.604  adjusted loss = 0.604  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1450]:	loss = 0.593  exp loss = 0.597  adjusted loss = 0.597  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.636  
Average sample loss: 0.636  
Average acc: 0.759  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 659]:	loss = 0.713  exp loss = 0.716  adjusted loss = 0.716  adv prob = 0.250000   acc = 0.275
  waterbird_complete95 = 0, forest2water2 = 1  [n = 659]:	loss = 0.667  exp loss = 0.665  adjusted loss = 0.665  adv prob = 0.250000   acc = 0.577
  waterbird_complete95 = 1, forest2water2 = 0  [n = 468]:	loss = 0.612  exp loss = 0.611  adjusted loss = 0.611  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1414]:	loss = 0.593  exp loss = 0.591  adjusted loss = 0.591  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.637  
Average sample loss: 0.637  
Average acc: 0.749  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 658]:	loss = 0.712  exp loss = 0.710  adjusted loss = 0.710  adv prob = 0.250000   acc = 0.277
  waterbird_complete95 = 0, forest2water2 = 1  [n = 680]:	loss = 0.669  exp loss = 0.667  adjusted loss = 0.667  adv prob = 0.250000   acc = 0.546
  waterbird_complete95 = 1, forest2water2 = 0  [n = 431]:	loss = 0.613  exp loss = 0.614  adjusted loss = 0.614  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1431]:	loss = 0.593  exp loss = 0.593  adjusted loss = 0.593  adv prob = 0.250000   acc = 0.987
Average incurred loss: 0.639  
Average sample loss: 0.639  
Average acc: 0.749  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 682]:	loss = 0.714  exp loss = 0.714  adjusted loss = 0.714  adv prob = 0.250000   acc = 0.264
  waterbird_complete95 = 0, forest2water2 = 1  [n = 655]:	loss = 0.672  exp loss = 0.674  adjusted loss = 0.674  adv prob = 0.250000   acc = 0.562
  waterbird_complete95 = 1, forest2water2 = 0  [n = 443]:	loss = 0.614  exp loss = 0.613  adjusted loss = 0.613  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1420]:	loss = 0.595  exp loss = 0.595  adjusted loss = 0.595  adv prob = 0.250000   acc = 0.991
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_86.csv
logged to wandb
Average incurred loss: 0.639  
Average sample loss: 0.639  
Average acc: 0.760  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 525]:	loss = 0.712  exp loss = 0.716  adjusted loss = 0.716  adv prob = 0.250000   acc = 0.291
  waterbird_complete95 = 0, forest2water2 = 1  [n = 519]:	loss = 0.674  exp loss = 0.675  adjusted loss = 0.675  adv prob = 0.250000   acc = 0.559
  waterbird_complete95 = 1, forest2water2 = 0  [n = 378]:	loss = 0.615  exp loss = 0.607  adjusted loss = 0.607  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1123]:	loss = 0.597  exp loss = 0.599  adjusted loss = 0.599  adv prob = 0.250000   acc = 0.991

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_86.csv
logged to wandb
Average incurred loss: 0.696  
Average sample loss: 0.697  
Average acc: 0.441  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.711  exp loss = 0.715  adjusted loss = 0.715  adv prob = 0.250000   acc = 0.293
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.713  exp loss = 0.721  adjusted loss = 0.721  adv prob = 0.250000   acc = 0.350
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.649  exp loss = 0.649  adjusted loss = 0.649  adv prob = 0.250000   acc = 0.872
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.631  exp loss = 0.631  adjusted loss = 0.631  adv prob = 0.250000   acc = 0.850
Spurious Score = 0.935
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_86.csv
logged to wandb
Current lr: 0.000010


Epoch [87]:
Training:
Average incurred loss: 0.639  
Average sample loss: 0.639  
Average acc: 0.763  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 621]:	loss = 0.716  exp loss = 0.719  adjusted loss = 0.719  adv prob = 0.250000   acc = 0.248
  waterbird_complete95 = 0, forest2water2 = 1  [n = 647]:	loss = 0.673  exp loss = 0.672  adjusted loss = 0.672  adv prob = 0.250000   acc = 0.567
  waterbird_complete95 = 1, forest2water2 = 0  [n = 472]:	loss = 0.616  exp loss = 0.616  adjusted loss = 0.616  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1460]:	loss = 0.600  exp loss = 0.600  adjusted loss = 0.600  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.641  
Average sample loss: 0.641  
Average acc: 0.739  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 698]:	loss = 0.714  exp loss = 0.715  adjusted loss = 0.715  adv prob = 0.250000   acc = 0.259
  waterbird_complete95 = 0, forest2water2 = 1  [n = 638]:	loss = 0.677  exp loss = 0.680  adjusted loss = 0.680  adv prob = 0.250000   acc = 0.517
  waterbird_complete95 = 1, forest2water2 = 0  [n = 427]:	loss = 0.618  exp loss = 0.620  adjusted loss = 0.620  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1437]:	loss = 0.597  exp loss = 0.595  adjusted loss = 0.595  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.642  
Average sample loss: 0.642  
Average acc: 0.738  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.717  exp loss = 0.720  adjusted loss = 0.720  adv prob = 0.250000   acc = 0.262
  waterbird_complete95 = 0, forest2water2 = 1  [n = 676]:	loss = 0.675  exp loss = 0.671  adjusted loss = 0.671  adv prob = 0.250000   acc = 0.506
  waterbird_complete95 = 1, forest2water2 = 0  [n = 445]:	loss = 0.612  exp loss = 0.615  adjusted loss = 0.615  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1411]:	loss = 0.599  exp loss = 0.599  adjusted loss = 0.599  adv prob = 0.250000   acc = 0.991
Average incurred loss: 0.645  
Average sample loss: 0.645  
Average acc: 0.726  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 669]:	loss = 0.720  exp loss = 0.722  adjusted loss = 0.722  adv prob = 0.250000   acc = 0.206
  waterbird_complete95 = 0, forest2water2 = 1  [n = 663]:	loss = 0.679  exp loss = 0.677  adjusted loss = 0.677  adv prob = 0.250000   acc = 0.501
  waterbird_complete95 = 1, forest2water2 = 0  [n = 443]:	loss = 0.615  exp loss = 0.617  adjusted loss = 0.617  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1425]:	loss = 0.603  exp loss = 0.601  adjusted loss = 0.601  adv prob = 0.250000   acc = 0.989
Average incurred loss: 0.645  
Average sample loss: 0.645  
Average acc: 0.731  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.719  exp loss = 0.719  adjusted loss = 0.719  adv prob = 0.250000   acc = 0.237
  waterbird_complete95 = 0, forest2water2 = 1  [n = 676]:	loss = 0.681  exp loss = 0.678  adjusted loss = 0.678  adv prob = 0.250000   acc = 0.501
  waterbird_complete95 = 1, forest2water2 = 0  [n = 443]:	loss = 0.614  exp loss = 0.615  adjusted loss = 0.615  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1413]:	loss = 0.602  exp loss = 0.603  adjusted loss = 0.603  adv prob = 0.250000   acc = 0.991
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_87.csv
logged to wandb
Average incurred loss: 0.645  
Average sample loss: 0.645  
Average acc: 0.730  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 524]:	loss = 0.718  exp loss = 0.721  adjusted loss = 0.721  adv prob = 0.250000   acc = 0.195
  waterbird_complete95 = 0, forest2water2 = 1  [n = 534]:	loss = 0.683  exp loss = 0.680  adjusted loss = 0.680  adv prob = 0.250000   acc = 0.517
  waterbird_complete95 = 1, forest2water2 = 0  [n = 376]:	loss = 0.621  exp loss = 0.623  adjusted loss = 0.623  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1111]:	loss = 0.601  exp loss = 0.602  adjusted loss = 0.602  adv prob = 0.250000   acc = 0.993

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_87.csv
logged to wandb
Average incurred loss: 0.685  
Average sample loss: 0.685  
Average acc: 0.506  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.699  exp loss = 0.704  adjusted loss = 0.704  adv prob = 0.250000   acc = 0.364
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.688  exp loss = 0.696  adjusted loss = 0.696  adv prob = 0.250000   acc = 0.472
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.660  exp loss = 0.658  adjusted loss = 0.658  adv prob = 0.250000   acc = 0.820
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.649  exp loss = 0.652  adjusted loss = 0.652  adv prob = 0.250000   acc = 0.812
Spurious Score = 0.911
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_87.csv
logged to wandb
Current lr: 0.000010


Epoch [88]:
Training:
Average incurred loss: 0.647  
Average sample loss: 0.647  
Average acc: 0.718  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 678]:	loss = 0.720  exp loss = 0.721  adjusted loss = 0.721  adv prob = 0.250000   acc = 0.221
  waterbird_complete95 = 0, forest2water2 = 1  [n = 637]:	loss = 0.685  exp loss = 0.684  adjusted loss = 0.684  adv prob = 0.250000   acc = 0.436
  waterbird_complete95 = 1, forest2water2 = 0  [n = 440]:	loss = 0.620  exp loss = 0.615  adjusted loss = 0.615  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1445]:	loss = 0.605  exp loss = 0.607  adjusted loss = 0.607  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.647  
Average sample loss: 0.647  
Average acc: 0.725  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 661]:	loss = 0.720  exp loss = 0.722  adjusted loss = 0.722  adv prob = 0.250000   acc = 0.192
  waterbird_complete95 = 0, forest2water2 = 1  [n = 657]:	loss = 0.684  exp loss = 0.682  adjusted loss = 0.682  adv prob = 0.250000   acc = 0.482
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.620  exp loss = 0.618  adjusted loss = 0.618  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1416]:	loss = 0.604  exp loss = 0.603  adjusted loss = 0.603  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.650  
Average sample loss: 0.650  
Average acc: 0.715  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.725  exp loss = 0.726  adjusted loss = 0.726  adv prob = 0.250000   acc = 0.190
  waterbird_complete95 = 0, forest2water2 = 1  [n = 672]:	loss = 0.686  exp loss = 0.684  adjusted loss = 0.684  adv prob = 0.250000   acc = 0.475
  waterbird_complete95 = 1, forest2water2 = 0  [n = 453]:	loss = 0.619  exp loss = 0.619  adjusted loss = 0.619  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1407]:	loss = 0.607  exp loss = 0.607  adjusted loss = 0.607  adv prob = 0.250000   acc = 0.987
Average incurred loss: 0.651  
Average sample loss: 0.651  
Average acc: 0.714  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 668]:	loss = 0.722  exp loss = 0.724  adjusted loss = 0.724  adv prob = 0.250000   acc = 0.193
  waterbird_complete95 = 0, forest2water2 = 1  [n = 665]:	loss = 0.690  exp loss = 0.690  adjusted loss = 0.690  adv prob = 0.250000   acc = 0.445
  waterbird_complete95 = 1, forest2water2 = 0  [n = 451]:	loss = 0.619  exp loss = 0.620  adjusted loss = 0.620  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1416]:	loss = 0.608  exp loss = 0.607  adjusted loss = 0.607  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.652  
Average sample loss: 0.652  
Average acc: 0.702  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 679]:	loss = 0.723  exp loss = 0.724  adjusted loss = 0.724  adv prob = 0.250000   acc = 0.166
  waterbird_complete95 = 0, forest2water2 = 1  [n = 671]:	loss = 0.689  exp loss = 0.688  adjusted loss = 0.688  adv prob = 0.250000   acc = 0.440
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.622  exp loss = 0.620  adjusted loss = 0.620  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1402]:	loss = 0.608  exp loss = 0.609  adjusted loss = 0.609  adv prob = 0.250000   acc = 0.992
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_88.csv
logged to wandb
Average incurred loss: 0.651  
Average sample loss: 0.651  
Average acc: 0.718  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 494]:	loss = 0.724  exp loss = 0.724  adjusted loss = 0.724  adv prob = 0.250000   acc = 0.186
  waterbird_complete95 = 0, forest2water2 = 1  [n = 532]:	loss = 0.690  exp loss = 0.687  adjusted loss = 0.687  adv prob = 0.250000   acc = 0.427
  waterbird_complete95 = 1, forest2water2 = 0  [n = 348]:	loss = 0.626  exp loss = 0.627  adjusted loss = 0.627  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1171]:	loss = 0.610  exp loss = 0.608  adjusted loss = 0.608  adv prob = 0.250000   acc = 0.991

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_88.csv
logged to wandb
Average incurred loss: 0.716  
Average sample loss: 0.716  
Average acc: 0.327  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.735  exp loss = 0.737  adjusted loss = 0.737  adv prob = 0.250000   acc = 0.124
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.745  exp loss = 0.749  adjusted loss = 0.749  adv prob = 0.250000   acc = 0.157
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.639  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.621  exp loss = 0.622  adjusted loss = 0.622  adv prob = 0.250000   acc = 0.962
Spurious Score = 0.939
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_88.csv
logged to wandb
Current lr: 0.000010


Epoch [89]:
Training:
Average incurred loss: 0.651  
Average sample loss: 0.651  
Average acc: 0.708  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 650]:	loss = 0.723  exp loss = 0.724  adjusted loss = 0.724  adv prob = 0.250000   acc = 0.168
  waterbird_complete95 = 0, forest2water2 = 1  [n = 654]:	loss = 0.691  exp loss = 0.692  adjusted loss = 0.692  adv prob = 0.250000   acc = 0.414
  waterbird_complete95 = 1, forest2water2 = 0  [n = 461]:	loss = 0.624  exp loss = 0.627  adjusted loss = 0.627  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1435]:	loss = 0.609  exp loss = 0.609  adjusted loss = 0.609  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.654  
Average sample loss: 0.654  
Average acc: 0.691  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 673]:	loss = 0.728  exp loss = 0.727  adjusted loss = 0.727  adv prob = 0.250000   acc = 0.144
  waterbird_complete95 = 0, forest2water2 = 1  [n = 669]:	loss = 0.692  exp loss = 0.691  adjusted loss = 0.691  adv prob = 0.250000   acc = 0.393
  waterbird_complete95 = 1, forest2water2 = 0  [n = 452]:	loss = 0.622  exp loss = 0.626  adjusted loss = 0.626  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1406]:	loss = 0.611  exp loss = 0.609  adjusted loss = 0.609  adv prob = 0.250000   acc = 0.995
Average incurred loss: 0.655  
Average sample loss: 0.655  
Average acc: 0.690  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 714]:	loss = 0.727  exp loss = 0.727  adjusted loss = 0.727  adv prob = 0.250000   acc = 0.133
  waterbird_complete95 = 0, forest2water2 = 1  [n = 625]:	loss = 0.692  exp loss = 0.690  adjusted loss = 0.690  adv prob = 0.250000   acc = 0.413
  waterbird_complete95 = 1, forest2water2 = 0  [n = 445]:	loss = 0.625  exp loss = 0.627  adjusted loss = 0.627  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1416]:	loss = 0.612  exp loss = 0.611  adjusted loss = 0.611  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.656  
Average sample loss: 0.656  
Average acc: 0.688  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 627]:	loss = 0.728  exp loss = 0.729  adjusted loss = 0.729  adv prob = 0.250000   acc = 0.124
  waterbird_complete95 = 0, forest2water2 = 1  [n = 697]:	loss = 0.697  exp loss = 0.701  adjusted loss = 0.701  adv prob = 0.250000   acc = 0.376
  waterbird_complete95 = 1, forest2water2 = 0  [n = 431]:	loss = 0.623  exp loss = 0.622  adjusted loss = 0.622  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1445]:	loss = 0.615  exp loss = 0.614  adjusted loss = 0.614  adv prob = 0.250000   acc = 0.990
Average incurred loss: 0.658  
Average sample loss: 0.658  
Average acc: 0.687  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 658]:	loss = 0.727  exp loss = 0.730  adjusted loss = 0.730  adv prob = 0.250000   acc = 0.144
  waterbird_complete95 = 0, forest2water2 = 1  [n = 670]:	loss = 0.701  exp loss = 0.703  adjusted loss = 0.703  adv prob = 0.250000   acc = 0.358
  waterbird_complete95 = 1, forest2water2 = 0  [n = 428]:	loss = 0.627  exp loss = 0.632  adjusted loss = 0.632  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1444]:	loss = 0.615  exp loss = 0.617  adjusted loss = 0.617  adv prob = 0.250000   acc = 0.994
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_89.csv
logged to wandb
Average incurred loss: 0.657  
Average sample loss: 0.657  
Average acc: 0.690  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 526]:	loss = 0.726  exp loss = 0.730  adjusted loss = 0.730  adv prob = 0.250000   acc = 0.152
  waterbird_complete95 = 0, forest2water2 = 1  [n = 519]:	loss = 0.701  exp loss = 0.702  adjusted loss = 0.702  adv prob = 0.250000   acc = 0.356
  waterbird_complete95 = 1, forest2water2 = 0  [n = 389]:	loss = 0.628  exp loss = 0.630  adjusted loss = 0.630  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1111]:	loss = 0.614  exp loss = 0.614  adjusted loss = 0.614  adv prob = 0.250000   acc = 0.993

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_89.csv
logged to wandb
Average incurred loss: 0.703  
Average sample loss: 0.704  
Average acc: 0.387  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.720  exp loss = 0.723  adjusted loss = 0.723  adv prob = 0.250000   acc = 0.197
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.716  exp loss = 0.722  adjusted loss = 0.722  adv prob = 0.250000   acc = 0.288
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.653  exp loss = 0.652  adjusted loss = 0.652  adv prob = 0.250000   acc = 0.910
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.646  exp loss = 0.648  adjusted loss = 0.648  adv prob = 0.250000   acc = 0.880
Spurious Score = 0.899
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_89.csv
logged to wandb
Current lr: 0.000010


Epoch [90]:
Training:
Average incurred loss: 0.659  
Average sample loss: 0.659  
Average acc: 0.677  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 717]:	loss = 0.728  exp loss = 0.726  adjusted loss = 0.726  adv prob = 0.250000   acc = 0.130
  waterbird_complete95 = 0, forest2water2 = 1  [n = 612]:	loss = 0.700  exp loss = 0.701  adjusted loss = 0.701  adv prob = 0.250000   acc = 0.345
  waterbird_complete95 = 1, forest2water2 = 0  [n = 421]:	loss = 0.624  exp loss = 0.624  adjusted loss = 0.624  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1450]:	loss = 0.618  exp loss = 0.618  adjusted loss = 0.618  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.659  
Average sample loss: 0.659  
Average acc: 0.673  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 625]:	loss = 0.731  exp loss = 0.732  adjusted loss = 0.732  adv prob = 0.250000   acc = 0.093
  waterbird_complete95 = 0, forest2water2 = 1  [n = 684]:	loss = 0.700  exp loss = 0.701  adjusted loss = 0.701  adv prob = 0.250000   acc = 0.316
  waterbird_complete95 = 1, forest2water2 = 0  [n = 458]:	loss = 0.628  exp loss = 0.629  adjusted loss = 0.629  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1433]:	loss = 0.617  exp loss = 0.618  adjusted loss = 0.618  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.661  
Average sample loss: 0.661  
Average acc: 0.667  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 674]:	loss = 0.729  exp loss = 0.728  adjusted loss = 0.728  adv prob = 0.250000   acc = 0.123
  waterbird_complete95 = 0, forest2water2 = 1  [n = 666]:	loss = 0.706  exp loss = 0.703  adjusted loss = 0.703  adv prob = 0.250000   acc = 0.288
  waterbird_complete95 = 1, forest2water2 = 0  [n = 435]:	loss = 0.630  exp loss = 0.628  adjusted loss = 0.628  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1425]:	loss = 0.618  exp loss = 0.618  adjusted loss = 0.618  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.661  
Average sample loss: 0.661  
Average acc: 0.666  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 672]:	loss = 0.730  exp loss = 0.732  adjusted loss = 0.732  adv prob = 0.250000   acc = 0.107
  waterbird_complete95 = 0, forest2water2 = 1  [n = 656]:	loss = 0.705  exp loss = 0.704  adjusted loss = 0.704  adv prob = 0.250000   acc = 0.293
  waterbird_complete95 = 1, forest2water2 = 0  [n = 452]:	loss = 0.631  exp loss = 0.631  adjusted loss = 0.631  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1420]:	loss = 0.618  exp loss = 0.620  adjusted loss = 0.620  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.661  
Average sample loss: 0.661  
Average acc: 0.673  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 614]:	loss = 0.732  exp loss = 0.730  adjusted loss = 0.730  adv prob = 0.250000   acc = 0.093
  waterbird_complete95 = 0, forest2water2 = 1  [n = 689]:	loss = 0.706  exp loss = 0.705  adjusted loss = 0.705  adv prob = 0.250000   acc = 0.300
  waterbird_complete95 = 1, forest2water2 = 0  [n = 476]:	loss = 0.630  exp loss = 0.631  adjusted loss = 0.631  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1421]:	loss = 0.620  exp loss = 0.621  adjusted loss = 0.621  adv prob = 0.250000   acc = 0.996
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_90.csv
logged to wandb
Average incurred loss: 0.664  
Average sample loss: 0.664  
Average acc: 0.652  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 546]:	loss = 0.731  exp loss = 0.732  adjusted loss = 0.732  adv prob = 0.250000   acc = 0.077
  waterbird_complete95 = 0, forest2water2 = 1  [n = 527]:	loss = 0.708  exp loss = 0.706  adjusted loss = 0.706  adv prob = 0.250000   acc = 0.288
  waterbird_complete95 = 1, forest2water2 = 0  [n = 364]:	loss = 0.629  exp loss = 0.634  adjusted loss = 0.634  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1108]:	loss = 0.621  exp loss = 0.621  adjusted loss = 0.621  adv prob = 0.250000   acc = 0.995

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_90.csv
logged to wandb
Average incurred loss: 0.712  
Average sample loss: 0.713  
Average acc: 0.312  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.732  exp loss = 0.734  adjusted loss = 0.734  adv prob = 0.250000   acc = 0.099
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.732  exp loss = 0.736  adjusted loss = 0.736  adv prob = 0.250000   acc = 0.163
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.647  exp loss = 0.647  adjusted loss = 0.647  adv prob = 0.250000   acc = 0.970
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.637  exp loss = 0.640  adjusted loss = 0.640  adv prob = 0.250000   acc = 0.925
Spurious Score = 0.903
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_90.csv
logged to wandb
Current lr: 0.000010


Epoch [91]:
Training:
Average incurred loss: 0.663  
Average sample loss: 0.663  
Average acc: 0.660  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 659]:	loss = 0.732  exp loss = 0.732  adjusted loss = 0.732  adv prob = 0.250000   acc = 0.096
  waterbird_complete95 = 0, forest2water2 = 1  [n = 658]:	loss = 0.707  exp loss = 0.710  adjusted loss = 0.710  adv prob = 0.250000   acc = 0.267
  waterbird_complete95 = 1, forest2water2 = 0  [n = 450]:	loss = 0.630  exp loss = 0.632  adjusted loss = 0.632  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1433]:	loss = 0.622  exp loss = 0.622  adjusted loss = 0.622  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.664  
Average sample loss: 0.664  
Average acc: 0.655  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 654]:	loss = 0.732  exp loss = 0.730  adjusted loss = 0.730  adv prob = 0.250000   acc = 0.072
  waterbird_complete95 = 0, forest2water2 = 1  [n = 651]:	loss = 0.709  exp loss = 0.710  adjusted loss = 0.710  adv prob = 0.250000   acc = 0.250
  waterbird_complete95 = 1, forest2water2 = 0  [n = 476]:	loss = 0.631  exp loss = 0.631  adjusted loss = 0.631  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1419]:	loss = 0.622  exp loss = 0.623  adjusted loss = 0.623  adv prob = 0.250000   acc = 0.993
Average incurred loss: 0.668  
Average sample loss: 0.668  
Average acc: 0.627  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 704]:	loss = 0.735  exp loss = 0.732  adjusted loss = 0.732  adv prob = 0.250000   acc = 0.055
  waterbird_complete95 = 0, forest2water2 = 1  [n = 690]:	loss = 0.711  exp loss = 0.715  adjusted loss = 0.715  adv prob = 0.250000   acc = 0.241
  waterbird_complete95 = 1, forest2water2 = 0  [n = 415]:	loss = 0.632  exp loss = 0.630  adjusted loss = 0.630  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1391]:	loss = 0.623  exp loss = 0.623  adjusted loss = 0.623  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.666  
Average sample loss: 0.666  
Average acc: 0.653  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 654]:	loss = 0.733  exp loss = 0.733  adjusted loss = 0.733  adv prob = 0.250000   acc = 0.067
  waterbird_complete95 = 0, forest2water2 = 1  [n = 646]:	loss = 0.713  exp loss = 0.714  adjusted loss = 0.714  adv prob = 0.250000   acc = 0.232
  waterbird_complete95 = 1, forest2water2 = 0  [n = 442]:	loss = 0.634  exp loss = 0.638  adjusted loss = 0.638  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1458]:	loss = 0.624  exp loss = 0.623  adjusted loss = 0.623  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.668  
Average sample loss: 0.668  
Average acc: 0.641  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 671]:	loss = 0.734  exp loss = 0.733  adjusted loss = 0.733  adv prob = 0.250000   acc = 0.049
  waterbird_complete95 = 0, forest2water2 = 1  [n = 649]:	loss = 0.716  exp loss = 0.715  adjusted loss = 0.715  adv prob = 0.250000   acc = 0.217
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.634  exp loss = 0.633  adjusted loss = 0.633  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1414]:	loss = 0.626  exp loss = 0.626  adjusted loss = 0.626  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_91.csv
logged to wandb
Average incurred loss: 0.669  
Average sample loss: 0.669  
Average acc: 0.635  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 506]:	loss = 0.735  exp loss = 0.735  adjusted loss = 0.735  adv prob = 0.250000   acc = 0.053
  waterbird_complete95 = 0, forest2water2 = 1  [n = 540]:	loss = 0.718  exp loss = 0.716  adjusted loss = 0.716  adv prob = 0.250000   acc = 0.180
  waterbird_complete95 = 1, forest2water2 = 0  [n = 357]:	loss = 0.635  exp loss = 0.635  adjusted loss = 0.635  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1142]:	loss = 0.627  exp loss = 0.626  adjusted loss = 0.626  adv prob = 0.250000   acc = 0.995

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_91.csv
logged to wandb
Average incurred loss: 0.704  
Average sample loss: 0.704  
Average acc: 0.359  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.721  exp loss = 0.724  adjusted loss = 0.724  adv prob = 0.250000   acc = 0.158
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.712  exp loss = 0.716  adjusted loss = 0.716  adv prob = 0.250000   acc = 0.253
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.657  exp loss = 0.656  adjusted loss = 0.656  adv prob = 0.250000   acc = 0.925
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.659  exp loss = 0.662  adjusted loss = 0.662  adv prob = 0.250000   acc = 0.872
Spurious Score = 0.875
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_91.csv
logged to wandb
Current lr: 0.000010


Epoch [92]:
Training:
Average incurred loss: 0.670  
Average sample loss: 0.670  
Average acc: 0.627  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 682]:	loss = 0.735  exp loss = 0.733  adjusted loss = 0.733  adv prob = 0.250000   acc = 0.050
  waterbird_complete95 = 0, forest2water2 = 1  [n = 663]:	loss = 0.718  exp loss = 0.715  adjusted loss = 0.715  adv prob = 0.250000   acc = 0.184
  waterbird_complete95 = 1, forest2water2 = 0  [n = 416]:	loss = 0.635  exp loss = 0.635  adjusted loss = 0.635  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1439]:	loss = 0.627  exp loss = 0.626  adjusted loss = 0.626  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.670  
Average sample loss: 0.670  
Average acc: 0.628  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 664]:	loss = 0.735  exp loss = 0.737  adjusted loss = 0.737  adv prob = 0.250000   acc = 0.045
  waterbird_complete95 = 0, forest2water2 = 1  [n = 694]:	loss = 0.718  exp loss = 0.716  adjusted loss = 0.716  adv prob = 0.250000   acc = 0.210
  waterbird_complete95 = 1, forest2water2 = 0  [n = 465]:	loss = 0.634  exp loss = 0.635  adjusted loss = 0.635  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1377]:	loss = 0.627  exp loss = 0.628  adjusted loss = 0.628  adv prob = 0.250000   acc = 0.994
Average incurred loss: 0.672  
Average sample loss: 0.672  
Average acc: 0.618  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 687]:	loss = 0.737  exp loss = 0.735  adjusted loss = 0.735  adv prob = 0.250000   acc = 0.029
  waterbird_complete95 = 0, forest2water2 = 1  [n = 681]:	loss = 0.720  exp loss = 0.720  adjusted loss = 0.720  adv prob = 0.250000   acc = 0.192
  waterbird_complete95 = 1, forest2water2 = 0  [n = 438]:	loss = 0.634  exp loss = 0.636  adjusted loss = 0.636  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1394]:	loss = 0.629  exp loss = 0.629  adjusted loss = 0.629  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.670  
Average sample loss: 0.670  
Average acc: 0.644  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 674]:	loss = 0.735  exp loss = 0.735  adjusted loss = 0.735  adv prob = 0.250000   acc = 0.055
  waterbird_complete95 = 0, forest2water2 = 1  [n = 609]:	loss = 0.721  exp loss = 0.720  adjusted loss = 0.720  adv prob = 0.250000   acc = 0.186
  waterbird_complete95 = 1, forest2water2 = 0  [n = 459]:	loss = 0.636  exp loss = 0.637  adjusted loss = 0.637  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1458]:	loss = 0.630  exp loss = 0.629  adjusted loss = 0.629  adv prob = 0.250000   acc = 0.996
Average incurred loss: 0.670  
Average sample loss: 0.670  
Average acc: 0.642  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 611]:	loss = 0.737  exp loss = 0.738  adjusted loss = 0.738  adv prob = 0.250000   acc = 0.023
  waterbird_complete95 = 0, forest2water2 = 1  [n = 644]:	loss = 0.721  exp loss = 0.720  adjusted loss = 0.720  adv prob = 0.250000   acc = 0.158
  waterbird_complete95 = 1, forest2water2 = 0  [n = 473]:	loss = 0.638  exp loss = 0.638  adjusted loss = 0.638  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1472]:	loss = 0.630  exp loss = 0.629  adjusted loss = 0.629  adv prob = 0.250000   acc = 0.995
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_92.csv
logged to wandb
Average incurred loss: 0.673  
Average sample loss: 0.673  
Average acc: 0.610  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 530]:	loss = 0.736  exp loss = 0.737  adjusted loss = 0.737  adv prob = 0.250000   acc = 0.019
  waterbird_complete95 = 0, forest2water2 = 1  [n = 543]:	loss = 0.725  exp loss = 0.723  adjusted loss = 0.723  adv prob = 0.250000   acc = 0.136
  waterbird_complete95 = 1, forest2water2 = 0  [n = 355]:	loss = 0.637  exp loss = 0.633  adjusted loss = 0.633  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1117]:	loss = 0.630  exp loss = 0.631  adjusted loss = 0.631  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_92.csv
logged to wandb
Average incurred loss: 0.716  
Average sample loss: 0.717  
Average acc: 0.252  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.735  exp loss = 0.737  adjusted loss = 0.737  adv prob = 0.250000   acc = 0.032
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.737  exp loss = 0.739  adjusted loss = 0.739  adv prob = 0.250000   acc = 0.058
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.650  exp loss = 0.650  adjusted loss = 0.650  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.643  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 0.970
Spurious Score = 0.961
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_92.csv
logged to wandb
Current lr: 0.000010


Epoch [93]:
Training:
Average incurred loss: 0.673  
Average sample loss: 0.673  
Average acc: 0.620  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.737  exp loss = 0.738  adjusted loss = 0.738  adv prob = 0.250000   acc = 0.013
  waterbird_complete95 = 0, forest2water2 = 1  [n = 640]:	loss = 0.724  exp loss = 0.723  adjusted loss = 0.723  adv prob = 0.250000   acc = 0.133
  waterbird_complete95 = 1, forest2water2 = 0  [n = 478]:	loss = 0.638  exp loss = 0.636  adjusted loss = 0.636  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1412]:	loss = 0.631  exp loss = 0.631  adjusted loss = 0.631  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.676  
Average sample loss: 0.676  
Average acc: 0.610  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 673]:	loss = 0.739  exp loss = 0.740  adjusted loss = 0.740  adv prob = 0.250000   acc = 0.024
  waterbird_complete95 = 0, forest2water2 = 1  [n = 661]:	loss = 0.727  exp loss = 0.729  adjusted loss = 0.729  adv prob = 0.250000   acc = 0.126
  waterbird_complete95 = 1, forest2water2 = 0  [n = 447]:	loss = 0.637  exp loss = 0.637  adjusted loss = 0.637  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1419]:	loss = 0.634  exp loss = 0.635  adjusted loss = 0.635  adv prob = 0.250000   acc = 0.992
Average incurred loss: 0.674  
Average sample loss: 0.674  
Average acc: 0.612  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 677]:	loss = 0.737  exp loss = 0.739  adjusted loss = 0.739  adv prob = 0.250000   acc = 0.021
  waterbird_complete95 = 0, forest2water2 = 1  [n = 637]:	loss = 0.727  exp loss = 0.726  adjusted loss = 0.726  adv prob = 0.250000   acc = 0.099
  waterbird_complete95 = 1, forest2water2 = 0  [n = 409]:	loss = 0.639  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1477]:	loss = 0.633  exp loss = 0.633  adjusted loss = 0.633  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.675  
Average sample loss: 0.675  
Average acc: 0.605  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 645]:	loss = 0.739  exp loss = 0.740  adjusted loss = 0.740  adv prob = 0.250000   acc = 0.005
  waterbird_complete95 = 0, forest2water2 = 1  [n = 682]:	loss = 0.728  exp loss = 0.727  adjusted loss = 0.727  adv prob = 0.250000   acc = 0.095
  waterbird_complete95 = 1, forest2water2 = 0  [n = 441]:	loss = 0.639  exp loss = 0.639  adjusted loss = 0.639  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1432]:	loss = 0.633  exp loss = 0.634  adjusted loss = 0.634  adv prob = 0.250000   acc = 0.997
Average incurred loss: 0.676  
Average sample loss: 0.676  
Average acc: 0.611  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 671]:	loss = 0.739  exp loss = 0.739  adjusted loss = 0.739  adv prob = 0.250000   acc = 0.015
  waterbird_complete95 = 0, forest2water2 = 1  [n = 649]:	loss = 0.727  exp loss = 0.727  adjusted loss = 0.727  adv prob = 0.250000   acc = 0.108
  waterbird_complete95 = 1, forest2water2 = 0  [n = 474]:	loss = 0.639  exp loss = 0.639  adjusted loss = 0.639  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1406]:	loss = 0.634  exp loss = 0.634  adjusted loss = 0.634  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_93.csv
logged to wandb
Average incurred loss: 0.677  
Average sample loss: 0.677  
Average acc: 0.594  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 512]:	loss = 0.739  exp loss = 0.739  adjusted loss = 0.739  adv prob = 0.250000   acc = 0.014
  waterbird_complete95 = 0, forest2water2 = 1  [n = 565]:	loss = 0.730  exp loss = 0.731  adjusted loss = 0.731  adv prob = 0.250000   acc = 0.071
  waterbird_complete95 = 1, forest2water2 = 0  [n = 357]:	loss = 0.639  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1111]:	loss = 0.634  exp loss = 0.634  adjusted loss = 0.634  adv prob = 0.250000   acc = 0.996

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_93.csv
logged to wandb
Average incurred loss: 0.722  
Average sample loss: 0.722  
Average acc: 0.228  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.741  exp loss = 0.741  adjusted loss = 0.741  adv prob = 0.250000   acc = 0.004
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.747  exp loss = 0.747  adjusted loss = 0.747  adv prob = 0.250000   acc = 0.011
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.647  exp loss = 0.649  adjusted loss = 0.649  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.640  exp loss = 0.641  adjusted loss = 0.641  adv prob = 0.250000   acc = 1.000
Spurious Score = 0.994
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_93.csv
logged to wandb
Current lr: 0.000010


Epoch [94]:
Training:
Average incurred loss: 0.677  
Average sample loss: 0.677  
Average acc: 0.599  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.739  exp loss = 0.739  adjusted loss = 0.739  adv prob = 0.250000   acc = 0.001
  waterbird_complete95 = 0, forest2water2 = 1  [n = 648]:	loss = 0.731  exp loss = 0.730  adjusted loss = 0.730  adv prob = 0.250000   acc = 0.051
  waterbird_complete95 = 1, forest2water2 = 0  [n = 451]:	loss = 0.641  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1431]:	loss = 0.635  exp loss = 0.635  adjusted loss = 0.635  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.678  
Average sample loss: 0.678  
Average acc: 0.599  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 653]:	loss = 0.740  exp loss = 0.739  adjusted loss = 0.739  adv prob = 0.250000   acc = 0.008
  waterbird_complete95 = 0, forest2water2 = 1  [n = 685]:	loss = 0.731  exp loss = 0.731  adjusted loss = 0.731  adv prob = 0.250000   acc = 0.079
  waterbird_complete95 = 1, forest2water2 = 0  [n = 466]:	loss = 0.640  exp loss = 0.638  adjusted loss = 0.638  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1396]:	loss = 0.636  exp loss = 0.636  adjusted loss = 0.636  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.677  
Average sample loss: 0.677  
Average acc: 0.606  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 642]:	loss = 0.740  exp loss = 0.739  adjusted loss = 0.739  adv prob = 0.250000   acc = 0.002
  waterbird_complete95 = 0, forest2water2 = 1  [n = 654]:	loss = 0.732  exp loss = 0.732  adjusted loss = 0.732  adv prob = 0.250000   acc = 0.057
  waterbird_complete95 = 1, forest2water2 = 0  [n = 450]:	loss = 0.641  exp loss = 0.641  adjusted loss = 0.641  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1454]:	loss = 0.637  exp loss = 0.636  adjusted loss = 0.636  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.679  
Average sample loss: 0.679  
Average acc: 0.591  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 680]:	loss = 0.740  exp loss = 0.740  adjusted loss = 0.740  adv prob = 0.250000   acc = 0.001
  waterbird_complete95 = 0, forest2water2 = 1  [n = 648]:	loss = 0.734  exp loss = 0.735  adjusted loss = 0.735  adv prob = 0.250000   acc = 0.031
  waterbird_complete95 = 1, forest2water2 = 0  [n = 436]:	loss = 0.642  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1436]:	loss = 0.637  exp loss = 0.636  adjusted loss = 0.636  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.679  
Average sample loss: 0.679  
Average acc: 0.600  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 645]:	loss = 0.739  exp loss = 0.739  adjusted loss = 0.739  adv prob = 0.250000   acc = 0.006
  waterbird_complete95 = 0, forest2water2 = 1  [n = 661]:	loss = 0.735  exp loss = 0.736  adjusted loss = 0.736  adv prob = 0.250000   acc = 0.039
  waterbird_complete95 = 1, forest2water2 = 0  [n = 438]:	loss = 0.640  exp loss = 0.638  adjusted loss = 0.638  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1456]:	loss = 0.638  exp loss = 0.638  adjusted loss = 0.638  adv prob = 0.250000   acc = 0.997
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_94.csv
logged to wandb
Average incurred loss: 0.681  
Average sample loss: 0.681  
Average acc: 0.576  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 558]:	loss = 0.741  exp loss = 0.741  adjusted loss = 0.741  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 538]:	loss = 0.735  exp loss = 0.735  adjusted loss = 0.735  adv prob = 0.250000   acc = 0.033
  waterbird_complete95 = 1, forest2water2 = 0  [n = 365]:	loss = 0.641  exp loss = 0.640  adjusted loss = 0.640  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1084]:	loss = 0.638  exp loss = 0.638  adjusted loss = 0.638  adv prob = 0.250000   acc = 0.999

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_94.csv
logged to wandb
Average incurred loss: 0.721  
Average sample loss: 0.721  
Average acc: 0.227  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.741  exp loss = 0.741  adjusted loss = 0.741  adv prob = 0.250000   acc = 0.004
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.744  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.011
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.648  exp loss = 0.649  adjusted loss = 0.649  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.642  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 0.992
Spurious Score = 0.986
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_94.csv
logged to wandb
Current lr: 0.000010


Epoch [95]:
Training:
Average incurred loss: 0.680  
Average sample loss: 0.680  
Average acc: 0.603  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 637]:	loss = 0.741  exp loss = 0.741  adjusted loss = 0.741  adv prob = 0.250000   acc = 0.003
  waterbird_complete95 = 0, forest2water2 = 1  [n = 662]:	loss = 0.736  exp loss = 0.736  adjusted loss = 0.736  adv prob = 0.250000   acc = 0.039
  waterbird_complete95 = 1, forest2water2 = 0  [n = 451]:	loss = 0.644  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1450]:	loss = 0.638  exp loss = 0.638  adjusted loss = 0.638  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.680  
Average sample loss: 0.680  
Average acc: 0.596  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 637]:	loss = 0.740  exp loss = 0.739  adjusted loss = 0.739  adv prob = 0.250000   acc = 0.003
  waterbird_complete95 = 0, forest2water2 = 1  [n = 676]:	loss = 0.736  exp loss = 0.738  adjusted loss = 0.738  adv prob = 0.250000   acc = 0.031
  waterbird_complete95 = 1, forest2water2 = 0  [n = 467]:	loss = 0.642  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1420]:	loss = 0.638  exp loss = 0.637  adjusted loss = 0.637  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.679  
Average sample loss: 0.679  
Average acc: 0.605  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 635]:	loss = 0.740  exp loss = 0.740  adjusted loss = 0.740  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 657]:	loss = 0.736  exp loss = 0.736  adjusted loss = 0.736  adv prob = 0.250000   acc = 0.044
  waterbird_complete95 = 1, forest2water2 = 0  [n = 468]:	loss = 0.642  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1440]:	loss = 0.638  exp loss = 0.638  adjusted loss = 0.638  adv prob = 0.250000   acc = 0.999
Average incurred loss: 0.682  
Average sample loss: 0.682  
Average acc: 0.581  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 678]:	loss = 0.741  exp loss = 0.741  adjusted loss = 0.741  adv prob = 0.250000   acc = 0.001
  waterbird_complete95 = 0, forest2water2 = 1  [n = 678]:	loss = 0.738  exp loss = 0.738  adjusted loss = 0.738  adv prob = 0.250000   acc = 0.027
  waterbird_complete95 = 1, forest2water2 = 0  [n = 411]:	loss = 0.642  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1433]:	loss = 0.639  exp loss = 0.639  adjusted loss = 0.639  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.682  
Average sample loss: 0.682  
Average acc: 0.591  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 678]:	loss = 0.741  exp loss = 0.741  adjusted loss = 0.741  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 643]:	loss = 0.739  exp loss = 0.740  adjusted loss = 0.740  adv prob = 0.250000   acc = 0.020
  waterbird_complete95 = 1, forest2water2 = 0  [n = 454]:	loss = 0.643  exp loss = 0.645  adjusted loss = 0.645  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1425]:	loss = 0.640  exp loss = 0.639  adjusted loss = 0.639  adv prob = 0.250000   acc = 0.999
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_95.csv
logged to wandb
Average incurred loss: 0.684  
Average sample loss: 0.684  
Average acc: 0.571  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 583]:	loss = 0.742  exp loss = 0.742  adjusted loss = 0.742  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 518]:	loss = 0.740  exp loss = 0.739  adjusted loss = 0.739  adv prob = 0.250000   acc = 0.019
  waterbird_complete95 = 1, forest2water2 = 0  [n = 355]:	loss = 0.642  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1089]:	loss = 0.640  exp loss = 0.640  adjusted loss = 0.640  adv prob = 0.250000   acc = 0.998

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_95.csv
logged to wandb
Average incurred loss: 0.722  
Average sample loss: 0.722  
Average acc: 0.224  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.742  exp loss = 0.742  adjusted loss = 0.742  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.745  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.006
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.648  exp loss = 0.649  adjusted loss = 0.649  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.643  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
Spurious Score = 0.994
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_95.csv
logged to wandb
Current lr: 0.000010


Epoch [96]:
Training:
Average incurred loss: 0.682  
Average sample loss: 0.682  
Average acc: 0.589  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 663]:	loss = 0.741  exp loss = 0.742  adjusted loss = 0.742  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 664]:	loss = 0.740  exp loss = 0.741  adjusted loss = 0.741  adv prob = 0.250000   acc = 0.023
  waterbird_complete95 = 1, forest2water2 = 0  [n = 462]:	loss = 0.644  exp loss = 0.645  adjusted loss = 0.645  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1411]:	loss = 0.640  exp loss = 0.640  adjusted loss = 0.640  adv prob = 0.250000   acc = 0.998
Average incurred loss: 0.683  
Average sample loss: 0.683  
Average acc: 0.583  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 681]:	loss = 0.741  exp loss = 0.741  adjusted loss = 0.741  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.740  exp loss = 0.740  adjusted loss = 0.740  adv prob = 0.250000   acc = 0.012
  waterbird_complete95 = 1, forest2water2 = 0  [n = 438]:	loss = 0.643  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1421]:	loss = 0.641  exp loss = 0.640  adjusted loss = 0.640  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.681  
Average sample loss: 0.681  
Average acc: 0.598  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 636]:	loss = 0.740  exp loss = 0.740  adjusted loss = 0.740  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 663]:	loss = 0.740  exp loss = 0.740  adjusted loss = 0.740  adv prob = 0.250000   acc = 0.018
  waterbird_complete95 = 1, forest2water2 = 0  [n = 456]:	loss = 0.644  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1445]:	loss = 0.640  exp loss = 0.640  adjusted loss = 0.640  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.684  
Average sample loss: 0.684  
Average acc: 0.582  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 683]:	loss = 0.742  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 657]:	loss = 0.741  exp loss = 0.741  adjusted loss = 0.741  adv prob = 0.250000   acc = 0.003
  waterbird_complete95 = 1, forest2water2 = 0  [n = 445]:	loss = 0.644  exp loss = 0.645  adjusted loss = 0.645  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1415]:	loss = 0.641  exp loss = 0.641  adjusted loss = 0.641  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.683  
Average sample loss: 0.683  
Average acc: 0.592  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 657]:	loss = 0.742  exp loss = 0.742  adjusted loss = 0.742  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 651]:	loss = 0.741  exp loss = 0.741  adjusted loss = 0.741  adv prob = 0.250000   acc = 0.002
  waterbird_complete95 = 1, forest2water2 = 0  [n = 442]:	loss = 0.644  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1450]:	loss = 0.641  exp loss = 0.641  adjusted loss = 0.641  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_96.csv
logged to wandb
Average incurred loss: 0.684  
Average sample loss: 0.684  
Average acc: 0.581  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 528]:	loss = 0.742  exp loss = 0.742  adjusted loss = 0.742  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 539]:	loss = 0.743  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.002
  waterbird_complete95 = 1, forest2water2 = 0  [n = 363]:	loss = 0.645  exp loss = 0.645  adjusted loss = 0.645  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1115]:	loss = 0.641  exp loss = 0.641  adjusted loss = 0.641  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_96.csv
logged to wandb
Average incurred loss: 0.722  
Average sample loss: 0.722  
Average acc: 0.222  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.743  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.745  exp loss = 0.745  adjusted loss = 0.745  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.647  exp loss = 0.648  adjusted loss = 0.648  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.643  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
Spurious Score = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_96.csv
logged to wandb
Current lr: 0.000010


Epoch [97]:
Training:
Average incurred loss: 0.683  
Average sample loss: 0.683  
Average acc: 0.594  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 654]:	loss = 0.742  exp loss = 0.742  adjusted loss = 0.742  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 644]:	loss = 0.742  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 463]:	loss = 0.644  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1439]:	loss = 0.642  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.683  
Average sample loss: 0.683  
Average acc: 0.596  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 635]:	loss = 0.742  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 659]:	loss = 0.743  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 438]:	loss = 0.645  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1468]:	loss = 0.642  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.683  
Average sample loss: 0.683  
Average acc: 0.590  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 665]:	loss = 0.742  exp loss = 0.741  adjusted loss = 0.741  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 648]:	loss = 0.743  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 454]:	loss = 0.644  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1433]:	loss = 0.642  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.686  
Average sample loss: 0.686  
Average acc: 0.572  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 699]:	loss = 0.743  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 670]:	loss = 0.743  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.645  exp loss = 0.645  adjusted loss = 0.645  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1383]:	loss = 0.642  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.684  
Average sample loss: 0.684  
Average acc: 0.586  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 676]:	loss = 0.743  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 650]:	loss = 0.743  exp loss = 0.742  adjusted loss = 0.742  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 448]:	loss = 0.645  exp loss = 0.645  adjusted loss = 0.645  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1426]:	loss = 0.642  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_97.csv
logged to wandb
Average incurred loss: 0.685  
Average sample loss: 0.685  
Average acc: 0.575  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 519]:	loss = 0.741  exp loss = 0.742  adjusted loss = 0.742  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 563]:	loss = 0.744  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 355]:	loss = 0.645  exp loss = 0.645  adjusted loss = 0.645  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1108]:	loss = 0.642  exp loss = 0.642  adjusted loss = 0.642  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_97.csv
logged to wandb
Average incurred loss: 0.722  
Average sample loss: 0.723  
Average acc: 0.222  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.743  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.745  exp loss = 0.745  adjusted loss = 0.745  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.647  exp loss = 0.648  adjusted loss = 0.648  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.644  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
Spurious Score = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_97.csv
logged to wandb
Current lr: 0.000010


Epoch [98]:
Training:
Average incurred loss: 0.684  
Average sample loss: 0.684  
Average acc: 0.590  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 694]:	loss = 0.742  exp loss = 0.742  adjusted loss = 0.742  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 617]:	loss = 0.743  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 455]:	loss = 0.645  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1434]:	loss = 0.642  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.686  
Average sample loss: 0.686  
Average acc: 0.578  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 702]:	loss = 0.743  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 648]:	loss = 0.744  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 450]:	loss = 0.644  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1400]:	loss = 0.643  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.685  
Average sample loss: 0.685  
Average acc: 0.587  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 642]:	loss = 0.743  exp loss = 0.742  adjusted loss = 0.742  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 681]:	loss = 0.744  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 423]:	loss = 0.645  exp loss = 0.646  adjusted loss = 0.646  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1454]:	loss = 0.643  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.686  
Average sample loss: 0.686  
Average acc: 0.574  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 654]:	loss = 0.743  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 710]:	loss = 0.744  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 444]:	loss = 0.645  exp loss = 0.645  adjusted loss = 0.645  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1392]:	loss = 0.643  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.683  
Average sample loss: 0.683  
Average acc: 0.601  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 618]:	loss = 0.743  exp loss = 0.742  adjusted loss = 0.742  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.744  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 470]:	loss = 0.644  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1452]:	loss = 0.643  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_98.csv
logged to wandb
Average incurred loss: 0.685  
Average sample loss: 0.685  
Average acc: 0.585  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 538]:	loss = 0.743  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 518]:	loss = 0.744  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 364]:	loss = 0.645  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1125]:	loss = 0.643  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_98.csv
logged to wandb
Average incurred loss: 0.722  
Average sample loss: 0.722  
Average acc: 0.222  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.743  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.745  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.647  exp loss = 0.647  adjusted loss = 0.647  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.645  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
Spurious Score = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_98.csv
logged to wandb
Current lr: 0.000010


Epoch [99]:
Training:
Average incurred loss: 0.686  
Average sample loss: 0.686  
Average acc: 0.572  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 704]:	loss = 0.743  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 667]:	loss = 0.744  exp loss = 0.745  adjusted loss = 0.745  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 408]:	loss = 0.645  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1421]:	loss = 0.643  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.685  
Average sample loss: 0.685  
Average acc: 0.589  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 655]:	loss = 0.743  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 660]:	loss = 0.744  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 460]:	loss = 0.644  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1425]:	loss = 0.643  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.686  
Average sample loss: 0.686  
Average acc: 0.579  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 634]:	loss = 0.744  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 712]:	loss = 0.744  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 459]:	loss = 0.645  exp loss = 0.645  adjusted loss = 0.645  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1395]:	loss = 0.643  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.684  
Average sample loss: 0.684  
Average acc: 0.599  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 658]:	loss = 0.744  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 626]:	loss = 0.744  exp loss = 0.745  adjusted loss = 0.745  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 473]:	loss = 0.645  exp loss = 0.645  adjusted loss = 0.645  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1443]:	loss = 0.643  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000
Average incurred loss: 0.685  
Average sample loss: 0.685  
Average acc: 0.587  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 670]:	loss = 0.744  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 653]:	loss = 0.744  exp loss = 0.745  adjusted loss = 0.745  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 459]:	loss = 0.645  exp loss = 0.645  adjusted loss = 0.645  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1418]:	loss = 0.643  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_train_epoch_99.csv
logged to wandb
Average incurred loss: 0.685  
Average sample loss: 0.685  
Average acc: 0.590  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 527]:	loss = 0.744  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 516]:	loss = 0.744  exp loss = 0.745  adjusted loss = 0.745  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 347]:	loss = 0.644  exp loss = 0.645  adjusted loss = 0.645  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1155]:	loss = 0.643  exp loss = 0.643  adjusted loss = 0.643  adv prob = 0.250000   acc = 1.000

Validation:
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_val_epoch_99.csv
logged to wandb
Average incurred loss: 0.722  
Average sample loss: 0.723  
Average acc: 0.222  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.744  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.745  exp loss = 0.744  adjusted loss = 0.744  adv prob = 0.250000   acc = 0.000
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 0.645  exp loss = 0.646  adjusted loss = 0.646  adv prob = 0.250000   acc = 1.000
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.645  exp loss = 0.644  adjusted loss = 0.644  adv prob = 0.250000   acc = 1.000
Spurious Score = 1.000
Saved results/CUB/CUB_sample_exp/train_downstream_ERM_upweight_0_epochs_74_lr_1e-05_weight_decay_0.0/final_epoch32/JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0/model_outputs/output_test_epoch_99.csv
logged to wandb
Current lr: 0.000010

wandb: Waiting for W&B process to finish, PID 123547
wandb: Program ended successfully.
wandb: - 0.02MB of 0.02MB uploaded (0.00MB deduped)wandb: \ 0.85MB of 0.85MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: wandb/run-20220716_181208-37j0z3ds/logs/debug.log
wandb: Find internal logs for this run at: wandb/run-20220716_181208-37j0z3ds/logs/debug-internal.log
wandb: Run summary:
wandb:                   train/avg_loss_group:0 0.74391
wandb:               train/exp_avg_loss_group:0 0.74386
wandb:                    train/avg_acc_group:0 0.0
wandb:       train/processed_data_count_group:0 527.0
wandb:          train/update_data_count_group:0 527.0
wandb:         train/update_batch_count_group:0 40.0
wandb:                   train/avg_loss_group:1 0.74448
wandb:               train/exp_avg_loss_group:1 0.74453
wandb:                    train/avg_acc_group:1 0.0
wandb:       train/processed_data_count_group:1 516.0
wandb:          train/update_data_count_group:1 516.0
wandb:         train/update_batch_count_group:1 40.0
wandb:                   train/avg_loss_group:2 0.64437
wandb:               train/exp_avg_loss_group:2 0.64463
wandb:                    train/avg_acc_group:2 1.0
wandb:       train/processed_data_count_group:2 347.0
wandb:          train/update_data_count_group:2 347.0
wandb:         train/update_batch_count_group:2 40.0
wandb:                   train/avg_loss_group:3 0.64337
wandb:               train/exp_avg_loss_group:3 0.64324
wandb:                    train/avg_acc_group:3 1.0
wandb:       train/processed_data_count_group:3 1155.0
wandb:          train/update_data_count_group:3 1155.0
wandb:         train/update_batch_count_group:3 40.0
wandb:                    train/avg_actual_loss 0.68489
wandb:                train/avg_per_sample_loss 0.68483
wandb:                            train/avg_acc 0.59018
wandb:                      train/model_norm_sq 26.28682
wandb:                           train/reg_loss 13.14341
wandb:                              train/epoch 99
wandb:                              train/batch 249
wandb:                                    epoch 99
wandb:                                batch_idx 90
wandb:                                    _step 799
wandb:                                 _runtime 16818
wandb:                               _timestamp 1658026346
wandb:                     val/avg_loss_group:0 0.74395
wandb:                 val/exp_avg_loss_group:0 0.74391
wandb:                      val/avg_acc_group:0 0.0
wandb:         val/processed_data_count_group:0 467.0
wandb:            val/update_data_count_group:0 467.0
wandb:           val/update_batch_count_group:0 19.0
wandb:                     val/avg_loss_group:1 0.74461
wandb:                 val/exp_avg_loss_group:1 0.74448
wandb:                      val/avg_acc_group:1 0.0
wandb:         val/processed_data_count_group:1 466.0
wandb:            val/update_data_count_group:1 466.0
wandb:           val/update_batch_count_group:1 19.0
wandb:                     val/avg_loss_group:2 0.64539
wandb:                 val/exp_avg_loss_group:2 0.64569
wandb:                      val/avg_acc_group:2 1.0
wandb:         val/processed_data_count_group:2 133.0
wandb:            val/update_data_count_group:2 133.0
wandb:           val/update_batch_count_group:2 12.0
wandb:                     val/avg_loss_group:3 0.64457
wandb:                 val/exp_avg_loss_group:3 0.6443
wandb:                      val/avg_acc_group:3 1.0
wandb:         val/processed_data_count_group:3 133.0
wandb:            val/update_data_count_group:3 133.0
wandb:           val/update_batch_count_group:3 12.0
wandb:                      val/avg_actual_loss 0.72256
wandb:                  val/avg_per_sample_loss 0.72225
wandb:                              val/avg_acc 0.22185
wandb:                        val/model_norm_sq 26.28682
wandb:                             val/reg_loss 13.14341
wandb:                    test/avg_loss_group:0 0.7438
wandb:                test/exp_avg_loss_group:0 0.74408
wandb:                     test/avg_acc_group:0 0.0
wandb:        test/processed_data_count_group:0 2255.0
wandb:           test/update_data_count_group:0 2255.0
wandb:          test/update_batch_count_group:0 79.0
wandb:                    test/avg_loss_group:1 0.74469
wandb:                test/exp_avg_loss_group:1 0.74452
wandb:                     test/avg_acc_group:1 0.0
wandb:        test/processed_data_count_group:1 2255.0
wandb:           test/update_data_count_group:1 2255.0
wandb:          test/update_batch_count_group:1 79.0
wandb:                    test/avg_loss_group:2 0.64519
wandb:                test/exp_avg_loss_group:2 0.64537
wandb:                     test/avg_acc_group:2 1.0
wandb:        test/processed_data_count_group:2 642.0
wandb:           test/update_data_count_group:2 642.0
wandb:          test/update_batch_count_group:2 32.0
wandb:                    test/avg_loss_group:3 0.64453
wandb:                test/exp_avg_loss_group:3 0.64455
wandb:                     test/avg_acc_group:3 1.0
wandb:        test/processed_data_count_group:3 642.0
wandb:           test/update_data_count_group:3 642.0
wandb:          test/update_batch_count_group:3 30.0
wandb:                     test/avg_actual_loss 0.72233
wandb:                 test/avg_per_sample_loss 0.72222
wandb:                             test/avg_acc 0.22161
wandb:                       test/model_norm_sq 26.28682
wandb:                            test/reg_loss 13.14341
wandb: Run history:
wandb:               train/avg_loss_group:0 ‚ñà‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá
wandb:           train/exp_avg_loss_group:0 ‚ñà‚ñá‚ñÜ‚ñÖ‚ñÖ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá
wandb:                train/avg_acc_group:0 ‚ñÇ‚ñÉ‚ñÑ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:   train/processed_data_count_group:0 ‚ñá‚ñà‚ñá‚ñÅ‚ñà‚ñá‚ñÇ‚ñá‚ñà‚ñÅ‚ñÜ‚ñÇ‚ñÜ‚ñà‚ñÅ‚ñà‚ñÜ‚ñÇ‚ñà‚ñà‚ñá‚ñà‚ñÇ‚ñà‚ñá‚ñÇ‚ñá‚ñÜ‚ñÉ‚ñà‚ñÅ‚ñà‚ñá‚ñÅ‚ñá‚ñà‚ñÅ‚ñà‚ñÜ‚ñÇ
wandb:      train/update_data_count_group:0 ‚ñá‚ñà‚ñá‚ñÅ‚ñà‚ñá‚ñÇ‚ñá‚ñà‚ñÅ‚ñÜ‚ñÇ‚ñÜ‚ñà‚ñÅ‚ñà‚ñÜ‚ñÇ‚ñà‚ñà‚ñá‚ñà‚ñÇ‚ñà‚ñá‚ñÇ‚ñá‚ñÜ‚ñÉ‚ñà‚ñÅ‚ñà‚ñá‚ñÅ‚ñá‚ñà‚ñÅ‚ñà‚ñÜ‚ñÇ
wandb:     train/update_batch_count_group:0 ‚ñà‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ
wandb:               train/avg_loss_group:1 ‚ñà‚ñá‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá
wandb:           train/exp_avg_loss_group:1 ‚ñà‚ñá‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá
wandb:                train/avg_acc_group:1 ‚ñÉ‚ñÑ‚ñÜ‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñÜ‚ñÖ‚ñÑ‚ñÇ‚ñÅ‚ñÅ‚ñÅ
wandb:   train/processed_data_count_group:1 ‚ñÜ‚ñá‚ñÜ‚ñÉ‚ñÜ‚ñá‚ñÇ‚ñá‚ñÜ‚ñÇ‚ñá‚ñÇ‚ñá‚ñá‚ñÇ‚ñá‚ñà‚ñÇ‚ñá‚ñÜ‚ñá‚ñà‚ñÉ‚ñÜ‚ñá‚ñÅ‚ñÜ‚ñá‚ñÅ‚ñá‚ñÑ‚ñÜ‚ñá‚ñÅ‚ñá‚ñá‚ñÉ‚ñÜ‚ñá‚ñÇ
wandb:      train/update_data_count_group:1 ‚ñÜ‚ñá‚ñÜ‚ñÉ‚ñÜ‚ñá‚ñÇ‚ñá‚ñÜ‚ñÇ‚ñá‚ñÇ‚ñá‚ñá‚ñÇ‚ñá‚ñà‚ñÇ‚ñá‚ñÜ‚ñá‚ñà‚ñÉ‚ñÜ‚ñá‚ñÅ‚ñÜ‚ñá‚ñÅ‚ñá‚ñÑ‚ñÜ‚ñá‚ñÅ‚ñá‚ñá‚ñÉ‚ñÜ‚ñá‚ñÇ
wandb:     train/update_batch_count_group:1 ‚ñà‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ
wandb:               train/avg_loss_group:2 ‚ñÖ‚ñÖ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:           train/exp_avg_loss_group:2 ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:                train/avg_acc_group:2 ‚ñà‚ñá‚ñÇ‚ñÅ‚ñÑ‚ñÖ‚ñÜ‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñà‚ñà‚ñà‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:   train/processed_data_count_group:2 ‚ñà‚ñà‚ñá‚ñÉ‚ñà‚ñÜ‚ñÅ‚ñÖ‚ñÜ‚ñÉ‚ñá‚ñÉ‚ñà‚ñá‚ñÉ‚ñÖ‚ñÜ‚ñÑ‚ñÜ‚ñá‚ñá‚ñÖ‚ñÇ‚ñÜ‚ñá‚ñÇ‚ñá‚ñá‚ñÇ‚ñà‚ñÅ‚ñá‚ñá‚ñÉ‚ñÜ‚ñá‚ñÇ‚ñÜ‚ñÜ‚ñÇ
wandb:      train/update_data_count_group:2 ‚ñà‚ñà‚ñá‚ñÉ‚ñà‚ñÜ‚ñÅ‚ñÖ‚ñÜ‚ñÉ‚ñá‚ñÉ‚ñà‚ñá‚ñÉ‚ñÖ‚ñÜ‚ñÑ‚ñÜ‚ñá‚ñá‚ñÖ‚ñÇ‚ñÜ‚ñá‚ñÇ‚ñá‚ñá‚ñÇ‚ñà‚ñÅ‚ñá‚ñá‚ñÉ‚ñÜ‚ñá‚ñÇ‚ñÜ‚ñÜ‚ñÇ
wandb:     train/update_batch_count_group:2 ‚ñà‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ
wandb:               train/avg_loss_group:3 ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:           train/exp_avg_loss_group:3 ‚ñÜ‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:                train/avg_acc_group:3 ‚ñÇ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÑ‚ñÖ‚ñÜ‚ñà‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:   train/processed_data_count_group:3 ‚ñá‚ñá‚ñá‚ñÇ‚ñá‚ñá‚ñÇ‚ñà‚ñá‚ñÇ‚ñà‚ñÅ‚ñá‚ñá‚ñÇ‚ñà‚ñá‚ñÅ‚ñá‚ñá‚ñá‚ñá‚ñÇ‚ñà‚ñá‚ñÇ‚ñà‚ñá‚ñÇ‚ñá‚ñÇ‚ñá‚ñá‚ñÇ‚ñá‚ñá‚ñÇ‚ñá‚ñà‚ñÇ
wandb:      train/update_data_count_group:3 ‚ñá‚ñá‚ñá‚ñÇ‚ñá‚ñá‚ñÇ‚ñà‚ñá‚ñÇ‚ñà‚ñÅ‚ñá‚ñá‚ñÇ‚ñà‚ñá‚ñÅ‚ñá‚ñá‚ñá‚ñá‚ñÇ‚ñà‚ñá‚ñÇ‚ñà‚ñá‚ñÇ‚ñá‚ñÇ‚ñá‚ñá‚ñÇ‚ñá‚ñá‚ñÇ‚ñá‚ñà‚ñÇ
wandb:     train/update_batch_count_group:3 ‚ñà‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ
wandb:                train/avg_actual_loss ‚ñá‚ñá‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:            train/avg_per_sample_loss ‚ñá‚ñá‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:                        train/avg_acc ‚ñÅ‚ñÉ‚ñÑ‚ñÖ‚ñÜ‚ñÜ‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÑ‚ñÉ‚ñÇ‚ñÅ‚ñÅ‚ñÅ
wandb:                  train/model_norm_sq ‚ñà‚ñá‚ñá‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                       train/reg_loss ‚ñà‚ñá‚ñá‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                          train/epoch ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:                          train/batch ‚ñÜ‚ñÅ‚ñÖ‚ñà‚ñÉ‚ñÜ‚ñà‚ñÉ‚ñÜ‚ñÅ‚ñÖ‚ñà‚ñÅ‚ñÖ‚ñà‚ñÉ‚ñÜ‚ñà‚ñÉ‚ñÜ‚ñÅ‚ñÖ‚ñà‚ñÅ‚ñÖ‚ñà‚ñÉ‚ñÜ‚ñà‚ñÉ‚ñÜ‚ñÅ‚ñÖ‚ñà‚ñÅ‚ñÖ‚ñà‚ñÉ‚ñÜ‚ñÅ
wandb:                                epoch ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:                            batch_idx ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                                _step ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:                             _runtime ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:                           _timestamp ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:                 val/avg_loss_group:0 ‚ñà‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ
wandb:             val/exp_avg_loss_group:0 ‚ñà‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ
wandb:                  val/avg_acc_group:0 ‚ñÇ‚ñÉ‚ñÑ‚ñÖ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ
wandb:     val/processed_data_count_group:0 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:        val/update_data_count_group:0 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:       val/update_batch_count_group:0 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                 val/avg_loss_group:1 ‚ñà‚ñá‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñÖ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá
wandb:             val/exp_avg_loss_group:1 ‚ñà‚ñá‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñÖ‚ñÜ‚ñá‚ñá‚ñÜ‚ñá‚ñá‚ñá
wandb:                  val/avg_acc_group:1 ‚ñÉ‚ñÖ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÑ‚ñÇ‚ñÉ‚ñÅ‚ñÅ‚ñÅ
wandb:     val/processed_data_count_group:1 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:        val/update_data_count_group:1 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:       val/update_batch_count_group:1 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                 val/avg_loss_group:2 ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñà‚ñà‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá
wandb:             val/exp_avg_loss_group:2 ‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÉ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñà‚ñà‚ñá‚ñá‚ñà‚ñá‚ñá‚ñá
wandb:                  val/avg_acc_group:2 ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÉ‚ñÅ‚ñÇ‚ñÖ‚ñà‚ñÜ‚ñà‚ñà‚ñà
wandb:     val/processed_data_count_group:2 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:        val/update_data_count_group:2 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:       val/update_batch_count_group:2 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                 val/avg_loss_group:3 ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñá‚ñÜ‚ñà‚ñà‚ñà‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:             val/exp_avg_loss_group:3 ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÜ‚ñÖ‚ñÖ‚ñÜ‚ñá‚ñÜ‚ñà‚ñà‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:                  val/avg_acc_group:3 ‚ñá‚ñá‚ñá‚ñÜ‚ñá‚ñá‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñÖ‚ñÖ‚ñÑ‚ñÉ‚ñÖ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÇ‚ñÅ‚ñÖ‚ñá‚ñÖ‚ñà‚ñà‚ñà
wandb:     val/processed_data_count_group:3 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:        val/update_data_count_group:3 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:       val/update_batch_count_group:3 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                  val/avg_actual_loss ‚ñà‚ñá‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá
wandb:              val/avg_per_sample_loss ‚ñà‚ñá‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá
wandb:                          val/avg_acc ‚ñÇ‚ñÑ‚ñÖ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ
wandb:                    val/model_norm_sq ‚ñà‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                         val/reg_loss ‚ñà‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                test/avg_loss_group:0 ‚ñà‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ
wandb:            test/exp_avg_loss_group:0 ‚ñà‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá
wandb:                 test/avg_acc_group:0 ‚ñÇ‚ñÉ‚ñÑ‚ñÖ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ
wandb:    test/processed_data_count_group:0 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:       test/update_data_count_group:0 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:      test/update_batch_count_group:0 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                test/avg_loss_group:1 ‚ñà‚ñá‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñá‚ñá‚ñá
wandb:            test/exp_avg_loss_group:1 ‚ñà‚ñá‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá
wandb:                 test/avg_acc_group:1 ‚ñÉ‚ñÖ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÑ‚ñÇ‚ñÉ‚ñÅ‚ñÅ‚ñÅ
wandb:    test/processed_data_count_group:1 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:       test/update_data_count_group:1 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:      test/update_batch_count_group:1 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                test/avg_loss_group:2 ‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:            test/exp_avg_loss_group:2 ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñÜ‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:                 test/avg_acc_group:2 ‚ñà‚ñà‚ñá‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÇ‚ñÑ‚ñÑ‚ñÉ‚ñÑ‚ñÇ‚ñÉ‚ñÜ‚ñà‚ñá‚ñà‚ñà‚ñà
wandb:    test/processed_data_count_group:2 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:       test/update_data_count_group:2 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:      test/update_batch_count_group:2 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                test/avg_loss_group:3 ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñá‚ñá‚ñà‚ñà‚ñà‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:            test/exp_avg_loss_group:3 ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñá‚ñá‚ñà‚ñà‚ñà‚ñá‚ñà‚ñà‚ñà‚ñà
wandb:                 test/avg_acc_group:3 ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÅ‚ñÅ‚ñÖ‚ñá‚ñÑ‚ñà‚ñà‚ñà
wandb:    test/processed_data_count_group:3 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:       test/update_data_count_group:3 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:      test/update_batch_count_group:3 ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                 test/avg_actual_loss ‚ñà‚ñá‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá
wandb:             test/avg_per_sample_loss ‚ñà‚ñá‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá
wandb:                         test/avg_acc ‚ñÇ‚ñÑ‚ñÖ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñá‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÉ‚ñÇ‚ñÉ‚ñÅ‚ñÅ‚ñÅ
wandb:                   test/model_norm_sq ‚ñà‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                        test/reg_loss ‚ñà‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb: 
wandb: Synced 5 W&B file(s), 1 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced colorful-sky-65: https://wandb.ai/gaotang/spurious_CUB/runs/37j0z3ds

Done


problem with metadata_aug.csv
(<class 'NotADirectoryError'>, NotADirectoryError(20, 'Not a directory'), <traceback object at 0x2b1cece57d88>)


problem with val_accuracies.txt
(<class 'NotADirectoryError'>, NotADirectoryError(20, 'Not a directory'), <traceback object at 0x2b1cece57c08>)
Downstream Accuracies for JTT_upweight_100_epochs_100_lr_1e-05_weight_decay_1.0 with 4 groups.
Val Robust Worst Group val   acc (early stop at epoch 24): 87.2
Val Robust Worst Group test  acc (early stop at epoch 24): 86.3
Val Average Acc val   acc (early stop at epoch 24): 90.2
Val Average Acc test  acc (early stop at epoch 24): 89.6
group 0 acc val   acc (early stop at epoch 24): 92.7
group 0 acc test  acc (early stop at epoch 24): 93.2
group 1 acc val   acc (early stop at epoch 24): 87.6
group 1 acc test  acc (early stop at epoch 24): 86.3
group 2 acc val   acc (early stop at epoch 24): 87.2
group 2 acc test  acc (early stop at epoch 24): 89.4
group 3 acc val   acc (early stop at epoch 24): 93.2
group 3 acc test  acc (early stop at epoch 24): 89.1


Downstream Accuracies for JTT_upweight_50_epochs_100_lr_1e-05_weight_decay_1.0 with 4 groups.
Val Robust Worst Group val   acc (early stop at epoch 25): 85.2
Val Robust Worst Group test  acc (early stop at epoch 25): 85.5
Val Average Acc val   acc (early stop at epoch 25): 89.1
Val Average Acc test  acc (early stop at epoch 25): 89.6
group 0 acc val   acc (early stop at epoch 25): 92.7
group 0 acc test  acc (early stop at epoch 25): 92.9
group 1 acc val   acc (early stop at epoch 25): 85.2
group 1 acc test  acc (early stop at epoch 25): 85.5
group 2 acc val   acc (early stop at epoch 25): 85.7
group 2 acc test  acc (early stop at epoch 25): 89.9
group 3 acc val   acc (early stop at epoch 25): 93.2
group 3 acc test  acc (early stop at epoch 25): 92.7


Downstream Accuracies for JTT_upweight_20_epochs_100_lr_1e-05_weight_decay_1.0 with 4 groups.
Val Robust Worst Group val   acc (early stop at epoch 53): 81.2
Val Robust Worst Group test  acc (early stop at epoch 53): 83.0
Val Average Acc val   acc (early stop at epoch 53): 90.7
Val Average Acc test  acc (early stop at epoch 53): 90.5
group 0 acc val   acc (early stop at epoch 53): 97.2
group 0 acc test  acc (early stop at epoch 53): 97.6
group 1 acc val   acc (early stop at epoch 53): 86.1
group 1 acc test  acc (early stop at epoch 53): 84.7
group 2 acc val   acc (early stop at epoch 53): 81.2
group 2 acc test  acc (early stop at epoch 53): 83.0
group 3 acc val   acc (early stop at epoch 53): 94.0
group 3 acc test  acc (early stop at epoch 53): 93.6


